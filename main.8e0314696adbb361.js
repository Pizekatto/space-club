(self.webpackChunkcrud=self.webpackChunkcrud||[]).push([[179],{702:(Gs,jr,zi)=>{"use strict";function mn(n){return"function"==typeof n}function io(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const wr=io(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function f(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class Ie{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(mn(i))try{i()}catch(s){t=s instanceof wr?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{hn(s)}catch(u){t=t??[],u instanceof wr?t=[...t,...u.errors]:t.push(u)}}if(t)throw new wr(t)}}add(t){var e;if(t&&t!==this)if(this.closed)hn(t);else{if(t instanceof Ie){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&f(e,t)}remove(t){const{_finalizers:e}=this;e&&f(e,t),t instanceof Ie&&t._removeParent(this)}}Ie.EMPTY=(()=>{const n=new Ie;return n.closed=!0,n})();const Pi=Ie.EMPTY;function Ar(n){return n instanceof Ie||n&&"closed"in n&&mn(n.remove)&&mn(n.add)&&mn(n.unsubscribe)}function hn(n){mn(n)?n():n.unsubscribe()}const ln={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Vi={setTimeout(n,t,...e){const{delegate:i}=Vi;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=Vi;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Ir(n){Vi.setTimeout(()=>{const{onUnhandledError:t}=ln;if(!t)throw n;t(n)})}function ro(){}const Ci=xo("C",void 0,void 0);function xo(n,t,e){return{kind:n,value:t,error:e}}let Bo=null;function oo(n){if(ln.useDeprecatedSynchronousErrorHandling){const t=!Bo;if(t&&(Bo={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=Bo;if(Bo=null,e)throw i}}else n()}class vs extends Ie{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Ar(t)&&t.add(this)):this.destination=ul}static create(t,e,i){return new Pa(t,e,i)}next(t){this.isStopped?Xl(function Ra(n){return xo("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Xl(function ka(n){return xo("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Xl(Ci,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const rs=Function.prototype.bind;function pt(n,t){return rs.call(n,t)}class qs{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){xn(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){xn(i)}else xn(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){xn(e)}}}class Pa extends vs{constructor(t,e,i){let r;if(super(),mn(t)||!t)r={next:t??void 0,error:e??void 0,complete:i??void 0};else{let s;this&&ln.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&pt(t.next,s),error:t.error&&pt(t.error,s),complete:t.complete&&pt(t.complete,s)}):r=t}this.destination=new qs(r)}}function xn(n){ln.useDeprecatedSynchronousErrorHandling?function aa(n){ln.useDeprecatedSynchronousErrorHandling&&Bo&&(Bo.errorThrown=!0,Bo.error=n)}(n):Ir(n)}function Xl(n,t){const{onStoppedNotification:e}=ln;e&&Vi.setTimeout(()=>e(n,t))}const ul={closed:!0,next:ro,error:function Ei(n){throw n},complete:ro},He="function"==typeof Symbol&&Symbol.observable||"@@observable";function mt(n){return n}function Xi(n){return 0===n.length?mt:1===n.length?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}let Vt=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){const s=function Oi(n){return n&&n instanceof vs||function os(n){return n&&mn(n.next)&&mn(n.error)&&mn(n.complete)}(n)&&Ar(n)}(e)?e:new Pa(e,i,r);return oo(()=>{const{operator:u,source:m}=this;s.add(u?u.call(s,m):m?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=gn(i))((r,s)=>{const u=new Pa({next:m=>{try{e(m)}catch(b){s(b),u.unsubscribe()}},error:s,complete:r});this.subscribe(u)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[He](){return this}pipe(...e){return Xi(e)(this)}toPromise(e){return new(e=gn(e))((i,r)=>{let s;this.subscribe(u=>s=u,u=>r(u),()=>i(s))})}}return n.create=t=>new n(t),n})();function gn(n){var t;return null!==(t=n??ln.Promise)&&void 0!==t?t:Promise}const bs=io(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Xt=(()=>{class n extends Vt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Oa(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new bs}next(e){oo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){oo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){oo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:s}=this;return i||r?Pi:(this.currentObservers=null,s.push(e),new Ie(()=>{this.currentObservers=null,f(s,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:s}=this;i?e.error(r):s&&e.complete()}asObservable(){const e=new Vt;return e.source=this,e}}return n.create=(t,e)=>new Oa(t,e),n})();class Oa extends Xt{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:Pi}}function la(n){return mn(n?.lift)}function Ui(n){return t=>{if(la(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function fi(n,t,e,i,r){return new Fc(n,t,e,i,r)}class Fc extends vs{constructor(t,e,i,r,s,u){super(t),this.onFinalize=s,this.shouldUnsubscribe=u,this._next=e?function(m){try{e(m)}catch(b){t.error(b)}}:super._next,this._error=r?function(m){try{r(m)}catch(b){t.error(b)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(m){t.error(m)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function xt(n,t){return Ui((e,i)=>{let r=0;e.subscribe(fi(i,s=>{i.next(n.call(t,s,r++))}))})}function Cs(n){return this instanceof Cs?(this.v=n,this):new Cs(n)}function gl(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function zo(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(s){e[s]=n[s]&&function(u){return new Promise(function(m,b){!function r(s,u,m,b){Promise.resolve(b).then(function(E){s({value:E,done:m})},u)}(m,b,(u=n[s](u)).done,u.value)})}}}const _e=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ee(n){return mn(n?.then)}function Ce(n){return mn(n[He])}function ye(n){return Symbol.asyncIterator&&mn(n?.[Symbol.asyncIterator])}function Oe(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ut=function ct(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function it(n){return mn(n?.[ut])}function cn(n){return function fl(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(n,t||[]),s=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(H){i[H]&&(r[H]=function(q){return new Promise(function(oe,de){s.push([H,q,oe,de])>1||m(H,q)})})}function m(H,q){try{!function b(H){H.value instanceof Cs?Promise.resolve(H.value.v).then(E,T):O(s[0][2],H)}(i[H](q))}catch(oe){O(s[0][3],oe)}}function E(H){m("next",H)}function T(H){m("throw",H)}function O(H,q){H(q),s.shift(),s.length&&m(s[0][0],s[0][1])}}(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:r}=yield Cs(e.read());if(r)return yield Cs(void 0);yield yield Cs(i)}}finally{e.releaseLock()}})}function wn(n){return mn(n?.getReader)}function Lt(n){if(n instanceof Vt)return n;if(null!=n){if(Ce(n))return function kn(n){return new Vt(t=>{const e=n[He]();if(mn(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(_e(n))return function zn(n){return new Vt(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(Ee(n))return function Hi(n){return new Vt(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Ir)})}(n);if(ye(n))return Hr(n);if(it(n))return function pr(n){return new Vt(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(wn(n))return function vr(n){return Hr(cn(n))}(n)}throw Oe(n)}function Hr(n){return new Vt(t=>{(function ca(n,t){var e,i,r,s;return function Fa(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=gl(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(u){r={error:u}}finally{try{i&&!i.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Ni(n,t,e,i=0,r=!1){const s=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Ki(n,t,e=1/0){return mn(t)?Ki((i,r)=>xt((s,u)=>t(i,s,r,u))(Lt(n(i,r))),e):("number"==typeof t&&(e=t),Ui((i,r)=>function wo(n,t,e,i,r,s,u,m){const b=[];let E=0,T=0,O=!1;const H=()=>{O&&!b.length&&!E&&t.complete()},q=de=>E<i?oe(de):b.push(de),oe=de=>{s&&t.next(de),E++;let xe=!1;Lt(e(de,T++)).subscribe(fi(t,Pe=>{r?.(Pe),s?q(Pe):t.next(Pe)},()=>{xe=!0},void 0,()=>{if(xe)try{for(E--;b.length&&E<i;){const Pe=b.shift();u?Ni(t,u,()=>oe(Pe)):oe(Pe)}H()}catch(Pe){t.error(Pe)}}))};return n.subscribe(fi(t,q,()=>{O=!0,H()})),()=>{m?.()}}(i,r,n,e)))}function Vc(n=1/0){return Ki(mt,n)}const Es=new Vt(n=>n.complete());function Uc(n){return n&&mn(n.schedule)}function Hd(n){return n[n.length-1]}function $d(n){return mn(Hd(n))?n.pop():void 0}function Vo(n){return Uc(Hd(n))?n.pop():void 0}function ih(n,t=0){return Ui((e,i)=>{e.subscribe(fi(i,r=>Ni(i,n,()=>i.next(r),t),()=>Ni(i,n,()=>i.complete(),t),r=>Ni(i,n,()=>i.error(r),t)))})}function rh(n,t=0){return Ui((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function da(n,t){if(!n)throw new Error("Iterable cannot be null");return new Vt(e=>{Ni(e,t,()=>{const i=n[Symbol.asyncIterator]();Ni(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function mr(n,t){return t?function kr(n,t){if(null!=n){if(Ce(n))return function ec(n,t){return Lt(n).pipe(rh(t),ih(t))}(n,t);if(_e(n))return function Gd(n,t){return new Vt(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(Ee(n))return function Ba(n,t){return Lt(n).pipe(rh(t),ih(t))}(n,t);if(ye(n))return da(n,t);if(it(n))return function ze(n,t){return new Vt(e=>{let i;return Ni(e,t,()=>{i=n[ut](),Ni(e,t,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(u){return void e.error(u)}s?e.complete():e.next(r)},0,!0)}),()=>mn(i?.return)&&i.return()})}(n,t);if(wn(n))return function fr(n,t){return da(cn(n),t)}(n,t)}throw Oe(n)}(n,t):Lt(n)}function $i(...n){const t=Vo(n),e=function Na(n,t){return"number"==typeof Hd(n)?n.pop():t}(n,1/0),i=n;return i.length?1===i.length?Lt(i[0]):Vc(e)(mr(i,t)):Es}function oh(n={}){const{connector:t=(()=>new Xt),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let u,m,b,E=0,T=!1,O=!1;const H=()=>{m?.unsubscribe(),m=void 0},q=()=>{H(),u=b=void 0,T=O=!1},oe=()=>{const de=u;q(),de?.unsubscribe()};return Ui((de,xe)=>{E++,!O&&!T&&H();const Pe=b=b??t();xe.add(()=>{E--,0===E&&!O&&!T&&(m=sh(oe,r))}),Pe.subscribe(xe),!u&&E>0&&(u=new Pa({next:we=>Pe.next(we),error:we=>{O=!0,H(),m=sh(q,e,we),Pe.error(we)},complete:()=>{T=!0,H(),m=sh(q,i),Pe.complete()}}),Lt(de).subscribe(u))})(s)}}function sh(n,t,...e){if(!0===t)return void n();if(!1===t)return;const i=new Pa({next:()=>{i.unsubscribe(),n()}});return Lt(t(...e)).subscribe(i)}function Jn(n){for(let t in n)if(n[t]===Jn)return t;throw Error("Could not find renamed property on target object.")}function yt(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Gt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Gt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function Cn(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const as=Jn({__forward_ref__:Jn});function Pn(n){return n.__forward_ref__=Pn,n.toString=function(){return Gt(this())},n}function vt(n){return Co(n)?n():n}function Co(n){return"function"==typeof n&&n.hasOwnProperty(as)&&n.__forward_ref__===Pn}function tc(n){return n&&!!n.\u0275providers}const ls="https://g.co/ng/security#xss";class ke extends Error{constructor(t,e){super(function qd(n,t){return`NG0${Math.abs(n)}${t?": "+t:""}`}(t,e)),this.code=t}}function Qt(n){return"string"==typeof n?n:null==n?"":String(n)}function _l(n,t){throw new ke(-201,!1)}function Uo(n,t){null==n&&function Zn(n,t,e,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${e} ${i} ${t} <=Actual]`))}(t,n,null,"!=")}function at(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function pn(n){return{providers:n.providers||[],imports:n.imports||[]}}function ch(n){return ic(n,ha)||ic(n,$c)}function ic(n,t){return n.hasOwnProperty(t)?n[t]:null}function dh(n){return n&&(n.hasOwnProperty(Zs)||n.hasOwnProperty(za))?n[Zs]:null}const ha=Jn({\u0275prov:Jn}),Zs=Jn({\u0275inj:Jn}),$c=Jn({ngInjectableDef:Jn}),za=Jn({ngInjectorDef:Jn});var Jt=(()=>((Jt=Jt||{})[Jt.Default=0]="Default",Jt[Jt.Host=1]="Host",Jt[Jt.Self=2]="Self",Jt[Jt.SkipSelf=4]="SkipSelf",Jt[Jt.Optional=8]="Optional",Jt))();let yl;function Eo(n){const t=yl;return yl=n,t}function Zd(n,t,e){const i=ch(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&Jt.Optional?null:void 0!==t?t:void _l(Gt(n))}const Ii=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),rc={},uh="__NG_DI_FLAG__",qc="ngTempTokenPath",Op=/\n/gm,Xd="__source";let Ys;function jo(n){const t=Ys;return Ys=n,t}function hh(n,t=Jt.Default){if(void 0===Ys)throw new ke(-203,!1);return null===Ys?Zd(n,void 0,t):Ys.get(n,t&Jt.Optional?null:void 0,t)}function Ne(n,t=Jt.Default){return(function Gc(){return yl}()||hh)(vt(n),t)}function gt(n,t=Jt.Default){return Ne(n,Yc(t))}function Yc(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Xc(n){const t=[];for(let e=0;e<n.length;e++){const i=vt(n[e]);if(Array.isArray(i)){if(0===i.length)throw new ke(900,!1);let r,s=Jt.Default;for(let u=0;u<i.length;u++){const m=i[u],b=Fp(m);"number"==typeof b?-1===b?r=m.token:s|=b:r=m}t.push(Ne(r,s))}else t.push(Ne(i))}return t}function vl(n,t){return n[uh]=t,n.prototype[uh]=t,n}function Fp(n){return n[uh]}function pa(n){return{toString:n}.toString()}var Ds=(()=>((Ds=Ds||{})[Ds.OnPush=0]="OnPush",Ds[Ds.Default=1]="Default",Ds))(),Do=(()=>{return(n=Do||(Do={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Do;var n})();const So={},ei=[],ph=Jn({\u0275cmp:Jn}),Lp=Jn({\u0275dir:Jn}),Np=Jn({\u0275pipe:Jn}),fh=Jn({\u0275mod:Jn}),Xs=Jn({\u0275fac:Jn}),oc=Jn({__NG_ELEMENT_ID__:Jn}),Jd=Jn({__NG_ENV_ID__:Jn});function Bp(n,t,e){let i=n.length;for(;;){const r=n.indexOf(t,e);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=t.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}e=r+1}}function mh(n,t,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const s=e[i++],u=e[i++],m=e[i++];n.setAttribute(t,u,m,s)}else{const s=r,u=e[++i];Kc(s)?n.setProperty(t,s,u):n.setAttribute(t,s,u),i++}}return i}function Fm(n){return 3===n||4===n||6===n}function Kc(n){return 64===n.charCodeAt(0)}function fa(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?e=r:0===e||gh(n,e,r,null,-1===e||2===e?t[++i]:null)}}return n}function gh(n,t,e,i,r){let s=0,u=n.length;if(-1===t)u=-1;else for(;s<n.length;){const m=n[s++];if("number"==typeof m){if(m===t){u=-1;break}if(m>t){u=s-1;break}}}for(;s<n.length;){const m=n[s];if("number"==typeof m)break;if(m===e){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==u&&(n.splice(u,0,t),s=u+1),n.splice(s++,0,e),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const Jc="ng-template";function zp(n,t,e){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const u=n[i++];if(e&&"class"===s&&-1!==Bp(u.toLowerCase(),t,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===t)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function Ks(n){return 4===n.type&&n.value!==Jc}function _h(n,t,e){return t===(4!==n.type||e?n.value:Jc)}function Vp(n,t,e){let i=4;const r=n.attrs||[],s=function Up(n){for(let t=0;t<n.length;t++)if(Fm(n[t]))return t;return n.length}(r);let u=!1;for(let m=0;m<t.length;m++){const b=t[m];if("number"!=typeof b){if(!u)if(4&i){if(i=2|1&i,""!==b&&!_h(n,b,e)||""===b&&1===t.length){if(Ho(i))return!1;u=!0}}else{const E=8&i?b:t[++m];if(8&i&&null!==n.attrs){if(!zp(n.attrs,E,e)){if(Ho(i))return!1;u=!0}continue}const O=Lm(8&i?"class":b,r,Ks(n),e);if(-1===O){if(Ho(i))return!1;u=!0;continue}if(""!==E){let H;H=O>s?"":r[O+1].toLowerCase();const q=8&i?H:null;if(q&&-1!==Bp(q,E,0)||2&i&&E!==H){if(Ho(i))return!1;u=!0}}}}else{if(!u&&!Ho(i)&&!Ho(b))return!1;if(u&&Ho(b))continue;u=!1,i=b|1&i}}return Ho(i)||u}function Ho(n){return 0==(1&n)}function Lm(n,t,e,i){if(null===t)return-1;let r=0;if(i||!e){let s=!1;for(;r<t.length;){const u=t[r];if(u===n)return r;if(3===u||6===u)s=!0;else{if(1===u||2===u){let m=t[++r];for(;"string"==typeof m;)m=t[++r];continue}if(4===u)break;if(0===u){r+=4;continue}}r+=s?1:2}return-1}return function vh(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function yh(n,t,e=!1){for(let i=0;i<t.length;i++)if(Vp(n,t[i],e))return!0;return!1}function Qd(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function jp(n,t){return n?":not("+t.trim()+")":t}function Hp(n){let t=n[0],e=1,i=2,r="",s=!1;for(;e<n.length;){let u=n[e];if("string"==typeof u)if(2&i){const m=n[++e];r+="["+u+(m.length>0?'="'+m+'"':"")+"]"}else 8&i?r+="."+u:4&i&&(r+=" "+u);else""!==r&&!Ho(u)&&(t+=jp(s,r),r=""),i=u,s=s||!Ho(i);e++}return""!==r&&(t+=jp(s,r)),t}function Fn(n){return pa(()=>{const t=Gp(n),e={...t,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Ds.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||Do.Emulated,styles:n.styles||ei,_:null,schemas:n.schemas||null,tView:null,id:""};qp(e);const i=n.dependencies;return e.directiveDefs=Ss(i,!1),e.pipeDefs=Ss(i,!0),e.id=function Ms(n){let t=0;const e=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of e)t=Math.imul(31,t)+r.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(e),e})}function Nm(n){return di(n)||ao(n)}function bh(n){return null!==n}function En(n){return pa(()=>({type:n.type,bootstrap:n.bootstrap||ei,declarations:n.declarations||ei,imports:n.imports||ei,exports:n.exports||ei,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Bm(n,t){if(null==n)return So;const e={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),e[r]=i,t&&(t[r]=s)}return e}function rt(n){return pa(()=>{const t=Gp(n);return qp(t),t})}function $o(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function di(n){return n[ph]||null}function ao(n){return n[Lp]||null}function Mo(n){return n[Np]||null}function Rr(n,t){const e=n[fh]||null;if(!e&&!0===t)throw new Error(`Type ${Gt(n)} does not have '\u0275mod' property.`);return e}function Gp(n){const t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||ei,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Bm(n.inputs,t),outputs:Bm(n.outputs)}}function qp(n){n.features?.forEach(t=>t(n))}function Ss(n,t){if(!n)return null;const e=t?Mo:Nm;return()=>("function"==typeof n?n():n).map(i=>e(i)).filter(bh)}const er=0,It=1,dn=2,ki=3,Go=4,ma=5,tn=6,ga=7,tr=8,ja=9,Ts=10,Dn=11,bl=12,_a=13,sc=14,nr=15,ya=16,Js=17,As=18,Ha=19,td=20,Qs=21,Is=22,bt=23,qo=24,$n=25,ac=1,Cr=2,Wo=7,lc=8,xl=9,Pr=11;function Or(n){return Array.isArray(n)&&"object"==typeof n[ac]}function lo(n){return Array.isArray(n)&&!0===n[ac]}function Zp(n){return 0!=(4&n.flags)}function Cl(n){return n.componentOffset>-1}function $a(n){return 1==(1&n.flags)}function us(n){return!!n.template}function eu(n){return 0!=(512&n[dn])}function Fr(n,t){return n.hasOwnProperty(Xs)?n[Xs]:null}let Ch=Ii.WeakRef??class dc{constructor(t){this.ref=t}deref(){return this.ref}},Jp=0,To=null,va=!1;function dt(n){const t=To;return To=n,t}class Eh{constructor(){this.id=Jp++,this.ref=function Dt(n){return new Ch(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[t,e]of this.producers){const i=e.producerNode.deref();if(void 0!==i&&e.atTrackingVersion===this.trackingVersion){if(i.producerPollStatus(e.seenValueVersion))return!0}else this.producers.delete(t),i?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const t=va;va=!0;try{for(const[e,i]of this.consumers){const r=i.consumerNode.deref();void 0!==r&&r.trackingVersion===i.atTrackingVersion?r.onConsumerDependencyMayHaveChanged():(this.consumers.delete(e),r?.producers.delete(this.id))}}finally{va=t}}producerAccessed(){if(va)throw new Error("");if(null===To)return;let t=To.producers.get(this.id);void 0===t?(t={consumerNode:To.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:To.trackingVersion},To.producers.set(this.id,t),this.consumers.set(To.id,t)):(t.seenValueVersion=this.valueVersion,t.atTrackingVersion=To.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==To?.consumerAllowSignalWrites}producerPollStatus(t){return this.valueVersion!==t||(this.onProducerUpdateValueVersion(),this.valueVersion!==t)}}let Gm=null;const y=()=>{};class x extends Eh{constructor(t,e,i){super(),this.watch=t,this.schedule=e,this.dirty=!1,this.cleanupFn=y,this.registerOnCleanup=r=>{this.cleanupFn=r},this.consumerAllowSignalWrites=i}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const t=dt(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=y,this.watch(this.registerOnCleanup)}finally{dt(t)}}cleanup(){this.cleanupFn()}}class C{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function M(){return I}function I(n){return n.type.prototype.ngOnChanges&&(n.setInput=N),R}function R(){const n=V(this),t=n?.current;if(t){const e=n.previous;if(e===So)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function N(n,t,e,i){const r=this.declaredInputs[e],s=V(n)||function W(n,t){return n[L]=t}(n,{previous:So,current:null}),u=s.current||(s.current={}),m=s.previous,b=m[r];u[r]=new C(b&&b.currentValue,t,m===So),n[i]=t}M.ngInherit=!0;const L="__ngSimpleChanges__";function V(n){return n[L]||null}const K=function(n,t,e){},ee="svg";function Z(n){for(;Array.isArray(n);)n=n[er];return n}function re(n,t){return Z(t[n])}function ue(n,t){return Z(t[n.index])}function me(n,t){return n.data[t]}function be(n,t){return n[t]}function ve(n,t){const e=t[n];return Or(e)?e:e[er]}function Je(n){return 128==(128&n[dn])}function Ve(n,t){return null==t?null:n[t]}function Re(n){n[Js]=0}function Qe(n){1024&n[dn]||(n[dn]|=1024,$e(n,1))}function Me(n){1024&n[dn]&&(n[dn]&=-1025,$e(n,-1))}function $e(n,t){let e=n[ki];if(null===e)return;e[ma]+=t;let i=e;for(e=e[ki];null!==e&&(1===t&&1===i[ma]||-1===t&&0===i[ma]);)e[ma]+=t,i=e,e=e[ki]}const Le={lFrame:ry(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Sn(){return Le.bindingsEnabled}function At(){return null!==Le.skipHydrationRootTNode}function qe(){return Le.lFrame.lView}function Mn(){return Le.lFrame.tView}function ti(n){return Le.lFrame.contextLView=n,n[tr]}function on(n){return Le.lFrame.contextLView=null,n}function bn(){let n=Yn();for(;null!==n&&64===n.type;)n=n.parent;return n}function Yn(){return Le.lFrame.currentTNode}function Ji(n,t){const e=Le.lFrame;e.currentTNode=n,e.isParent=t}function Si(){return Le.lFrame.isParent}function uo(){Le.lFrame.isParent=!1}function ir(){const n=Le.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function Ga(){return Le.lFrame.bindingIndex++}function ps(n){const t=Le.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function t0(n,t){const e=Le.lFrame;e.bindingIndex=e.bindingRootIndex=n,tf(t)}function tf(n){Le.lFrame.currentDirectiveIndex=n}function Mh(n){const t=Le.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}function ny(){return Le.lFrame.currentQueryIndex}function nf(n){Le.lFrame.currentQueryIndex=n}function qm(n){const t=n[It];return 2===t.type?t.declTNode:1===t.type?n[tn]:null}function Dl(n,t,e){if(e&Jt.SkipSelf){let r=t,s=n;for(;!(r=r.parent,null!==r||e&Jt.Host||(r=qm(s),null===r||(s=s[sc],10&r.type))););if(null===r)return!1;t=r,n=s}const i=Le.lFrame=iy();return i.currentTNode=t,i.lView=n,!0}function Th(n){const t=iy(),e=n[It];Le.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function iy(){const n=Le.lFrame,t=null===n?null:n.child;return null===t?ry(n):t}function ry(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function n0(){const n=Le.lFrame;return Le.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const r0=n0;function oy(){const n=n0();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Lr(){return Le.lFrame.selectedIndex}function fs(n){Le.lFrame.selectedIndex=n}function ui(){const n=Le.lFrame;return me(n.tView,n.selectedIndex)}function ba(){Le.lFrame.currentNamespace=ee}let s0=!0;function Wm(){return s0}function hc(n){s0=n}function ks(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const s=n.data[e].type.prototype,{ngAfterContentInit:u,ngAfterContentChecked:m,ngAfterViewInit:b,ngAfterViewChecked:E,ngOnDestroy:T}=s;u&&(n.contentHooks??=[]).push(-e,u),m&&((n.contentHooks??=[]).push(e,m),(n.contentCheckHooks??=[]).push(e,m)),b&&(n.viewHooks??=[]).push(-e,b),E&&((n.viewHooks??=[]).push(e,E),(n.viewCheckHooks??=[]).push(e,E)),null!=T&&(n.destroyHooks??=[]).push(e,T)}}function Zm(n,t,e){Ot(n,t,3,e)}function Ym(n,t,e,i){(3&n[dn])===e&&Ot(n,t,e,i)}function rr(n,t){let e=n[dn];(3&e)===t&&(e&=4095,e+=1,n[dn]=e)}function Ot(n,t,e,i){const s=i??-1,u=t.length-1;let m=0;for(let b=void 0!==i?65535&n[Js]:0;b<u;b++)if("number"==typeof t[b+1]){if(m=t[b],null!=i&&m>=i)break}else t[b]<0&&(n[Js]+=65536),(m<s||-1==s)&&(Xm(n,e,t,b),n[Js]=(4294901760&n[Js])+b+2),b++}function pc(n,t){K(4,n,t);const e=dt(null);try{t.call(n)}finally{dt(e),K(5,n,t)}}function Xm(n,t,e,i){const r=e[i]<0,s=e[i+1],m=n[r?-e[i]:e[i]];r?n[dn]>>12<n[Js]>>16&&(3&n[dn])===t&&(n[dn]+=4096,pc(m,s)):pc(m,s)}const qr=-1;class Ah{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function ly(n){return n!==qr}function lf(n){return 32767&n}function kh(n,t){let e=function rC(n){return n>>16}(n),i=t;for(;e>0;)i=i[sc],e--;return i}let Km=!0;function ad(n){const t=Km;return Km=n,t}const Ml=255,Jm=5;let d0=0;const Rs={};function Zo(n,t){const e=Ao(n,t);if(-1!==e)return e;const i=t[It];i.firstCreatePass&&(n.injectorIndex=t.length,au(i.data,n),au(t,null),au(i.blueprint,null));const r=Ps(n,t),s=n.injectorIndex;if(ly(r)){const u=lf(r),m=kh(r,t),b=m[It].data;for(let E=0;E<8;E++)t[s+E]=m[u+E]|b[u+E]}return t[s+8]=r,s}function au(n,t){n.push(0,0,0,0,0,0,0,0,t)}function Ao(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Ps(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;null!==r;){if(i=py(r),null===i)return qr;if(e++,r=r[sc],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return qr}function uf(n,t,e){!function df(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(oc)&&(i=e[oc]),null==i&&(i=e[oc]=d0++);const r=i&Ml;t.data[n+(r>>Jm)]|=1<<r}(n,t,e)}function cy(n,t,e){if(e&Jt.Optional||void 0!==n)return n;_l()}function Rh(n,t,e,i){if(e&Jt.Optional&&void 0===i&&(i=null),!(e&(Jt.Self|Jt.Host))){const r=n[ja],s=Eo(void 0);try{return r?r.get(t,i,e&Jt.Optional):Zd(t,i,e&Jt.Optional)}finally{Eo(s)}}return cy(i,0,e)}function xa(n,t,e,i=Jt.Default,r){if(null!==n){if(2048&t[dn]&&!(i&Jt.Self)){const u=function p0(n,t,e,i,r){let s=n,u=t;for(;null!==s&&null!==u&&2048&u[dn]&&!(512&u[dn]);){const m=u0(s,u,e,i|Jt.Self,Rs);if(m!==Rs)return m;let b=s.parent;if(!b){const E=u[td];if(E){const T=E.get(e,Rs,i);if(T!==Rs)return T}b=py(u),u=u[sc]}s=b}return r}(n,t,e,i,Rs);if(u!==Rs)return u}const s=u0(n,t,e,i,Rs);if(s!==Rs)return s}return Rh(t,e,i,r)}function u0(n,t,e,i,r){const s=function lu(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(oc)?n[oc]:void 0;return"number"==typeof t?t>=0?t&Ml:h0:t}(e);if("function"==typeof s){if(!Dl(t,n,i))return i&Jt.Host?cy(r,0,i):Rh(t,e,i,r);try{const u=s(i);if(null!=u||i&Jt.Optional)return u;_l()}finally{r0()}}else if("number"==typeof s){let u=null,m=Ao(n,t),b=qr,E=i&Jt.Host?t[nr][tn]:null;for((-1===m||i&Jt.SkipSelf)&&(b=-1===m?Ps(n,t):t[m+8],b!==qr&&uy(i,!1)?(u=t[It],m=lf(b),t=kh(b,t)):m=-1);-1!==m;){const T=t[It];if(dy(s,m,T.data)){const O=oC(m,t,e,u,i,E);if(O!==Rs)return O}b=t[m+8],b!==qr&&uy(i,t[It].data[m+8]===E)&&dy(s,m,t)?(u=T,m=lf(b),t=kh(b,t)):m=-1}}return r}function oC(n,t,e,i,r,s){const u=t[It],m=u.data[n+8],T=hf(m,u,e,null==i?Cl(m)&&Km:i!=u&&0!=(3&m.type),r&Jt.Host&&s===m);return null!==T?ld(t,u,T,m):Rs}function hf(n,t,e,i,r){const s=n.providerIndexes,u=t.data,m=1048575&s,b=n.directiveStart,T=s>>20,H=r?m+T:n.directiveEnd;for(let q=i?m:m+T;q<H;q++){const oe=u[q];if(q<b&&e===oe||q>=b&&oe.type===e)return q}if(r){const q=u[b];if(q&&us(q)&&q.type===e)return b}return null}function ld(n,t,e,i){let r=n[e];const s=t.data;if(function l0(n){return n instanceof Ah}(r)){const u=r;u.resolving&&function Wd(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new ke(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Qn(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Qt(n)}(s[e]));const m=ad(u.canSeeViewProviders);u.resolving=!0;const b=u.injectImpl?Eo(u.injectImpl):null;Dl(n,i,Jt.Default);try{r=n[e]=u.factory(void 0,s,n,i),t.firstCreatePass&&e>=i.directiveStart&&function a0(n,t,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(i){const u=I(t);(e.preOrderHooks??=[]).push(n,u),(e.preOrderCheckHooks??=[]).push(n,u)}r&&(e.preOrderHooks??=[]).push(0-n,r),s&&((e.preOrderHooks??=[]).push(n,s),(e.preOrderCheckHooks??=[]).push(n,s))}(e,s[e],t)}finally{null!==b&&Eo(b),ad(m),u.resolving=!1,r0()}}return r}function dy(n,t,e){return!!(e[t+(n>>Jm)]&1<<n)}function uy(n,t){return!(n&Jt.Self||n&Jt.Host&&t)}class cu{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return xa(this._tNode,this._lView,t,Yc(i),e)}}function h0(){return new cu(bn(),qe())}function Un(n){return pa(()=>{const t=n.prototype.constructor,e=t[Xs]||hy(t),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Xs]||hy(r);if(s&&s!==e)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function hy(n){return Co(n)?()=>{const t=hy(vt(n));return t&&t()}:Fr(n)}function py(n){const t=n[It],e=t.type;return 2===e?t.declTNode:1===e?n[tn]:null}function Os(n){return function sr(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const i=e.length;let r=0;for(;r<i;){const s=e[r];if(Fm(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof e[r];)r++;else{if(s===t)return e[r+1];r+=2}}}return null}(bn(),n)}const dd="__parameters__";function du(n,t,e){return pa(()=>{const i=function pf(n){return function(...e){if(n){const i=n(...e);for(const r in i)this[r]=i[r]}}}(t);function r(...s){if(this instanceof r)return i.apply(this,s),this;const u=new r(...s);return m.annotation=u,m;function m(b,E,T){const O=b.hasOwnProperty(dd)?b[dd]:Object.defineProperty(b,dd,{value:[]})[dd];for(;O.length<=T;)O.push(null);return(O[T]=O[T]||[]).push(u),b}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function hd(n,t){n.forEach(e=>Array.isArray(e)?hd(e,t):t(e))}function eg(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function mc(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Tl(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}function ms(n,t,e){let i=Za(n,t);return i>=0?n[1|i]=e:(i=~i,function g0(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(1===r)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;)n[r]=n[r-2],r--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function ng(n,t){const e=Za(n,t);if(e>=0)return n[1|e]}function Za(n,t){return function ig(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){const s=i+(r-i>>1),u=n[s<<e];if(t===u)return s<<e;u>t?r=s:i=s+1}return~(r<<e)}(n,t,1)}const Er=vl(du("Optional"),8),br=vl(du("SkipSelf"),4);function Bh(n){return 128==(128&n.flags)}var qi=(()=>((qi=qi||{})[qi.Important=1]="Important",qi[qi.DashCase=2]="DashCase",qi))();const fC=/^>|^->|<!--|-->|--!>|<!-$/g,Cy=/(<|>)/,mC="\u200b$1\u200b";const Ey=new Map;let Dy=0;const My="__ngContext__";function Yo(n,t){Or(t)?(n[My]=t[Ha],function P0(n){Ey.set(n[Ha],n)}(t)):n[My]=t}let ug;function hg(n,t){return ug(n,t)}function fu(n){const t=n[ki];return lo(t)?t[ki]:t}function Iy(n){return Vh(n[bl])}function pg(n){return Vh(n[Go])}function Vh(n){for(;null!==n&&!lo(n);)n=n[Go];return n}function Uh(n,t,e,i,r){if(null!=i){let s,u=!1;lo(i)?s=i:Or(i)&&(u=!0,i=i[er]);const m=Z(i);0===n&&null!==e?null==r?Ry(t,e,m):_d(t,e,m,r||null,!0):1===n&&null!==e?_d(t,e,m,r||null,!0):2===n?function Tf(n,t,e){const i=qh(n,t);i&&function CC(n,t,e,i){n.removeChild(t,e,i)}(n,i,t,e)}(t,m,u):3===n&&t.destroyNode(m),null!=s&&function EC(n,t,e,i,r){const s=e[Wo];s!==Z(e)&&Uh(t,n,i,s,r);for(let m=Pr;m<e.length;m++){const b=e[m];Zh(b[It],b,n,t,i,s)}}(t,n,s,e,r)}}function Df(n,t){return n.createComment(function R0(n){return n.replace(fC,t=>t.replace(Cy,mC))}(t))}function Hh(n,t,e){return n.createElement(t,e)}function z0(n,t){const e=n[xl],i=e.indexOf(t);Me(t),e.splice(i,1)}function $h(n,t){if(n.length<=Pr)return;const e=Pr+t,i=n[e];if(i){const r=i[ya];null!==r&&r!==n&&z0(r,i),t>0&&(n[e-1][Go]=i[Go]);const s=mc(n,Pr+t);!function fg(n,t){Zh(n,t,t[Dn],2,null,null),t[er]=null,t[tn]=null}(i[It],i);const u=s[As];null!==u&&u.detachView(s[It]),i[ki]=null,i[Go]=null,i[dn]&=-129}return i}function V0(n,t){if(!(256&t[dn])){const e=t[Dn];t[bt]?.destroy(),t[qo]?.destroy(),e.destroyNode&&Zh(n,t,e,3,null,null),function vC(n){let t=n[bl];if(!t)return mg(n[It],n);for(;t;){let e=null;if(Or(t))e=t[bl];else{const i=t[Pr];i&&(e=i)}if(!e){for(;t&&!t[Go]&&t!==n;)Or(t)&&mg(t[It],t),t=t[ki];null===t&&(t=n),Or(t)&&mg(t[It],t),e=t&&t[Go]}t=e}}(t)}}function mg(n,t){if(!(256&t[dn])){t[dn]&=-129,t[dn]|=256,function wC(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const r=t[e[i]];if(!(r instanceof Ah)){const s=e[i+1];if(Array.isArray(s))for(let u=0;u<s.length;u+=2){const m=r[s[u]],b=s[u+1];K(4,m,b);try{b.call(m)}finally{K(5,m,b)}}else{K(4,r,s);try{s.call(r)}finally{K(5,r,s)}}}}}(n,t),function Gh(n,t){const e=n.cleanup,i=t[ga];if(null!==e)for(let s=0;s<e.length-1;s+=2)if("string"==typeof e[s]){const u=e[s+3];u>=0?i[u]():i[-u].unsubscribe(),s+=2}else e[s].call(i[e[s+1]]);null!==i&&(t[ga]=null);const r=t[Qs];if(null!==r){t[Qs]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,t),1===t[It].type&&t[Dn].destroy();const e=t[ya];if(null!==e&&lo(t[ki])){e!==t[ki]&&z0(e,t);const i=t[As];null!==i&&i.detachView(n)}!function vf(n){Ey.delete(n[Ha])}(t)}}function ky(n,t,e){return function U0(n,t,e){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return e[er];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Do.None||s===Do.Emulated)return null}return ue(i,e)}}(n,t.parent,e)}function _d(n,t,e,i,r){n.insertBefore(t,e,i,r)}function Ry(n,t,e){n.appendChild(t,e)}function j0(n,t,e,i,r){null!==i?_d(n,t,e,i,r):Ry(n,t,e)}function qh(n,t){return n.parentNode(t)}function Sf(n,t,e){return $0(n,t,e)}let mu,Wr,By,$0=function H0(n,t,e){return 40&n.type?ue(n,e):null};function Mf(n,t,e,i){const r=ky(n,i,t),s=t[Dn],m=Sf(i.parent||t[tn],i,t);if(null!=r)if(Array.isArray(e))for(let b=0;b<e.length;b++)j0(s,r,e[b],m,!1);else j0(s,r,e,m,!1);void 0!==mu&&mu(s,i,t,e,r)}function yc(n,t){if(null!==t){const e=t.type;if(3&e)return ue(t,n);if(4&e)return Oy(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return yc(n,i);{const r=n[t.index];return lo(r)?Oy(-1,r):Z(r)}}if(32&e)return hg(t,n)()||Z(n[t.index]);{const i=Py(n,t);return null!==i?Array.isArray(i)?i[0]:yc(fu(n[nr]),i):yc(n,t.next)}}return null}function Py(n,t){return null!==t?n[nr][tn].projection[t.projection]:null}function Oy(n,t){const e=Pr+n+1;if(e<t.length){const i=t[e],r=i[It].firstChild;if(null!==r)return yc(i,r)}return t[Wo]}function _g(n,t,e,i,r,s,u){for(;null!=e;){const m=i[e.index],b=e.type;if(u&&0===t&&(m&&Yo(Z(m),i),e.flags|=2),32!=(32&e.flags))if(8&b)_g(n,t,e.child,i,r,s,!1),Uh(t,n,r,m,s);else if(32&b){const E=hg(e,i);let T;for(;T=E();)Uh(t,n,r,T,s);Uh(t,n,r,m,s)}else 16&b?Ly(n,t,i,e,r,s):Uh(t,n,r,m,s);e=u?e.projectionNext:e.next}}function Zh(n,t,e,i,r,s){_g(e,i,n.firstChild,t,r,s,!1)}function Ly(n,t,e,i,r,s){const u=e[nr],b=u[tn].projection[i.projection];if(Array.isArray(b))for(let E=0;E<b.length;E++)Uh(t,n,r,b[E],s);else{let E=b;const T=u[ki];Bh(i)&&(E.flags|=128),_g(n,t,E,T,r,s,!0)}}function Af(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function Ny(n,t,e){const{mergedAttrs:i,classes:r,styles:s}=e;null!==i&&mh(n,t,i),null!==r&&Af(n,t,r),null!==s&&function q0(n,t,e){n.setAttribute(t,"style",e)}(n,t,s)}function Xa(n){return function gu(){if(void 0===Wr&&(Wr=null,Ii.trustedTypes))try{Wr=Ii.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Wr}()?.createHTML(n)||n}class yd{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ls})`}}class Y0 extends yd{getTypeName(){return"HTML"}}class AC extends yd{getTypeName(){return"Style"}}class IC extends yd{getTypeName(){return"Script"}}class kC extends yd{getTypeName(){return"URL"}}class RC extends yd{getTypeName(){return"ResourceURL"}}function ta(n){return n instanceof yd?n.changingThisBreaksApplicationSecurity:n}function Ka(n,t){const e=function PC(n){return n instanceof yd&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${ls})`)}return e===t}class OC{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Xa(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class Pf{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const e=this.inertDocument.createElement("template");return e.innerHTML=Xa(t),e}}const LC=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Of(n){return(n=String(n)).match(LC)?n:"unsafe:"+n}function Il(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Xh(...n){const t={};for(const e of n)for(const i in e)e.hasOwnProperty(i)&&(t[i]=!0);return t}const yi=Il("area,br,col,hr,img,wbr"),bg=Il("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),jy=Il("rp,rt"),xg=Xh(yi,Xh(bg,Il("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Xh(jy,Il("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Xh(jy,bg)),Hy=Il("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),K0=Xh(Hy,Il("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Il("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),BC=Il("script,style,template");class zC{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!xg.hasOwnProperty(e))return this.sanitizedSomething=!0,!BC.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=t.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),u=s.name,m=u.toLowerCase();if(!K0.hasOwnProperty(m)){this.sanitizedSomething=!0;continue}let b=s.value;Hy[m]&&(b=Of(b)),this.buf.push(" ",u,'="',J0(b),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();xg.hasOwnProperty(e)&&!yi.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(J0(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const VC=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,UC=/([^\#-~ |!])/g;function J0(n){return n.replace(/&/g,"&amp;").replace(VC,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(UC,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let _u;function yu(n,t){let e=null;try{_u=_u||function X0(n){const t=new Pf(n);return function FC(){try{return!!(new window.DOMParser).parseFromString(Xa(""),"text/html")}catch{return!1}}()?new OC(t):t}(n);let i=t?String(t):"";e=_u.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=e.innerHTML,e=_u.getInertBodyElement(i)}while(i!==s);return Xa((new zC).sanitizeChildren(wg(e)||e))}finally{if(e){const i=wg(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function wg(n){return"content"in n&&function Cg(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var hi=(()=>((hi=hi||{})[hi.NONE=0]="NONE",hi[hi.HTML=1]="HTML",hi[hi.STYLE=2]="STYLE",hi[hi.SCRIPT=3]="SCRIPT",hi[hi.URL=4]="URL",hi[hi.RESOURCE_URL=5]="RESOURCE_URL",hi))();function $y(n){const t=function kl(){const n=qe();return n&&n[Ts].sanitizer}();return t?t.sanitize(hi.URL,n)||"":Ka(n,"URL")?ta(n):Of(Qt(n))}class Ke{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=at({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const bd=new Ke("ENVIRONMENT_INITIALIZER"),ex=new Ke("INJECTOR",-1),Zy=new Ke("INJECTOR_DEF_TYPES");class Yy{get(t,e=rc){if(e===rc){const i=new Error(`NullInjectorError: No provider for ${Gt(t)}!`);throw i.name="NullInjectorError",i}return e}}function tx(...n){return{\u0275providers:Ky(0,n),\u0275fromNgModule:!0}}function Ky(n,...t){const e=[],i=new Set;let r;return hd(t,s=>{const u=s;Sg(u,e,[],i)&&(r||=[],r.push(u))}),void 0!==r&&Dg(r,e),e}function Dg(n,t){for(let e=0;e<n.length;e++){const{providers:r}=n[e];Mg(r,s=>{t.push(s)})}}function Sg(n,t,e,i){if(!(n=vt(n)))return!1;let r=null,s=dh(n);const u=!s&&di(n);if(s||u){if(u&&!u.standalone)return!1;r=n}else{const b=n.ngModule;if(s=dh(b),!s)return!1;r=b}const m=i.has(r);if(u){if(m)return!1;if(i.add(r),u.dependencies){const b="function"==typeof u.dependencies?u.dependencies():u.dependencies;for(const E of b)Sg(E,t,e,i)}}else{if(!s)return!1;{if(null!=s.imports&&!m){let E;i.add(r);try{hd(s.imports,T=>{Sg(T,t,e,i)&&(E||=[],E.push(T))})}finally{}void 0!==E&&Dg(E,t)}if(!m){const E=Fr(r)||(()=>new r);t.push({provide:r,useFactory:E,deps:ei},{provide:Zy,useValue:r,multi:!0},{provide:bd,useValue:()=>Ne(r),multi:!0})}const b=s.providers;null==b||m||Mg(b,T=>{t.push(T)})}}return r!==n&&void 0!==n.providers}function Mg(n,t){for(let e of n)tc(e)&&(e=e.\u0275providers),Array.isArray(e)?Mg(e,t):t(e)}const vc=Jn({provide:String,useValue:Jn});function Tg(n){return null!==n&&"object"==typeof n&&vc in n}function xd(n){return"function"==typeof n}const ev=new Ke("Set Injector scope."),Lf={},nx={};let vu;function Nf(){return void 0===vu&&(vu=new Yy),vu}class Qa{}class na extends Qa{get destroyed(){return this._destroyed}constructor(t,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,nv(t,u=>this.processProvider(u)),this.records.set(ex,bc(void 0,this)),r.has("environment")&&this.records.set(Qa,bc(void 0,this));const s=this.records.get(ev);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Zy.multi,ei,Jt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const e of t)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const e=jo(this),i=Eo(void 0);try{return t()}finally{jo(e),Eo(i)}}get(t,e=rc,i=Jt.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(Jd))return t[Jd](this);i=Yc(i);const r=jo(this),s=Eo(void 0);try{if(!(i&Jt.SkipSelf)){let m=this.records.get(t);if(void 0===m){const b=function Ig(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ke}(t)&&ch(t);m=b&&this.injectableDefInScope(b)?bc(Bf(t),Lf):null,this.records.set(t,m)}if(null!=m)return this.hydrate(t,m)}return(i&Jt.Self?Nf():this.parent).get(t,e=i&Jt.Optional&&e===rc?null:e)}catch(u){if("NullInjectorError"===u.name){if((u[qc]=u[qc]||[]).unshift(Gt(t)),r)throw u;return function Hn(n,t,e,i){const r=n[qc];throw t[Xd]&&r.unshift(t[Xd]),n.message=function Kd(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Gt(t);if(Array.isArray(t))r=t.map(Gt).join(" -> ");else if("object"==typeof t){let s=[];for(let u in t)if(t.hasOwnProperty(u)){let m=t[u];s.push(u+":"+("string"==typeof m?JSON.stringify(m):Gt(m)))}r=`{${s.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${n.replace(Op,"\n  ")}`}("\n"+n.message,r,e,i),n.ngTokenPath=r,n[qc]=null,n}(u,t,"R3InjectorError",this.source)}throw u}finally{Eo(s),jo(r)}}resolveInjectorInitializers(){const t=jo(this),e=Eo(void 0);try{const i=this.get(bd.multi,ei,Jt.Self);for(const r of i)r()}finally{jo(t),Eo(e)}}toString(){const t=[],e=this.records;for(const i of e.keys())t.push(Gt(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ke(205,!1)}processProvider(t){let e=xd(t=vt(t))?t:vt(t&&t.provide);const i=function Jh(n){return Tg(n)?bc(void 0,n.useValue):bc(tv(n),Lf)}(t);if(xd(t)||!0!==t.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=bc(void 0,Lf,!0),r.factory=()=>Xc(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,i)}hydrate(t,e){return e.value===Lf&&(e.value=nx,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Ag(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=vt(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){const e=this._onDestroyHooks.indexOf(t);-1!==e&&this._onDestroyHooks.splice(e,1)}}function Bf(n){const t=ch(n),e=null!==t?t.factory:Fr(n);if(null!==e)return e;if(n instanceof Ke)throw new ke(204,!1);if(n instanceof Function)return function Kh(n){const t=n.length;if(t>0)throw Tl(t,"?"),new ke(204,!1);const e=function ua(n){return n&&(n[ha]||n[$c])||null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new ke(204,!1)}function tv(n,t,e){let i;if(xd(n)){const r=vt(n);return Fr(r)||Bf(r)}if(Tg(n))i=()=>vt(n.useValue);else if(function Qy(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Xc(n.deps||[]));else if(function Jy(n){return!(!n||!n.useExisting)}(n))i=()=>Ne(vt(n.useExisting));else{const r=vt(n&&(n.useClass||n.provide));if(!function ix(n){return!!n.deps}(n))return Fr(r)||Bf(r);i=()=>new r(...Xc(n.deps))}return i}function bc(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function nv(n,t){for(const e of n)Array.isArray(e)?nv(e,t):e&&tc(e)?nv(e.\u0275providers,t):t(e)}const kg=new Ke("AppId",{providedIn:"root",factory:()=>qC}),qC="ng",rx=new Ke("Platform Initializer"),wd=new Ke("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),ko=new Ke("AnimationModuleType"),Vf=new Ke("CSP nonce",{providedIn:"root",factory:()=>function kf(){if(void 0!==By)return By;if(typeof document<"u")return document;throw new ke(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let ip=(n,t)=>null;function ox(n,t){return ip(n,t)}class dx{}class ux{}class zg{resolveComponentFactory(t){throw function XC(n){const t=Error(`No component factory found for ${Gt(n)}.`);return t.ngComponent=n,t}(t)}}let op=(()=>{class n{}return n.NULL=new zg,n})();function sv(){return Ed(bn(),qe())}function Ed(n,t){return new jt(ue(n,t))}let jt=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=sv,n})();function KC(n){return n instanceof jt?n.nativeElement:n}class Eu{}let Pl=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Vg(){const n=qe(),e=ve(bn().index,n);return(Or(e)?e:n)[Dn]}(),n})(),JC=(()=>{class n{}return n.\u0275prov=at({token:n,providedIn:"root",factory:()=>null}),n})();class Du{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const QC=new Du("16.0.3"),av={};function Su(n){for(;n;){n[dn]|=64;const t=fu(n);if(eu(n)&&!t)return n;n=t}return null}function lv(n){return n.ngOriginalError}class Ol{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&lv(t);for(;e&&lv(e);)e=lv(e);return e||null}}const cv=new Ke("",{providedIn:"root",factory:()=>!1});function Nl(n){return n instanceof Function?n():n}class pv extends Eh{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(t){this._lView=t}onConsumerDependencyMayHaveChanged(){Su(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(t,e,i){const r=dt(this);this.trackingVersion++;try{t(e,i)}finally{dt(r)}}destroy(){this.trackingVersion++}}let tl=null;function fv(){return tl??=new pv,tl}function mx(n,t){return n[t]??fv()}function gx(n,t){const e=fv();e.hasReadASignal&&(n[t]=tl,e.lView=n,tl=new pv)}const Tn={};function Ze(n){Tu(Mn(),qe(),Lr()+n,!1)}function Tu(n,t,e,i){if(!i)if(3==(3&t[dn])){const s=n.preOrderCheckHooks;null!==s&&Zm(t,s,e)}else{const s=n.preOrderHooks;null!==s&&Ym(t,s,0,e)}fs(e)}function bv(n,t=null,e=null,i){const r=xv(n,t,e,i);return r.resolveInjectorInitializers(),r}function xv(n,t=null,e=null,i,r=new Set){const s=[e||ei,tx(n)];return i=i||("object"==typeof n?void 0:Gt(n)),new na(s,t||Nf(),i||null,r)}let Ro=(()=>{class n{static create(e,i){if(Array.isArray(e))return bv({name:""},i,e,"");{const r=e.name??"";return bv({name:r},e.parent,e.providers,r)}}}return n.THROW_IF_NOT_FOUND=rc,n.NULL=new Yy,n.\u0275prov=at({token:n,providedIn:"any",factory:()=>Ne(ex)}),n.__NG_ELEMENT_ID__=-1,n})();function J(n,t=Jt.Default){const e=qe();return null===e?Ne(n,t):xa(bn(),e,vt(n),t)}function Iu(){throw new Error("invalid")}function $g(n,t,e,i,r,s,u,m,b,E,T){const O=t.blueprint.slice();return O[er]=r,O[dn]=140|i,(null!==E||n&&2048&n[dn])&&(O[dn]|=2048),Re(O),O[ki]=O[sc]=n,O[tr]=e,O[Ts]=u||n&&n[Ts],O[Dn]=m||n&&n[Dn],O[ja]=b||n&&n[ja]||null,O[tn]=s,O[Ha]=function lg(){return Dy++}(),O[Is]=T,O[td]=E,O[nr]=2==t.type?n[nr]:O,O}function Md(n,t,e,i,r){let s=n.data[t];if(null===s)s=function Gg(n,t,e,i,r){const s=Yn(),u=Si(),b=n.data[t]=function v(n,t,e,i,r,s){let u=t?t.injectorIndex:-1,m=0;return At()&&(m|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:u,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:m,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,u?s:s&&s.parent,e,t,i,r);return null===n.firstChild&&(n.firstChild=b),null!==s&&(u?null==s.child&&null!==b.parent&&(s.child=b):null===s.next&&(s.next=b,b.prev=s)),b}(n,t,e,i,r),function ef(){return Le.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=e,s.value=i,s.attrs=r;const u=function Gi(){const n=Le.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();s.injectorIndex=null===u?-1:u.injectorIndex}return Ji(s,!0),s}function sp(n,t,e,i){if(0===e)return-1;const r=t.length;for(let s=0;s<e;s++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function wv(n,t,e,i,r){const s=mx(t,bt),u=Lr(),m=2&i;try{if(fs(-1),m&&t.length>$n&&Tu(n,t,$n,!1),K(m?2:0,r),m)s.runInContext(e,i,r);else{const E=dt(null);try{e(i,r)}finally{dt(E)}}}finally{m&&null===t[bt]&&gx(t,bt),fs(u),K(m?3:1,r)}}function Gf(n,t,e){if(Zp(t)){const i=dt(null);try{const s=t.directiveEnd;for(let u=t.directiveStart;u<s;u++){const m=n.data[u];m.contentQueries&&m.contentQueries(1,e[u],u)}}finally{dt(i)}}}function qf(n,t,e){Sn()&&(function ne(n,t,e,i){const r=e.directiveStart,s=e.directiveEnd;Cl(e)&&function Ge(n,t,e){const i=ue(t,n),u=en(n,$g(n,ap(e),null,e.onPush?64:16,i,t,null,n[Ts].rendererFactory.createRenderer(i,e),null,null,null));n[t.index]=u}(t,e,n.data[r+e.componentOffset]),n.firstCreatePass||Zo(e,t),Yo(i,t);const u=e.initialInputs;for(let m=r;m<s;m++){const b=n.data[m],E=ld(t,n,m,e);Yo(E,t),null!==u&&lt(0,m-r,E,b,0,u),us(b)&&(ve(e.index,t)[tr]=ld(t,n,m,e))}}(n,t,e,ue(e,t)),64==(64&e.flags)&&ae(n,t,e))}function qg(n,t,e=ue){const i=t.localNames;if(null!==i){let r=t.index+1;for(let s=0;s<i.length;s+=2){const u=i[s+1],m=-1===u?e(t,n):n[u];n[r++]=m}}}function ap(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=Wf(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):t}function Wf(n,t,e,i,r,s,u,m,b,E,T){const O=$n+i,H=O+r,q=function bx(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:Tn);return e}(O,H),oe="function"==typeof E?E():E;return q[It]={type:n,blueprint:q,template:e,queries:null,viewQuery:m,declTNode:t,data:q.slice().fill(null,O),bindingStartIndex:O,expandoStartIndex:H,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof u?u():u,firstChild:null,schemas:b,consts:oe,incompleteFirstPass:!1,ssrId:T}}let l=n=>null;function w(n,t,e,i){for(let r in n)if(n.hasOwnProperty(r)){e=null===e?{}:e;const s=n[r];null===i?D(e,t,r,s):i.hasOwnProperty(r)&&D(e,t,i[r],s)}return e}function D(n,t,e,i){n.hasOwnProperty(e)?n[e].push(t,i):n[e]=[t,i]}function P(n,t,e,i,r,s,u,m){const b=ue(t,e);let T,E=t.inputs;!m&&null!=E&&(T=E[i])?(vi(n,e,T,i,r),Cl(t)&&function F(n,t){const e=ve(t,n);16&e[dn]||(e[dn]|=64)}(e,t.index)):3&t.type&&(i=function k(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=u?u(r,t.value||"",i):r,s.setProperty(b,i,r))}function j(n,t,e,i){if(Sn()){const r=null===i?null:{"":-1},s=function he(n,t){const e=n.directiveRegistry;let i=null,r=null;if(e)for(let s=0;s<e.length;s++){const u=e[s];if(yh(t,u.selectors,!1))if(i||(i=[]),us(u))if(null!==u.findHostDirectiveDefs){const m=[];r=r||new Map,u.findHostDirectiveDefs(u,m,r),i.unshift(...m,u),Te(n,t,m.length)}else i.unshift(u),Te(n,t,0);else r=r||new Map,u.findHostDirectiveDefs?.(u,i,r),i.push(u)}return null===i?null:[i,r]}(n,e);let u,m;null===s?u=m=null:[u,m]=s,null!==u&&Y(n,t,e,u,r,m),r&&function Se(n,t,e){if(t){const i=n.localNames=[];for(let r=0;r<t.length;r+=2){const s=e[t[r+1]];if(null==s)throw new ke(-301,!1);i.push(t[r],s)}}}(e,i,r)}e.mergedAttrs=fa(e.mergedAttrs,e.attrs)}function Y(n,t,e,i,r,s){for(let E=0;E<i.length;E++)uf(Zo(e,t),n,i[E].type);!function nt(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}(e,n.data.length,i.length);for(let E=0;E<i.length;E++){const T=i[E];T.providersResolver&&T.providersResolver(T)}let u=!1,m=!1,b=sp(n,t,i.length,null);for(let E=0;E<i.length;E++){const T=i[E];e.mergedAttrs=fa(e.mergedAttrs,T.hostAttrs),Fe(n,e,t,b,T),Ue(b,T,r),null!==T.contentQueries&&(e.flags|=4),(null!==T.hostBindings||null!==T.hostAttrs||0!==T.hostVars)&&(e.flags|=64);const O=T.type.prototype;!u&&(O.ngOnChanges||O.ngOnInit||O.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),u=!0),!m&&(O.ngOnChanges||O.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),m=!0),b++}!function S(n,t,e){const r=t.directiveEnd,s=n.data,u=t.attrs,m=[];let b=null,E=null;for(let T=t.directiveStart;T<r;T++){const O=s[T],H=e?e.get(O):null,oe=H?H.outputs:null;b=w(O.inputs,T,b,H?H.inputs:null),E=w(O.outputs,T,E,oe);const de=null===b||null===u||Ks(t)?null:ft(b,T,u);m.push(de)}null!==b&&(b.hasOwnProperty("class")&&(t.flags|=8),b.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=m,t.inputs=b,t.outputs=E}(n,e,s)}function ae(n,t,e){const i=e.directiveStart,r=e.directiveEnd,s=e.index,u=function nC(){return Le.lFrame.currentDirectiveIndex}();try{fs(s);for(let m=i;m<r;m++){const b=n.data[m],E=t[m];tf(m),(null!==b.hostBindings||0!==b.hostVars||null!==b.hostAttrs)&&pe(b,E)}}finally{fs(-1),tf(u)}}function pe(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function Te(n,t,e){t.componentOffset=e,(n.components??=[]).push(t.index)}function Ue(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;us(t)&&(e[""]=n)}}function Fe(n,t,e,i,r){n.data[i]=r;const s=r.factory||(r.factory=Fr(r.type)),u=new Ah(s,us(r),J);n.blueprint[i]=u,e[i]=u,function te(n,t,e,i,r){const s=r.hostBindings;if(s){let u=n.hostBindingOpCodes;null===u&&(u=n.hostBindingOpCodes=[]);const m=~t.index;(function ce(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(u)!=m&&u.push(m),u.push(e,i,s)}}(n,t,i,sp(n,e,r.hostVars,Tn),r)}function je(n,t,e,i,r,s){const u=ue(n,t);!function Xe(n,t,e,i,r,s,u){if(null==s)n.removeAttribute(t,r,e);else{const m=null==u?Qt(s):u(s,i||"",r);n.setAttribute(t,r,m,e)}}(t[Dn],u,s,n.value,e,i,r)}function lt(n,t,e,i,r,s){const u=s[t];if(null!==u)for(let m=0;m<u.length;)Be(i,e,u[m++],u[m++],u[m++])}function Be(n,t,e,i,r){const s=dt(null);try{null!==n.setInput?n.setInput(t,r,e,i):t[i]=r}finally{dt(s)}}function ft(n,t,e){let i=null,r=0;for(;r<e.length;){const s=e[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const u=n[s];for(let m=0;m<u.length;m+=2)if(u[m]===t){i.push(s,u[m+1],e[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function St(n,t,e,i){return[n,!0,!1,t,null,0,i,e,null,null,null]}function _t(n,t){const e=n.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const s=e[i+1];if(-1!==s){const u=n.data[s];nf(e[i]),u.contentQueries(2,t[s],s)}}}function en(n,t){return n[bl]?n[_a][Go]=t:n[bl]=t,n[_a]=t,t}function st(n,t,e){nf(0);const i=dt(null);try{t(n,e)}finally{dt(i)}}function sn(n){return n[ga]||(n[ga]=[])}function Gn(n){return n.cleanup||(n.cleanup=[])}function an(n,t,e){return(null===n||us(n))&&(e=function ie(n){for(;Array.isArray(n);){if("object"==typeof n[ac])return n;n=n[er]}return null}(e[t.index])),e[Dn]}function Ht(n,t){const e=n[ja],i=e?e.get(Ol,null):null;i&&i.handleError(t)}function vi(n,t,e,i,r){for(let s=0;s<e.length;){const u=e[s++],m=e[s++];Be(n.data[u],t[u],i,m,r)}}function Yt(n,t,e){const i=re(t,n);!function B0(n,t,e){n.setValue(t,e)}(n[Dn],i,e)}function fn(n,t){const e=ve(t,n),i=e[It];!function bi(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])}(i,e);const r=e[er];null!==r&&null===e[Is]&&(e[Is]=ox(r,e[ja])),pi(i,e,e[tr])}function pi(n,t,e){Th(t);try{const i=n.viewQuery;null!==i&&st(1,i,e);const r=n.template;null!==r&&wv(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&_t(n,t),n.staticViewQueries&&st(2,n.viewQuery,e);const s=n.components;null!==s&&function Mi(n,t){for(let e=0;e<t.length;e++)fn(n,t[e])}(t,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[dn]&=-5,oy()}}let lr=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(e,i,r){const s=typeof Zone>"u"?null:Zone.current,u=new x(e,E=>{this.all.has(E)&&this.queue.set(E,s)},r);let m;this.all.add(u),u.notify();const b=()=>{u.cleanup(),m?.(),this.all.delete(u),this.queue.delete(u)};return m=i?.onDestroy(b),{destroy:b}}flush(){if(0!==this.queue.size)for(const[e,i]of this.queue)this.queue.delete(e),i?i.run(()=>e.run()):e.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=at({token:n,providedIn:"root",factory:()=>new n}),n})();function or(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,s=0;if(null!==t)for(let u=0;u<t.length;u++){const m=t[u];"number"==typeof m?s=m:1==s?r=Cn(r,m):2==s&&(i=Cn(i,m+": "+t[++u]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}function Zi(n,t,e,i,r=!1){for(;null!==e;){const s=t[e.index];if(null!==s&&i.push(Z(s)),lo(s)){for(let m=Pr;m<s.length;m++){const b=s[m],E=b[It].firstChild;null!==E&&Zi(b[It],b,E,i)}s[Wo]!==s[er]&&i.push(s[Wo])}const u=e.type;if(8&u)Zi(n,t,e.child,i);else if(32&u){const m=hg(e,t);let b;for(;b=m();)i.push(b)}else if(16&u){const m=Py(t,e);if(Array.isArray(m))i.push(...m);else{const b=fu(t[nr]);Zi(b[It],b,m,i,!0)}}e=r?e.projectionNext:e.next}return i}function Fi(n,t,e,i=!0){const r=t[Ts].rendererFactory;r.begin&&r.begin();try{li(n,t,n.template,e)}catch(u){throw i&&Ht(t,u),u}finally{r.end&&r.end(),t[Ts].effectManager?.flush()}}function li(n,t,e,i){const r=t[dn];if(256!=(256&r)){t[Ts].effectManager?.flush(),Th(t);try{Re(t),function El(n){return Le.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&wv(n,t,e,2,i);const u=3==(3&r);if(u){const E=n.preOrderCheckHooks;null!==E&&Zm(t,E,null)}else{const E=n.preOrderHooks;null!==E&&Ym(t,E,0,null),rr(t,0)}if(function yr(n){for(let t=Iy(n);null!==t;t=pg(t)){if(!t[Cr])continue;const e=t[xl];for(let i=0;i<e.length;i++){Qe(e[i])}}}(t),function Xo(n){for(let t=Iy(n);null!==t;t=pg(t))for(let e=Pr;e<t.length;e++){const i=t[e],r=i[It];Je(i)&&li(r,i,r.template,i[tr])}}(t),null!==n.contentQueries&&_t(n,t),u){const E=n.contentCheckHooks;null!==E&&Zm(t,E)}else{const E=n.contentHooks;null!==E&&Ym(t,E,1),rr(t,1)}!function vx(n,t){const e=n.hostBindingOpCodes;if(null===e)return;const i=mx(t,qo);try{for(let r=0;r<e.length;r++){const s=e[r];if(s<0)fs(~s);else{const u=s,m=e[++r],b=e[++r];t0(m,u),i.runInContext(b,2,t[u])}}}finally{null===t[qo]&&gx(t,qo),fs(-1)}}(n,t);const m=n.components;null!==m&&function Ko(n,t){for(let e=0;e<t.length;e++)Yr(n,t[e])}(t,m);const b=n.viewQuery;if(null!==b&&st(2,b,i),u){const E=n.viewCheckHooks;null!==E&&Zm(t,E)}else{const E=n.viewHooks;null!==E&&Ym(t,E,2),rr(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[dn]&=-73,Me(t)}finally{oy()}}}function Yr(n,t){const e=ve(t,n);if(Je(e)){const i=e[It];80&e[dn]?li(i,e,i.template,e[tr]):e[ma]>0&&xr(e)}}function xr(n){for(let i=Iy(n);null!==i;i=pg(i))for(let r=Pr;r<i.length;r++){const s=i[r];if(Je(s))if(1024&s[dn]){const u=s[It];li(u,s,u.template,s[tr])}else s[ma]>0&&xr(s)}const e=n[It].components;if(null!==e)for(let i=0;i<e.length;i++){const r=ve(e[i],n);Je(r)&&r[ma]>0&&xr(r)}}class cr{get rootNodes(){const t=this._lView,e=t[It];return Zi(e,t,e.firstChild,[])}constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[tr]}set context(t){this._lView[tr]=t}get destroyed(){return 256==(256&this._lView[dn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[ki];if(lo(t)){const e=t[lc],i=e?e.indexOf(this):-1;i>-1&&($h(t,i),mc(e,i))}this._attachedToViewContainer=!1}V0(this._lView[It],this._lView)}onDestroy(t){!function tt(n,t){if(256==(256&n[dn]))throw new ke(911,!1);null===n[Qs]&&(n[Qs]=[]),n[Qs].push(t)}(this._lView,t)}markForCheck(){Su(this._cdRefInjectingView||this._lView)}detach(){this._lView[dn]&=-129}reattach(){this._lView[dn]|=128}detectChanges(){Fi(this._lView[It],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ke(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function yC(n,t){Zh(n,t,t[Dn],2,null,null)}(this._lView[It],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new ke(902,!1);this._appRef=t}}class il extends cr{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Fi(t[It],t,t[tr],!1)}checkNoChanges(){}get context(){return null}}class ku extends op{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=di(t);return new cp(e,this.ngModule)}}function lp(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class xx{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){i=Yc(i);const r=this.injector.get(t,av,i);return r!==av||e===av?r:this.parentInjector.get(t,e,i)}}class cp extends ux{get inputs(){return lp(this.componentDef.inputs)}get outputs(){return lp(this.componentDef.outputs)}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function q_(n){return n.map(Hp).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}create(t,e,i,r){let s=(r=r||this.ngModule)instanceof Qa?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const u=s?new xx(t,s):t,m=u.get(Eu,null);if(null===m)throw new ke(407,!1);const T={rendererFactory:m,sanitizer:u.get(JC,null),effectManager:u.get(lr,null)},O=m.createRenderer(null,this.componentDef),H=this.componentDef.selectors[0][0]||"div",q=i?function a(n,t,e,i){const s=i.get(cv,!1)||e===Do.ShadowDom,u=n.selectRootElement(t,s);return function o(n){l(n)}(u),u}(O,i,this.componentDef.encapsulation,u):Hh(O,H,function Zf(n){const t=n.toLowerCase();return"svg"===t?ee:"math"===t?"math":null}(H)),oe=this.componentDef.onPush?576:528,de=Wf(0,null,null,1,0,null,null,null,null,null,null),xe=$g(null,de,null,oe,null,null,T,O,u,null,null);let Pe,we;Th(xe);try{const ht=this.componentDef;let Ct,$t=null;ht.findHostDirectiveDefs?(Ct=[],$t=new Map,ht.findHostDirectiveDefs(ht,Ct,$t),Ct.push(ht)):Ct=[ht];const hr=function Cv(n,t){const e=n[It],i=$n;return n[i]=t,Md(e,i,2,"#host",null)}(xe,q),bo=function Ev(n,t,e,i,r,s,u){const m=r[It];!function Bl(n,t,e,i){for(const r of n)t.mergedAttrs=fa(t.mergedAttrs,r.hostAttrs);null!==t.mergedAttrs&&(or(t,t.mergedAttrs,!0),null!==e&&Ny(i,e,t))}(i,n,t,u);let b=null;null!==t&&(b=ox(t,r[ja]));const E=s.rendererFactory.createRenderer(t,e),T=$g(r,ap(e),null,e.onPush?64:16,r[n.index],n,s,E,null,null,b);return m.firstCreatePass&&Te(m,n,i.length-1),en(r,T),r[n.index]=T}(hr,q,ht,Ct,xe,T,O);we=me(de,$n),q&&function Ru(n,t,e,i){if(i)mh(n,e,["ng-version",QC.full]);else{const{attrs:r,classes:s}=function $p(n){const t=[],e=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&t.push(s,n[++i]):8===r&&e.push(s);else{if(!Ho(r))break;r=s}i++}return{attrs:t,classes:e}}(t.selectors[0]);r&&mh(n,e,r),s&&s.length>0&&Af(n,e,s.join(" "))}}(O,ht,q,i),void 0!==e&&function Dv(n,t,e){const i=n.projection=[];for(let r=0;r<t.length;r++){const s=e[r];i.push(null!=s?Array.from(s):null)}}(we,this.ngContentSelectors,e),Pe=function Cx(n,t,e,i,r,s){const u=bn(),m=r[It],b=ue(u,r);Y(m,r,u,e,null,i);for(let T=0;T<e.length;T++)Yo(ld(r,m,u.directiveStart+T,u),r);ae(m,r,u),b&&Yo(b,r);const E=ld(r,m,u.directiveStart+u.componentOffset,u);if(n[tr]=r[tr]=E,null!==s)for(const T of s)T(E,t);return Gf(m,u,n),E}(bo,ht,Ct,$t,xe,[Sv]),pi(de,xe,null)}finally{oy()}return new wx(this.componentType,Pe,Ed(we,xe),xe,we)}}class wx extends dx{constructor(t,e,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new il(r),this.componentType=t}setInput(t,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;const s=this._rootLView;vi(s[It],s,r,t,e),this.previousInputValues.set(t,e),Su(ve(this._tNode.index,s))}}get injector(){return new cu(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function Sv(){const n=bn();ks(qe()[It],n)}function Et(n){let t=function xc(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let r;if(us(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new ke(903,!1);r=t.\u0275dir}if(r){if(e){i.push(r);const u=n;u.inputs=Jo(n.inputs),u.declaredInputs=Jo(n.declaredInputs),u.outputs=Jo(n.outputs);const m=r.hostBindings;m&&Mv(n,m);const b=r.viewQuery,E=r.contentQueries;if(b&&Ns(n,b),E&&Yf(n,E),yt(n.inputs,r.inputs),yt(n.declaredInputs,r.declaredInputs),yt(n.outputs,r.outputs),us(r)&&r.data.animation){const T=n.data;T.animation=(T.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let u=0;u<s.length;u++){const m=s[u];m&&m.ngInherit&&m(n),m===Et&&(e=!1)}}t=Object.getPrototypeOf(t)}!function rE(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=fa(r.hostAttrs,e=fa(e,r.hostAttrs))}}(i)}function Jo(n){return n===So?{}:n===ei?[]:n}function Ns(n,t){const e=n.viewQuery;n.viewQuery=e?(i,r)=>{t(i,r),e(i,r)}:t}function Yf(n,t){const e=n.contentQueries;n.contentQueries=e?(i,r,s)=>{t(i,r,s),e(i,r,s)}:t}function Mv(n,t){const e=n.hostBindings;n.hostBindings=e?(i,r)=>{t(i,r),e(i,r)}:t}function Dx(n){return!!oE(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function oE(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Td(n,t,e){return n[t]=e}function Bs(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function Xf(n,t,e,i){const r=Bs(n,t,e);return Bs(n,t+1,i)||r}function zl(n,t,e,i,r,s){const u=Xf(n,t,e,i);return Xf(n,t+2,r,s)||u}function Ln(n,t,e,i){const r=qe();return Bs(r,Ga(),t)&&(Mn(),je(ui(),r,n,t,e,i)),Ln}function Zg(n,t,e,i){return Bs(n,Ga(),e)?t+Qt(e)+i:Tn}function Yg(n,t,e,i,r,s){const m=Xf(n,function ho(){return Le.lFrame.bindingIndex}(),e,r);return ps(2),m?t+Qt(e)+i+Qt(r)+s:Tn}function kt(n,t,e,i,r,s,u,m){const b=qe(),E=Mn(),T=n+$n,O=E.firstCreatePass?function tB(n,t,e,i,r,s,u,m,b){const E=t.consts,T=Md(t,n,4,u||null,Ve(E,m));j(t,e,T,Ve(E,b)),ks(t,T);const O=T.tView=Wf(2,T,i,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,E,null);return null!==t.queries&&(t.queries.template(t,T),O.queries=t.queries.embeddedTView(T)),T}(T,E,b,t,e,i,r,s,u):E.data[T];Ji(O,!1);const H=UT(E,b,O,n);Wm()&&Mf(E,b,H,O),Yo(H,b),en(b,b[T]=St(H,b,H,O)),$a(O)&&qf(E,b,O),null!=u&&qg(b,O,m)}let UT=function jT(n,t,e,i){return hc(!0),t[Dn].createComment("")};function Sa(n){return be(function Sh(){return Le.lFrame.contextLView}(),$n+n)}function et(n,t,e){const i=qe();return Bs(i,Ga(),t)&&P(Mn(),ui(),i,n,t,i[Dn],e,!1),et}function uE(n,t,e,i,r){const u=r?"class":"style";vi(n,e,t.inputs[u],u,i)}function Ye(n,t,e,i){const r=qe(),s=Mn(),u=$n+n,m=r[Dn],b=s.firstCreatePass?function oB(n,t,e,i,r,s){const u=t.consts,b=Md(t,n,2,i,Ve(u,r));return j(t,e,b,Ve(u,s)),null!==b.attrs&&or(b,b.attrs,!1),null!==b.mergedAttrs&&or(b,b.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,b),b}(u,s,r,t,e,i):s.data[u],E=HT(s,r,b,m,t,n);r[u]=E;const T=$a(b);return Ji(b,!0),Ny(m,E,b),32!=(32&b.flags)&&Wm()&&Mf(s,r,E,b),0===function Mt(){return Le.lFrame.elementDepthCount}()&&Yo(E,r),function Ut(){Le.lFrame.elementDepthCount++}(),T&&(qf(s,r,b),Gf(s,b,r)),null!==i&&qg(r,b),Ye}function ot(){let n=bn();Si()?uo():(n=n.parent,Ji(n,!1));const t=n;(function oi(n){return Le.skipHydrationRootTNode===n})(t)&&function co(){Le.skipHydrationRootTNode=null}(),function On(){Le.lFrame.elementDepthCount--}();const e=Mn();return e.firstCreatePass&&(ks(e,n),Zp(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function af(n){return 0!=(8&n.flags)}(t)&&uE(e,t,qe(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function su(n){return 0!=(16&n.flags)}(t)&&uE(e,t,qe(),t.stylesWithoutHost,!1),ot}function _n(n,t,e,i){return Ye(n,t,e,i),ot(),_n}let HT=(n,t,e,i,r,s)=>(hc(!0),Hh(i,r,function o0(){return Le.lFrame.currentNamespace}()));function Qo(n,t,e){const i=qe(),r=Mn(),s=n+$n,u=r.firstCreatePass?function lB(n,t,e,i,r){const s=t.consts,u=Ve(s,i),m=Md(t,n,8,"ng-container",u);return null!==u&&or(m,u,!0),j(t,e,m,Ve(s,r)),null!==t.queries&&t.queries.elementStart(t,m),m}(s,r,i,t,e):r.data[s];Ji(u,!0);const m=$T(r,i,u,n);return i[s]=m,Wm()&&Mf(r,i,m,u),Yo(m,i),$a(u)&&(qf(r,i,u),Gf(r,u,i)),null!=e&&qg(i,u),Qo}function es(){let n=bn();const t=Mn();return Si()?uo():(n=n.parent,Ji(n,!1)),t.firstCreatePass&&(ks(t,n),Zp(n)&&t.queries.elementEnd(n)),es}function Vl(n,t,e){return Qo(n,t,e),es(),Vl}let $T=(n,t,e,i)=>(hc(!0),Df(t[Dn],""));function rl(){return qe()}function Rv(n){return!!n&&"function"==typeof n.then}function GT(n){return!!n&&"function"==typeof n.subscribe}function Kt(n,t,e,i){const r=qe(),s=Mn(),u=bn();return qT(s,r,r[Dn],u,n,t,i),Kt}function hE(n,t){const e=bn(),i=qe(),r=Mn();return qT(r,i,an(Mh(r.data),e,i),e,n,t),hE}function qT(n,t,e,i,r,s,u){const m=$a(i),E=n.firstCreatePass&&Gn(n),T=t[tr],O=sn(t);let H=!0;if(3&i.type||u){const de=ue(i,t),xe=u?u(de):de,Pe=O.length,we=u?Ct=>u(Z(Ct[i.index])):i.index;let ht=null;if(!u&&m&&(ht=function uB(n,t,e,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const u=r[s];if(u===e&&r[s+1]===i){const m=t[ga],b=r[s+2];return m.length>b?m[b]:null}"string"==typeof u&&(s+=2)}return null}(n,t,r,i.index)),null!==ht)(ht.__ngLastListenerFn__||ht).__ngNextListenerFn__=s,ht.__ngLastListenerFn__=s,H=!1;else{s=ZT(i,t,T,s,!1);const Ct=e.listen(xe,r,s);O.push(s,Ct),E&&E.push(r,we,Pe,Pe+1)}}else s=ZT(i,t,T,s,!1);const q=i.outputs;let oe;if(H&&null!==q&&(oe=q[r])){const de=oe.length;if(de)for(let xe=0;xe<de;xe+=2){const $t=t[oe[xe]][oe[xe+1]].subscribe(s),hr=O.length;O.push(s,$t),E&&E.push(r,i.index,hr,-(hr+1))}}}function WT(n,t,e,i){try{return K(6,t,e),!1!==e(i)}catch(r){return Ht(n,r),!1}finally{K(7,t,e)}}function ZT(n,t,e,i,r){return function s(u){if(u===Function)return i;Su(n.componentOffset>-1?ve(n.index,t):t);let b=WT(t,e,i,u),E=s.__ngNextListenerFn__;for(;E;)b=WT(t,e,E,u)&&b,E=E.__ngNextListenerFn__;return r&&!1===b&&u.preventDefault(),b}}function Nt(n=1){return function sy(n){return(Le.lFrame.contextLView=function rf(n,t){for(;n>0;)t=t[sc],n--;return t}(n,Le.lFrame.contextLView))[tr]}(n)}function hB(n,t){let e=null;const i=function G_(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(!(1&e))return t[e+1]}return null}(n);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===i?yh(n,s,!0):Qd(i,s))return r}else e=r}return e}function fo(n){const t=qe()[nr][tn];if(!t.projection){const i=t.projection=Tl(n?n.length:1,null),r=i.slice();let s=t.child;for(;null!==s;){const u=n?hB(s,n):0;null!==u&&(r[u]?r[u].projectionNext=s:i[u]=s,r[u]=s),s=s.next}}}function qn(n,t=0,e){const i=qe(),r=Mn(),s=Md(r,$n+n,16,null,e||null);null===s.projection&&(s.projection=t),uo(),(!i[Is]||At())&&32!=(32&s.flags)&&function G0(n,t,e){Ly(t[Dn],0,t,e,ky(n,e,t),Sf(e.parent||t[tn],e,t))}(r,i,s)}function Ix(n,t,e){return pE(n,"",t,"",e),Ix}function pE(n,t,e,i,r){const s=qe(),u=Zg(s,t,e,i);return u!==Tn&&P(Mn(),ui(),s,n,u,s[Dn],r,!1),pE}function kx(n,t){return n<<17|t<<2}function dp(n){return n>>17&32767}function fE(n){return 2|n}function Kf(n){return(131068&n)>>2}function mE(n,t){return-131069&n|t<<2}function gE(n){return 1|n}function iA(n,t,e,i,r){const s=n[e+1],u=null===t;let m=i?dp(s):Kf(s),b=!1;for(;0!==m&&(!1===b||u);){const T=n[m+1];yB(n[m],t)&&(b=!0,n[m+1]=i?gE(T):fE(T)),m=i?dp(T):Kf(T)}b&&(n[e+1]=i?fE(s):gE(s))}function yB(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&Za(n,t)>=0}function Ad(n,t,e){return wc(n,t,e,!1),Ad}function Xn(n,t){return wc(n,t,null,!0),Xn}function wc(n,t,e,i){const r=qe(),s=Mn(),u=ps(2);s.firstUpdatePass&&function uA(n,t,e,i){const r=n.data;if(null===r[e+1]){const s=r[Lr()],u=function dA(n,t){return t>=n.expandoStartIndex}(n,e);(function mA(n,t){return 0!=(n.flags&(t?8:16))})(s,i)&&null===t&&!u&&(t=!1),t=function MB(n,t,e,i){const r=Mh(n);let s=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(e=Pv(e=_E(null,n,t,e,i),t.attrs,i),s=null);else{const u=t.directiveStylingLast;if(-1===u||n[u]!==r)if(e=_E(r,n,t,e,i),null===s){let b=function TB(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==Kf(i))return n[dp(i)]}(n,t,i);void 0!==b&&Array.isArray(b)&&(b=_E(null,n,t,b[1],i),b=Pv(b,t.attrs,i),function AB(n,t,e,i){n[dp(e?t.classBindings:t.styleBindings)]=i}(n,t,i,b))}else s=function IB(n,t,e){let i;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)i=Pv(i,n[s].hostAttrs,e);return Pv(i,t.attrs,e)}(n,t,i)}return void 0!==s&&(i?t.residualClasses=s:t.residualStyles=s),e}(r,s,t,i),function gB(n,t,e,i,r,s){let u=s?t.classBindings:t.styleBindings,m=dp(u),b=Kf(u);n[i]=e;let T,E=!1;if(Array.isArray(e)?(T=e[1],(null===T||Za(e,T)>0)&&(E=!0)):T=e,r)if(0!==b){const H=dp(n[m+1]);n[i+1]=kx(H,m),0!==H&&(n[H+1]=mE(n[H+1],i)),n[m+1]=function fB(n,t){return 131071&n|t<<17}(n[m+1],i)}else n[i+1]=kx(m,0),0!==m&&(n[m+1]=mE(n[m+1],i)),m=i;else n[i+1]=kx(b,0),0===m?m=i:n[b+1]=mE(n[b+1],i),b=i;E&&(n[i+1]=fE(n[i+1])),iA(n,T,i,!0),iA(n,T,i,!1),function _B(n,t,e,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof t&&Za(s,t)>=0&&(e[i+1]=gE(e[i+1]))}(t,T,n,i,s),u=kx(m,b),s?t.classBindings=u:t.styleBindings=u}(r,s,t,e,u,i)}}(s,n,u,i),t!==Tn&&Bs(r,u,t)&&function pA(n,t,e,i,r,s,u,m){if(!(3&t.type))return;const b=n.data,E=b[m+1],T=function mB(n){return 1==(1&n)}(E)?fA(b,t,e,r,Kf(E),u):void 0;Rx(T)||(Rx(s)||function pB(n){return 2==(2&n)}(E)&&(s=fA(b,null,e,r,m,u)),function DC(n,t,e,i,r){if(t)r?n.addClass(e,i):n.removeClass(e,i);else{let s=-1===i.indexOf("-")?void 0:qi.DashCase;null==r?n.removeStyle(e,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=qi.Important),n.setStyle(e,i,r,s))}}(i,u,re(Lr(),e),r,s))}(s,s.data[Lr()],r,r[Dn],n,r[u+1]=function OB(n,t){return null==n||""===n||("string"==typeof t?n+=t:"object"==typeof n&&(n=Gt(ta(n)))),n}(t,e),i,u)}function _E(n,t,e,i,r){let s=null;const u=e.directiveEnd;let m=e.directiveStylingLast;for(-1===m?m=e.directiveStart:m++;m<u&&(s=t[m],i=Pv(i,s.hostAttrs,r),s!==n);)m++;return null!==n&&(e.directiveStylingLast=m),i}function Pv(n,t,e){const i=e?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const u=t[s];"number"==typeof u?r=u:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ms(n,u,!!e||t[++s]))}return void 0===n?null:n}function fA(n,t,e,i,r,s){const u=null===t;let m;for(;r>0;){const b=n[r],E=Array.isArray(b),T=E?b[1]:b,O=null===T;let H=e[r+1];H===Tn&&(H=O?ei:void 0);let q=O?ng(H,i):T===i?H:void 0;if(E&&!Rx(q)&&(q=ng(b,i)),Rx(q)&&(m=q,u))return m;const oe=n[r+1];r=u?dp(oe):Kf(oe)}if(null!==t){let b=s?t.residualClasses:t.residualStyles;null!=b&&(m=ng(b,i))}return m}function Rx(n){return void 0!==n}function Kn(n,t=""){const e=qe(),i=Mn(),r=n+$n,s=i.firstCreatePass?Md(i,r,1,t,null):i.data[r],u=gA(i,e,s,t,n);e[r]=u,Wm()&&Mf(i,e,u,s),Ji(s,!1)}let gA=(n,t,e,i,r)=>(hc(!0),function jh(n,t){return n.createText(t)}(t[Dn],i));function Ma(n){return zs("",n,""),Ma}function zs(n,t,e){const i=qe(),r=Zg(i,n,t,e);return r!==Tn&&Yt(i,Lr(),r),zs}function Ov(n,t,e,i,r){const s=qe(),u=Yg(s,n,t,e,i,r);return u!==Tn&&Yt(s,Lr(),u),Ov}function ia(n,t,e){const i=qe();return Bs(i,Ga(),t)&&P(Mn(),ui(),i,n,t,i[Dn],e,!0),ia}function yE(n,t,e){const i=qe();if(Bs(i,Ga(),t)){const s=Mn(),u=ui();P(s,u,i,n,t,an(Mh(s.data),u,i),e,!0)}return yE}const Jf=void 0;var nz=["en",[["a","p"],["AM","PM"],Jf],[["AM","PM"],Jf,Jf],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Jf,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Jf,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Jf,"{1} 'at' {0}",Jf],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function tz(n){const e=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let i_={};function ra(n){const t=function rz(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=OA(t);if(e)return e;const i=t.split("-")[0];if(e=OA(i),e)return e;if("en"===i)return nz;throw new ke(701,!1)}function OA(n){return n in i_||(i_[n]=Ii.ng&&Ii.ng.common&&Ii.ng.common.locales&&Ii.ng.common.locales[n]),i_[n]}var Rt=(()=>((Rt=Rt||{})[Rt.LocaleId=0]="LocaleId",Rt[Rt.DayPeriodsFormat=1]="DayPeriodsFormat",Rt[Rt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Rt[Rt.DaysFormat=3]="DaysFormat",Rt[Rt.DaysStandalone=4]="DaysStandalone",Rt[Rt.MonthsFormat=5]="MonthsFormat",Rt[Rt.MonthsStandalone=6]="MonthsStandalone",Rt[Rt.Eras=7]="Eras",Rt[Rt.FirstDayOfWeek=8]="FirstDayOfWeek",Rt[Rt.WeekendRange=9]="WeekendRange",Rt[Rt.DateFormat=10]="DateFormat",Rt[Rt.TimeFormat=11]="TimeFormat",Rt[Rt.DateTimeFormat=12]="DateTimeFormat",Rt[Rt.NumberSymbols=13]="NumberSymbols",Rt[Rt.NumberFormats=14]="NumberFormats",Rt[Rt.CurrencyCode=15]="CurrencyCode",Rt[Rt.CurrencySymbol=16]="CurrencySymbol",Rt[Rt.CurrencyName=17]="CurrencyName",Rt[Rt.Currencies=18]="Currencies",Rt[Rt.Directionality=19]="Directionality",Rt[Rt.PluralCase=20]="PluralCase",Rt[Rt.ExtraData=21]="ExtraData",Rt))();const r_="en-US";let FA=r_;function xE(n,t,e,i,r){if(n=vt(n),Array.isArray(n))for(let s=0;s<n.length;s++)xE(n[s],t,e,i,r);else{const s=Mn(),u=qe();let m=xd(n)?n:vt(n.provide),b=tv(n);const E=bn(),T=1048575&E.providerIndexes,O=E.directiveStart,H=E.providerIndexes>>20;if(xd(n)||!n.multi){const q=new Ah(b,r,J),oe=CE(m,t,r?T:T+H,O);-1===oe?(uf(Zo(E,u),s,m),wE(s,n,t.length),t.push(m),E.directiveStart++,E.directiveEnd++,r&&(E.providerIndexes+=1048576),e.push(q),u.push(q)):(e[oe]=q,u[oe]=q)}else{const q=CE(m,t,T+H,O),oe=CE(m,t,T,T+H),xe=oe>=0&&e[oe];if(r&&!xe||!r&&!(q>=0&&e[q])){uf(Zo(E,u),s,m);const Pe=function tV(n,t,e,i,r){const s=new Ah(n,e,J);return s.multi=[],s.index=t,s.componentProviders=0,sI(s,r,i&&!e),s}(r?eV:Qz,e.length,r,i,b);!r&&xe&&(e[oe].providerFactory=Pe),wE(s,n,t.length,0),t.push(m),E.directiveStart++,E.directiveEnd++,r&&(E.providerIndexes+=1048576),e.push(Pe),u.push(Pe)}else wE(s,n,q>-1?q:oe,sI(e[r?oe:q],b,!r&&i));!r&&i&&xe&&e[oe].componentProviders++}}}function wE(n,t,e,i){const r=xd(t),s=function GC(n){return!!n.useClass}(t);if(r||s){const b=(s?vt(t.useClass):t).prototype.ngOnDestroy;if(b){const E=n.destroyHooks||(n.destroyHooks=[]);if(!r&&t.multi){const T=E.indexOf(e);-1===T?E.push(e,[i,b]):E[T+1].push(i,b)}else E.push(e,b)}}}function sI(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function CE(n,t,e,i){for(let r=e;r<i;r++)if(t[r]===n)return r;return-1}function Qz(n,t,e,i){return EE(this.multi,[])}function eV(n,t,e,i){const r=this.multi;let s;if(this.providerFactory){const u=this.providerFactory.componentProviders,m=ld(e,e[It],this.providerFactory.index,i);s=m.slice(0,u),EE(r,s);for(let b=u;b<m.length;b++)s.push(m[b])}else s=[],EE(r,s);return s}function EE(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Zt(n,t=[]){return e=>{e.providersResolver=(i,r)=>function Jz(n,t,e){const i=Mn();if(i.firstCreatePass){const r=us(n);xE(e,i.data,i.blueprint,r,!0),xE(t,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,t)}}class o_{}class aI{}class DE extends o_{constructor(t,e,i){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ku(this);const r=Rr(t);this._bootstrapComponents=Nl(r.bootstrap),this._r3Injector=xv(t,e,[{provide:o_,useValue:this},{provide:op,useValue:this.componentFactoryResolver},...i],Gt(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class SE extends aI{constructor(t){super(),this.moduleType=t}create(t){return new DE(this.moduleType,t,[])}}class lI extends o_{constructor(t){super(),this.componentFactoryResolver=new ku(this),this.instance=null;const e=new na([...t.providers,{provide:o_,useValue:this},{provide:op,useValue:this.componentFactoryResolver}],t.parent||Nf(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function ME(n,t,e=null){return new lI({providers:n,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}let rV=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const i=Ky(0,e.type),r=i.length>0?ME([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,r)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=at({token:n,providedIn:"environment",factory:()=>new n(Ne(Qa))}),n})();function cI(n){n.getStandaloneInjector=t=>t.get(rV).getOrCreateStandaloneInjector(n)}function gI(n,t,e,i,r,s,u){return function xI(n,t,e,i,r,s,u,m,b){const E=t+e;return zl(n,E,r,s,u,m)?Td(n,E+4,b?i.call(b,r,s,u,m):i(r,s,u,m)):Vv(n,E+4)}(qe(),ir(),n,t,e,i,r,s,u)}function Vv(n,t){const e=n[t];return e===Tn?void 0:e}function s_(n,t){const e=Mn();let i;const r=n+$n;e.firstCreatePass?(i=function xV(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??=[]).push(r,i.onDestroy)):i=e.data[r];const s=i.factory||(i.factory=Fr(i.type)),u=Eo(J);try{const m=ad(!1),b=s();return ad(m),function rB(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,qe(),r,b),b}finally{Eo(u)}}function CI(n,t,e){const i=n+$n,r=qe(),s=be(r,i);return jv(r,i)?function yI(n,t,e,i,r,s){const u=t+e;return Bs(n,u,r)?Td(n,u+1,s?i.call(s,r):i(r)):Vv(n,u+1)}(r,ir(),t,s.transform,e,s):s.transform(e)}function Uv(n,t,e,i){const r=n+$n,s=qe(),u=be(s,r);return jv(s,r)?function vI(n,t,e,i,r,s,u){const m=t+e;return Xf(n,m,r,s)?Td(n,m+2,u?i.call(u,r,s):i(r,s)):Vv(n,m+2)}(s,ir(),t,u.transform,e,i,u):u.transform(e,i)}function jv(n,t){return n[It].data[t].pure}function AE(n){return t=>{setTimeout(n,void 0,t)}}const Tt=class DV extends Xt{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let r=t,s=e||(()=>null),u=i;if(t&&"object"==typeof t){const b=t;r=b.next?.bind(b),s=b.error?.bind(b),u=b.complete?.bind(b)}this.__isAsync&&(s=AE(s),r&&(r=AE(r)),u&&(u=AE(u)));const m=super.subscribe({next:r,error:s,complete:u});return t instanceof Ie&&t.add(m),m}};function SV(){return this._results[Symbol.iterator]()}class a_{get changes(){return this._changes||(this._changes=new Tt)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=a_.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=SV)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const i=this;i.dirty=!1;const r=function wa(n){return n.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function m0(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=t[i];if(e&&(r=e(r),s=e(s)),s!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let ts=(()=>{class n{}return n.__NG_ELEMENT_ID__=AV,n})();const MV=ts,TV=class extends MV{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,e){return this.createEmbeddedViewImpl(t,e,null)}createEmbeddedViewImpl(t,e,i){const r=this._declarationTContainer.tView,s=$g(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,e||null,i||null);s[ya]=this._declarationLView[this._declarationTContainer.index];const m=this._declarationLView[As];return null!==m&&(s[As]=m.createEmbeddedView(r)),pi(r,s,t),new cr(s)}};function AV(){return Nx(bn(),qe())}function Nx(n,t){return 4&n.type?new TV(t,n,Ed(n,t)):null}let Oo=(()=>{class n{}return n.__NG_ELEMENT_ID__=LV,n})();function LV(){return AI(bn(),qe())}const NV=Oo,MI=class extends NV{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return Ed(this._hostTNode,this._hostLView)}get injector(){return new cu(this._hostTNode,this._hostLView)}get parentInjector(){const t=Ps(this._hostTNode,this._hostLView);if(ly(t)){const e=kh(t,this._hostLView),i=lf(t);return new cu(e[It].data[i+8],e)}return new cu(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=TI(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-Pr}createEmbeddedView(t,e,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const m=t.createEmbeddedViewImpl(e||{},s,null);return this.insertImpl(m,r,false),m}createComponent(t,e,i,r,s){const u=t&&!function Fh(n){return"function"==typeof n}(t);let m;if(u)m=e;else{const de=e||{};m=de.index,i=de.injector,r=de.projectableNodes,s=de.environmentInjector||de.ngModuleRef}const b=u?t:new cp(di(t)),E=i||this.parentInjector;if(!s&&null==b.ngModule){const xe=(u?E:this.parentInjector).get(Qa,null);xe&&(s=xe)}di(b.componentType??{});const q=b.create(E,r,null,s);return this.insertImpl(q.hostView,m,false),q}insert(t,e){return this.insertImpl(t,e,!1)}insertImpl(t,e,i){const r=t._lView,s=r[It];if(function De(n){return lo(n[ki])}(r)){const b=this.indexOf(t);if(-1!==b)this.detach(b);else{const E=r[ki],T=new MI(E,E[tn],E[ki]);T.detach(T.indexOf(t))}}const u=this._adjustIndex(e),m=this._lContainer;if(function bC(n,t,e,i){const r=Pr+i,s=e.length;i>0&&(e[r-1][Go]=t),i<s-Pr?(t[Go]=e[r],eg(e,Pr+i,t)):(e.push(t),t[Go]=null),t[ki]=e;const u=t[ya];null!==u&&e!==u&&function xC(n,t){const e=n[xl];t[nr]!==t[ki][ki][nr]&&(n[Cr]=!0),null===e?n[xl]=[t]:e.push(t)}(u,t);const m=t[As];null!==m&&m.insertView(n),t[dn]|=128}(s,r,m,u),!i){const b=Oy(u,m),E=r[Dn],T=qh(E,m[Wo]);null!==T&&function _C(n,t,e,i,r,s){i[er]=r,i[tn]=t,Zh(n,i,e,1,r,s)}(s,m[tn],E,r,T,b)}return t.attachToViewContainerRef(),eg(kE(m),u,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=TI(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=$h(this._lContainer,e);i&&(mc(kE(this._lContainer),e),V0(i[It],i))}detach(t){const e=this._adjustIndex(t,-1),i=$h(this._lContainer,e);return i&&null!=mc(kE(this._lContainer),e)?new cr(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function TI(n){return n[lc]}function kE(n){return n[lc]||(n[lc]=[])}function AI(n,t){let e;const i=t[n.index];return lo(i)?e=i:(e=St(i,t,null,n),t[n.index]=e,en(t,e)),II(e,t,n,i),new MI(e,n,t)}let II=function kI(n,t,e,i){if(n[Wo])return;let r;r=8&e.type?Z(i):function BV(n,t){const e=n[Dn],i=e.createComment(""),r=ue(t,n);return _d(e,qh(e,r),i,function gg(n,t){return n.nextSibling(t)}(e,r),!1),i}(t,e),n[Wo]=r};class RE{constructor(t){this.queryList=t,this.matches=null}clone(){return new RE(this.queryList)}setDirty(){this.queryList.setDirty()}}class PE{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let s=0;s<i;s++){const u=e.getByIndex(s);r.push(this.queries[u.indexInDeclarationView].clone())}return new PE(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==LI(t,e).matches&&this.queries[e].setDirty()}}class RI{constructor(t,e,i=null){this.predicate=t,this.flags=e,this.read=i}}class OE{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,s=this.getByIndex(i).embeddedTView(t,r);s&&(s.indexInDeclarationView=i,null!==e?e.push(s):e=[s])}return null!==e?new OE(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class FE{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new FE(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(t,e,UV(e,s)),this.matchTNodeWithReadOption(t,e,hf(e,t,s,!1,!1))}else i===ts?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,hf(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===jt||r===Oo||r===ts&&4&e.type)this.addMatch(e.index,-2);else{const s=hf(e,t,r,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function UV(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function HV(n,t,e,i){return-1===e?function jV(n,t){return 11&n.type?Ed(n,t):4&n.type?Nx(n,t):null}(t,n):-2===e?function $V(n,t,e){return e===jt?Ed(t,n):e===ts?Nx(t,n):e===Oo?AI(t,n):void 0}(n,t,i):ld(n,n[It],e,t)}function PI(n,t,e,i){const r=t[As].queries[i];if(null===r.matches){const s=n.data,u=e.matches,m=[];for(let b=0;b<u.length;b+=2){const E=u[b];m.push(E<0?null:HV(t,s[E],u[b+1],e.metadata.read))}r.matches=m}return r.matches}function LE(n,t,e,i){const r=n.queries.getByIndex(e),s=r.matches;if(null!==s){const u=PI(n,t,r,e);for(let m=0;m<s.length;m+=2){const b=s[m];if(b>0)i.push(u[m/2]);else{const E=s[m+1],T=t[-b];for(let O=Pr;O<T.length;O++){const H=T[O];H[ya]===H[ki]&&LE(H[It],H,E,i)}if(null!==T[xl]){const O=T[xl];for(let H=0;H<O.length;H++){const q=O[H];LE(q[It],q,E,i)}}}}}return i}function Bt(n){const t=qe(),e=Mn(),i=ny();nf(i+1);const r=LI(e,i);if(n.dirty&&function Ae(n){return 4==(4&n[dn])}(t)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?LE(e,t,i,[]):PI(e,t,r,i);n.reset(s,KC),n.notifyOnChanges()}return!0}return!1}function ci(n,t,e){const i=Mn();i.firstCreatePass&&(FI(i,new RI(n,t,e),-1),2==(2&t)&&(i.staticViewQueries=!0)),OI(i,qe(),t)}function Ri(n,t,e,i){const r=Mn();if(r.firstCreatePass){const s=bn();FI(r,new RI(t,e,i),s.index),function qV(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(r,n),2==(2&e)&&(r.staticContentQueries=!0)}OI(r,qe(),e)}function zt(){return function GV(n,t){return n[As].queries[t].queryList}(qe(),ny())}function OI(n,t,e){const i=new a_(4==(4&e));(function _(n,t,e,i){const r=sn(t);r.push(e),n.firstCreatePass&&Gn(n).push(i,r.length-1)})(n,t,i,i.destroy),null===t[As]&&(t[As]=new PE),t[As].queries.push(new RE(i))}function FI(n,t,e){null===n.queries&&(n.queries=new OE),n.queries.track(new FE(t,e))}function LI(n,t){return n.queries.getByIndex(t)}function Hv(n,t){return Nx(n,t)}const jE=new Ke("Application Initializer");let HE=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i}),this.appInits=gt(jE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const r of this.appInits){const s=r();if(Rv(s))e.push(s);else if(GT(s)){const u=new Promise((m,b)=>{s.subscribe({complete:m,error:b})});e.push(u)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),QI=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Ec=new Ke("LocaleId",{providedIn:"root",factory:()=>gt(Ec,Jt.Optional|Jt.SkipSelf)||function f3(){return typeof $localize<"u"&&$localize.locale||r_}()});class g3{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let ek=(()=>{class n{compileModuleSync(e){return new SE(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const i=this.compileModuleSync(e),s=Nl(Rr(e).declarations).reduce((u,m)=>{const b=di(m);return b&&u.push(new cp(b)),u},[]);return new g3(i,s)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const v3=(()=>Promise.resolve(0))();function $E(n){typeof Zone>"u"?v3.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}function ik(...n){}class rn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Tt(!1),this.onMicrotaskEmpty=new Tt(!1),this.onStable=new Tt(!1),this.onError=new Tt(!1),typeof Zone>"u")throw new ke(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function b3(){let n=Ii.requestAnimationFrame,t=Ii.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function C3(n){const t=()=>{!function w3(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Ii,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,qE(n),n.isCheckStableRunning=!0,GE(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),qE(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,s,u,m)=>{try{return rk(n),e.invokeTask(r,s,u,m)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&t(),ok(n)}},onInvoke:(e,i,r,s,u,m,b)=>{try{return rk(n),e.invoke(r,s,u,m,b)}finally{n.shouldCoalesceRunChangeDetection&&t(),ok(n)}},onHasTask:(e,i,r,s)=>{e.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,qE(n),GE(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,i,r,s)=>(e.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!rn.isInAngularZone())throw new ke(909,!1)}static assertNotInAngularZone(){if(rn.isInAngularZone())throw new ke(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){const s=this._inner,u=s.scheduleEventTask("NgZoneEvent: "+r,t,x3,ik,ik);try{return s.runTask(u,e,i)}finally{s.cancelTask(u)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const x3={};function GE(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function qE(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function rk(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function ok(n){n._nesting--,GE(n)}class E3{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Tt,this.onMicrotaskEmpty=new Tt,this.onStable=new Tt,this.onError=new Tt}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}}const sk=new Ke("",{providedIn:"root",factory:ak});function ak(){const n=gt(rn);let t=!0;return $i(new Vt(r=>{t=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(t),r.complete()})}),new Vt(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{rn.assertNotInAngularZone(),$E(()=>{!t&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(t=!0,r.next(!0))})})});const u=n.onUnstable.subscribe(()=>{rn.assertInAngularZone(),t&&(t=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),u.unsubscribe()}}).pipe(oh()))}const lk=new Ke(""),zx=new Ke("");let YE,WE=(()=>{class n{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,YE||(function D3(n){YE=n}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{rn.assertNotInAngularZone(),$E(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())$E(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(u=>u.timeoutId!==s),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}}return n.\u0275fac=function(e){return new(e||n)(Ne(rn),Ne(ZE),Ne(zx))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})(),ZE=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return YE?.findTestabilityInTree(this,e,i)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),up=null;const ck=new Ke("AllowMultipleToken"),XE=new Ke("PlatformDestroyListeners"),KE=new Ke("appBootstrapListener");class uk{constructor(t,e){this.name=t,this.token=e}}function pk(n,t,e=[]){const i=`Platform: ${t}`,r=new Ke(i);return(s=[])=>{let u=JE();if(!u||u.injector.get(ck,!1)){const m=[...e,...s,{provide:r,useValue:!0}];n?n(m):function T3(n){if(up&&!up.get(ck,!1))throw new ke(400,!1);(function dk(){!function Qp(n){Gm=n}(()=>{throw new ke(600,!1)})})(),up=n;const t=n.get(mk);(function hk(n){n.get(rx,null)?.forEach(e=>e())})(n)}(function fk(n=[],t){return Ro.create({name:t,providers:[{provide:ev,useValue:"platform"},{provide:XE,useValue:new Set([()=>up=null])},...n]})}(m,i))}return function I3(n){const t=JE();if(!t)throw new ke(401,!1);return t}()}}function JE(){return up?.get(mk)??null}let mk=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function k3(n="zone.js",t){return"noop"===n?new E3:"zone.js"===n?new rn(t):n}(i?.ngZone,function gk(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function iV(n,t,e){return new DE(n,t,e)}(e.moduleType,this.injector,function xk(n){return[{provide:rn,useFactory:n},{provide:bd,multi:!0,useFactory:()=>{const t=gt(P3,{optional:!0});return()=>t.initialize()}},{provide:bk,useFactory:R3},{provide:sk,useFactory:ak}]}(()=>r)),u=s.injector.get(Ol,null);return r.runOutsideAngular(()=>{const m=r.onError.subscribe({next:b=>{u.handleError(b)}});s.onDestroy(()=>{Vx(this._modules,s),m.unsubscribe()})}),function _k(n,t,e){try{const i=e();return Rv(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(u,r,()=>{const m=s.injector.get(HE);return m.runInitializers(),m.donePromise.then(()=>(function LA(n){Uo(n,"Expected localeId to be defined"),"string"==typeof n&&(FA=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Ec,r_)||r_),this._moduleDoBootstrap(s),s))})})}bootstrapModule(e,i=[]){const r=yk({},i);return function S3(n,t,e){const i=new SE(e);return Promise.resolve(i)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(e){const i=e.injector.get(hp);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new ke(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ke(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(XE,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(Ne(Ro))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function yk(n,t){return Array.isArray(t)?t.reduce(yk,n):{...n,...t}}let hp=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=gt(bk),this.componentTypes=[],this.components=[],this.isStable=gt(sk),this._injector=gt(Qa)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof ux;if(!this._injector.get(HE).done)throw!r&&function Ua(n){const t=di(n)||ao(n)||Mo(n);return null!==t&&t.standalone}(e),new ke(405,!1);let u;u=r?e:this._injector.get(op).resolveComponentFactory(e),this.componentTypes.push(u.componentType);const m=function M3(n){return n.isBoundToModule}(u)?void 0:this._injector.get(o_),E=u.create(Ro.NULL,[],i||u.selector,m),T=E.location.nativeElement,O=E.injector.get(lk,null);return O?.registerApplication(T),E.onDestroy(()=>{this.detachView(E.hostView),Vx(this.components,E),O?.unregisterApplication(T)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new ke(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this.internalErrorHandler(e)}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;Vx(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(KE,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>Vx(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ke(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Vx(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const bk=new Ke("",{providedIn:"root",factory:()=>gt(Ol).handleError.bind(void 0)});function R3(){const n=gt(rn),t=gt(Ol);return e=>n.runOutsideAngular(()=>t.handleError(e))}let P3=(()=>{class n{constructor(){this.zone=gt(rn),this.applicationRef=gt(hp)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();let zr=(()=>{class n{}return n.__NG_ELEMENT_ID__=F3,n})();function F3(n){return function L3(n,t,e){if(Cl(n)&&!e){const i=ve(n.index,t);return new cr(i,i)}return 47&n.type?new cr(t[nr],t):null}(bn(),qe(),16==(16&n))}class Dk{constructor(){}supports(t){return Dx(t)}create(t){return new j3(t)}}const U3=(n,t)=>t;class j3{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||U3}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,s=null;for(;e||i;){const u=!i||e&&e.currentIndex<Mk(i,r,s)?e:i,m=Mk(u,r,s),b=u.currentIndex;if(u===i)r--,i=i._nextRemoved;else if(e=e._next,null==u.previousIndex)r++;else{s||(s=[]);const E=m-r,T=b-r;if(E!=T){for(let H=0;H<E;H++){const q=H<s.length?s[H]:s[H]=0,oe=q+H;T<=oe&&oe<E&&(s[H]=q+1)}s[u.previousIndex]=T-E}}m!==b&&t(u,m,b)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Dx(t))throw new ke(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,s,u,e=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let m=0;m<this.length;m++)s=t[m],u=this._trackByFn(m,s),null!==e&&Object.is(e.trackById,u)?(i&&(e=this._verifyReinsertion(e,s,u,m)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,u,m),i=!0),e=e._next}else r=0,function NN(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Symbol.iterator]();let i;for(;!(i=e.next()).done;)t(i.value)}}(t,m=>{u=this._trackByFn(r,m),null!==e&&Object.is(e.trackById,u)?(i&&(e=this._verifyReinsertion(e,m,u,r)),Object.is(e.item,m)||this._addIdentityChange(e,m)):(e=this._mismatch(e,m,u,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,r)):t=this._addAfter(new H3(e,i),s,r),t}_verifyReinsertion(t,e,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new Sk),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Sk),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class H3{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class $3{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class Sk{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new $3,this.map.set(e,i)),i.add(t)}get(t,e){const r=this.map.get(t);return r?r.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Mk(n,t,e){const i=n.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}class Tk{constructor(){}supports(t){return t instanceof Map||oE(t)}create(){return new G3}}class G3{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||oE(t)))throw new ke(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const s=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,e);const s=r._prev,u=r._next;return s&&(s._next=u),u&&(u._prev=s),r._next=null,r._prev=null,r}const i=new q3(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class q3{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Ak(){return new Ou([new Dk])}let Ou=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||Ak()),deps:[[n,new br,new Er]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new ke(901,!1)}}return n.\u0275prov=at({token:n,providedIn:"root",factory:Ak}),n})();function Ik(){return new Gv([new Tk])}let Gv=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||Ik()),deps:[[n,new br,new Er]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new ke(901,!1)}}return n.\u0275prov=at({token:n,providedIn:"root",factory:Ik}),n})();const Y3=pk(null,"core",[]);let X3=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(Ne(hp))},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})(),Lk=(()=>{class n{get whenAllTasksComplete(){return 0===this.collection.size&&this.complete(),this.promise}constructor(){this.taskId=0,this.collection=new Set,this.ngZone=gt(rn),this.completed=!1,this.ngZone.runOutsideAngular(()=>{this.promise=new Promise(e=>{this.resolve=e})})}add(){if(this.completed)return-1;const e=this.taskId++;return this.collection.add(e),e}remove(e){this.completed||(this.collection.delete(e),0===this.collection.size&&this.complete())}ngOnDestroy(){this.complete(),this.collection.clear()}complete(){this.completed=!0,this.resolve()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function d_(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let oD=null;function pp(){return oD}class c4{}const Nn=new Ke("DocumentToken");let sD=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:function(){return gt(u4)},providedIn:"platform"}),n})();const d4=new Ke("Location Initialized");let u4=(()=>{class n extends sD{constructor(){super(),this._doc=gt(Nn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return pp().getBaseHref(this._doc)}onPopState(e){const i=pp().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=pp().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,r){this._history.pushState(e,i,r)}replaceState(e,i,r){this._history.replaceState(e,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:function(){return new n},providedIn:"platform"}),n})();function aD(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function Bk(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Fu(n){return n&&"?"!==n[0]?"?"+n:n}let em=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:function(){return gt(Vk)},providedIn:"root"}),n})();const zk=new Ke("appBaseHref");let Vk=(()=>{class n extends em{constructor(e,i){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??gt(Nn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return aD(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+Fu(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${i}${r}`:i}pushState(e,i,r,s){const u=this.prepareExternalUrl(r+Fu(s));this._platformLocation.pushState(e,i,u)}replaceState(e,i,r,s){const u=this.prepareExternalUrl(r+Fu(s));this._platformLocation.replaceState(e,i,u)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Ne(sD),Ne(zk,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),h4=(()=>{class n extends em{constructor(e,i){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=aD(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,r,s){let u=this.prepareExternalUrl(r+Fu(s));0==u.length&&(u=this._platformLocation.pathname),this._platformLocation.pushState(e,i,u)}replaceState(e,i,r,s){let u=this.prepareExternalUrl(r+Fu(s));0==u.length&&(u=this._platformLocation.pathname),this._platformLocation.replaceState(e,i,u)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Ne(sD),Ne(zk,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})(),$x=(()=>{class n{constructor(e){this._subject=new Tt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const i=this._locationStrategy.getBaseHref();this._basePath=function m4(n){if(new RegExp("^(https?:)?//").test(n)){const[,e]=n.split(/\/\/[^\/]+/);return e}return n}(Bk(Uk(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+Fu(i))}normalize(e){return n.stripTrailingSlash(function f4(n,t){if(!n||!t.startsWith(n))return t;const e=t.substring(n.length);return""===e||["/",";","?","#"].includes(e[0])?e:t}(this._basePath,Uk(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",r=null){this._locationStrategy.pushState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Fu(i)),r)}replaceState(e,i="",r=null){this._locationStrategy.replaceState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Fu(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(r=>r(e,i))}subscribe(e,i,r){return this._subject.subscribe({next:e,error:i,complete:r})}}return n.normalizeQueryParams=Fu,n.joinWithSlash=aD,n.stripTrailingSlash=Bk,n.\u0275fac=function(e){return new(e||n)(Ne(em))},n.\u0275prov=at({token:n,factory:function(){return function p4(){return new $x(Ne(em))}()},providedIn:"root"}),n})();function Uk(n){return n.replace(/\/index.html$/,"")}var Xr=(()=>((Xr=Xr||{})[Xr.Format=0]="Format",Xr[Xr.Standalone=1]="Standalone",Xr))(),si=(()=>((si=si||{})[si.Narrow=0]="Narrow",si[si.Abbreviated=1]="Abbreviated",si[si.Wide=2]="Wide",si[si.Short=3]="Short",si))(),Dr=(()=>((Dr=Dr||{})[Dr.Short=0]="Short",Dr[Dr.Medium=1]="Medium",Dr[Dr.Long=2]="Long",Dr[Dr.Full=3]="Full",Dr))(),yn=(()=>((yn=yn||{})[yn.Decimal=0]="Decimal",yn[yn.Group=1]="Group",yn[yn.List=2]="List",yn[yn.PercentSign=3]="PercentSign",yn[yn.PlusSign=4]="PlusSign",yn[yn.MinusSign=5]="MinusSign",yn[yn.Exponential=6]="Exponential",yn[yn.SuperscriptingExponent=7]="SuperscriptingExponent",yn[yn.PerMille=8]="PerMille",yn[yn.Infinity=9]="Infinity",yn[yn.NaN=10]="NaN",yn[yn.TimeSeparator=11]="TimeSeparator",yn[yn.CurrencyDecimal=12]="CurrencyDecimal",yn[yn.CurrencyGroup=13]="CurrencyGroup",yn))();function Gx(n,t){return jl(ra(n)[Rt.DateFormat],t)}function qx(n,t){return jl(ra(n)[Rt.TimeFormat],t)}function Wx(n,t){return jl(ra(n)[Rt.DateTimeFormat],t)}function Ul(n,t){const e=ra(n),i=e[Rt.NumberSymbols][t];if(typeof i>"u"){if(t===yn.CurrencyDecimal)return e[Rt.NumberSymbols][yn.Decimal];if(t===yn.CurrencyGroup)return e[Rt.NumberSymbols][yn.Group]}return i}function Hk(n){if(!n[Rt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Rt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function jl(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function cD(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const T4=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,qv={},A4=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Fo=(()=>((Fo=Fo||{})[Fo.Short=0]="Short",Fo[Fo.ShortGMT=1]="ShortGMT",Fo[Fo.Long=2]="Long",Fo[Fo.Extended=3]="Extended",Fo))(),An=(()=>((An=An||{})[An.FullYear=0]="FullYear",An[An.Month=1]="Month",An[An.Date=2]="Date",An[An.Hours=3]="Hours",An[An.Minutes=4]="Minutes",An[An.Seconds=5]="Seconds",An[An.FractionalSeconds=6]="FractionalSeconds",An[An.Day=7]="Day",An))(),Wn=(()=>((Wn=Wn||{})[Wn.DayPeriods=0]="DayPeriods",Wn[Wn.Days=1]="Days",Wn[Wn.Months=2]="Months",Wn[Wn.Eras=3]="Eras",Wn))();function I4(n,t,e,i){let r=function z4(n){if(qk(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,s=1,u=1]=n.split("-").map(m=>+m);return Zx(r,s-1,u)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let i;if(i=n.match(T4))return function V4(n){const t=new Date(0);let e=0,i=0;const r=n[8]?t.setUTCFullYear:t.setFullYear,s=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const u=Number(n[4]||0)-e,m=Number(n[5]||0)-i,b=Number(n[6]||0),E=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return s.call(t,u,m,b,E),t}(i)}const t=new Date(n);if(!qk(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=Lu(e,t)||t;let m,u=[];for(;t;){if(m=A4.exec(t),!m){u.push(t);break}{u=u.concat(m.slice(1));const T=u.pop();if(!T)break;t=T}}let b=r.getTimezoneOffset();i&&(b=Gk(i,b),r=function B4(n,t,e){const i=e?-1:1,r=n.getTimezoneOffset();return function N4(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,i*(Gk(t,r)-r))}(r,i,!0));let E="";return u.forEach(T=>{const O=function L4(n){if(uD[n])return uD[n];let t;switch(n){case"G":case"GG":case"GGG":t=dr(Wn.Eras,si.Abbreviated);break;case"GGGG":t=dr(Wn.Eras,si.Wide);break;case"GGGGG":t=dr(Wn.Eras,si.Narrow);break;case"y":t=go(An.FullYear,1,0,!1,!0);break;case"yy":t=go(An.FullYear,2,0,!0,!0);break;case"yyy":t=go(An.FullYear,3,0,!1,!0);break;case"yyyy":t=go(An.FullYear,4,0,!1,!0);break;case"Y":t=Jx(1);break;case"YY":t=Jx(2,!0);break;case"YYY":t=Jx(3);break;case"YYYY":t=Jx(4);break;case"M":case"L":t=go(An.Month,1,1);break;case"MM":case"LL":t=go(An.Month,2,1);break;case"MMM":t=dr(Wn.Months,si.Abbreviated);break;case"MMMM":t=dr(Wn.Months,si.Wide);break;case"MMMMM":t=dr(Wn.Months,si.Narrow);break;case"LLL":t=dr(Wn.Months,si.Abbreviated,Xr.Standalone);break;case"LLLL":t=dr(Wn.Months,si.Wide,Xr.Standalone);break;case"LLLLL":t=dr(Wn.Months,si.Narrow,Xr.Standalone);break;case"w":t=dD(1);break;case"ww":t=dD(2);break;case"W":t=dD(1,!0);break;case"d":t=go(An.Date,1);break;case"dd":t=go(An.Date,2);break;case"c":case"cc":t=go(An.Day,1);break;case"ccc":t=dr(Wn.Days,si.Abbreviated,Xr.Standalone);break;case"cccc":t=dr(Wn.Days,si.Wide,Xr.Standalone);break;case"ccccc":t=dr(Wn.Days,si.Narrow,Xr.Standalone);break;case"cccccc":t=dr(Wn.Days,si.Short,Xr.Standalone);break;case"E":case"EE":case"EEE":t=dr(Wn.Days,si.Abbreviated);break;case"EEEE":t=dr(Wn.Days,si.Wide);break;case"EEEEE":t=dr(Wn.Days,si.Narrow);break;case"EEEEEE":t=dr(Wn.Days,si.Short);break;case"a":case"aa":case"aaa":t=dr(Wn.DayPeriods,si.Abbreviated);break;case"aaaa":t=dr(Wn.DayPeriods,si.Wide);break;case"aaaaa":t=dr(Wn.DayPeriods,si.Narrow);break;case"b":case"bb":case"bbb":t=dr(Wn.DayPeriods,si.Abbreviated,Xr.Standalone,!0);break;case"bbbb":t=dr(Wn.DayPeriods,si.Wide,Xr.Standalone,!0);break;case"bbbbb":t=dr(Wn.DayPeriods,si.Narrow,Xr.Standalone,!0);break;case"B":case"BB":case"BBB":t=dr(Wn.DayPeriods,si.Abbreviated,Xr.Format,!0);break;case"BBBB":t=dr(Wn.DayPeriods,si.Wide,Xr.Format,!0);break;case"BBBBB":t=dr(Wn.DayPeriods,si.Narrow,Xr.Format,!0);break;case"h":t=go(An.Hours,1,-12);break;case"hh":t=go(An.Hours,2,-12);break;case"H":t=go(An.Hours,1);break;case"HH":t=go(An.Hours,2);break;case"m":t=go(An.Minutes,1);break;case"mm":t=go(An.Minutes,2);break;case"s":t=go(An.Seconds,1);break;case"ss":t=go(An.Seconds,2);break;case"S":t=go(An.FractionalSeconds,1);break;case"SS":t=go(An.FractionalSeconds,2);break;case"SSS":t=go(An.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Xx(Fo.Short);break;case"ZZZZZ":t=Xx(Fo.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Xx(Fo.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Xx(Fo.Long);break;default:return null}return uD[n]=t,t}(T);E+=O?O(r,e,b):"''"===T?"'":T.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),E}function Zx(n,t,e){const i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function Lu(n,t){const e=function g4(n){return ra(n)[Rt.LocaleId]}(n);if(qv[e]=qv[e]||{},qv[e][t])return qv[e][t];let i="";switch(t){case"shortDate":i=Gx(n,Dr.Short);break;case"mediumDate":i=Gx(n,Dr.Medium);break;case"longDate":i=Gx(n,Dr.Long);break;case"fullDate":i=Gx(n,Dr.Full);break;case"shortTime":i=qx(n,Dr.Short);break;case"mediumTime":i=qx(n,Dr.Medium);break;case"longTime":i=qx(n,Dr.Long);break;case"fullTime":i=qx(n,Dr.Full);break;case"short":const r=Lu(n,"shortTime"),s=Lu(n,"shortDate");i=Yx(Wx(n,Dr.Short),[r,s]);break;case"medium":const u=Lu(n,"mediumTime"),m=Lu(n,"mediumDate");i=Yx(Wx(n,Dr.Medium),[u,m]);break;case"long":const b=Lu(n,"longTime"),E=Lu(n,"longDate");i=Yx(Wx(n,Dr.Long),[b,E]);break;case"full":const T=Lu(n,"fullTime"),O=Lu(n,"fullDate");i=Yx(Wx(n,Dr.Full),[T,O])}return i&&(qv[e][t]=i),i}function Yx(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return null!=t&&i in t?t[i]:e})),n}function Sc(n,t,e="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,s=e));let u=String(n);for(;u.length<t;)u="0"+u;return i&&(u=u.slice(u.length-t)),s+u}function go(n,t,e=0,i=!1,r=!1){return function(s,u){let m=function R4(n,t){switch(n){case An.FullYear:return t.getFullYear();case An.Month:return t.getMonth();case An.Date:return t.getDate();case An.Hours:return t.getHours();case An.Minutes:return t.getMinutes();case An.Seconds:return t.getSeconds();case An.FractionalSeconds:return t.getMilliseconds();case An.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,s);if((e>0||m>-e)&&(m+=e),n===An.Hours)0===m&&-12===e&&(m=12);else if(n===An.FractionalSeconds)return function k4(n,t){return Sc(n,3).substring(0,t)}(m,t);const b=Ul(u,yn.MinusSign);return Sc(m,t,b,i,r)}}function dr(n,t,e=Xr.Format,i=!1){return function(r,s){return function P4(n,t,e,i,r,s){switch(e){case Wn.Months:return function v4(n,t,e){const i=ra(n),s=jl([i[Rt.MonthsFormat],i[Rt.MonthsStandalone]],t);return jl(s,e)}(t,r,i)[n.getMonth()];case Wn.Days:return function y4(n,t,e){const i=ra(n),s=jl([i[Rt.DaysFormat],i[Rt.DaysStandalone]],t);return jl(s,e)}(t,r,i)[n.getDay()];case Wn.DayPeriods:const u=n.getHours(),m=n.getMinutes();if(s){const E=function C4(n){const t=ra(n);return Hk(t),(t[Rt.ExtraData][2]||[]).map(i=>"string"==typeof i?cD(i):[cD(i[0]),cD(i[1])])}(t),T=function E4(n,t,e){const i=ra(n);Hk(i);const s=jl([i[Rt.ExtraData][0],i[Rt.ExtraData][1]],t)||[];return jl(s,e)||[]}(t,r,i),O=E.findIndex(H=>{if(Array.isArray(H)){const[q,oe]=H,de=u>=q.hours&&m>=q.minutes,xe=u<oe.hours||u===oe.hours&&m<oe.minutes;if(q.hours<oe.hours){if(de&&xe)return!0}else if(de||xe)return!0}else if(H.hours===u&&H.minutes===m)return!0;return!1});if(-1!==O)return T[O]}return function _4(n,t,e){const i=ra(n),s=jl([i[Rt.DayPeriodsFormat],i[Rt.DayPeriodsStandalone]],t);return jl(s,e)}(t,r,i)[u<12?0:1];case Wn.Eras:return function b4(n,t){return jl(ra(n)[Rt.Eras],t)}(t,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,s,n,t,e,i)}}function Xx(n){return function(t,e,i){const r=-1*i,s=Ul(e,yn.MinusSign),u=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case Fo.Short:return(r>=0?"+":"")+Sc(u,2,s)+Sc(Math.abs(r%60),2,s);case Fo.ShortGMT:return"GMT"+(r>=0?"+":"")+Sc(u,1,s);case Fo.Long:return"GMT"+(r>=0?"+":"")+Sc(u,2,s)+":"+Sc(Math.abs(r%60),2,s);case Fo.Extended:return 0===i?"Z":(r>=0?"+":"")+Sc(u,2,s)+":"+Sc(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}const O4=0,Kx=4;function $k(n){return Zx(n.getFullYear(),n.getMonth(),n.getDate()+(Kx-n.getDay()))}function dD(n,t=!1){return function(e,i){let r;if(t){const s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,u=e.getDate();r=1+Math.floor((u+s)/7)}else{const s=$k(e),u=function F4(n){const t=Zx(n,O4,1).getDay();return Zx(n,0,1+(t<=Kx?Kx:Kx+7)-t)}(s.getFullYear()),m=s.getTime()-u.getTime();r=1+Math.round(m/6048e5)}return Sc(r,n,Ul(i,yn.MinusSign))}}function Jx(n,t=!1){return function(e,i){return Sc($k(e).getFullYear(),n,Ul(i,yn.MinusSign),t)}}const uD={};function Gk(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function qk(n){return n instanceof Date&&!isNaN(n.valueOf())}function Xk(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,s]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(s)}return null}const _D=/\s+/,Kk=[];let ew=(()=>{class n{constructor(e,i,r,s){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=Kk,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(_D):Kk}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(_D):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,!!e[i]);this._applyStateDiff()}_updateState(e,i){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(_D).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(e){return new(e||n)(J(Ou),J(Gv),J(jt),J(Pl))},n.\u0275dir=rt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class e5{constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let tw=(()=>{class n{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,s,u)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new e5(r.item,this._ngForOf,-1,-1),null===u?void 0:u);else if(null==u)i.remove(null===s?void 0:s);else if(null!==s){const m=i.get(s);i.move(m,u),Qk(m,r)}});for(let r=0,s=i.length;r<s;r++){const m=i.get(r).context;m.index=r,m.count=s,m.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{Qk(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(J(Oo),J(ts),J(Ou))},n.\u0275dir=rt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function Qk(n,t){n.context.$implicit=t.item}let Nu=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new t5,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){eR("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){eR("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(J(Oo),J(ts))},n.\u0275dir=rt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class t5{constructor(){this.$implicit=null,this.ngIf=null}}function eR(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Gt(t)}'.`)}class yD{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let tm=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const i of this._defaultViews)i.enforceState(e)}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),n})(),Zv=(()=>{class n{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new yD(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(e){return new(e||n)(J(Oo),J(ts),J(tm,9))},n.\u0275dir=rt({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),n})(),vD=(()=>{class n{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:u}=this;this._viewRef=i.createEmbeddedView(r,s,u?{injector:u}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(e){return new(e||n)(J(Oo))},n.\u0275dir=rt({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[M]}),n})();function Mc(n,t){return new ke(2100,!1)}class s5{createSubscription(t,e){return t.subscribe({next:e,error:i=>{throw i}})}dispose(t){t.unsubscribe()}}class a5{createSubscription(t,e){return t.then(e,i=>{throw i})}dispose(t){}}const l5=new a5,c5=new s5;let nR=(()=>{class n{constructor(e){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=e}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue:(e&&this._subscribe(e),this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,i=>this._updateLatestValue(e,i))}_selectStrategy(e){if(Rv(e))return l5;if(GT(e))return c5;throw Mc()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,i){e===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(e){return new(e||n)(J(zr,16))},n.\u0275pipe=$o({name:"async",type:n,pure:!1,standalone:!0}),n})();const m5=new Ke("DATE_PIPE_DEFAULT_TIMEZONE"),g5=new Ke("DATE_PIPE_DEFAULT_OPTIONS");let iR=(()=>{class n{constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,s){if(null==e||""===e||e!=e)return null;try{return I4(e,i??this.defaultOptions?.dateFormat??"mediumDate",s||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(u){throw Mc()}}}return n.\u0275fac=function(e){return new(e||n)(J(Ec,16),J(m5,24),J(g5,24))},n.\u0275pipe=$o({name:"date",type:n,pure:!0,standalone:!0}),n})(),Tc=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})();const oR="browser";function sR(n){return"server"===n}let I5=(()=>{class n{}return n.\u0275prov=at({token:n,providedIn:"root",factory:()=>new k5(Ne(Nn),window)}),n})();class k5{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function R5(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const u=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(u)return u}r=i.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=aR(this.window.history)||aR(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function aR(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class lR{}class oU extends c4{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ED extends oU{static makeCurrent(){!function l4(n){oD||(oD=n)}(new ED)}onAndCancel(t,e,i){return t.addEventListener(e,i),()=>{t.removeEventListener(e,i)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function sU(){return Xv=Xv||document.querySelector("base"),Xv?Xv.getAttribute("href"):null}();return null==e?null:function aU(n){ow=ow||document.createElement("a"),ow.setAttribute("href",n);const t=ow.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){Xv=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return Xk(document.cookie,t)}}let ow,Xv=null,cU=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const DD=new Ke("EventManagerPlugins");let pR=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(s=>s.supports(e)),!i)throw new ke(5101,!1);return this._eventNameToPlugin.set(e,i),i}}return n.\u0275fac=function(e){return new(e||n)(Ne(DD),Ne(rn))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();class fR{constructor(t){this._doc=t}}const SD="ng-app-id";let mR=(()=>{class n{constructor(e,i,r,s={}){this.doc=e,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=sR(s),this.resetHostNodes()}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(i=>i.remove()),e.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.elements?.forEach(r=>r.remove()),i.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${SD}="${this.appId}"]`);if(e?.length){const i=new Map;return e.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(e,i){const r=this.styleRef;if(r.has(e)){const s=r.get(e);return s.usage+=i,s.usage}return r.set(e,{usage:i,elements:[]}),i}getStyleElement(e,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===e)return r.delete(i),s.removeAttribute(SD),s;{const u=this.doc.createElement("style");return this.nonce&&u.setAttribute("nonce",this.nonce),u.textContent=i,this.platformIsServer&&u.setAttribute(SD,this.appId),u}}addStyleToHost(e,i){const r=this.getStyleElement(e,i);e.appendChild(r);const s=this.styleRef,u=s.get(i)?.elements;u?u.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn),Ne(kg),Ne(Vf,8),Ne(wd))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const MD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},TD=/%COMP%/g,pU=new Ke("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function _R(n,t){return t.map(e=>e.replace(TD,n))}let AD=(()=>{class n{constructor(e,i,r,s,u,m,b,E=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.doc=u,this.platformId=m,this.ngZone=b,this.nonce=E,this.rendererByCompId=new Map,this.platformIsServer=sR(m),this.defaultRenderer=new ID(e,u,b,this.platformIsServer)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Do.ShadowDom&&(i={...i,encapsulation:Do.Emulated});const r=this.getOrCreateRenderer(e,i);return r instanceof vR?r.applyToHost(e):r instanceof kD&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const u=this.doc,m=this.ngZone,b=this.eventManager,E=this.sharedStylesHost,T=this.removeStylesOnCompDestory,O=this.platformIsServer;switch(i.encapsulation){case Do.Emulated:s=new vR(b,E,i,this.appId,T,u,m,O);break;case Do.ShadowDom:return new _U(b,E,e,i,u,m,this.nonce,O);default:s=new kD(b,E,i,T,u,m,O)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}}return n.\u0275fac=function(e){return new(e||n)(Ne(pR),Ne(mR),Ne(kg),Ne(pU),Ne(Nn),Ne(wd),Ne(rn),Ne(Vf))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();class ID{constructor(t,e,i,r){this.eventManager=t,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?this.doc.createElementNS(MD[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(yR(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(yR(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?this.doc.querySelector(t):t;if(!i)throw new ke(5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const s=MD[r];s?t.setAttributeNS(s,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=MD[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(qi.DashCase|qi.Important)?t.style.setProperty(e,i,r&qi.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&qi.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){if("string"==typeof t&&!(t=pp().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${e}`);return this.eventManager.addEventListener(t,e,this.decoratePreventDefault(i))}decoratePreventDefault(t){return e=>{if("__ngUnwrap__"===e)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))&&e.preventDefault()}}}function yR(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class _U extends ID{constructor(t,e,i,r,s,u,m,b){super(t,s,u,b),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const E=_R(r.id,r.styles);for(const T of E){const O=document.createElement("style");m&&O.setAttribute("nonce",m),O.textContent=T,this.shadowRoot.appendChild(O)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class kD extends ID{constructor(t,e,i,r,s,u,m,b){super(t,s,u,m),this.sharedStylesHost=e,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=b?_R(b,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class vR extends kD{constructor(t,e,i,r,s,u,m,b){const E=r+"-"+i.id;super(t,e,i,s,u,m,b,E),this.contentAttr=function fU(n){return"_ngcontent-%COMP%".replace(TD,n)}(E),this.hostAttr=function mU(n){return"_nghost-%COMP%".replace(TD,n)}(E)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}let yU=(()=>{class n extends fR{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const bR=["alt","control","meta","shift"],vU={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},bU={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let xU=(()=>{class n extends fR{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r){const s=n.parseEventName(i),u=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>pp().onAndCancel(e,s.domEventName,u))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let u="",m=i.indexOf("code");if(m>-1&&(i.splice(m,1),u="code."),bR.forEach(E=>{const T=i.indexOf(E);T>-1&&(i.splice(T,1),u+=E+".")}),u+=s,0!=i.length||0===s.length)return null;const b={};return b.domEventName=r,b.fullKey=u,b}static matchEventFullKeyCode(e,i){let r=vU[e.key]||e.key,s="";return i.indexOf("code.")>-1&&(r=e.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),bR.forEach(u=>{u!==r&&(0,bU[u])(e)&&(s+=u+".")}),s+=r,s===i)}static eventCallback(e,i,r){return s=>{n.matchEventFullKeyCode(s,e)&&r.runGuarded(()=>i(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const DU=pk(Y3,"browser",[{provide:wd,useValue:oR},{provide:rx,useValue:function wU(){ED.makeCurrent()},multi:!0},{provide:Nn,useFactory:function EU(){return function TC(n){By=n}(document),document},deps:[]}]),SU=new Ke(""),CR=[{provide:zx,useClass:class lU{addToWindow(t){Ii.getAngularTestability=(i,r=!0)=>{const s=t.findTestabilityInTree(i,r);if(null==s)throw new ke(5103,!1);return s},Ii.getAllAngularTestabilities=()=>t.getAllTestabilities(),Ii.getAllAngularRootElements=()=>t.getAllRootElements(),Ii.frameworkStabilizers||(Ii.frameworkStabilizers=[]),Ii.frameworkStabilizers.push(i=>{const r=Ii.getAllAngularTestabilities();let s=r.length,u=!1;const m=function(b){u=u||b,s--,0==s&&i(u)};r.forEach(function(b){b.whenStable(m)})})}findTestabilityInTree(t,e,i){return null==e?null:t.getTestability(e)??(i?pp().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:lk,useClass:WE,deps:[rn,ZE,zx]},{provide:WE,useClass:WE,deps:[rn,ZE,zx]}],ER=[{provide:ev,useValue:"root"},{provide:Ol,useFactory:function CU(){return new Ol},deps:[]},{provide:DD,useClass:yU,multi:!0,deps:[Nn,rn,wd]},{provide:DD,useClass:xU,multi:!0,deps:[Nn]},AD,mR,pR,{provide:Eu,useExisting:AD},{provide:lR,useClass:cU,deps:[]},[]];let DR=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:kg,useValue:e.appId}]}}}return n.\u0275fac=function(e){return new(e||n)(Ne(SU,12))},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[...ER,...CR],imports:[Tc,X3]}),n})(),SR=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn))},n.\u0275prov=at({token:n,factory:function(e){let i=null;return i=e?new e:function TU(){return new SR(Ne(Nn))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let sw=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:function(e){let i=null;return i=e?new(e||n):Ne(AR),i},providedIn:"root"}),n})(),AR=(()=>{class n extends sw{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case hi.NONE:return i;case hi.HTML:return Ka(i,"HTML")?ta(i):yu(this._doc,String(i)).toString();case hi.STYLE:return Ka(i,"Style")?ta(i):i;case hi.SCRIPT:if(Ka(i,"Script"))return ta(i);throw new ke(5200,!1);case hi.URL:return Ka(i,"URL")?ta(i):Of(String(i));case hi.RESOURCE_URL:if(Ka(i,"ResourceURL"))return ta(i);throw new ke(5201,!1);default:throw new ke(5202,!1)}}bypassSecurityTrustHtml(e){return function Zr(n){return new Y0(n)}(e)}bypassSecurityTrustStyle(e){return function Ja(n){return new AC(n)}(e)}bypassSecurityTrustScript(e){return function Uy(n){return new IC(n)}(e)}bypassSecurityTrustUrl(e){return function vg(n){return new kC(n)}(e)}bypassSecurityTrustResourceUrl(e){return function Yh(n){return new RC(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn))},n.\u0275prov=at({token:n,factory:function(e){let i=null;return i=e?new e:function RU(n){return new AR(n.get(Nn))}(Ne(Ro)),i},providedIn:"root"}),n})();function kR(n){return!!n&&(n instanceof Vt||mn(n.lift)&&mn(n.subscribe))}function qt(...n){return mr(n,Vo(n))}class _s extends Xt{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}const{isArray:PU}=Array,{getPrototypeOf:OU,prototype:FU,keys:LU}=Object;function RR(n){if(1===n.length){const t=n[0];if(PU(t))return{args:t,keys:null};if(function NU(n){return n&&"object"==typeof n&&OU(n)===FU}(t)){const e=LU(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}const{isArray:BU}=Array;function PD(n){return xt(t=>function zU(n,t){return BU(t)?n(...t):n(t)}(n,t))}function PR(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}function nm(...n){const t=Vo(n),e=$d(n),{args:i,keys:r}=RR(n);if(0===i.length)return mr([],t);const s=new Vt(function VU(n,t,e=mt){return i=>{OR(t,()=>{const{length:r}=n,s=new Array(r);let u=r,m=r;for(let b=0;b<r;b++)OR(t,()=>{const E=mr(n[b],t);let T=!1;E.subscribe(fi(i,O=>{s[b]=O,T||(T=!0,m--),m||i.next(e(s.slice()))},()=>{--u||i.complete()}))},i)},i)}}(i,t,r?u=>PR(r,u):mt));return e?s.pipe(PD(e)):s}function OR(n,t,e){n?Ni(e,n,t):t()}const aw=io(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Kv(...n){return function UU(){return Vc(1)}()(mr(n,Vo(n)))}function lw(n){return new Vt(t=>{Lt(n()).subscribe(t)})}function u_(n,t){const e=mn(n)?n:()=>n,i=r=>r.error(e());return new Vt(t?r=>t.schedule(i,0,r):i)}function OD(){return Ui((n,t)=>{let e=null;n._refCount++;const i=fi(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const r=n._connection,s=e;e=null,r&&(!s||r===s)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}class FD extends Vt{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,la(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Ie;const e=this.getSubject();t.add(this.source.subscribe(fi(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Ie.EMPTY)}return t}refCount(){return OD()(this)}}function Vs(n,t){return Ui((e,i)=>{let r=null,s=0,u=!1;const m=()=>u&&!r&&i.complete();e.subscribe(fi(i,b=>{r?.unsubscribe();let E=0;const T=s++;Lt(n(b,T)).subscribe(r=fi(i,O=>i.next(t?t(b,O,T,E++):O),()=>{r=null,m()}))},()=>{u=!0,m()}))})}function Jr(n){return n<=0?()=>Es:Ui((t,e)=>{let i=0;t.subscribe(fi(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function Rd(...n){const t=Vo(n);return Ui((e,i)=>{(t?Kv(n,e,t):Kv(n,e)).subscribe(i)})}function Lo(n,t){return Ui((e,i)=>{let r=0;e.subscribe(fi(i,s=>n.call(t,s,r++)&&i.next(s)))})}function cw(n){return Ui((t,e)=>{let i=!1;t.subscribe(fi(e,r=>{i=!0,e.next(r)},()=>{i||e.next(n),e.complete()}))})}function FR(n=jU){return Ui((t,e)=>{let i=!1;t.subscribe(fi(e,r=>{i=!0,e.next(r)},()=>i?e.complete():e.error(n())))})}function jU(){return new aw}function im(n,t){const e=arguments.length>=2;return i=>i.pipe(n?Lo((r,s)=>n(r,s,i)):mt,Jr(1),e?cw(t):FR(()=>new aw))}function h_(n,t){return mn(t)?Ki(n,t,1):Ki(n,1)}function Vr(n,t,e){const i=mn(n)||t||e?{next:n,error:t,complete:e}:n;return i?Ui((r,s)=>{var u;null===(u=i.subscribe)||void 0===u||u.call(i);let m=!0;r.subscribe(fi(s,b=>{var E;null===(E=i.next)||void 0===E||E.call(i,b),s.next(b)},()=>{var b;m=!1,null===(b=i.complete)||void 0===b||b.call(i),s.complete()},b=>{var E;m=!1,null===(E=i.error)||void 0===E||E.call(i,b),s.error(b)},()=>{var b,E;m&&(null===(b=i.unsubscribe)||void 0===b||b.call(i)),null===(E=i.finalize)||void 0===E||E.call(i)}))}):mt}function mp(n){return Ui((t,e)=>{let s,i=null,r=!1;i=t.subscribe(fi(e,void 0,void 0,u=>{s=Lt(n(u,mp(n)(t))),i?(i.unsubscribe(),i=null,s.subscribe(e)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(e))})}function LD(n){return n<=0?()=>Es:Ui((t,e)=>{let i=[];t.subscribe(fi(e,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)e.next(r);e.complete()},void 0,()=>{i=null}))})}function LR(n){return xt(()=>n)}function dw(n){return Ui((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const jn="primary",Jv=Symbol("RouteTitle");class qU{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function p_(n){return new qU(n)}function WU(n,t,e){const i=e.path.split("/");if(i.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const u=i[s],m=n[s];if(u.startsWith(":"))r[u.substring(1)]=m;else if(u!==m.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Pd(n,t){const e=n?Object.keys(n):void 0,i=t?Object.keys(t):void 0;if(!e||!i||e.length!=i.length)return!1;let r;for(let s=0;s<e.length;s++)if(r=e[s],!NR(n[r],t[r]))return!1;return!0}function NR(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),i=[...t].sort();return e.every((r,s)=>i[s]===r)}return n===t}function BR(n){return n.length>0?n[n.length-1]:null}function gp(n){return kR(n)?n:Rv(n)?mr(Promise.resolve(n)):qt(n)}const YU={exact:function UR(n,t,e){if(!rm(n.segments,t.segments)||!uw(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!n.children[i]||!UR(n.children[i],t.children[i],e))return!1;return!0},subset:jR},zR={exact:function XU(n,t){return Pd(n,t)},subset:function KU(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>NR(n[e],t[e]))},ignored:()=>!0};function VR(n,t,e){return YU[e.paths](n.root,t.root,e.matrixParams)&&zR[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function jR(n,t,e){return HR(n,t,t.segments,e)}function HR(n,t,e,i){if(n.segments.length>e.length){const r=n.segments.slice(0,e.length);return!(!rm(r,e)||t.hasChildren()||!uw(r,e,i))}if(n.segments.length===e.length){if(!rm(n.segments,e)||!uw(n.segments,e,i))return!1;for(const r in t.children)if(!n.children[r]||!jR(n.children[r],t.children[r],i))return!1;return!0}{const r=e.slice(0,n.segments.length),s=e.slice(n.segments.length);return!!(rm(n.segments,r)&&uw(n.segments,r,i)&&n.children[jn])&&HR(n.children[jn],t,s,i)}}function uw(n,t,e){return t.every((i,r)=>zR[e](n[r].parameters,i.parameters))}class f_{constructor(t=new Yi([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=p_(this.queryParams)),this._queryParamMap}toString(){return ej.serialize(this)}}class Yi{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Object.values(e).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return hw(this)}}class Qv{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=p_(this.parameters)),this._parameterMap}toString(){return qR(this)}}function rm(n,t){return n.length===t.length&&n.every((e,i)=>e.path===t[i].path)}let eb=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:function(){return new ND},providedIn:"root"}),n})();class ND{parse(t){const e=new uj(t);return new f_(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${tb(t.root,!0)}`,i=function ij(n){const t=Object.keys(n).map(e=>{const i=n[e];return Array.isArray(i)?i.map(r=>`${pw(e)}=${pw(r)}`).join("&"):`${pw(e)}=${pw(i)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${i}${"string"==typeof t.fragment?`#${function tj(n){return encodeURI(n)}(t.fragment)}`:""}`}}const ej=new ND;function hw(n){return n.segments.map(t=>qR(t)).join("/")}function tb(n,t){if(!n.hasChildren())return hw(n);if(t){const e=n.children[jn]?tb(n.children[jn],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==jn&&i.push(`${r}:${tb(s,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function QU(n,t){let e=[];return Object.entries(n.children).forEach(([i,r])=>{i===jn&&(e=e.concat(t(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==jn&&(e=e.concat(t(r,i)))}),e}(n,(i,r)=>r===jn?[tb(n.children[jn],!1)]:[`${r}:${tb(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[jn]?`${hw(n)}/${e[0]}`:`${hw(n)}/(${e.join("//")})`}}function $R(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function pw(n){return $R(n).replace(/%3B/gi,";")}function BD(n){return $R(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function fw(n){return decodeURIComponent(n)}function GR(n){return fw(n.replace(/\+/g,"%20"))}function qR(n){return`${BD(n.path)}${function nj(n){return Object.keys(n).map(t=>`;${BD(t)}=${BD(n[t])}`).join("")}(n.parameters)}`}const rj=/^[^\/()?;#]+/;function zD(n){const t=n.match(rj);return t?t[0]:""}const oj=/^[^\/()?;=#]+/,aj=/^[^=?&#]+/,cj=/^[^&#]+/;class uj{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Yi([],{}):new Yi([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[jn]=new Yi(t,e)),i}parseSegment(){const t=zD(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new ke(4009,!1);return this.capture(t),new Qv(fw(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=function sj(n){const t=n.match(oj);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const r=zD(this.remaining);r&&(i=r,this.capture(i))}t[fw(e)]=fw(i)}parseQueryParam(t){const e=function lj(n){const t=n.match(aj);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const u=function dj(n){const t=n.match(cj);return t?t[0]:""}(this.remaining);u&&(i=u,this.capture(i))}const r=GR(e),s=GR(i);if(t.hasOwnProperty(r)){let u=t[r];Array.isArray(u)||(u=[u],t[r]=u),u.push(s)}else t[r]=s}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=zD(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ke(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=jn);const u=this.parseChildren();e[s]=1===Object.keys(u).length?u[jn]:new Yi([],u),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new ke(4011,!1)}}function WR(n){return n.segments.length>0?new Yi([],{[jn]:n}):n}function ZR(n){const t={};for(const i of Object.keys(n.children)){const s=ZR(n.children[i]);if(i===jn&&0===s.segments.length&&s.hasChildren())for(const[u,m]of Object.entries(s.children))t[u]=m;else(s.segments.length>0||s.hasChildren())&&(t[i]=s)}return function hj(n){if(1===n.numberOfChildren&&n.children[jn]){const t=n.children[jn];return new Yi(n.segments.concat(t.segments),t.children)}return n}(new Yi(n.segments,t))}function om(n){return n instanceof f_}function YR(n){let t;const r=WR(function e(s){const u={};for(const b of s.children){const E=e(b);u[b.outlet]=E}const m=new Yi(s.url,u);return s===n&&(t=m),m}(n.root));return t??r}function XR(n,t,e,i){let r=n;for(;r.parent;)r=r.parent;if(0===t.length)return VD(r,r,r,e,i);const s=function fj(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new JR(!0,0,n);let t=0,e=!1;const i=n.reduce((r,s,u)=>{if("object"==typeof s&&null!=s){if(s.outlets){const m={};return Object.entries(s.outlets).forEach(([b,E])=>{m[b]="string"==typeof E?E.split("/"):E}),[...r,{outlets:m}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===u?(s.split("/").forEach((m,b)=>{0==b&&"."===m||(0==b&&""===m?e=!0:".."===m?t++:""!=m&&r.push(m))}),r):[...r,s]},[]);return new JR(e,t,i)}(t);if(s.toRoot())return VD(r,r,new Yi([],{}),e,i);const u=function mj(n,t,e){if(n.isAbsolute)return new gw(t,!0,0);if(!e)return new gw(t,!1,NaN);if(null===e.parent)return new gw(e,!0,0);const i=mw(n.commands[0])?0:1;return function gj(n,t,e){let i=n,r=t,s=e;for(;s>r;){if(s-=r,i=i.parent,!i)throw new ke(4005,!1);r=i.segments.length}return new gw(i,!1,r-s)}(e,e.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),m=u.processChildren?ib(u.segmentGroup,u.index,s.commands):QR(u.segmentGroup,u.index,s.commands);return VD(r,u.segmentGroup,m,e,i)}function mw(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function nb(n){return"object"==typeof n&&null!=n&&n.outlets}function VD(n,t,e,i,r){let u,s={};i&&Object.entries(i).forEach(([b,E])=>{s[b]=Array.isArray(E)?E.map(T=>`${T}`):`${E}`}),u=n===t?e:KR(n,t,e);const m=WR(ZR(u));return new f_(m,s,r)}function KR(n,t,e){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===t?e:KR(s,t,e)}),new Yi(n.segments,i)}class JR{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&mw(i[0]))throw new ke(4003,!1);const r=i.find(nb);if(r&&r!==BR(i))throw new ke(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class gw{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function QR(n,t,e){if(n||(n=new Yi([],{})),0===n.segments.length&&n.hasChildren())return ib(n,t,e);const i=function yj(n,t,e){let i=0,r=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=e.length)return s;const u=n.segments[r],m=e[i];if(nb(m))break;const b=`${m}`,E=i<e.length-1?e[i+1]:null;if(r>0&&void 0===b)break;if(b&&E&&"object"==typeof E&&void 0===E.outlets){if(!tP(b,E,u))return s;i+=2}else{if(!tP(b,{},u))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,t,e),r=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Yi(n.segments.slice(0,i.pathIndex),{});return s.children[jn]=new Yi(n.segments.slice(i.pathIndex),n.children),ib(s,0,r)}return i.match&&0===r.length?new Yi(n.segments,{}):i.match&&!n.hasChildren()?UD(n,t,e):i.match?ib(n,0,r):UD(n,t,e)}function ib(n,t,e){if(0===e.length)return new Yi(n.segments,{});{const i=function _j(n){return nb(n[0])?n[0].outlets:{[jn]:n}}(e),r={};if(!i[jn]&&n.children[jn]&&1===n.numberOfChildren&&0===n.children[jn].segments.length){const s=ib(n.children[jn],t,e);return new Yi(n.segments,s.children)}return Object.entries(i).forEach(([s,u])=>{"string"==typeof u&&(u=[u]),null!==u&&(r[s]=QR(n.children[s],t,u))}),Object.entries(n.children).forEach(([s,u])=>{void 0===i[s]&&(r[s]=u)}),new Yi(n.segments,r)}}function UD(n,t,e){const i=n.segments.slice(0,t);let r=0;for(;r<e.length;){const s=e[r];if(nb(s)){const b=vj(s.outlets);return new Yi(i,b)}if(0===r&&mw(e[0])){i.push(new Qv(n.segments[t].path,eP(e[0]))),r++;continue}const u=nb(s)?s.outlets[jn]:`${s}`,m=r<e.length-1?e[r+1]:null;u&&m&&mw(m)?(i.push(new Qv(u,eP(m))),r+=2):(i.push(new Qv(u,{})),r++)}return new Yi(i,{})}function vj(n){const t={};return Object.entries(n).forEach(([e,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(t[e]=UD(new Yi([],{}),0,i))}),t}function eP(n){const t={};return Object.entries(n).forEach(([e,i])=>t[e]=`${i}`),t}function tP(n,t,e){return n==e.path&&Pd(t,e.parameters)}const rb="imperative";class Od{constructor(t,e){this.id=t,this.url=e}}class jD extends Od{constructor(t,e,i="imperative",r=null){super(t,e),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class sm extends Od{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class _w extends Od{constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ob extends Od{constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r,this.type=16}}class HD extends Od{constructor(t,e,i,r){super(t,e),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class bj extends Od{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xj extends Od{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wj extends Od{constructor(t,e,i,r,s){super(t,e),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Cj extends Od{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ej extends Od{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Dj{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Sj{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Mj{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Tj{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Aj{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ij{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nP{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class kj{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new sb,this.attachRef=null}}let sb=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const r=this.getOrCreateContext(e);r.outlet=i,this.contexts.set(e,r)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new kj,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class iP{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=$D(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){const e=$D(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=GD(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return GD(t,this._root).map(e=>e.value)}}function $D(n,t){if(n===t.value)return t;for(const e of t.children){const i=$D(n,e);if(i)return i}return null}function GD(n,t){if(n===t.value)return[t];for(const e of t.children){const i=GD(n,e);if(i.length)return i.unshift(t),i}return[]}class Bu{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function m_(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class rP extends iP{constructor(t,e){super(t),this.snapshot=e,qD(this,t)}toString(){return this.snapshot.toString()}}function oP(n,t){const e=function Rj(n,t){const u=new yw([],{},{},"",{},jn,t,null,{});return new aP("",new Bu(u,[]))}(0,t),i=new _s([new Qv("",{})]),r=new _s({}),s=new _s({}),u=new _s({}),m=new _s(""),b=new _p(i,r,u,m,s,jn,t,e.root);return b.snapshot=e.root,new rP(new Bu(b,[]),e)}class _p{constructor(t,e,i,r,s,u,m,b){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=u,this.component=m,this._futureSnapshot=b,this.title=this.dataSubject?.pipe(xt(E=>E[Jv]))??qt(void 0),this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(xt(t=>p_(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(xt(t=>p_(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function sP(n,t="emptyOnly"){const e=n.pathFromRoot;let i=0;if("always"!==t)for(i=e.length-1;i>=1;){const r=e[i],s=e[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function Pj(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(i))}class yw{get title(){return this.data?.[Jv]}constructor(t,e,i,r,s,u,m,b,E){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=u,this.component=m,this.routeConfig=b,this._resolve=E}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=p_(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=p_(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class aP extends iP{constructor(t,e){super(e),this.url=t,qD(this,e)}toString(){return lP(this._root)}}function qD(n,t){t.value._routerState=n,t.children.forEach(e=>qD(n,e))}function lP(n){const t=n.children.length>0?` { ${n.children.map(lP).join(", ")} } `:"";return`${n.value}${t}`}function WD(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,Pd(t.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),Pd(t.params,e.params)||n.paramsSubject.next(e.params),function ZU(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!Pd(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.urlSubject.next(e.url),Pd(t.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function ZD(n,t){const e=Pd(n.params,t.params)&&function JU(n,t){return rm(n,t)&&n.every((e,i)=>Pd(e.parameters,t[i].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||ZD(n.parent,t.parent))}let YD=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=jn,this.activateEvents=new Tt,this.deactivateEvents=new Tt,this.attachEvents=new Tt,this.detachEvents=new Tt,this.parentContexts=gt(sb),this.location=gt(Oo),this.changeDetector=gt(zr),this.environmentInjector=gt(Qa),this.inputBinder=gt(vw,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){const{firstChange:i,previousValue:r}=e.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ke(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ke(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ke(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new ke(4013,!1);this._activatedRoute=e;const r=this.location,u=e.snapshot.component,m=this.parentContexts.getOrCreateContext(this.name).children,b=new Oj(e,m,r.injector);this.activated=r.createComponent(u,{index:r.length,injector:b,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[M]}),n})();class Oj{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===_p?this.route:t===sb?this.childContexts:this.parent.get(t,e)}}const vw=new Ke("");let cP=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:i}=e,r=nm([i.queryParams,i.params,i.data]).pipe(Vs(([s,u,m],b)=>(m={...s,...u,...m},0===b?qt(m):Promise.resolve(m)))).subscribe(s=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(e);const u=function a4(n){const t=di(n);if(!t)return null;const e=new cp(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone}}}(i.component);if(u)for(const{templateName:m}of u.inputs)e.activatedComponentRef.setInput(m,s[m]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,r)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();function ab(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=t.value;const r=function Lj(n,t,e){return t.children.map(i=>{for(const r of e.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return ab(n,i,r);return ab(n,i)})}(n,t,e);return new Bu(i,r)}{if(n.shouldAttach(t.value)){const s=n.retrieve(t.value);if(null!==s){const u=s.route;return u.value._futureSnapshot=t.value,u.children=t.children.map(m=>ab(n,m)),u}}const i=function Nj(n){return new _p(new _s(n.url),new _s(n.params),new _s(n.queryParams),new _s(n.fragment),new _s(n.data),n.outlet,n.component,n)}(t.value),r=t.children.map(s=>ab(n,s));return new Bu(i,r)}}const XD="ngNavigationCancelingError";function dP(n,t){const{redirectTo:e,navigationBehaviorOptions:i}=om(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=uP(!1,0,t);return r.url=e,r.navigationBehaviorOptions=i,r}function uP(n,t,e){const i=new Error("NavigationCancelingError: "+(n||""));return i[XD]=!0,i.cancellationCode=t,e&&(i.url=e),i}function hP(n){return pP(n)&&om(n.url)}function pP(n){return n&&n[XD]}let fP=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Fn({type:n,selectors:[["ng-component"]],standalone:!0,features:[cI],decls:1,vars:0,template:function(e,i){1&e&&_n(0,"router-outlet")},dependencies:[YD],encapsulation:2}),n})();function KD(n){const t=n.children&&n.children.map(KD),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==jn&&(e.component=fP),e}function Ac(n){return n.outlet||jn}function lb(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class $j{constructor(t,e,i,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),WD(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const r=m_(e);t.children.forEach(s=>{const u=s.value.outlet;this.deactivateRoutes(s,r[u],i),delete r[u]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(t,e,i){const r=t.value,s=e?e.value:null;if(r===s)if(r.component){const u=i.getContext(r.outlet);u&&this.deactivateChildRoutes(t,e,u.children)}else this.deactivateChildRoutes(t,e,i);else s&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,s=m_(t);for(const u of Object.keys(s))this.deactivateRouteAndItsChildren(s[u],r);if(i&&i.outlet){const u=i.outlet.detach(),m=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:u,route:t,contexts:m})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,s=m_(t);for(const u of Object.keys(s))this.deactivateRouteAndItsChildren(s[u],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(t,e,i){const r=m_(e);t.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Ij(s.value.snapshot))}),t.children.length&&this.forwardEvent(new Tj(t.value.snapshot))}activateRoutes(t,e,i){const r=t.value,s=e?e.value:null;if(WD(r),r===s)if(r.component){const u=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,u.children)}else this.activateChildRoutes(t,e,i);else if(r.component){const u=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const m=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),u.children.onOutletReAttached(m.contexts),u.attachRef=m.componentRef,u.route=m.route.value,u.outlet&&u.outlet.attach(m.componentRef,m.route.value),WD(m.route.value),this.activateChildRoutes(t,null,u.children)}else{const m=lb(r.snapshot);u.attachRef=null,u.route=r,u.injector=m,u.outlet&&u.outlet.activateWith(r,u.injector),this.activateChildRoutes(t,null,u.children)}}else this.activateChildRoutes(t,null,i)}}class mP{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class bw{constructor(t,e){this.component=t,this.route=e}}function Gj(n,t,e){const i=n._root;return cb(i,t?t._root:null,e,[i.value])}function g_(n,t){const e=Symbol(),i=t.get(n,e);return i===e?"function"!=typeof n||function Pp(n){return null!==ch(n)}(n)?t.get(n):n:i}function cb(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=m_(t);return n.children.forEach(u=>{(function Wj(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,u=t?t.value:null,m=e?e.getContext(n.value.outlet):null;if(u&&s.routeConfig===u.routeConfig){const b=function Zj(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!rm(n.url,t.url);case"pathParamsOrQueryParamsChange":return!rm(n.url,t.url)||!Pd(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ZD(n,t)||!Pd(n.queryParams,t.queryParams);default:return!ZD(n,t)}}(u,s,s.routeConfig.runGuardsAndResolvers);b?r.canActivateChecks.push(new mP(i)):(s.data=u.data,s._resolvedData=u._resolvedData),cb(n,t,s.component?m?m.children:null:e,i,r),b&&m&&m.outlet&&m.outlet.isActivated&&r.canDeactivateChecks.push(new bw(m.outlet.component,u))}else u&&db(t,m,r),r.canActivateChecks.push(new mP(i)),cb(n,null,s.component?m?m.children:null:e,i,r)})(u,s[u.value.outlet],e,i.concat([u.value]),r),delete s[u.value.outlet]}),Object.entries(s).forEach(([u,m])=>db(m,e.getContext(u),r)),r}function db(n,t,e){const i=m_(n),r=n.value;Object.entries(i).forEach(([s,u])=>{db(u,r.component?t?t.children.getContext(s):null:t,e)}),e.canDeactivateChecks.push(new bw(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function ub(n){return"function"==typeof n}function gP(n){return n instanceof aw||"EmptyError"===n?.name}const xw=Symbol("INITIAL_VALUE");function __(){return Vs(n=>nm(n.map(t=>t.pipe(Jr(1),Rd(xw)))).pipe(xt(t=>{for(const e of t)if(!0!==e){if(e===xw)return xw;if(!1===e||e instanceof f_)return e}return!0}),Lo(t=>t!==xw),Jr(1)))}function _P(n){return function wt(...n){return Xi(n)}(Vr(t=>{if(om(t))throw dP(0,t)}),xt(t=>!0===t))}class ww{constructor(t){this.segmentGroup=t||null}}class yP{constructor(t){this.urlTree=t}}function y_(n){return u_(new ww(n))}function vP(n){return u_(new yP(n))}class fH{constructor(t,e){this.urlSerializer=t,this.urlTree=e}noMatchError(t){return new ke(4002,!1)}lineralizeSegments(t,e){let i=[],r=e.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return qt(i);if(r.numberOfChildren>1||!r.children[jn])return u_(new ke(4e3,!1));r=r.children[jn]}}applyRedirectCommands(t,e,i){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreateUrlTree(t,e,i,r){const s=this.createSegmentGroup(t,e.root,i,r);return new f_(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return Object.entries(t).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const m=s.substring(1);i[r]=e[m]}else i[r]=s}),i}createSegmentGroup(t,e,i,r){const s=this.createSegments(t,e.segments,i,r);let u={};return Object.entries(e.children).forEach(([m,b])=>{u[m]=this.createSegmentGroup(t,b,i,r)}),new Yi(s,u)}createSegments(t,e,i,r){return e.map(s=>s.path.startsWith(":")?this.findPosParam(t,s,r):this.findOrReturn(s,i))}findPosParam(t,e,i){const r=i[e.path.substring(1)];if(!r)throw new ke(4001,!1);return r}findOrReturn(t,e){let i=0;for(const r of e){if(r.path===t.path)return e.splice(i),r;i++}return t}}const JD={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function mH(n,t,e,i,r){const s=QD(n,t,e);return s.matched?(i=function Bj(n,t){return n.providers&&!n._injector&&(n._injector=ME(n.providers,t,`Route: ${n.path}`)),n._injector??t}(t,i),function uH(n,t,e,i){const r=t.canMatch;return r&&0!==r.length?qt(r.map(u=>{const m=g_(u,n);return gp(function eH(n){return n&&ub(n.canMatch)}(m)?m.canMatch(t,e):n.runInContext(()=>m(t,e)))})).pipe(__(),_P()):qt(!0)}(i,t,e).pipe(xt(u=>!0===u?s:{...JD}))):qt(s)}function QD(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...JD}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(t.matcher||WU)(e,n,t);if(!r)return{...JD};const s={};Object.entries(r.posParams??{}).forEach(([m,b])=>{s[m]=b.path});const u=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:u,positionalParamSegments:r.posParams??{}}}function bP(n,t,e,i){return e.length>0&&function yH(n,t,e){return e.some(i=>Cw(n,t,i)&&Ac(i)!==jn)}(n,e,i)?{segmentGroup:new Yi(t,_H(i,new Yi(e,n.children))),slicedSegments:[]}:0===e.length&&function vH(n,t,e){return e.some(i=>Cw(n,t,i))}(n,e,i)?{segmentGroup:new Yi(n.segments,gH(n,0,e,i,n.children)),slicedSegments:e}:{segmentGroup:new Yi(n.segments,n.children),slicedSegments:e}}function gH(n,t,e,i,r){const s={};for(const u of i)if(Cw(n,e,u)&&!r[Ac(u)]){const m=new Yi([],{});s[Ac(u)]=m}return{...r,...s}}function _H(n,t){const e={};e[jn]=t;for(const i of n)if(""===i.path&&Ac(i)!==jn){const r=new Yi([],{});e[Ac(i)]=r}return e}function Cw(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}class CH{constructor(t,e,i,r,s,u,m){this.injector=t,this.configLoader=e,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=u,this.urlSerializer=m,this.allowRedirects=!0,this.applyRedirects=new fH(this.urlSerializer,this.urlTree)}noMatchError(t){return new ke(4002,!1)}recognize(){const t=bP(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,jn).pipe(mp(e=>{if(e instanceof yP)return this.allowRedirects=!1,this.urlTree=e.urlTree,this.match(e.urlTree);throw e instanceof ww?this.noMatchError(e):e}),xt(e=>{const i=new yw([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},jn,this.rootComponentType,null,{}),r=new Bu(i,e),s=new aP("",r),u=function pj(n,t,e=null,i=null){return XR(YR(n),t,e,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return u.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(u),this.inheritParamsAndData(s._root),{state:s,tree:u}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t.root,jn).pipe(mp(i=>{throw i instanceof ww?this.noMatchError(i):i}))}inheritParamsAndData(t){const e=t.value,i=sP(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,e,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,e,i):this.processSegment(t,e,i,i.segments,r,!0)}processChildren(t,e,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return mr(r).pipe(h_(s=>{const u=i.children[s],m=function jj(n,t){const e=n.filter(i=>Ac(i)===t);return e.push(...n.filter(i=>Ac(i)!==t)),e}(e,s);return this.processSegmentGroup(t,m,u,s)}),function $U(n,t){return Ui(function HU(n,t,e,i,r){return(s,u)=>{let m=e,b=t,E=0;s.subscribe(fi(u,T=>{const O=E++;b=m?n(b,T,O):(m=!0,T),i&&u.next(b)},r&&(()=>{m&&u.next(b),u.complete()})))}}(n,t,arguments.length>=2,!0))}((s,u)=>(s.push(...u),s)),cw(null),function GU(n,t){const e=arguments.length>=2;return i=>i.pipe(n?Lo((r,s)=>n(r,s,i)):mt,LD(1),e?cw(t):FR(()=>new aw))}(),Ki(s=>{if(null===s)return y_(i);const u=xP(s);return function EH(n){n.sort((t,e)=>t.value.outlet===jn?-1:e.value.outlet===jn?1:t.value.outlet.localeCompare(e.value.outlet))}(u),qt(u)}))}processSegment(t,e,i,r,s,u){return mr(e).pipe(h_(m=>this.processSegmentAgainstRoute(m._injector??t,e,m,i,r,s,u).pipe(mp(b=>{if(b instanceof ww)return qt(null);throw b}))),im(m=>!!m),mp(m=>{if(gP(m))return function xH(n,t,e){return 0===t.length&&!n.children[e]}(i,r,s)?qt([]):y_(i);throw m}))}processSegmentAgainstRoute(t,e,i,r,s,u,m){return function bH(n,t,e,i){return!!(Ac(n)===i||i!==jn&&Cw(t,e,n))&&("**"===n.path||QD(t,n,e).matched)}(i,r,s,u)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,r,i,s,u,m):m&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,r,e,i,s,u):y_(r):y_(r)}expandSegmentAgainstRouteUsingRedirect(t,e,i,r,s,u){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,r,u):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,r,s,u)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?vP(s):this.applyRedirects.lineralizeSegments(i,s).pipe(Ki(u=>{const m=new Yi(u,{});return this.processSegment(t,e,m,u,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,r,s,u){const{matched:m,consumedSegments:b,remainingSegments:E,positionalParamSegments:T}=QD(e,r,s);if(!m)return y_(e);const O=this.applyRedirects.applyRedirectCommands(b,r.redirectTo,T);return r.redirectTo.startsWith("/")?vP(O):this.applyRedirects.lineralizeSegments(r,O).pipe(Ki(H=>this.processSegment(t,i,e,H.concat(E),u,!1)))}matchSegmentAgainstRoute(t,e,i,r,s,u){let m;if("**"===i.path){const b=r.length>0?BR(r).parameters:{};m=qt({snapshot:new yw(r,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,wP(i),Ac(i),i.component??i._loadedComponent??null,i,CP(i)),consumedSegments:[],remainingSegments:[]}),e.children={}}else m=mH(e,i,r,t).pipe(xt(({matched:b,consumedSegments:E,remainingSegments:T,parameters:O})=>b?{snapshot:new yw(E,O,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,wP(i),Ac(i),i.component??i._loadedComponent??null,i,CP(i)),consumedSegments:E,remainingSegments:T}:null));return m.pipe(Vs(b=>null===b?y_(e):this.getChildConfig(t=i._injector??t,i,r).pipe(Vs(({routes:E})=>{const T=i._loadedInjector??t,{snapshot:O,consumedSegments:H,remainingSegments:q}=b,{segmentGroup:oe,slicedSegments:de}=bP(e,H,q,E);if(0===de.length&&oe.hasChildren())return this.processChildren(T,E,oe).pipe(xt(Pe=>null===Pe?null:[new Bu(O,Pe)]));if(0===E.length&&0===de.length)return qt([new Bu(O,[])]);const xe=Ac(i)===s;return this.processSegment(T,E,oe,de,xe?jn:s,!0).pipe(xt(Pe=>[new Bu(O,Pe)]))}))))}getChildConfig(t,e,i){return e.children?qt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?qt({routes:e._loadedRoutes,injector:e._loadedInjector}):function dH(n,t,e,i){const r=t.canLoad;return void 0===r||0===r.length?qt(!0):qt(r.map(u=>{const m=g_(u,n);return gp(function Xj(n){return n&&ub(n.canLoad)}(m)?m.canLoad(t,e):n.runInContext(()=>m(t,e)))})).pipe(__(),_P())}(t,e,i).pipe(Ki(r=>r?this.configLoader.loadChildren(t,e).pipe(Vr(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):function pH(n){return u_(uP(!1,3))}())):qt({routes:[],injector:t})}}function DH(n){const t=n.value.routeConfig;return t&&""===t.path}function xP(n){const t=[],e=new Set;for(const i of n){if(!DH(i)){t.push(i);continue}const r=t.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),e.add(r)):t.push(i)}for(const i of e){const r=xP(i.children);t.push(new Bu(i.value,r))}return t.filter(i=>!e.has(i))}function wP(n){return n.data||{}}function CP(n){return n.resolve||{}}function EP(n){return"string"==typeof n.title||null===n.title}function eS(n){return Vs(t=>{const e=n(t);return e?mr(e).pipe(xt(()=>t)):qt(t)})}const v_=new Ke("ROUTES");let tS=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=gt(ek)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return qt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const i=gp(e.loadComponent()).pipe(xt(DP),Vr(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),dw(()=>{this.componentLoaders.delete(e)})),r=new FD(i,()=>new Xt).pipe(OD());return this.componentLoaders.set(e,r),r}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return qt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(xt(m=>{this.onLoadEndListener&&this.onLoadEndListener(i);let b,E;return Array.isArray(m)?E=m:(b=m.create(e).injector,E=b.get(v_,[],Jt.Self|Jt.Optional).flat()),{routes:E.map(KD),injector:b}}),dw(()=>{this.childrenLoaders.delete(i)})),u=new FD(s,()=>new Xt).pipe(OD());return this.childrenLoaders.set(i,u),u}loadModuleFactoryOrRoutes(e){return gp(e()).pipe(xt(DP),Ki(i=>i instanceof aI||Array.isArray(i)?qt(i):mr(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function DP(n){return function RH(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Ew=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Xt,this.configLoader=gt(tS),this.environmentInjector=gt(Qa),this.urlSerializer=gt(eb),this.rootContexts=gt(sb),this.inputBindingEnabled=null!==gt(vw,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>qt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new Sj(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Dj(r))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:i})}setupNavigations(e){return this.transitions=new _s({id:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:rb,restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Lo(i=>0!==i.id),xt(i=>({...i,extractedUrl:e.urlHandlingStrategy.extract(i.rawUrl)})),Vs(i=>{let r=!1,s=!1;return qt(i).pipe(Vr(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Vs(u=>{const m=e.browserUrlTree.toString(),b=!e.navigated||u.extractedUrl.toString()!==m||m!==e.currentUrlTree.toString();if(!b&&"reload"!==(u.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const T="";return this.events.next(new ob(u.id,e.serializeUrl(i.rawUrl),T,0)),e.rawUrlTree=u.rawUrl,u.resolve(null),Es}if(e.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return SP(u.source)&&(e.browserUrlTree=u.extractedUrl),qt(u).pipe(Vs(T=>{const O=this.transitions?.getValue();return this.events.next(new jD(T.id,this.urlSerializer.serialize(T.extractedUrl),T.source,T.restoredState)),O!==this.transitions?.getValue()?Es:Promise.resolve(T)}),function SH(n,t,e,i,r,s){return Ki(u=>function wH(n,t,e,i,r,s,u="emptyOnly"){return new CH(n,t,e,i,r,u,s).recognize()}(n,t,e,i,u.extractedUrl,r,s).pipe(xt(({state:m,tree:b})=>({...u,targetSnapshot:m,urlAfterRedirects:b}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),Vr(T=>{if(i.targetSnapshot=T.targetSnapshot,i.urlAfterRedirects=T.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:T.urlAfterRedirects},"eager"===e.urlUpdateStrategy){if(!T.extras.skipLocationChange){const H=e.urlHandlingStrategy.merge(T.urlAfterRedirects,T.rawUrl);e.setBrowserUrl(H,T)}e.browserUrlTree=T.urlAfterRedirects}const O=new bj(T.id,this.urlSerializer.serialize(T.extractedUrl),this.urlSerializer.serialize(T.urlAfterRedirects),T.targetSnapshot);this.events.next(O)}));if(b&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:T,extractedUrl:O,source:H,restoredState:q,extras:oe}=u,de=new jD(T,this.urlSerializer.serialize(O),H,q);this.events.next(de);const xe=oP(0,this.rootComponentType).snapshot;return qt(i={...u,targetSnapshot:xe,urlAfterRedirects:O,extras:{...oe,skipLocationChange:!1,replaceUrl:!1}})}{const T="";return this.events.next(new ob(u.id,e.serializeUrl(i.extractedUrl),T,1)),e.rawUrlTree=u.rawUrl,u.resolve(null),Es}}),Vr(u=>{const m=new xj(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(m)}),xt(u=>i={...u,guards:Gj(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),function nH(n,t){return Ki(e=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:u}}=e;return 0===u.length&&0===s.length?qt({...e,guardsResult:!0}):function iH(n,t,e,i){return mr(n).pipe(Ki(r=>function cH(n,t,e,i,r){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?qt(s.map(m=>{const b=lb(t)??r,E=g_(m,b);return gp(function Qj(n){return n&&ub(n.canDeactivate)}(E)?E.canDeactivate(n,t,e,i):b.runInContext(()=>E(n,t,e,i))).pipe(im())})).pipe(__()):qt(!0)}(r.component,r.route,e,t,i)),im(r=>!0!==r,!0))}(u,i,r,n).pipe(Ki(m=>m&&function Yj(n){return"boolean"==typeof n}(m)?function rH(n,t,e,i){return mr(t).pipe(h_(r=>Kv(function sH(n,t){return null!==n&&t&&t(new Mj(n)),qt(!0)}(r.route.parent,i),function oH(n,t){return null!==n&&t&&t(new Aj(n)),qt(!0)}(r.route,i),function lH(n,t,e){const i=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(u=>function qj(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(u)).filter(u=>null!==u).map(u=>lw(()=>qt(u.guards.map(b=>{const E=lb(u.node)??e,T=g_(b,E);return gp(function Jj(n){return n&&ub(n.canActivateChild)}(T)?T.canActivateChild(i,n):E.runInContext(()=>T(i,n))).pipe(im())})).pipe(__())));return qt(s).pipe(__())}(n,r.path,e),function aH(n,t,e){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return qt(!0);const r=i.map(s=>lw(()=>{const u=lb(t)??e,m=g_(s,u);return gp(function Kj(n){return n&&ub(n.canActivate)}(m)?m.canActivate(t,n):u.runInContext(()=>m(t,n))).pipe(im())}));return qt(r).pipe(__())}(n,r.route,e))),im(r=>!0!==r,!0))}(i,s,n,t):qt(m)),xt(m=>({...e,guardsResult:m})))})}(this.environmentInjector,u=>this.events.next(u)),Vr(u=>{if(i.guardsResult=u.guardsResult,om(u.guardsResult))throw dP(0,u.guardsResult);const m=new wj(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(m)}),Lo(u=>!!u.guardsResult||(e.restoreHistory(u),this.cancelNavigationTransition(u,"",3),!1)),eS(u=>{if(u.guards.canActivateChecks.length)return qt(u).pipe(Vr(m=>{const b=new Cj(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(b)}),Vs(m=>{let b=!1;return qt(m).pipe(function MH(n,t){return Ki(e=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=e;if(!r.length)return qt(e);let s=0;return mr(r).pipe(h_(u=>function TH(n,t,e,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!EP(r)&&(s[Jv]=r.title),function AH(n,t,e,i){const r=function IH(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return qt({});const s={};return mr(r).pipe(Ki(u=>function kH(n,t,e,i){const r=lb(t)??i,s=g_(n,r);return gp(s.resolve?s.resolve(t,e):r.runInContext(()=>s(t,e)))}(n[u],t,e,i).pipe(im(),Vr(m=>{s[u]=m}))),LD(1),LR(s),mp(u=>gP(u)?Es:u_(u)))}(s,n,t,i).pipe(xt(u=>(n._resolvedData=u,n.data=sP(n,e).resolve,r&&EP(r)&&(n.data[Jv]=r.title),null)))}(u.route,i,n,t)),Vr(()=>s++),LD(1),Ki(u=>s===r.length?qt(e):Es))})}(e.paramsInheritanceStrategy,this.environmentInjector),Vr({next:()=>b=!0,complete:()=>{b||(e.restoreHistory(m),this.cancelNavigationTransition(m,"",2))}}))}),Vr(m=>{const b=new Ej(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(b)}))}),eS(u=>{const m=b=>{const E=[];b.routeConfig?.loadComponent&&!b.routeConfig._loadedComponent&&E.push(this.configLoader.loadComponent(b.routeConfig).pipe(Vr(T=>{b.component=T}),xt(()=>{})));for(const T of b.children)E.push(...m(T));return E};return nm(m(u.targetSnapshot.root)).pipe(cw(),Jr(1))}),eS(()=>this.afterPreactivation()),xt(u=>{const m=function Fj(n,t,e){const i=ab(n,t._root,e?e._root:void 0);return new rP(i,t)}(e.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return i={...u,targetRouterState:m}}),Vr(u=>{e.currentUrlTree=u.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl),e.routerState=u.targetRouterState,"deferred"===e.urlUpdateStrategy&&(u.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,u),e.browserUrlTree=u.urlAfterRedirects)}),((n,t,e,i)=>xt(r=>(new $j(t,r.targetRouterState,r.currentRouterState,e,i).activate(n),r)))(this.rootContexts,e.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Jr(1),Vr({next:u=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new sm(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{r=!0}}),dw(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),mp(u=>{if(s=!0,pP(u)){hP(u)||(e.navigated=!0,e.restoreHistory(i,!0));const m=new _w(i.id,this.urlSerializer.serialize(i.extractedUrl),u.message,u.cancellationCode);if(this.events.next(m),hP(u)){const b=e.urlHandlingStrategy.merge(u.url,e.rawUrlTree),E={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||SP(i.source)};e.scheduleNavigation(b,rb,null,E,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{e.restoreHistory(i,!0);const m=new HD(i.id,this.urlSerializer.serialize(i.extractedUrl),u,i.targetSnapshot??void 0);this.events.next(m);try{i.resolve(e.errorHandler(u))}catch(b){i.reject(b)}}return Es}))}))}cancelNavigationTransition(e,i,r){const s=new _w(e.id,this.urlSerializer.serialize(e.extractedUrl),i,r);this.events.next(s),e.resolve(!1)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function SP(n){return n!==rb}let MP=(()=>{class n{buildTitle(e){let i,r=e.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===jn);return i}getResolvedTitleForRoute(e){return e.data[Jv]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:function(){return gt(PH)},providedIn:"root"}),n})(),PH=(()=>{class n extends MP{constructor(e){super(),this.title=e}updateTitle(e){const i=this.buildTitle(e);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(e){return new(e||n)(Ne(SR))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),OH=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:function(){return gt(LH)},providedIn:"root"}),n})();class FH{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let LH=(()=>{class n extends FH{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Dw=new Ke("",{providedIn:"root",factory:()=>({})});let NH=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:function(){return gt(BH)},providedIn:"root"}),n})(),BH=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ol=(()=>((ol=ol||{})[ol.COMPLETE=0]="COMPLETE",ol[ol.FAILED=1]="FAILED",ol[ol.REDIRECTING=2]="REDIRECTING",ol))();function TP(n,t){n.events.pipe(Lo(e=>e instanceof sm||e instanceof _w||e instanceof HD||e instanceof ob),xt(e=>e instanceof sm||e instanceof ob?ol.COMPLETE:e instanceof _w&&(0===e.code||1===e.code)?ol.REDIRECTING:ol.FAILED),Lo(e=>e!==ol.REDIRECTING),Jr(1)).subscribe(()=>{t()})}function zH(n){throw n}function VH(n,t,e){return t.parse("/")}const UH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},jH={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Hl=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=gt(QI),this.isNgZoneEnabled=!1,this.options=gt(Dw,{optional:!0})||{},this.pendingTasks=gt(Lk),this.errorHandler=this.options.errorHandler||zH,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||VH,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=gt(NH),this.routeReuseStrategy=gt(OH),this.titleStrategy=gt(MP),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=gt(v_,{optional:!0})?.flat()??[],this.navigationTransitions=gt(Ew),this.urlSerializer=gt(eb),this.location=gt($x),this.componentInputBindingEnabled=!!gt(vw,{optional:!0}),this.isNgZoneEnabled=gt(rn)instanceof rn&&rn.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new f_,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=oP(0,null),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId??0},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),rb,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const i="popstate"===e.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,i,e.state)},0)}))}navigateToSyncWithBrowser(e,i,r){const s={replaceUrl:!0},u=r?.navigationId?r:null;if(r){const b={...r};delete b.navigationId,delete b.\u0275routerPageId,0!==Object.keys(b).length&&(s.state=b)}const m=this.parseUrl(e);this.scheduleNavigation(m,i,u,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(KD),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,i={}){const{relativeTo:r,queryParams:s,fragment:u,queryParamsHandling:m,preserveFragment:b}=i,E=b?this.currentUrlTree.fragment:u;let O,T=null;switch(m){case"merge":T={...this.currentUrlTree.queryParams,...s};break;case"preserve":T=this.currentUrlTree.queryParams;break;default:T=s||null}null!==T&&(T=this.removeEmptyProps(T));try{O=YR(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||!e[0].startsWith("/"))&&(e=[]),O=this.currentUrlTree.root}return XR(O,e,T,E??null)}navigateByUrl(e,i={skipLocationChange:!1}){const r=om(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,rb,null,i)}navigate(e,i={skipLocationChange:!1}){return function HH(n){for(let t=0;t<n.length;t++)if(null==n[t])throw new ke(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let i;try{i=this.urlSerializer.parse(e)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return i}isActive(e,i){let r;if(r=!0===i?{...UH}:!1===i?{...jH}:i,om(e))return VR(this.currentUrlTree,e,r);const s=this.parseUrl(e);return VR(this.currentUrlTree,s,r)}removeEmptyProps(e){return Object.keys(e).reduce((i,r)=>{const s=e[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(e,i,r,s,u){if(this.disposed)return Promise.resolve(!1);let m,b,E;u?(m=u.resolve,b=u.reject,E=u.promise):E=new Promise((O,H)=>{m=O,b=H});const T=this.pendingTasks.add();return TP(this,()=>{Promise.resolve().then(()=>this.pendingTasks.remove(T))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:m,reject:b,promise:E,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),E.catch(O=>Promise.reject(O))}setBrowserUrl(e,i){const r=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const u={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",u)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(r,"",s)}}restoreHistory(e,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-(this.browserPageId??this.currentPageId);0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class AP{}let qH=(()=>{class n{constructor(e,i,r,s,u){this.router=e,this.injector=r,this.preloadingStrategy=s,this.loader=u}setUpPreloading(){this.subscription=this.router.events.pipe(Lo(e=>e instanceof sm),h_(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=ME(s.providers,e,`Route: ${s.path}`));const u=s._injector??e,m=s._loadedInjector??u;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(u,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(m,s.children??s._loadedRoutes))}return mr(r).pipe(Vc())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(e,i):qt(null);const s=r.pipe(Ki(u=>null===u?qt(void 0):(i._loadedRoutes=u.routes,i._loadedInjector=u.injector,this.processRoutes(u.injector??e,u.routes))));return i.loadComponent&&!i._loadedComponent?mr([s,this.loader.loadComponent(i)]).pipe(Vc()):s})}}return n.\u0275fac=function(e){return new(e||n)(Ne(Hl),Ne(ek),Ne(Qa),Ne(AP),Ne(tS))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const iS=new Ke("");let IP=(()=>{class n{constructor(e,i,r,s,u={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=u,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},u.scrollPositionRestoration=u.scrollPositionRestoration||"disabled",u.anchorScrolling=u.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof jD?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof sm?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof ob&&0===e.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof nP&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new nP(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(e){Iu()},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();function zu(n,t){return{\u0275kind:n,\u0275providers:t}}function RP(){const n=gt(Ro);return t=>{const e=n.get(hp);if(t!==e.components[0])return;const i=n.get(Hl),r=n.get(PP);1===n.get(rS)&&i.initialNavigation(),n.get(OP,null,Jt.Optional)?.setUpPreloading(),n.get(iS,null,Jt.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const PP=new Ke("",{factory:()=>new Xt}),rS=new Ke("",{providedIn:"root",factory:()=>1}),OP=new Ke("");function XH(n){return zu(0,[{provide:OP,useExisting:qH},{provide:AP,useExisting:n}])}const FP=new Ke("ROUTER_FORROOT_GUARD"),JH=[$x,{provide:eb,useClass:ND},Hl,sb,{provide:_p,useFactory:function kP(n){return n.routerState.root},deps:[Hl]},tS,[]];function QH(){return new uk("Router",Hl)}let LP=(()=>{class n{constructor(e){}static forRoot(e,i){return{ngModule:n,providers:[JH,[],{provide:v_,multi:!0,useValue:e},{provide:FP,useFactory:i$,deps:[[Hl,new Er,new br]]},{provide:Dw,useValue:i||{}},i?.useHash?{provide:em,useClass:h4}:{provide:em,useClass:Vk},{provide:iS,useFactory:()=>{const n=gt(I5),t=gt(rn),e=gt(Dw),i=gt(Ew),r=gt(eb);return e.scrollOffset&&n.setOffset(e.scrollOffset),new IP(r,i,n,t,e)}},i?.preloadingStrategy?XH(i.preloadingStrategy).\u0275providers:[],{provide:uk,multi:!0,useFactory:QH},i?.initialNavigation?r$(i):[],i?.bindToComponentInputs?zu(8,[cP,{provide:vw,useExisting:cP}]).\u0275providers:[],[{provide:NP,useFactory:RP},{provide:KE,multi:!0,useExisting:NP}]]}}static forChild(e){return{ngModule:n,providers:[{provide:v_,multi:!0,useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)(Ne(FP,8))},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})();function i$(n){return"guarded"}function r$(n){return["disabled"===n.initialNavigation?zu(3,[{provide:jE,multi:!0,useFactory:()=>{const t=gt(Hl);return()=>{t.setUpLocationChangeListener()}}},{provide:rS,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?zu(2,[{provide:rS,useValue:0},{provide:jE,multi:!0,deps:[Ro],useFactory:t=>{const e=t.get(d4,Promise.resolve());return()=>e.then(()=>new Promise(i=>{const r=t.get(Hl),s=t.get(PP);TP(r,()=>{i(!0)}),t.get(Ew).afterPreactivation=()=>(i(!0),s.closed?qt(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const NP=new Ke("");class s${}function oS(n){return n&&"function"==typeof n.connect&&!(n instanceof FD)}class BP{applyChanges(t,e,i,r,s){t.forEachOperation((u,m,b)=>{let E,T;if(null==u.previousIndex){const O=i(u,m,b);E=e.createEmbeddedView(O.templateRef,O.context,O.index),T=1}else null==b?(e.remove(m),T=3):(E=e.get(m),e.move(E,b),T=2);s&&s({context:E?.context,operation:T,record:u})})}detach(){}}class a${get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(t=!1,e,i=!0,r){this._multiple=t,this._emitChanges=i,this.compareWith=r,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new Xt,e&&e.length&&(t?e.forEach(s=>this._markSelected(s)):this._markSelected(e[0]),this._selectedToEmit.length=0)}select(...t){this._verifyValueAssignment(t),t.forEach(i=>this._markSelected(i));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...t){this._verifyValueAssignment(t),t.forEach(i=>this._unmarkSelected(i));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...t){this._verifyValueAssignment(t);const e=this.selected,i=new Set(t);t.forEach(s=>this._markSelected(s)),e.filter(s=>!i.has(s)).forEach(s=>this._unmarkSelected(s));const r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();const e=this._hasQueuedChanges();return t&&this._emitChangeEvent(),e}isSelected(t){return this._selection.has(this._getConcreteValue(t))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){t=this._getConcreteValue(t),this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){t=this._getConcreteValue(t),this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(t){if(this.compareWith){for(let e of this._selection)if(this.compareWith(t,e))return e;return t}return t}}const hb=new Ke("_ViewRepeater");function VP(...n){const t=$d(n),{args:e,keys:i}=RR(n),r=new Vt(s=>{const{length:u}=e;if(!u)return void s.complete();const m=new Array(u);let b=u,E=u;for(let T=0;T<u;T++){let O=!1;Lt(e[T]).subscribe(fi(s,H=>{O||(O=!0,E--),m[T]=H},()=>b--,void 0,()=>{(!b||!O)&&(E||s.next(i?PR(i,m):m),s.complete())}))}});return t?r.pipe(PD(t)):r}let UP=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(J(Pl),J(jt))},n.\u0275dir=rt({type:n}),n})(),am=(()=>{class n extends UP{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,features:[Et]}),n})();const Us=new Ke("NgValueAccessor"),c$={provide:Us,useExisting:Pn(()=>Sw),multi:!0},u$=new Ke("CompositionEventMode");let Sw=(()=>{class n extends UP{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function d$(){const n=pp()?pp().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(J(Pl),J(jt),J(u$,8))},n.\u0275dir=rt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&Kt("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[Zt([c$]),Et]}),n})();function yp(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function HP(n){return null!=n&&"number"==typeof n.length}const _o=new Ke("NgValidators"),vp=new Ke("NgAsyncValidators"),h$=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class lm{static min(t){return function $P(n){return t=>{if(yp(t.value)||yp(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function GP(n){return t=>{if(yp(t.value)||yp(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return qP(t)}static requiredTrue(t){return function WP(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function ZP(n){return yp(n.value)||h$.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function YP(n){return t=>yp(t.value)||!HP(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function XP(n){return t=>HP(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static pattern(t){return function KP(n){if(!n)return Mw;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),i=>{if(yp(i.value))return null;const r=i.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(t)}static nullValidator(t){return null}static compose(t){return iO(t)}static composeAsync(t){return rO(t)}}function qP(n){return yp(n.value)?{required:!0}:null}function Mw(n){return null}function JP(n){return null!=n}function QP(n){return Rv(n)?mr(n):n}function eO(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function tO(n,t){return t.map(e=>e(n))}function nO(n){return n.map(t=>function p$(n){return!n.validate}(t)?t:e=>t.validate(e))}function iO(n){if(!n)return null;const t=n.filter(JP);return 0==t.length?null:function(e){return eO(tO(e,t))}}function sS(n){return null!=n?iO(nO(n)):null}function rO(n){if(!n)return null;const t=n.filter(JP);return 0==t.length?null:function(e){return VP(tO(e,t).map(QP)).pipe(xt(eO))}}function aS(n){return null!=n?rO(nO(n)):null}function oO(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function sO(n){return n._rawValidators}function aO(n){return n._rawAsyncValidators}function lS(n){return n?Array.isArray(n)?n:[n]:[]}function Tw(n,t){return Array.isArray(n)?n.includes(t):n===t}function lO(n,t){const e=lS(t);return lS(n).forEach(r=>{Tw(e,r)||e.push(r)}),e}function cO(n,t){return lS(t).filter(e=>!Tw(n,e))}class dO{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=sS(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=aS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class js extends dO{get formDirective(){return null}get path(){return null}}class Ic extends dO{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class uO{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let hO=(()=>{class n extends uO{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(J(Ic,2))},n.\u0275dir=rt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&Xn("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Et]}),n})(),pO=(()=>{class n extends uO{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(J(js,10))},n.\u0275dir=rt({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&Xn("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Et]}),n})();const pb="VALID",Iw="INVALID",b_="PENDING",fb="DISABLED";function uS(n){return(kw(n)?n.validators:n)||null}function hS(n,t){return(kw(t)?t.asyncValidators:n)||null}function kw(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function mO(n,t,e){const i=n.controls;if(!(t?Object.keys(i):i).length)throw new ke(1e3,"");if(!i[e])throw new ke(1001,"")}function gO(n,t,e){n._forEachChild((i,r)=>{if(void 0===e[r])throw new ke(1002,"")})}class Rw{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===pb}get invalid(){return this.status===Iw}get pending(){return this.status==b_}get disabled(){return this.status===fb}get enabled(){return this.status!==fb}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(lO(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(lO(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(cO(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(cO(t,this._rawAsyncValidators))}hasValidator(t){return Tw(this._rawValidators,t)}hasAsyncValidator(t){return Tw(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=b_,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=fb,this.errors=null,this._forEachChild(i=>{i.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=pb,this._forEachChild(i=>{i.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===pb||this.status===b_)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?fb:pb}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=b_,this._hasOwnPendingAsyncValidator=!0;const e=QP(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Tt,this.statusChanges=new Tt}_calculateStatus(){return this._allControlsDisabled()?fb:this.errors?Iw:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(b_)?b_:this._anyControlsHaveStatus(Iw)?Iw:pb}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){kw(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function _$(n){return Array.isArray(n)?sS(n):n||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function y$(n){return Array.isArray(n)?aS(n):n||null}(this._rawAsyncValidators)}}class mb extends Rw{constructor(t,e,i){super(uS(e),hS(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){gO(this,0,t),Object.keys(t).forEach(i=>{mO(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(i=>{const r=this.controls[i];r&&r.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((r,s)=>{i=e(i,r,s)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class _O extends mb{}const x_=new Ke("CallSetDisabledState",{providedIn:"root",factory:()=>Pw}),Pw="always";function Ow(n,t){return[...t.path,n]}function gb(n,t,e=Pw){pS(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(n.disabled),function b$(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&yO(n,t)})}(n,t),function w$(n,t){const e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function x$(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&yO(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function v$(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function Fw(n,t,e=!0){const i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),Nw(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Lw(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function pS(n,t){const e=sO(n);null!==t.validator?n.setValidators(oO(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=aO(n);null!==t.asyncValidator?n.setAsyncValidators(oO(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Lw(t._rawValidators,r),Lw(t._rawAsyncValidators,r)}function Nw(n,t){let e=!1;if(null!==n){if(null!==t.validator){const r=sO(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(u=>u!==t.validator);s.length!==r.length&&(e=!0,n.setValidators(s))}}if(null!==t.asyncValidator){const r=aO(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(u=>u!==t.asyncValidator);s.length!==r.length&&(e=!0,n.setAsyncValidators(s))}}}const i=()=>{};return Lw(t._rawValidators,i),Lw(t._rawAsyncValidators,i),e}function yO(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function vO(n,t){pS(n,t)}function bO(n,t){n._syncPendingControls(),t.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}const M$={provide:js,useExisting:Pn(()=>bp)},_b=(()=>Promise.resolve())();let bp=(()=>{class n extends js{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Tt,this.form=new mb({},sS(e),aS(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){_b.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),gb(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){_b.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){_b.then(()=>{const i=this._findContainer(e.path),r=new mb({});vO(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){_b.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){_b.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,bO(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(J(_o,10),J(vp,10),J(x_,8))},n.\u0275dir=rt({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&Kt("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Zt([M$]),Et]}),n})();function xO(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function wO(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const yb=class extends Rw{constructor(t=null,e,i){super(uS(e),hS(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),kw(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=wO(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){xO(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){xO(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){wO(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};let CO=(()=>{class n extends js{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return Ow(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,features:[Et]}),n})(),MO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),AO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})();const _S=new Ke("NgModelWithFormControlWarning"),L$={provide:js,useExisting:Pn(()=>Vu)};let Vu=(()=>{class n extends js{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Tt,this._setValidators(e),this._setAsyncValidators(i)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Nw(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const i=this.form.get(e.path);return gb(i,e,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),i}getControl(e){return this.form.get(e.path)}removeControl(e){Fw(e.control||null,e,!1),function S$(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,i){this.form.get(e.path).setValue(i)}onSubmit(e){return this.submitted=!0,bO(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const i=e.control,r=this.form.get(e.path);i!==r&&(Fw(i||null,e),(n=>n instanceof yb)(r)&&(gb(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const i=this.form.get(e.path);vO(i,e),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const i=this.form.get(e.path);i&&function C$(n,t){return Nw(n,t)}(i,e)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){pS(this.form,this),this._oldForm&&Nw(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(J(_o,10),J(vp,10),J(x_,8))},n.\u0275dir=rt({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,i){1&e&&Kt("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Zt([L$]),Et,M]}),n})();const N$={provide:js,useExisting:Pn(()=>Bw)};let Bw=(()=>{class n extends CO{constructor(e,i,r){super(),this.name=null,this._parent=e,this._setValidators(i),this._setAsyncValidators(r)}_checkParentType(){PO(this._parent)}}return n.\u0275fac=function(e){return new(e||n)(J(js,13),J(_o,10),J(vp,10))},n.\u0275dir=rt({type:n,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[Zt([N$]),Et]}),n})();const B$={provide:js,useExisting:Pn(()=>yS)};let yS=(()=>{class n extends js{constructor(e,i,r){super(),this.name=null,this._parent=e,this._setValidators(i),this._setAsyncValidators(r)}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return Ow(null==this.name?this.name:this.name.toString(),this._parent)}_checkParentType(){PO(this._parent)}}return n.\u0275fac=function(e){return new(e||n)(J(js,13),J(_o,10),J(vp,10))},n.\u0275dir=rt({type:n,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[Zt([B$]),Et]}),n})();function PO(n){return!(n instanceof Bw||n instanceof Vu||n instanceof yS)}const z$={provide:Ic,useExisting:Pn(()=>vS)};let vS=(()=>{class n extends Ic{set isDisabled(e){}constructor(e,i,r,s,u){super(),this._ngModelWarningConfig=u,this._added=!1,this.name=null,this.update=new Tt,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function gS(n,t){if(!t)return null;let e,i,r;return Array.isArray(t),t.forEach(s=>{s.constructor===Sw?e=s:function D$(n){return Object.getPrototypeOf(n.constructor)===am}(s)?i=s:r=s}),r||i||e||null}(0,s)}ngOnChanges(e){this._added||this._setUpControl(),function mS(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Ow(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(J(js,13),J(_o,10),J(vp,10),J(Us,10),J(_S,8))},n.\u0275dir=rt({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Zt([z$]),Et,M]}),n})(),cm=(()=>{class n{constructor(){this._validator=Mw}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Mw,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n,features:[M]}),n})();const Z$={provide:_o,useExisting:Pn(()=>zw),multi:!0};let zw=(()=>{class n extends cm{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=d_,this.createValidator=e=>qP}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Ln("required",i._enabled?"":null)},inputs:{required:"required"},features:[Zt([Z$]),Et]}),n})(),e6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[AO]}),n})();class $O extends Rw{constructor(t,e,i){super(uS(e),hS(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){gO(this,0,t),t.forEach((i,r)=>{mO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function GO(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let t6=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,i=null){const r=this._reduceControls(e);let s={};return GO(i)?s=i:null!==i&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new mb(r,s)}record(e,i=null){const r=this._reduceControls(e);return new _O(r,i)}control(e,i,r){let s={};return this.useNonNullable?(GO(i)?s=i:(s.validators=i,s.asyncValidators=r),new yb(e,{...s,nonNullable:!0})):new yb(e,i,r)}array(e,i,r){const s=e.map(u=>this._createControl(u));return new $O(s,i,r)}_reduceControls(e){const i={};return Object.keys(e).forEach(r=>{i[r]=this._createControl(e[r])}),i}_createControl(e){return e instanceof yb||e instanceof Rw?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),n6=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:_S,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:x_,useValue:e.callSetDisabledState??Pw}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[e6]}),n})();const r6=[{title:"\u041f\u0440\u043e\u0448\u043b\u0438",value:"passed"},{title:"\u041d\u0435 \u043f\u0440\u043e\u0448\u043b\u0438",value:"notPassed"}];class o6 extends Ie{constructor(t,e){super()}schedule(t,e=0){return this}}const Vw={setInterval(n,t,...e){const{delegate:i}=Vw;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=Vw;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class CS extends o6{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,e),this}requestAsyncId(t,e,i=0){return Vw.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&Vw.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,i=!1;try{this.work(t)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,f(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const qO={now:()=>(qO.delegate||Date).now(),delegate:void 0};class vb{constructor(t,e=vb.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}vb.now=qO.now;class ES extends vb{constructor(t,e=vb.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}const Uw=new ES(CS),s6=Uw;function jw(n,t=Uw){return Ui((e,i)=>{let r=null,s=null,u=null;const m=()=>{if(r){r.unsubscribe(),r=null;const E=s;s=null,i.next(E)}};function b(){const E=u+n,T=t.now();if(T<E)return r=this.schedule(void 0,E-T),void i.add(r);m()}e.subscribe(fi(i,E=>{s=E,u=t.now(),r||(r=t.schedule(b,n),i.add(r))},()=>{m(),i.complete()},void 0,()=>{s=r=null}))})}function WO(n,t=mt){return n=n??a6,Ui((e,i)=>{let r,s=!0;e.subscribe(fi(i,u=>{const m=t(u);(s||!n(r,m))&&(s=!1,r=m,i.next(u))}))})}function a6(n,t){return n===t}class ZO{}class l6{}const Uu="*";function sa(n,t){return{type:7,name:n,definitions:t,options:{}}}function Ur(n,t=null){return{type:4,styles:t,timings:n}}function c6(n,t=null){return{type:3,steps:n,options:t}}function YO(n,t=null){return{type:2,steps:n,options:t}}function Vn(n){return{type:6,styles:n,offset:null}}function Sr(n,t,e){return{type:0,name:n,styles:t,options:e}}function w_(n){return{type:5,steps:n}}function Mr(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function JO(n){Promise.resolve().then(n)}class bb{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){JO(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class QO{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,r=0;const s=this.players.length;0==s?JO(()=>this._onFinish()):this.players.forEach(u=>{u.onDone(()=>{++e==s&&this._onFinish()}),u.onDestroy(()=>{++i==s&&this._onDestroy()}),u.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((u,m)=>Math.max(u,m.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const DS="!",d6=new Ke("cdk-dir-doc",{providedIn:"root",factory:function u6(){return gt(Nn)}}),h6=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let SS,kc=(()=>{class n{constructor(e){this.value="ltr",this.change=new Tt,e&&(this.value=function p6(n){const t=n?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?h6.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(e){return new(e||n)(Ne(d6,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),xb=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})();function Bn(n){return null!=n&&"false"!=`${n}`}function e2(n,t=0){return t2(n)?Number(n):t}function t2(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function Hw(n){return Array.isArray(n)?n:[n]}function yo(n){return null==n?"":"string"==typeof n?n:`${n}px`}function ju(n){return n instanceof jt?n.nativeElement:n}function n2(n,t=/\s+/){const e=[];if(null!=n){const i=Array.isArray(n)?n:`${n}`.split(t);for(const r of i){const s=`${r}`.trim();s&&e.push(s)}}return e}try{SS=typeof Intl<"u"&&Intl.v8BreakIterator}catch{SS=!1}let C_,Qr=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function A5(n){return n===oR}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!SS)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(e){return new(e||n)(Ne(wd))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const r2=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function o2(){if(C_)return C_;if("object"!=typeof document||!document)return C_=new Set(r2),C_;let n=document.createElement("input");return C_=new Set(r2.filter(t=>(n.setAttribute("type",t),n.type===t))),C_}let wb,dm,MS;function E_(n){return function f6(){if(null==wb&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>wb=!0}))}finally{wb=wb||!1}return wb}()?n:!!n.capture}function m6(){if(null==dm){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return dm=!1,dm;if("scrollBehavior"in document.documentElement.style)dm=!0;else{const n=Element.prototype.scrollTo;dm=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return dm}function s2(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const t=n.shadowRoot.activeElement;if(t===n)break;n=t}return n}function Hu(n){return n.composedPath?n.composedPath()[0]:n.target}function TS(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}const y6=["addListener","removeListener"],v6=["addEventListener","removeEventListener"],b6=["on","off"];function D_(n,t,e,i){if(mn(e)&&(i=e,e=void 0),i)return D_(n,t,e).pipe(PD(i));const[r,s]=function C6(n){return mn(n.addEventListener)&&mn(n.removeEventListener)}(n)?v6.map(u=>m=>n[u](t,m,e)):function x6(n){return mn(n.addListener)&&mn(n.removeListener)}(n)?y6.map(a2(n,t)):function w6(n){return mn(n.on)&&mn(n.off)}(n)?b6.map(a2(n,t)):[];if(!r&&_e(n))return Ki(u=>D_(u,t,e))(Lt(n));if(!r)throw new TypeError("Invalid event target");return new Vt(u=>{const m=(...b)=>u.next(1<b.length?b:b[0]);return r(m),()=>s(m)})}function a2(n,t){return e=>i=>n[e](t,i)}const Cb={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:i}=Cb;i&&(t=i.requestAnimationFrame,e=i.cancelAnimationFrame);const r=t(s=>{e=void 0,n(s)});return new Ie(()=>e?.(r))},requestAnimationFrame(...n){const{delegate:t}=Cb;return(t?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=Cb;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};new class D6 extends ES{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw r}}}(class E6 extends CS{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=Cb.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,e,i);const{actions:s}=t;null!=e&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==e&&(Cb.cancelAnimationFrame(e),t._scheduled=void 0)}});let AS,M6=1;const Gw={};function l2(n){return n in Gw&&(delete Gw[n],!0)}const T6={setImmediate(n){const t=M6++;return Gw[t]=!0,AS||(AS=Promise.resolve()),AS.then(()=>l2(t)&&n()),t},clearImmediate(n){l2(n)}},{setImmediate:A6,clearImmediate:I6}=T6,qw={setImmediate(...n){const{delegate:t}=qw;return(t?.setImmediate||A6)(...n)},clearImmediate(n){const{delegate:t}=qw;return(t?.clearImmediate||I6)(n)},delegate:void 0};new class R6 extends ES{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw r}}}(class k6 extends CS{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=qw.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,e,i);const{actions:s}=t;null!=e&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==e&&(qw.clearImmediate(e),t._scheduled===e&&(t._scheduled=void 0))}});function c2(n=0,t,e=s6){let i=-1;return null!=t&&(Uc(t)?e=t:i=t),new Vt(r=>{let s=function F6(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;s<0&&(s=0);let u=0;return e.schedule(function(){r.closed||(r.next(u++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function d2(n,t=Uw){return function O6(n){return Ui((t,e)=>{let i=!1,r=null,s=null,u=!1;const m=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const E=r;r=null,e.next(E)}u&&e.complete()},b=()=>{s=null,u&&e.complete()};t.subscribe(fi(e,E=>{i=!0,r=E,s||Lt(n(E)).subscribe(s=fi(e,m,b))},()=>{u=!0,(!i||!s||s.closed)&&e.complete()}))})}(()=>c2(n,t))}let N6=(()=>{class n{constructor(e,i,r){this._ngZone=e,this._platform=i,this._scrolled=new Xt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const i=this.scrollContainers.get(e);i&&(i.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Vt(i=>{this._globalSubscription||this._addGlobalListener();const r=e>0?this._scrolled.pipe(d2(e)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):qt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(e,i){const r=this.getAncestorScrollContainers(e);return this.scrolled(i).pipe(Lo(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(e){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,e)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,i){let r=ju(i),s=e.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>D_(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(e){return new(e||n)(Ne(rn),Ne(Qr),Ne(Nn,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ww=(()=>{class n{constructor(e,i,r){this._platform=e,this._change=new Xt,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(e.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,i=this._getWindow(),r=e.documentElement,s=r.getBoundingClientRect();return{top:-s.top||e.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||e.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(d2(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(e){return new(e||n)(Ne(Qr),Ne(rn),Ne(Nn,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),S_=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})(),IS=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[xb,S_,xb,S_]}),n})();function eo(n){return Ui((t,e)=>{Lt(n).subscribe(fi(e,()=>e.complete(),ro)),!e.closed&&t.subscribe(e)})}const z6=[[["caption"]],[["colgroup"],["col"]]],V6=["caption","colgroup, col"];function kS(n){return class extends n{get sticky(){return this._sticky}set sticky(t){const e=this._sticky;this._sticky=Bn(t),this._hasStickyChanged=e!==this._sticky}hasStickyChanged(){const t=this._hasStickyChanged;return this._hasStickyChanged=!1,t}resetStickyChanged(){this._hasStickyChanged=!1}constructor(...t){super(...t),this._sticky=!1,this._hasStickyChanged=!1}}}const M_=new Ke("CDK_TABLE");let T_=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(J(ts))},n.\u0275dir=rt({type:n,selectors:[["","cdkCellDef",""]]}),n})(),A_=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(J(ts))},n.\u0275dir=rt({type:n,selectors:[["","cdkHeaderCellDef",""]]}),n})(),Zw=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(J(ts))},n.\u0275dir=rt({type:n,selectors:[["","cdkFooterCellDef",""]]}),n})();class $6{}const G6=kS($6);let $u=(()=>{class n extends G6{get name(){return this._name}set name(e){this._setNameInput(e)}get stickyEnd(){return this._stickyEnd}set stickyEnd(e){const i=this._stickyEnd;this._stickyEnd=Bn(e),this._hasStickyChanged=i!==this._stickyEnd}constructor(e){super(),this._table=e,this._stickyEnd=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(e){e&&(this._name=e,this.cssClassFriendlyName=e.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}}return n.\u0275fac=function(e){return new(e||n)(J(M_,8))},n.\u0275dir=rt({type:n,selectors:[["","cdkColumnDef",""]],contentQueries:function(e,i,r){if(1&e&&(Ri(r,T_,5),Ri(r,A_,5),Ri(r,Zw,5)),2&e){let s;Bt(s=zt())&&(i.cell=s.first),Bt(s=zt())&&(i.headerCell=s.first),Bt(s=zt())&&(i.footerCell=s.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[Zt([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),Et]}),n})();class RS{constructor(t,e){e.nativeElement.classList.add(...t._columnCssClassName)}}let PS=(()=>{class n extends RS{constructor(e,i){super(e,i)}}return n.\u0275fac=function(e){return new(e||n)(J($u),J(jt))},n.\u0275dir=rt({type:n,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[Et]}),n})(),OS=(()=>{class n extends RS{constructor(e,i){if(super(e,i),1===e._table?._elementRef.nativeElement.nodeType){const r=e._table._elementRef.nativeElement.getAttribute("role");i.nativeElement.setAttribute("role","grid"===r||"treegrid"===r?"gridcell":"cell")}}}return n.\u0275fac=function(e){return new(e||n)(J($u),J(jt))},n.\u0275dir=rt({type:n,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[Et]}),n})();class h2{constructor(){this.tasks=[],this.endTasks=[]}}const FS=new Ke("_COALESCED_STYLE_SCHEDULER");let p2=(()=>{class n{constructor(e){this._ngZone=e,this._currentSchedule=null,this._destroyed=new Xt}schedule(e){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(e)}scheduleEnd(e){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(e)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new h2,this._getScheduleObservable().pipe(eo(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const e=this._currentSchedule;this._currentSchedule=new h2;for(const i of e.tasks)i();for(const i of e.endTasks)i()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?mr(Promise.resolve(void 0)):this._ngZone.onStable.pipe(Jr(1))}}return n.\u0275fac=function(e){return new(e||n)(Ne(rn))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})(),LS=(()=>{class n{constructor(e,i){this.template=e,this._differs=i}ngOnChanges(e){if(!this._columnsDiffer){const i=e.columns&&e.columns.currentValue||[];this._columnsDiffer=this._differs.find(i).create(),this._columnsDiffer.diff(i)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(e){return this instanceof Eb?e.headerCell.template:this instanceof Db?e.footerCell.template:e.cell.template}}return n.\u0275fac=function(e){return new(e||n)(J(ts),J(Ou))},n.\u0275dir=rt({type:n,features:[M]}),n})();class q6 extends LS{}const W6=kS(q6);let Eb=(()=>{class n extends W6{constructor(e,i,r){super(e,i),this._table=r}ngOnChanges(e){super.ngOnChanges(e)}}return n.\u0275fac=function(e){return new(e||n)(J(ts),J(Ou),J(M_,8))},n.\u0275dir=rt({type:n,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[Et,M]}),n})();class Z6 extends LS{}const Y6=kS(Z6);let Db=(()=>{class n extends Y6{constructor(e,i,r){super(e,i),this._table=r}ngOnChanges(e){super.ngOnChanges(e)}}return n.\u0275fac=function(e){return new(e||n)(J(ts),J(Ou),J(M_,8))},n.\u0275dir=rt({type:n,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[Et,M]}),n})(),Yw=(()=>{class n extends LS{constructor(e,i,r){super(e,i),this._table=r}}return n.\u0275fac=function(e){return new(e||n)(J(ts),J(Ou),J(M_,8))},n.\u0275dir=rt({type:n,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[Et]}),n})(),Gu=(()=>{class n{constructor(e){this._viewContainer=e,n.mostRecentCellOutlet=this}ngOnDestroy(){n.mostRecentCellOutlet===this&&(n.mostRecentCellOutlet=null)}}return n.mostRecentCellOutlet=null,n.\u0275fac=function(e){return new(e||n)(J(Oo))},n.\u0275dir=rt({type:n,selectors:[["","cdkCellOutlet",""]]}),n})(),NS=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Fn({type:n,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,i){1&e&&Vl(0,0)},dependencies:[Gu],encapsulation:2}),n})(),zS=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Fn({type:n,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,i){1&e&&Vl(0,0)},dependencies:[Gu],encapsulation:2}),n})(),Xw=(()=>{class n{constructor(e){this.templateRef=e,this._contentClassName="cdk-no-data-row"}}return n.\u0275fac=function(e){return new(e||n)(J(ts))},n.\u0275dir=rt({type:n,selectors:[["ng-template","cdkNoDataRow",""]]}),n})();const f2=["top","bottom","left","right"];class X6{constructor(t,e,i,r,s=!0,u=!0,m){this._isNativeHtmlTable=t,this._stickCellCss=e,this.direction=i,this._coalescedStyleScheduler=r,this._isBrowser=s,this._needsPositionStickyOnElement=u,this._positionListener=m,this._cachedCellWidths=[],this._borderCellCss={top:`${e}-border-elem-top`,bottom:`${e}-border-elem-bottom`,left:`${e}-border-elem-left`,right:`${e}-border-elem-right`}}clearStickyPositioning(t,e){const i=[];for(const r of t)if(r.nodeType===r.ELEMENT_NODE){i.push(r);for(let s=0;s<r.children.length;s++)i.push(r.children[s])}this._coalescedStyleScheduler.schedule(()=>{for(const r of i)this._removeStickyStyle(r,e)})}updateStickyColumns(t,e,i,r=!0){if(!t.length||!this._isBrowser||!e.some(H=>H)&&!i.some(H=>H))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const s=t[0],u=s.children.length,m=this._getCellWidths(s,r),b=this._getStickyStartColumnPositions(m,e),E=this._getStickyEndColumnPositions(m,i),T=e.lastIndexOf(!0),O=i.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const H="rtl"===this.direction,q=H?"right":"left",oe=H?"left":"right";for(const de of t)for(let xe=0;xe<u;xe++){const Pe=de.children[xe];e[xe]&&this._addStickyStyle(Pe,q,b[xe],xe===T),i[xe]&&this._addStickyStyle(Pe,oe,E[xe],xe===O)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===T?[]:m.slice(0,T+1).map((de,xe)=>e[xe]?de:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===O?[]:m.slice(O).map((de,xe)=>i[xe+O]?de:null).reverse()}))})}stickRows(t,e,i){if(!this._isBrowser)return;const r="bottom"===i?t.slice().reverse():t,s="bottom"===i?e.slice().reverse():e,u=[],m=[],b=[];for(let T=0,O=0;T<r.length;T++){if(!s[T])continue;u[T]=O;const H=r[T];b[T]=this._isNativeHtmlTable?Array.from(H.children):[H];const q=H.getBoundingClientRect().height;O+=q,m[T]=q}const E=s.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{for(let T=0;T<r.length;T++){if(!s[T])continue;const O=u[T],H=T===E;for(const q of b[T])this._addStickyStyle(q,i,O,H)}"top"===i?this._positionListener?.stickyHeaderRowsUpdated({sizes:m,offsets:u,elements:b}):this._positionListener?.stickyFooterRowsUpdated({sizes:m,offsets:u,elements:b})})}updateStickyFooterContainer(t,e){if(!this._isNativeHtmlTable)return;const i=t.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{e.some(r=>!r)?this._removeStickyStyle(i,["bottom"]):this._addStickyStyle(i,"bottom",0,!1)})}_removeStickyStyle(t,e){for(const r of e)t.style[r]="",t.classList.remove(this._borderCellCss[r]);f2.some(r=>-1===e.indexOf(r)&&t.style[r])?t.style.zIndex=this._getCalculatedZIndex(t):(t.style.zIndex="",this._needsPositionStickyOnElement&&(t.style.position=""),t.classList.remove(this._stickCellCss))}_addStickyStyle(t,e,i,r){t.classList.add(this._stickCellCss),r&&t.classList.add(this._borderCellCss[e]),t.style[e]=`${i}px`,t.style.zIndex=this._getCalculatedZIndex(t),this._needsPositionStickyOnElement&&(t.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(t){const e={top:100,bottom:10,left:1,right:1};let i=0;for(const r of f2)t.style[r]&&(i+=e[r]);return i?`${i}`:""}_getCellWidths(t,e=!0){if(!e&&this._cachedCellWidths.length)return this._cachedCellWidths;const i=[],r=t.children;for(let s=0;s<r.length;s++)i.push(r[s].getBoundingClientRect().width);return this._cachedCellWidths=i,i}_getStickyStartColumnPositions(t,e){const i=[];let r=0;for(let s=0;s<t.length;s++)e[s]&&(i[s]=r,r+=t[s]);return i}_getStickyEndColumnPositions(t,e){const i=[];let r=0;for(let s=t.length;s>0;s--)e[s]&&(i[s]=r,r+=t[s]);return i}}const VS=new Ke("CDK_SPL");let Kw=(()=>{class n{constructor(e,i){this.viewContainer=e,this.elementRef=i}}return n.\u0275fac=function(e){return new(e||n)(J(Oo),J(jt))},n.\u0275dir=rt({type:n,selectors:[["","rowOutlet",""]]}),n})(),Jw=(()=>{class n{constructor(e,i){this.viewContainer=e,this.elementRef=i}}return n.\u0275fac=function(e){return new(e||n)(J(Oo),J(jt))},n.\u0275dir=rt({type:n,selectors:[["","headerRowOutlet",""]]}),n})(),Qw=(()=>{class n{constructor(e,i){this.viewContainer=e,this.elementRef=i}}return n.\u0275fac=function(e){return new(e||n)(J(Oo),J(jt))},n.\u0275dir=rt({type:n,selectors:[["","footerRowOutlet",""]]}),n})(),e1=(()=>{class n{constructor(e,i){this.viewContainer=e,this.elementRef=i}}return n.\u0275fac=function(e){return new(e||n)(J(Oo),J(jt))},n.\u0275dir=rt({type:n,selectors:[["","noDataRowOutlet",""]]}),n})(),t1=(()=>{class n{get trackBy(){return this._trackByFn}set trackBy(e){this._trackByFn=e}get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(e){this._multiTemplateDataRows=Bn(e),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(e){this._fixedLayout=Bn(e),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(e,i,r,s,u,m,b,E,T,O,H,q){this._differs=e,this._changeDetectorRef=i,this._elementRef=r,this._dir=u,this._platform=b,this._viewRepeater=E,this._coalescedStyleScheduler=T,this._viewportRuler=O,this._stickyPositioningListener=H,this._ngZone=q,this._onDestroy=new Xt,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new Tt,this.viewChange=new _s({start:0,end:Number.MAX_VALUE}),s||this._elementRef.nativeElement.setAttribute("role","table"),this._document=m,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((e,i)=>this.trackBy?this.trackBy(i.dataIndex,i.data):i),this._viewportRuler.change().pipe(eo(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const i=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||i,this._forceRecalculateCellWidths=i,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(e=>{e.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),oS(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const e=this._dataDiffer.diff(this._renderRows);if(!e)return this._updateNoDataRow(),void this.contentChanged.next();const i=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(e,i,(r,s,u)=>this._getEmbeddedViewArgs(r.item,u),r=>r.item.data,r=>{1===r.operation&&r.context&&this._renderCellTemplateForItem(r.record.item.rowDef,r.context)}),this._updateRowIndexContext(),e.forEachIdentityChange(r=>{i.get(r.currentIndex).context.$implicit=r.item.data}),this._updateNoDataRow(),this._ngZone&&rn.isInAngularZone()?this._ngZone.onStable.pipe(Jr(1),eo(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(e){this._customColumnDefs.add(e)}removeColumnDef(e){this._customColumnDefs.delete(e)}addRowDef(e){this._customRowDefs.add(e)}removeRowDef(e){this._customRowDefs.delete(e)}addHeaderRowDef(e){this._customHeaderRowDefs.add(e),this._headerRowDefChanged=!0}removeHeaderRowDef(e){this._customHeaderRowDefs.delete(e),this._headerRowDefChanged=!0}addFooterRowDef(e){this._customFooterRowDefs.add(e),this._footerRowDefChanged=!0}removeFooterRowDef(e){this._customFooterRowDefs.delete(e),this._footerRowDefChanged=!0}setNoDataRow(e){this._customNoDataRow=e}updateStickyHeaderRowStyles(){const e=this._getRenderedRows(this._headerRowOutlet),r=this._elementRef.nativeElement.querySelector("thead");r&&(r.style.display=e.length?"":"none");const s=this._headerRowDefs.map(u=>u.sticky);this._stickyStyler.clearStickyPositioning(e,["top"]),this._stickyStyler.stickRows(e,s,"top"),this._headerRowDefs.forEach(u=>u.resetStickyChanged())}updateStickyFooterRowStyles(){const e=this._getRenderedRows(this._footerRowOutlet),r=this._elementRef.nativeElement.querySelector("tfoot");r&&(r.style.display=e.length?"":"none");const s=this._footerRowDefs.map(u=>u.sticky);this._stickyStyler.clearStickyPositioning(e,["bottom"]),this._stickyStyler.stickRows(e,s,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,s),this._footerRowDefs.forEach(u=>u.resetStickyChanged())}updateStickyColumnStyles(){const e=this._getRenderedRows(this._headerRowOutlet),i=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...e,...i,...r],["left","right"]),this._stickyColumnStylesNeedReset=!1),e.forEach((s,u)=>{this._addStickyColumnStyles([s],this._headerRowDefs[u])}),this._rowDefs.forEach(s=>{const u=[];for(let m=0;m<i.length;m++)this._renderRows[m].rowDef===s&&u.push(i[m]);this._addStickyColumnStyles(u,s)}),r.forEach((s,u)=>{this._addStickyColumnStyles([s],this._footerRowDefs[u])}),Array.from(this._columnDefsByName.values()).forEach(s=>s.resetStickyChanged())}_getAllRenderRows(){const e=[],i=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let r=0;r<this._data.length;r++){let s=this._data[r];const u=this._getRenderRowsForData(s,r,i.get(s));this._cachedRenderRowsMap.has(s)||this._cachedRenderRowsMap.set(s,new WeakMap);for(let m=0;m<u.length;m++){let b=u[m];const E=this._cachedRenderRowsMap.get(b.data);E.has(b.rowDef)?E.get(b.rowDef).push(b):E.set(b.rowDef,[b]),e.push(b)}}return e}_getRenderRowsForData(e,i,r){return this._getRowDefs(e,i).map(u=>{const m=r&&r.has(u)?r.get(u):[];if(m.length){const b=m.shift();return b.dataIndex=i,b}return{data:e,rowDef:u,dataIndex:i}})}_cacheColumnDefs(){this._columnDefsByName.clear(),n1(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(i=>{this._columnDefsByName.has(i.name),this._columnDefsByName.set(i.name,i)})}_cacheRowDefs(){this._headerRowDefs=n1(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=n1(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=n1(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const e=this._rowDefs.filter(i=>!i.when);this._defaultRowDef=e[0]}_renderUpdatedColumns(){const e=(u,m)=>u||!!m.getColumnsDiff(),i=this._rowDefs.reduce(e,!1);i&&this._forceRenderDataRows();const r=this._headerRowDefs.reduce(e,!1);r&&this._forceRenderHeaderRows();const s=this._footerRowDefs.reduce(e,!1);return s&&this._forceRenderFooterRows(),i||r||s}_switchDataSource(e){this._data=[],oS(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),e||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=e}_observeRenderChanges(){if(!this.dataSource)return;let e;oS(this.dataSource)?e=this.dataSource.connect(this):kR(this.dataSource)?e=this.dataSource:Array.isArray(this.dataSource)&&(e=qt(this.dataSource)),this._renderChangeSubscription=e.pipe(eo(this._onDestroy)).subscribe(i=>{this._data=i||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((e,i)=>this._renderRow(this._headerRowOutlet,e,i)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((e,i)=>this._renderRow(this._footerRowOutlet,e,i)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(e,i){const r=Array.from(i.columns||[]).map(m=>this._columnDefsByName.get(m)),s=r.map(m=>m.sticky),u=r.map(m=>m.stickyEnd);this._stickyStyler.updateStickyColumns(e,s,u,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(e){const i=[];for(let r=0;r<e.viewContainer.length;r++){const s=e.viewContainer.get(r);i.push(s.rootNodes[0])}return i}_getRowDefs(e,i){if(1==this._rowDefs.length)return[this._rowDefs[0]];let r=[];if(this.multiTemplateDataRows)r=this._rowDefs.filter(s=>!s.when||s.when(i,e));else{let s=this._rowDefs.find(u=>u.when&&u.when(i,e))||this._defaultRowDef;s&&r.push(s)}return r}_getEmbeddedViewArgs(e,i){return{templateRef:e.rowDef.template,context:{$implicit:e.data},index:i}}_renderRow(e,i,r,s={}){const u=e.viewContainer.createEmbeddedView(i.template,s,r);return this._renderCellTemplateForItem(i,s),u}_renderCellTemplateForItem(e,i){for(let r of this._getCellTemplates(e))Gu.mostRecentCellOutlet&&Gu.mostRecentCellOutlet._viewContainer.createEmbeddedView(r,i);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const e=this._rowOutlet.viewContainer;for(let i=0,r=e.length;i<r;i++){const u=e.get(i).context;u.count=r,u.first=0===i,u.last=i===r-1,u.even=i%2==0,u.odd=!u.even,this.multiTemplateDataRows?(u.dataIndex=this._renderRows[i].dataIndex,u.renderIndex=i):u.index=this._renderRows[i].dataIndex}}_getCellTemplates(e){return e&&e.columns?Array.from(e.columns,i=>{const r=this._columnDefsByName.get(i);return e.extractCellTemplate(r)}):[]}_applyNativeTableSections(){const e=this._document.createDocumentFragment(),i=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const r of i){const s=this._document.createElement(r.tag);s.setAttribute("role","rowgroup");for(const u of r.outlets)s.appendChild(u.elementRef.nativeElement);e.appendChild(s)}this._elementRef.nativeElement.appendChild(e)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const e=(i,r)=>i||r.hasStickyChanged();this._headerRowDefs.reduce(e,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(e,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(e,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new X6(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:qt()).pipe(eo(this._onDestroy)).subscribe(i=>{this._stickyStyler.direction=i,this.updateStickyColumnStyles()})}_getOwnDefs(e){return e.filter(i=>!i._table||i._table===this)}_updateNoDataRow(){const e=this._customNoDataRow||this._noDataRow;if(!e)return;const i=0===this._rowOutlet.viewContainer.length;if(i===this._isShowingNoDataRow)return;const r=this._noDataRowOutlet.viewContainer;if(i){const s=r.createEmbeddedView(e.templateRef),u=s.rootNodes[0];1===s.rootNodes.length&&u?.nodeType===this._document.ELEMENT_NODE&&(u.setAttribute("role","row"),u.classList.add(e._contentClassName))}else r.clear();this._isShowingNoDataRow=i}}return n.\u0275fac=function(e){return new(e||n)(J(Ou),J(zr),J(jt),Os("role"),J(kc,8),J(Nn),J(Qr),J(hb),J(FS),J(Ww),J(VS,12),J(rn,8))},n.\u0275cmp=Fn({type:n,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(e,i,r){if(1&e&&(Ri(r,Xw,5),Ri(r,$u,5),Ri(r,Yw,5),Ri(r,Eb,5),Ri(r,Db,5)),2&e){let s;Bt(s=zt())&&(i._noDataRow=s.first),Bt(s=zt())&&(i._contentColumnDefs=s),Bt(s=zt())&&(i._contentRowDefs=s),Bt(s=zt())&&(i._contentHeaderRowDefs=s),Bt(s=zt())&&(i._contentFooterRowDefs=s)}},viewQuery:function(e,i){if(1&e&&(ci(Kw,7),ci(Jw,7),ci(Qw,7),ci(e1,7)),2&e){let r;Bt(r=zt())&&(i._rowOutlet=r.first),Bt(r=zt())&&(i._headerRowOutlet=r.first),Bt(r=zt())&&(i._footerRowOutlet=r.first),Bt(r=zt())&&(i._noDataRowOutlet=r.first)}},hostAttrs:["ngSkipHydration","true",1,"cdk-table"],hostVars:2,hostBindings:function(e,i){2&e&&Xn("cdk-table-fixed-layout",i.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[Zt([{provide:M_,useExisting:n},{provide:hb,useClass:BP},{provide:FS,useClass:p2},{provide:VS,useValue:null}])],ngContentSelectors:V6,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(e,i){1&e&&(fo(z6),qn(0),qn(1,1),Vl(2,0)(3,1)(4,2)(5,3))},dependencies:[Kw,Jw,Qw,e1],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2}),n})();function n1(n,t){return n.concat(Array.from(t))}let J6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[IS]}),n})();function sl(n,...t){return t.length?t.some(e=>n[e]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function g2(n){return Lo((t,e)=>n<=e)}let _2=(()=>{class n{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),d8=(()=>{class n{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,i)=>this._cleanupObserver(i))}observe(e){const i=ju(e);return new Vt(r=>{const u=this._observeElement(i).subscribe(r);return()=>{u.unsubscribe(),this._unobserveElement(i)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const i=new Xt,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:r,stream:i,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:i,stream:r}=this._observedElements.get(e);i&&i.disconnect(),r.complete(),this._observedElements.delete(e)}}}return n.\u0275fac=function(e){return new(e||n)(Ne(_2))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),u8=(()=>{class n{get disabled(){return this._disabled}set disabled(e){this._disabled=Bn(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=e2(e),this._subscribe()}constructor(e,i,r){this._contentObserver=e,this._elementRef=i,this._ngZone=r,this.event=new Tt,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(jw(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(d8),J(jt),J(rn))},n.\u0275dir=rt({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),y2=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[_2]}),n})(),h8=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})();const v2=new Set;let fm,p8=(()=>{class n{constructor(e,i){this._platform=e,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):m8}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function f8(n,t){if(!v2.has(n))try{fm||(fm=document.createElement("style"),t&&(fm.nonce=t),fm.setAttribute("type","text/css"),document.head.appendChild(fm)),fm.sheet&&(fm.sheet.insertRule(`@media ${n} {body{ }}`,0),v2.add(n))}catch(e){console.error(e)}}(e,this._nonce),this._matchMedia(e)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Qr),Ne(Vf,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function m8(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let b2=(()=>{class n{constructor(e,i){this._mediaMatcher=e,this._zone=i,this._queries=new Map,this._destroySubject=new Xt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return x2(Hw(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let s=nm(x2(Hw(e)).map(u=>this._registerQuery(u).observable));return s=Kv(s.pipe(Jr(1)),s.pipe(g2(1),jw(0))),s.pipe(xt(u=>{const m={matches:!1,breakpoints:{}};return u.forEach(({matches:b,query:E})=>{m.matches=m.matches||b,m.breakpoints[E]=b}),m}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const i=this._mediaMatcher.matchMedia(e),s={observable:new Vt(u=>{const m=b=>this._zone.run(()=>u.next(b));return i.addListener(m),()=>{i.removeListener(m)}}).pipe(Rd(i),xt(({matches:u})=>({query:e,matches:u})),eo(this._destroySubject)),mql:i};return this._queries.set(e,s),s}}return n.\u0275fac=function(e){return new(e||n)(Ne(p8),Ne(rn))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function x2(n){return n.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}class E2{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Xt,this._typeaheadSubscription=Ie.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=e=>e.disabled,this._pressedLetters=[],this.tabOut=new Xt,this.change=new Xt,t instanceof a_&&(this._itemChangesSubscription=t.changes.subscribe(e=>{if(this._activeItem){const r=e.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Vr(e=>this._pressedLetters.push(e)),jw(t),Lo(()=>this._pressedLetters.length>0),xt(()=>this._pressedLetters.join(""))).subscribe(e=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,u=i[s];if(!this._skipPredicateFn(u)&&0===u.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}withPageUpDown(t=!0,e=10){return this._pageUpAndDown={enabled:t,delta:e},this}setActiveItem(t){const e=this._activeItem;this.updateActiveItem(t),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!t[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,u=this._getItemsArray().length;this._setActiveItemByIndex(s<u?s:u-1,-1);break}return;default:return void((r||sl(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),i="number"==typeof t?t:e.indexOf(t);this._activeItem=e[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let i=1;i<=e.length;i++){const r=(this._activeItemIndex+t*i+e.length)%e.length;if(!this._skipPredicateFn(e[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const i=this._getItemsArray();if(i[t]){for(;this._skipPredicateFn(i[t]);)if(!i[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof a_?this._items.toArray():this._items}}class y8 extends E2{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}class v8 extends E2{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}}let b8=(()=>{class n{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function w8(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const i=function x8(n){try{return n.frameElement}catch{return null}}(function I8(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(e));if(i&&(-1===S2(i)||!this.isVisible(i)))return!1;let r=e.nodeName.toLowerCase(),s=S2(e);return e.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function T8(n){let t=n.nodeName.toLowerCase(),e="input"===t&&n.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===r?!!e.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,i){return function A8(n){return!function E8(n){return function S8(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function C8(n){let t=n.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(n)||function D8(n){return function M8(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||D2(n))}(e)&&!this.isDisabled(e)&&(i?.ignoreVisibility||this.isVisible(e))}}return n.\u0275fac=function(e){return new(e||n)(Ne(Qr))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function D2(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let t=n.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function S2(n){if(!D2(n))return null;const t=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class k8{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,e,i,r,s=!1){this._element=t,this._checker=e,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const i=this._getFirstTabbableElement(e);return i?.focus(t),!!i}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let i=0;i<e.length;i++){const r=e[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[i]):null;if(r)return r}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let i=e.length-1;i>=0;i--){const r=e[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[i]):null;if(r)return r}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(Jr(1)).subscribe(t)}}let R8=(()=>{class n{constructor(e,i,r){this._checker=e,this._ngZone=i,this._document=r}create(e,i=!1){return new k8(e,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(e){return new(e||n)(Ne(b8),Ne(rn),Ne(Nn))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),P8=(()=>{class n{get enabled(){return this.focusTrap.enabled}set enabled(e){this.focusTrap.enabled=Bn(e)}get autoCapture(){return this._autoCapture}set autoCapture(e){this._autoCapture=Bn(e)}constructor(e,i,r){this._elementRef=e,this._focusTrapFactory=i,this._previouslyFocusedElement=null,this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0)}ngOnDestroy(){this.focusTrap.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap.hasAttached()||this.focusTrap.attachAnchors()}ngOnChanges(e){const i=e.autoCapture;i&&!i.firstChange&&this.autoCapture&&this.focusTrap.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=s2(),this.focusTrap.focusInitialElementWhenReady()}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(R8),J(Nn))},n.\u0275dir=rt({type:n,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:["cdkTrapFocus","enabled"],autoCapture:["cdkTrapFocusAutoCapture","autoCapture"]},exportAs:["cdkTrapFocus"],features:[M]}),n})();function M2(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function T2(n){const t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const O8=new Ke("cdk-input-modality-detector-options"),F8={ignoreKeys:[18,17,224,91,16]},I_=E_({passive:!0,capture:!0});let L8=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(e,i,r,s){this._platform=e,this._mostRecentTarget=null,this._modality=new _s(null),this._lastTouchMs=0,this._onKeydown=u=>{this._options?.ignoreKeys?.some(m=>m===u.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Hu(u))},this._onMousedown=u=>{Date.now()-this._lastTouchMs<650||(this._modality.next(M2(u)?"keyboard":"mouse"),this._mostRecentTarget=Hu(u))},this._onTouchstart=u=>{T2(u)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Hu(u))},this._options={...F8,...s},this.modalityDetected=this._modality.pipe(g2(1)),this.modalityChanged=this.modalityDetected.pipe(WO()),e.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,I_),r.addEventListener("mousedown",this._onMousedown,I_),r.addEventListener("touchstart",this._onTouchstart,I_)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,I_),document.removeEventListener("mousedown",this._onMousedown,I_),document.removeEventListener("touchstart",this._onTouchstart,I_))}}return n.\u0275fac=function(e){return new(e||n)(Ne(Qr),Ne(rn),Ne(Nn),Ne(O8,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const B8=new Ke("cdk-focus-monitor-default-options"),c1=E_({passive:!0,capture:!0});let d1=(()=>{class n{constructor(e,i,r,s,u){this._ngZone=e,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Xt,this._rootNodeFocusAndBlurListener=m=>{for(let E=Hu(m);E;E=E.parentElement)"focus"===m.type?this._onFocus(m,E):this._onBlur(m,E)},this._document=s,this._detectionMode=u?.detectionMode||0}monitor(e,i=!1){const r=ju(e);if(!this._platform.isBrowser||1!==r.nodeType)return qt(null);const s=function _6(n){if(function g6(){if(null==MS){const n=typeof document<"u"?document.head:null;MS=!(!n||!n.createShadowRoot&&!n.attachShadow)}return MS}()){const t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(r)||this._getDocument(),u=this._elementInfo.get(r);if(u)return i&&(u.checkChildren=!0),u.subject;const m={checkChildren:i,subject:new Xt,rootNode:s};return this._elementInfo.set(r,m),this._registerGlobalListeners(m),m.subject}stopMonitoring(e){const i=ju(e),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(e,i,r){const s=ju(e);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([m,b])=>this._originChanged(m,i,b)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((e,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,i){e.classList.toggle("cdk-focused",!!i),e.classList.toggle("cdk-touch-focused","touch"===i),e.classList.toggle("cdk-keyboard-focused","keyboard"===i),e.classList.toggle("cdk-mouse-focused","mouse"===i),e.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(e,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,i){const r=this._elementInfo.get(i),s=Hu(e);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(e,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&e.relatedTarget instanceof Node&&i.contains(e.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(e,i){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(i))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const i=e.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,c1),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,c1)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(eo(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(e){const i=e.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,c1),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,c1),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,i,r){this._setClasses(e,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(e){const i=[];return this._elementInfo.forEach((r,s)=>{(s===e||r.checkChildren&&s.contains(e))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const s=e.labels;if(s)for(let u=0;u<s.length;u++)if(s[u].contains(i))return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)(Ne(rn),Ne(Qr),Ne(L8),Ne(Nn,8),Ne(B8,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),I2=(()=>{class n{constructor(e,i){this._elementRef=e,this._focusMonitor=i,this._focusOrigin=null,this.cdkFocusChange=new Tt}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,1===e.nodeType&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(i=>{this._focusOrigin=i,this.cdkFocusChange.emit(i)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(d1))},n.\u0275dir=rt({type:n,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]}),n})();const k2="cdk-high-contrast-black-on-white",R2="cdk-high-contrast-white-on-black",US="cdk-high-contrast-active";let P2=(()=>{class n{constructor(e,i){this._platform=e,this._document=i,this._breakpointSubscription=gt(b2).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(e):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(US,k2,R2),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?e.add(US,k2):2===i&&e.add(US,R2)}}}return n.\u0275fac=function(e){return new(e||n)(Ne(Qr),Ne(Nn))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),O2=(()=>{class n{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(e){return new(e||n)(Ne(P2))},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[y2]}),n})();const z8=["text"];function V8(n,t){if(1&n&&_n(0,"mat-pseudo-checkbox",6),2&n){const e=Nt();et("state",e.selected?"checked":"unchecked")("disabled",e.disabled)}}function U8(n,t){1&n&&_n(0,"mat-pseudo-checkbox",7),2&n&&et("disabled",Nt().disabled)}function j8(n,t){if(1&n&&(Ye(0,"span",8),Kn(1),ot()),2&n){const e=Nt();Ze(1),zs("(",e.group.label,")")}}const H8=[[["mat-icon"]],"*"],$8=["mat-icon","*"],Z8=new Ke("mat-sanity-checks",{providedIn:"root",factory:function W8(){return!0}});let ur=(()=>{class n{constructor(e,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!TS()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return n.\u0275fac=function(e){return new(e||n)(Ne(P2),Ne(Z8,8),Ne(Nn))},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[xb,xb]}),n})();function jS(n){return class extends n{get disabled(){return this._disabled}set disabled(t){this._disabled=Bn(t)}constructor(...t){super(...t),this._disabled=!1}}}function Tb(n,t){return class extends n{get color(){return this._color}set color(e){const i=e||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...e){super(...e),this.defaultColor=t,this.color=t}}}function u1(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Bn(t)}constructor(...t){super(...t),this._disableRipple=!1}}}function h1(n,t=0){return class extends n{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?e2(e):this.defaultTabIndex}constructor(...e){super(...e),this._tabIndex=t,this.defaultTabIndex=t}}}function HS(n){return class extends n{updateErrorState(){const t=this.errorState,s=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);s!==t&&(this.errorState=s,this.stateChanges.next())}constructor(...t){super(...t),this.errorState=!1}}}const Y8=new Ke("MAT_DATE_LOCALE",{providedIn:"root",factory:function X8(){return gt(Ec)}});class to{constructor(){this._localeChanges=new Xt,this.localeChanges=this._localeChanges}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let i=this.isValid(t),r=this.isValid(e);return i&&r?!this.compareDate(t,e):i==r}return t==e}clampDate(t,e,i){return e&&this.compareDate(t,e)<0?e:i&&this.compareDate(t,i)>0?i:t}}const Fd=new Ke("mat-date-formats"),K8=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function $S(n,t){const e=Array(n);for(let i=0;i<n;i++)e[i]=t(i);return e}let J8=(()=>{class n extends to{constructor(e,i){super(),this.useUtcForDisplay=!1,super.setLocale(e)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){const i=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return $S(12,r=>this._format(i,new Date(2017,r,1)))}getDateNames(){const e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return $S(31,i=>this._format(e,new Date(2017,0,i+1)))}getDayOfWeekNames(e){const i=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return $S(7,r=>this._format(i,new Date(2017,0,r+1)))}getYearName(e){const i=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(i,e)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,i,r){let s=this._createDateWithOverflow(e,i,r);return s.getMonth(),s}today(){return new Date}parse(e,i){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}format(e,i){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");const r=new Intl.DateTimeFormat(this.locale,{...i,timeZone:"utc"});return this._format(r,e)}addCalendarYears(e,i){return this.addCalendarMonths(e,12*i)}addCalendarMonths(e,i){let r=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+i,this.getDate(e));return this.getMonth(r)!=((this.getMonth(e)+i)%12+12)%12&&(r=this._createDateWithOverflow(this.getYear(r),this.getMonth(r),0)),r}addCalendarDays(e,i){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+i)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if("string"==typeof e){if(!e)return null;if(K8.test(e)){let i=new Date(e);if(this.isValid(i))return i}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(e,i,r){const s=new Date;return s.setFullYear(e,i,r),s.setHours(0,0,0,0),s}_2digit(e){return("00"+e).slice(-2)}_format(e,i){const r=new Date;return r.setUTCFullYear(i.getFullYear(),i.getMonth(),i.getDate()),r.setUTCHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),e.format(r)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Y8,8),Ne(Qr))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const Q8={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let eG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[{provide:to,useClass:J8}]}),n})(),tG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[{provide:Fd,useValue:Q8}],imports:[eG]}),n})(),k_=(()=>{class n{isErrorState(e,i){return!!(e&&e.invalid&&(e.touched||i&&i.submitted))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class nG{constructor(t,e,i,r=!1){this._renderer=t,this.element=e,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const N2=E_({passive:!0,capture:!0});class iG{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const e=Hu(t);e&&this._events.get(t.type)?.forEach((i,r)=>{(r===e||r.contains(e))&&i.forEach(s=>s.handleEvent(t))})}}addHandler(t,e,i,r){const s=this._events.get(e);if(s){const u=s.get(i);u?u.add(r):s.set(i,new Set([r]))}else this._events.set(e,new Map([[i,new Set([r])]])),t.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,N2)})}removeHandler(t,e,i){const r=this._events.get(t);if(!r)return;const s=r.get(e);s&&(s.delete(i),0===s.size&&r.delete(e),0===r.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,N2)))}}const B2={enterDuration:225,exitDuration:150},z2=E_({passive:!0,capture:!0}),V2=["mousedown","touchstart"],U2=["mouseup","mouseleave","touchend","touchcancel"];class R_{constructor(t,e,i,r){this._target=t,this._ngZone=e,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=ju(i))}fadeInRipple(t,e,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...B2,...i.animation};i.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const u=i.radius||function oG(n,t,e){const i=Math.max(Math.abs(n-e.left),Math.abs(n-e.right)),r=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(i*i+r*r)}(t,e,r),m=t-r.left,b=e-r.top,E=s.enterDuration,T=document.createElement("div");T.classList.add("mat-ripple-element"),T.style.left=m-u+"px",T.style.top=b-u+"px",T.style.height=2*u+"px",T.style.width=2*u+"px",null!=i.color&&(T.style.backgroundColor=i.color),T.style.transitionDuration=`${E}ms`,this._containerElement.appendChild(T);const O=window.getComputedStyle(T),q=O.transitionDuration,oe="none"===O.transitionProperty||"0s"===q||"0s, 0s"===q||0===r.width&&0===r.height,de=new nG(this,T,i,oe);T.style.transform="scale3d(1, 1, 1)",de.state=0,i.persistent||(this._mostRecentTransientRipple=de);let xe=null;return!oe&&(E||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Pe=()=>this._finishRippleTransition(de),we=()=>this._destroyRipple(de);T.addEventListener("transitionend",Pe),T.addEventListener("transitioncancel",we),xe={onTransitionEnd:Pe,onTransitionCancel:we}}),this._activeRipples.set(de,xe),(oe||!E)&&this._finishRippleTransition(de),de}fadeOutRipple(t){if(2===t.state||3===t.state)return;const e=t.element,i={...B2,...t.config.animation};e.style.transitionDuration=`${i.exitDuration}ms`,e.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=ju(t);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,V2.forEach(i=>{R_._eventManager.addHandler(this._ngZone,i,e,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{U2.forEach(e=>{this._triggerElement.addEventListener(e,this,z2)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:i}=t.config;t.state=1,!i&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=M2(t),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!i&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!T2(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let i=0;i<e.length;i++)this.fadeInRipple(e[i].clientX,e[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(V2.forEach(e=>R_._eventManager.removeHandler(e,t,this)),this._pointerUpEventsRegistered&&U2.forEach(e=>t.removeEventListener(e,this,z2)))}}R_._eventManager=new iG;const p1=new Ke("mat-ripple-global-options");let wp=(()=>{class n{get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}constructor(e,i,r,s,u){this._elementRef=e,this._animationMode=u,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new R_(this,i,e,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,i=0,r){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(rn),J(Qr),J(p1,8),J(ko,8))},n.\u0275dir=rt({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,i){2&e&&Xn("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),f1=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[ur,ur]}),n})(),sG=(()=>{class n{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1,this.appearance="full"}}return n.\u0275fac=function(e){return new(e||n)(J(ko,8))},n.\u0275cmp=Fn({type:n,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(e,i){2&e&&Xn("mat-pseudo-checkbox-indeterminate","indeterminate"===i.state)("mat-pseudo-checkbox-checked","checked"===i.state)("mat-pseudo-checkbox-disabled",i.disabled)("mat-pseudo-checkbox-minimal","minimal"===i.appearance)("mat-pseudo-checkbox-full","full"===i.appearance)("_mat-animation-noopable","NoopAnimations"===i._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(e,i){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-full{border:2px solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0}),n})(),aG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[ur]}),n})();const j2=new Ke("MAT_OPTION_PARENT_COMPONENT"),H2=new Ke("MatOptgroup");let lG=0;class $2{constructor(t,e=!1){this.source=t,this.isUserInput=e}}let cG=(()=>{class n{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=Bn(e)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}constructor(e,i,r,s){this._element=e,this._changeDetectorRef=i,this._parent=r,this.group=s,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+lG++,this.onSelectionChange=new Tt,this._stateChanges=new Xt}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(e,i){const r=this._getHostElement();"function"==typeof r.focus&&r.focus(i)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!sl(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=e)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new $2(this,e))}}return n.\u0275fac=function(e){Iu()},n.\u0275dir=rt({type:n,viewQuery:function(e,i){if(1&e&&ci(z8,7),2&e){let r;Bt(r=zt())&&(i._text=r.first)}},inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),n})(),G2=(()=>{class n extends cG{constructor(e,i,r,s){super(e,i,r,s)}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(zr),J(j2,8),J(H2,8))},n.\u0275cmp=Fn({type:n,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(e,i){1&e&&Kt("click",function(){return i._selectViaInteraction()})("keydown",function(s){return i._handleKeydown(s)}),2&e&&(ia("id",i.id),Ln("aria-selected",i.selected)("aria-disabled",i.disabled.toString()),Xn("mdc-list-item--selected",i.selected)("mat-mdc-option-multiple",i.multiple)("mat-mdc-option-active",i.active)("mdc-list-item--disabled",i.disabled))},exportAs:["matOption"],features:[Et],ngContentSelectors:$8,decls:8,vars:5,consts:[["class","mat-mdc-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mdc-list-item__primary-text"],["text",""],["class","mat-mdc-option-pseudo-checkbox","state","checked","appearance","minimal",3,"disabled",4,"ngIf"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-mdc-option-pseudo-checkbox",3,"state","disabled"],["state","checked","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"]],template:function(e,i){1&e&&(fo(H8),kt(0,V8,1,2,"mat-pseudo-checkbox",0),qn(1),Ye(2,"span",1,2),qn(4,1),ot(),kt(5,U8,1,1,"mat-pseudo-checkbox",3),kt(6,j8,2,1,"span",4),_n(7,"div",5)),2&e&&(et("ngIf",i.multiple),Ze(5),et("ngIf",!i.multiple&&i.selected&&!i.hideSingleSelectionIndicator),Ze(1),et("ngIf",i.group&&i.group._inert),Ze(1),et("matRippleTrigger",i._getHostElement())("matRippleDisabled",i.disabled||i.disableRipple))},dependencies:[wp,Nu,sG],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option.mdc-list-item{align-items:center}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})(),m1=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[f1,Tc,ur,aG]}),n})();const hG=[[["caption"]],[["colgroup"],["col"]]],pG=["caption","colgroup, col"];let q2=(()=>{class n extends t1{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}ngOnInit(){super.ngOnInit(),this._isNativeHtmlTable&&this._elementRef.nativeElement.querySelector("tbody").classList.add("mdc-data-table__content")}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275cmp=Fn({type:n,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:["ngSkipHydration","true",1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(e,i){2&e&&Xn("mdc-table-fixed-layout",i.fixedLayout)},exportAs:["matTable"],features:[Zt([{provide:t1,useExisting:n},{provide:M_,useExisting:n},{provide:FS,useClass:p2},{provide:hb,useClass:BP},{provide:VS,useValue:null}]),Et],ngContentSelectors:pG,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(e,i){1&e&&(fo(hG),qn(0),qn(1,1),Vl(2,0)(3,1)(4,2)(5,3))},dependencies:[Kw,Jw,Qw,e1],styles:[".mdc-data-table{border-radius:var(--mdc-shape-medium, 4px);border-width:1px;border-style:solid}.mdc-data-table .mdc-data-table__header-cell:first-child{border-top-left-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table .mdc-data-table__header-cell:first-child,.mdc-data-table .mdc-data-table__header-cell:first-child[dir=rtl]{border-top-right-radius:var(--mdc-shape-medium, 4px);border-top-left-radius:0}.mdc-data-table .mdc-data-table__header-cell:last-child{border-top-right-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table .mdc-data-table__header-cell:last-child,.mdc-data-table .mdc-data-table__header-cell:last-child[dir=rtl]{border-top-left-radius:var(--mdc-shape-medium, 4px);border-top-right-radius:0}.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child{border-bottom-left-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child,.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child[dir=rtl]{border-bottom-right-radius:var(--mdc-shape-medium, 4px);border-bottom-left-radius:0}.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child{border-bottom-right-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child,.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child[dir=rtl]{border-bottom-left-radius:var(--mdc-shape-medium, 4px);border-bottom-right-radius:0}.mdc-data-table__cell,.mdc-data-table__header-cell{border-bottom-width:1px;border-bottom-style:solid}.mdc-data-table__pagination{border-top-width:1px;border-top-style:solid}.mdc-data-table__row:last-child .mdc-data-table__cell{border-bottom:none}.mdc-data-table__row{height:52px}.mdc-data-table__pagination{min-height:52px}.mdc-data-table__header-row{height:56px}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px 0 16px}.mdc-data-table__header-cell--checkbox,.mdc-data-table__cell--checkbox{padding-left:4px;padding-right:0}[dir=rtl] .mdc-data-table__header-cell--checkbox,[dir=rtl] .mdc-data-table__cell--checkbox,.mdc-data-table__header-cell--checkbox[dir=rtl],.mdc-data-table__cell--checkbox[dir=rtl]{padding-left:0;padding-right:4px}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__cell--checkbox{width:1px}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__header-cell--checkbox{width:1px}.mdc-data-table__sort-icon-button{width:28px;height:28px;padding:2px;transform:rotate(0.0001deg);margin-left:4px;margin-right:0;opacity:0}.mdc-data-table__sort-icon-button .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:28px;height:28px;margin-top:0px;margin-bottom:0px;margin-right:0px;margin-left:0px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:28px;left:50%;width:28px;transform:translate(-50%, -50%)}[dir=rtl] .mdc-data-table__sort-icon-button,.mdc-data-table__sort-icon-button[dir=rtl]{margin-left:0;margin-right:4px}.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button{margin-left:0;margin-right:4px}[dir=rtl] .mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button[dir=rtl]{margin-left:4px;margin-right:0}.mdc-data-table__header-cell--sorted-descending .mdc-data-table__sort-icon-button{transform:rotate(-180deg)}.mdc-data-table__sort-icon-button:focus,.mdc-data-table__header-cell:hover .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--sorted .mdc-data-table__sort-icon-button{opacity:1}.mdc-data-table__header-cell--with-sort{cursor:pointer}.mdc-data-table__sort-status-label{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.mdc-data-table--sticky-header .mdc-data-table__header-cell{position:sticky;top:0;z-index:1}.mdc-data-table{-webkit-overflow-scrolling:touch;display:inline-flex;flex-direction:column;box-sizing:border-box;position:relative}.mdc-data-table__table-container{-webkit-overflow-scrolling:touch;overflow-x:auto;width:100%}.mdc-data-table__table{min-width:100%;border:0;white-space:nowrap;border-spacing:0;table-layout:fixed}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__pagination{box-sizing:border-box;display:flex;justify-content:flex-end}.mdc-data-table__pagination-trailing{margin-left:4px;margin-right:0;align-items:center;display:flex;flex-wrap:wrap;justify-content:flex-end}[dir=rtl] .mdc-data-table__pagination-trailing,.mdc-data-table__pagination-trailing[dir=rtl]{margin-left:0;margin-right:4px}.mdc-data-table__pagination-navigation{align-items:center;display:flex}.mdc-data-table__pagination-button{margin-left:0;margin-right:4px}[dir=rtl] .mdc-data-table__pagination-button .mdc-button__icon,.mdc-data-table__pagination-button .mdc-button__icon[dir=rtl]{transform:rotate(180deg)}[dir=rtl] .mdc-data-table__pagination-button,.mdc-data-table__pagination-button[dir=rtl]{margin-left:4px;margin-right:0}.mdc-data-table__pagination-total{margin-left:14px;margin-right:36px;white-space:nowrap}[dir=rtl] .mdc-data-table__pagination-total,.mdc-data-table__pagination-total[dir=rtl]{margin-left:36px;margin-right:14px}.mdc-data-table__pagination-rows-per-page{margin-left:0;margin-right:22px;align-items:center;display:inline-flex}[dir=rtl] .mdc-data-table__pagination-rows-per-page,.mdc-data-table__pagination-rows-per-page[dir=rtl]{margin-left:22px;margin-right:0}.mdc-data-table__pagination-rows-per-page-label{margin-left:0;margin-right:12px;white-space:nowrap}[dir=rtl] .mdc-data-table__pagination-rows-per-page-label,.mdc-data-table__pagination-rows-per-page-label[dir=rtl]{margin-left:12px;margin-right:0}.mdc-data-table__pagination-rows-per-page-select{min-width:var(--mdc-menu-min-width, 80px);margin:8px 0}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor{width:100%;min-width:80px}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor{height:36px}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-floating-label--float-above{font-size:.75rem}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-data-table__pagination-rows-per-page-select .mdc-select__dropdown-icon{width:20px;height:20px}.mdc-data-table__pagination-rows-per-page-select.mdc-select--outlined .mdc-select__anchor :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 56px)}.mdc-data-table__pagination-rows-per-page-select .mdc-list-item.mdc-list-item--with-one-line{height:36px}.mdc-data-table__progress-indicator{display:none;position:absolute;width:100%}.mdc-data-table--in-progress .mdc-data-table__progress-indicator{display:block}.mdc-data-table__scrim{background-color:var(--mdc-theme-surface, #fff);height:100%;opacity:.32;position:absolute;top:0;width:100%}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table-sticky{position:sticky !important}.mat-mdc-table{table-layout:auto;white-space:normal}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table .mat-mdc-row:hover,.mat-mdc-table .mat-mdc-footer-row:hover{background-color:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2}),n})(),GS=(()=>{class n extends T_{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["","matCellDef",""]],features:[Zt([{provide:T_,useExisting:n}]),Et]}),n})(),qS=(()=>{class n extends A_{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["","matHeaderCellDef",""]],features:[Zt([{provide:A_,useExisting:n}]),Et]}),n})(),WS=(()=>{class n extends $u{get name(){return this._name}set name(e){this._setNameInput(e)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[Zt([{provide:$u,useExisting:n},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),Et]}),n})(),ZS=(()=>{class n extends PS{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],features:[Et]}),n})(),YS=(()=>{class n extends OS{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],features:[Et]}),n})(),W2=(()=>{class n extends Eb{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[Zt([{provide:Eb,useExisting:n}]),Et]}),n})(),Z2=(()=>{class n extends Yw{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[Zt([{provide:Yw,useExisting:n}]),Et]}),n})(),Y2=(()=>{class n extends NS{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275cmp=Fn({type:n,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],features:[Zt([{provide:NS,useExisting:n}]),Et],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,i){1&e&&Vl(0,0)},dependencies:[Gu],encapsulation:2}),n})(),X2=(()=>{class n extends zS{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275cmp=Fn({type:n,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],features:[Zt([{provide:zS,useExisting:n}]),Et],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(e,i){1&e&&Vl(0,0)},dependencies:[Gu],encapsulation:2}),n})(),xG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[ur,J6,ur]}),n})();class CG extends s${get data(){return this._data.value}set data(t){t=Array.isArray(t)?t:[],this._data.next(t),this._renderChangesSubscription||this._filterData(t)}get filter(){return this._filter.value}set filter(t){this._filter.next(t),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(t){this._sort=t,this._updateChangeSubscription()}get paginator(){return this._paginator}set paginator(t){this._paginator=t,this._updateChangeSubscription()}constructor(t=[]){super(),this._renderData=new _s([]),this._filter=new _s(""),this._internalPageChanges=new Xt,this._renderChangesSubscription=null,this.sortingDataAccessor=(e,i)=>{const r=e[i];if(t2(r)){const s=Number(r);return s<9007199254740991?s:r}return r},this.sortData=(e,i)=>{const r=i.active,s=i.direction;return r&&""!=s?e.sort((u,m)=>{let b=this.sortingDataAccessor(u,r),E=this.sortingDataAccessor(m,r);const T=typeof b,O=typeof E;T!==O&&("number"===T&&(b+=""),"number"===O&&(E+=""));let H=0;return null!=b&&null!=E?b>E?H=1:b<E&&(H=-1):null!=b?H=1:null!=E&&(H=-1),H*("asc"==s?1:-1)}):e},this.filterPredicate=(e,i)=>{const r=Object.keys(e).reduce((u,m)=>u+e[m]+"\u25ec","").toLowerCase(),s=i.trim().toLowerCase();return-1!=r.indexOf(s)},this._data=new _s(t),this._updateChangeSubscription()}_updateChangeSubscription(){const t=this._sort?$i(this._sort.sortChange,this._sort.initialized):qt(null),e=this._paginator?$i(this._paginator.page,this._internalPageChanges,this._paginator.initialized):qt(null),r=nm([this._data,this._filter]).pipe(xt(([m])=>this._filterData(m))),s=nm([r,t]).pipe(xt(([m])=>this._orderData(m))),u=nm([s,e]).pipe(xt(([m])=>this._pageData(m)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=u.subscribe(m=>this._renderData.next(m))}_filterData(t){return this.filteredData=null==this.filter||""===this.filter?t:t.filter(e=>this.filterPredicate(e,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(t){return this.sort?this.sortData(t.slice(),this.sort):t}_pageData(t){if(!this.paginator)return t;const e=this.paginator.pageIndex*this.paginator.pageSize;return t.slice(e,e+this.paginator.pageSize)}_updatePaginator(t){Promise.resolve().then(()=>{const e=this.paginator;if(e&&(e.length=t,e.pageIndex>0)){const i=Math.ceil(e.length/e.pageSize)-1||0,r=Math.min(e.pageIndex,i);r!==e.pageIndex&&(e.pageIndex=r,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}}class EG extends CG{}class DG extends EG{constructor(t,e){super(t),this.dataService=e}setData(t){this.data=t,this.dataService.setData(t)}}class g1{}class XS{}class Ld{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const i=e.indexOf(":");if(i>0){const r=e.slice(0,i),s=r.toLowerCase(),u=e.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(u):this.headers.set(s,[u])}})}:()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{let r;if(r="string"==typeof i?[i]:"number"==typeof i?[i.toString()]:i.map(s=>s.toString()),r.length>0){const s=e.toLowerCase();this.headers.set(s,r),this.maybeSetNormalizedName(e,s)}})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Ld?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Ld;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Ld?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...i),this.headers.set(e,r);break;case"d":const s=t.value;if(s){let u=this.headers.get(e);if(!u)return;u=u.filter(m=>-1===s.indexOf(m)),0===u.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,u)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class SG{encodeKey(t){return K2(t)}encodeValue(t){return K2(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const TG=/%(\d[a-f0-9])/gi,AG={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function K2(n){return encodeURIComponent(n).replace(TG,(t,e)=>AG[e]??t)}function _1(n){return`${n}`}class Wu{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new SG,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function MG(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[u,m]=-1==s?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,s)),t.decodeValue(r.slice(s+1))],b=e.get(u)||[];b.push(m),e.set(u,b)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e],r=Array.isArray(i)?i.map(_1):[_1(i)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(s=>{e.push({param:i,value:s,op:"a"})}):e.push({param:i,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Wu({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(_1(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(_1(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class IG{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function J2(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Q2(n){return typeof Blob<"u"&&n instanceof Blob}function eF(n){return typeof FormData<"u"&&n instanceof FormData}class Ib{constructor(t,e,i,r){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function kG(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Ld),this.context||(this.context=new IG),this.params){const u=this.params.toString();if(0===u.length)this.urlWithParams=e;else{const m=e.indexOf("?");this.urlWithParams=e+(-1===m?"?":m<e.length-1?"&":"")+u}}else this.params=new Wu,this.urlWithParams=e}serializeBody(){return null===this.body?null:J2(this.body)||Q2(this.body)||eF(this.body)||function RG(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Wu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||eF(this.body)?null:Q2(this.body)?this.body.type||null:J2(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Wu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,s=void 0!==t.body?t.body:this.body,u=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,m=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let b=t.headers||this.headers,E=t.params||this.params;const T=t.context??this.context;return void 0!==t.setHeaders&&(b=Object.keys(t.setHeaders).reduce((O,H)=>O.set(H,t.setHeaders[H]),b)),t.setParams&&(E=Object.keys(t.setParams).reduce((O,H)=>O.set(H,t.setParams[H]),E)),new Ib(e,i,s,{params:E,headers:b,context:T,reportProgress:m,responseType:r,withCredentials:u})}}var vo=(()=>((vo=vo||{})[vo.Sent=0]="Sent",vo[vo.UploadProgress=1]="UploadProgress",vo[vo.ResponseHeader=2]="ResponseHeader",vo[vo.DownloadProgress=3]="DownloadProgress",vo[vo.Response=4]="Response",vo[vo.User=5]="User",vo))();class KS{constructor(t,e=200,i="OK"){this.headers=t.headers||new Ld,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class JS extends KS{constructor(t={}){super(t),this.type=vo.ResponseHeader}clone(t={}){return new JS({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class P_ extends KS{constructor(t={}){super(t),this.type=vo.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new P_({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class tF extends KS{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function QS(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let y1=(()=>{class n{constructor(e){this.handler=e}request(e,i,r={}){let s;if(e instanceof Ib)s=e;else{let b,E;b=r.headers instanceof Ld?r.headers:new Ld(r.headers),r.params&&(E=r.params instanceof Wu?r.params:new Wu({fromObject:r.params})),s=new Ib(e,i,void 0!==r.body?r.body:null,{headers:b,context:r.context,params:E,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const u=qt(s).pipe(h_(b=>this.handler.handle(b)));if(e instanceof Ib||"events"===r.observe)return u;const m=u.pipe(Lo(b=>b instanceof P_));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return m.pipe(xt(b=>{if(null!==b.body&&!(b.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return b.body}));case"blob":return m.pipe(xt(b=>{if(null!==b.body&&!(b.body instanceof Blob))throw new Error("Response is not a Blob.");return b.body}));case"text":return m.pipe(xt(b=>{if(null!==b.body&&"string"!=typeof b.body)throw new Error("Response is not a string.");return b.body}));default:return m.pipe(xt(b=>b.body))}case"response":return m;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:(new Wu).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,r={}){return this.request("PATCH",e,QS(r,i))}post(e,i,r={}){return this.request("POST",e,QS(r,i))}put(e,i,r={}){return this.request("PUT",e,QS(r,i))}}return n.\u0275fac=function(e){return new(e||n)(Ne(g1))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();function nF(n,t){return t(n)}function PG(n,t){return(e,i)=>t.intercept(e,{handle:r=>n(r,i)})}const FG=new Ke(""),kb=new Ke(""),iF=new Ke("");function LG(){let n=null;return(t,e)=>(null===n&&(n=(gt(FG,{optional:!0})??[]).reduceRight(PG,nF)),n(t,e))}let rF=(()=>{class n extends g1{constructor(e,i){super(),this.backend=e,this.injector=i,this.chain=null}handle(e){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(kb),...this.injector.get(iF,[])]));this.chain=i.reduceRight((r,s)=>function OG(n,t,e){return(i,r)=>e.runInContext(()=>t(i,s=>n(s,r)))}(r,s,this.injector),nF)}return this.chain(e,i=>this.backend.handle(i))}}return n.\u0275fac=function(e){return new(e||n)(Ne(XS),Ne(Qa))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const VG=/^\)\]\}',?\n/;let sF=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new ke(-2800,!1);const i=function jG(){const n=()=>{};if(typeof Zone<"u"){const t=Zone.current,e=t.scheduleMacroTask("httpMacroTask",n,void 0,n,n);return()=>t.cancelTask(e)}return n}(),r=this.xhrFactory;return(r.\u0275loadImpl?mr(r.\u0275loadImpl()):qt(null)).pipe(Vs(()=>new Vt(u=>{const m=r.build();if(m.open(e.method,e.urlWithParams),e.withCredentials&&(m.withCredentials=!0),e.headers.forEach((Pe,we)=>m.setRequestHeader(Pe,we.join(","))),e.headers.has("Accept")||m.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const Pe=e.detectContentTypeHeader();null!==Pe&&m.setRequestHeader("Content-Type",Pe)}if(e.responseType){const Pe=e.responseType.toLowerCase();m.responseType="json"!==Pe?Pe:"text"}const b=e.serializeBody();let E=null;const T=()=>{if(null!==E)return E;const Pe=m.statusText||"OK",we=new Ld(m.getAllResponseHeaders()),ht=function UG(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(m)||e.url;return E=new JS({headers:we,status:m.status,statusText:Pe,url:ht}),E},O=()=>{let{headers:Pe,status:we,statusText:ht,url:Ct}=T(),$t=null;204!==we&&($t=typeof m.response>"u"?m.responseText:m.response),0===we&&(we=$t?200:0);let hr=we>=200&&we<300;if("json"===e.responseType&&"string"==typeof $t){const bo=$t;$t=$t.replace(VG,"");try{$t=""!==$t?JSON.parse($t):null}catch(Oc){$t=bo,hr&&(hr=!1,$t={error:Oc,text:$t})}}hr?(u.next(new P_({body:$t,headers:Pe,status:we,statusText:ht,url:Ct||void 0})),u.complete()):u.error(new tF({error:$t,headers:Pe,status:we,statusText:ht,url:Ct||void 0}))},H=Pe=>{const{url:we}=T(),ht=new tF({error:Pe,status:m.status||0,statusText:m.statusText||"Unknown Error",url:we||void 0});u.error(ht),i()};let q=!1;const oe=Pe=>{q||(u.next(T()),q=!0);let we={type:vo.DownloadProgress,loaded:Pe.loaded};Pe.lengthComputable&&(we.total=Pe.total),"text"===e.responseType&&m.responseText&&(we.partialText=m.responseText),u.next(we)},de=Pe=>{let we={type:vo.UploadProgress,loaded:Pe.loaded};Pe.lengthComputable&&(we.total=Pe.total),u.next(we)};m.addEventListener("load",O),m.addEventListener("error",H),m.addEventListener("timeout",H),m.addEventListener("abort",H),e.reportProgress&&(m.addEventListener("progress",oe),null!==b&&m.upload&&m.upload.addEventListener("progress",de));const xe=()=>i();m.addEventListener("loadend",xe);try{m.send(b)}catch(Pe){H(Pe)}return u.next({type:vo.Sent}),()=>{m.removeEventListener("loadend",xe),m.removeEventListener("error",H),m.removeEventListener("abort",H),m.removeEventListener("load",O),m.removeEventListener("timeout",H),i(),e.reportProgress&&(m.removeEventListener("progress",oe),null!==b&&m.upload&&m.upload.removeEventListener("progress",de)),m.readyState!==m.DONE&&m.abort()}})))}}return n.\u0275fac=function(e){return new(e||n)(Ne(lR))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const eM=new Ke("XSRF_ENABLED"),aF=new Ke("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),lF=new Ke("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class cF{}let GG=(()=>{class n{constructor(e,i,r){this.doc=e,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Xk(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn),Ne(wd),Ne(aF))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();function qG(n,t){const e=n.url.toLowerCase();if(!gt(eM)||"GET"===n.method||"HEAD"===n.method||e.startsWith("http://")||e.startsWith("https://"))return t(n);const i=gt(cF).getToken(),r=gt(lF);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),t(n)}var no=(()=>((no=no||{})[no.Interceptors=0]="Interceptors",no[no.LegacyInterceptors=1]="LegacyInterceptors",no[no.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",no[no.NoXsrfProtection=3]="NoXsrfProtection",no[no.JsonpSupport=4]="JsonpSupport",no[no.RequestsMadeViaParent=5]="RequestsMadeViaParent",no))();function O_(n,t){return{\u0275kind:n,\u0275providers:t}}function WG(...n){const t=[y1,sF,rF,{provide:g1,useExisting:rF},{provide:XS,useExisting:sF},{provide:kb,useValue:qG,multi:!0},{provide:eM,useValue:!0},{provide:cF,useClass:GG}];for(const e of n)t.push(...e.\u0275providers);return function Xy(n){return{\u0275providers:n}}(t)}const dF=new Ke("LEGACY_INTERCEPTOR_FN");let YG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[WG(O_(no.LegacyInterceptors,[{provide:dF,useFactory:LG},{provide:kb,useExisting:dF,multi:!0}]))]}),n})();var Rc=(()=>((Rc=Rc||{}).russia="russia",Rc.europe="europe",Rc.asia="asia",Rc.america="america",Rc))();let v1=(()=>{class n{constructor(e,i){this.http=e,this.injector=i,this.accessToken=this.injector.get(eC).mapbox,this.geocoding_url=gt(uT).mapbox}geoCodingGetAddress(e){let i=!1;Array.isArray(e)?(i=!0,e=e.join(",")):e=encodeURIComponent(e);const s=new URL(e+".json",this.geocoding_url);let u=new Wu;return i||(u=u.set("limit",5..toString())),u=u.set("access_token",this.accessToken),this.http.get(s.toString(),{params:u}).pipe(xt(m=>m.features.map(b=>({place:b.place_name,point:b.geometry}))))}}return n.\u0275fac=function(e){return new(e||n)(Ne(y1),Ne(Ro))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();function uF(n,t,e,i,r,s,u){try{var m=n[s](u),b=m.value}catch(E){return void e(E)}m.done?t(b):Promise.resolve(b).then(i,r)}function F_(n){return function(){var t=this,e=arguments;return new Promise(function(i,r){var s=n.apply(t,e);function u(b){uF(s,i,r,u,m,"next",b)}function m(b){uF(s,i,r,u,m,"throw",b)}u(void 0)})}}class tM extends Error{constructor(t,e="FunctionsError",i){super(t),this.name=e,this.context=i}}class iq extends tM{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class rq extends tM{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class oq extends tM{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}class aq{constructor(t,{headers:e={},customFetch:i}={}){this.url=t,this.headers=e,this.fetch=(n=>{let t;return t=n||(typeof fetch>"u"?(...e)=>function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})}(void 0,void 0,void 0,function*(){return yield(yield Promise.resolve().then(zi.t.bind(zi,472,23))).fetch(...e)}):fetch),(...e)=>t(...e)})(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var i;return function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:u}=e;let b,m={};u&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",b=u):"string"==typeof u?(m["Content-Type"]="text/plain",b=u):typeof FormData<"u"&&u instanceof FormData?b=u:(m["Content-Type"]="application/json",b=JSON.stringify(u)));const E=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),r),body:b}).catch(q=>{throw new iq(q)}),T=E.headers.get("x-relay-error");if(T&&"true"===T)throw new rq(E);if(!E.ok)throw new oq(E);let H,O=(null!==(i=E.headers.get("Content-Type"))&&void 0!==i?i:"text/plain").split(";")[0].trim();return H="application/json"===O?yield E.json():"application/octet-stream"===O?yield E.blob():"multipart/form-data"===O?yield E.formData():yield E.text(),{data:H,error:null}}catch(r){return{data:null,error:r}}})}}var hF=zi(472),pF=zi.n(hF);class lq{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,this.fetch=t.fetch?t.fetch:typeof fetch>"u"?pF():fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(t,e){var i=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(function(){var u=F_(function*(m){var b,E,T;let O=null,H=null,q=null,oe=m.status,de=m.statusText;if(m.ok){if("HEAD"!==i.method){const ht=yield m.text();""===ht||(H="text/csv"===i.headers.Accept||i.headers.Accept&&i.headers.Accept.includes("application/vnd.pgrst.plan+text")?ht:JSON.parse(ht))}const Pe=null===(b=i.headers.Prefer)||void 0===b?void 0:b.match(/count=(exact|planned|estimated)/),we=null===(E=m.headers.get("content-range"))||void 0===E?void 0:E.split("/");Pe&&we&&we.length>1&&(q=parseInt(we[1])),i.isMaybeSingle&&"GET"===i.method&&Array.isArray(H)&&(H.length>1?(O={code:"PGRST116",details:`Results contain ${H.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},H=null,q=null,oe=406,de="Not Acceptable"):H=1===H.length?H[0]:null)}else{const Pe=yield m.text();try{O=JSON.parse(Pe),Array.isArray(O)&&404===m.status&&(H=[],O=null,oe=200,de="OK")}catch{404===m.status&&""===Pe?(oe=204,de="No Content"):O={message:Pe}}if(O&&i.isMaybeSingle&&!(null===(T=O?.details)||void 0===T)&&T.includes("Results contain 0 rows")&&(O=null,oe=200,de="OK"),O&&i.shouldThrowOnError)throw O}return{error:O,data:H,count:q,status:oe,statusText:de}});return function(m){return u.apply(this,arguments)}}());return this.shouldThrowOnError||(s=s.catch(u=>{var m,b,E;return{error:{message:`${null!==(m=u?.name)&&void 0!==m?m:"FetchError"}: ${u?.message}`,details:`${null!==(b=u?.stack)&&void 0!==b?b:""}`,hint:"",code:`${null!==(E=u?.code)&&void 0!==E?E:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}}class cq extends lq{select(t){let e=!1;const i=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":('"'===r&&(e=!e),r)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:i,foreignTable:r}={}){const s=r?`${r}.order`:"order",u=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${u?`${u},`:""}${t}.${e?"asc":"desc"}${void 0===i?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e}={}){return this.url.searchParams.set(typeof e>"u"?"limit":`${e}.limit`,`${t}`),this}range(t,e,{foreignTable:i}={}){const s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(typeof i>"u"?"offset":`${i}.offset`,`${t}`),this.url.searchParams.set(s,""+(e-t+1)),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="GET"===this.method?"application/json":"application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:i=!1,buffers:r=!1,wal:s=!1,format:u="text"}={}){const m=[t?"analyze":null,e?"verbose":null,i?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|");return this.headers.Accept=`application/vnd.pgrst.plan+${u}; for="${this.headers.Accept}"; options=${m};`,this}rollback(){var t;return(null!==(t=this.headers.Prefer)&&void 0!==t?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class L_ extends cq{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){const i=e.map(r=>"string"==typeof r&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}contains(t,e){return"string"==typeof e?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return"string"==typeof e?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return this.url.searchParams.append(t,"string"==typeof e?`ov.${e}`:`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:i,type:r}={}){let s="";return"plain"===r?s="pl":"phrase"===r?s="ph":"websearch"===r&&(s="w"),this.url.searchParams.append(t,`${s}fts${void 0===i?"":`(${i})`}.${e}`),this}match(t){return Object.entries(t).forEach(([e,i])=>{this.url.searchParams.append(e,`eq.${i}`)}),this}not(t,e,i){return this.url.searchParams.append(t,`not.${e}.${i}`),this}or(t,{foreignTable:e}={}){return this.url.searchParams.append(e?`${e}.or`:"or",`(${t})`),this}filter(t,e,i){return this.url.searchParams.append(t,`${e}.${i}`),this}}class dq{constructor(t,{headers:e={},schema:i,fetch:r}){this.url=t,this.headers=e,this.schema=i,this.fetch=r}select(t,{head:e=!1,count:i}={}){const r=e?"HEAD":"GET";let s=!1;const u=(t??"*").split("").map(m=>/\s/.test(m)&&!s?"":('"'===m&&(s=!s),m)).join("");return this.url.searchParams.set("select",u),i&&(this.headers.Prefer=`count=${i}`),new L_({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:i=!0}={}){const s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),i||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const u=t.reduce((m,b)=>m.concat(Object.keys(b)),[]);if(u.length>0){const m=[...new Set(u)].map(b=>`"${b}"`);this.url.searchParams.set("columns",m.join(","))}}return new L_({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:i=!1,count:r,defaultToNull:s=!0}={}){const m=[`resolution=${i?"ignore":"merge"}-duplicates`];if(void 0!==e&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&m.push(this.headers.Prefer),r&&m.push(`count=${r}`),s||m.push("missing=default"),this.headers.Prefer=m.join(","),Array.isArray(t)){const b=t.reduce((E,T)=>E.concat(Object.keys(T)),[]);if(b.length>0){const E=[...new Set(b)].map(T=>`"${T}"`);this.url.searchParams.set("columns",E.join(","))}}return new L_({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){const r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),e&&r.push(`count=${e}`),this.headers.Prefer=r.join(","),new L_({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const i=[];return t&&i.push(`count=${t}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new L_({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const uq={"X-Client-Info":"postgrest-js/1.7.1"};class hq{constructor(t,{headers:e={},schema:i,fetch:r}={}){this.url=t,this.headers=Object.assign(Object.assign({},uq),e),this.schema=i,this.fetch=r}from(t){const e=new URL(`${this.url}/${t}`);return new dq(e,{headers:Object.assign({},this.headers),schema:this.schema,fetch:this.fetch})}rpc(t,e={},{head:i=!1,count:r}={}){let s;const u=new URL(`${this.url}/rpc/${t}`);let m;i?(s="HEAD",Object.entries(e).forEach(([E,T])=>{u.searchParams.append(E,`${T}`)})):(s="POST",m=e);const b=Object.assign({},this.headers);return r&&(b.Prefer=`count=${r}`),new L_({method:s,url:u,headers:b,schema:this.schema,body:m,fetch:this.fetch,allowEmpty:!1})}}var pq=zi(762);const fq={"X-Client-Info":"realtime-js/2.7.3"};var Aa=(()=>((Aa=Aa||{})[Aa.connecting=0]="connecting",Aa[Aa.open=1]="open",Aa[Aa.closing=2]="closing",Aa[Aa.closed=3]="closed",Aa))(),No=(()=>((No=No||{}).closed="closed",No.errored="errored",No.joined="joined",No.joining="joining",No.leaving="leaving",No))(),ns=(()=>((ns=ns||{}).close="phx_close",ns.error="phx_error",ns.join="phx_join",ns.reply="phx_reply",ns.leave="phx_leave",ns.access_token="access_token",ns))(),Pb=(()=>((Pb=Pb||{}).websocket="websocket",Pb))(),Gl=(()=>((Gl=Gl||{}).Connecting="connecting",Gl.Open="open",Gl.Closing="closing",Gl.Closed="closed",Gl))();class mF{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class _q{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e("string"==typeof t?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,e,i)}_decodeBroadcast(t,e,i){const r=e.getUint8(1),s=e.getUint8(2);let u=this.HEADER_LENGTH+2;const m=i.decode(t.slice(u,u+r));u+=r;const b=i.decode(t.slice(u,u+s));return u+=s,{ref:null,topic:m,event:b,payload:JSON.parse(i.decode(t.slice(u,t.byteLength)))}}}class nM{constructor(t,e,i={},r=1e4){this.channel=t,this.event=e,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,"rate limited"===this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})&&(this.rateLimited=!0))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var i;return this._hasReceived(t)&&e(null===(i=this.receivedResp)||void 0===i?void 0:i.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}class Ob{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:s,onLeave:u,onSync:m}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ob.syncState(this.state,r,s,u),this.pendingDiffs.forEach(b=>{this.state=Ob.syncDiff(this.state,b,s,u)}),this.pendingDiffs=[],m()}),this.channel._on(i.diff,{},r=>{const{onJoin:s,onLeave:u,onSync:m}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Ob.syncDiff(this.state,r,s,u),m())}),this.onJoin((r,s,u)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:u})}),this.onLeave((r,s,u)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,i,r){const s=this.cloneDeep(t),u=this.transformState(e),m={},b={};return this.map(s,(E,T)=>{u[E]||(b[E]=T)}),this.map(u,(E,T)=>{const O=s[E];if(O){const H=T.map(xe=>xe.presence_ref),q=O.map(xe=>xe.presence_ref),oe=T.filter(xe=>q.indexOf(xe.presence_ref)<0),de=O.filter(xe=>H.indexOf(xe.presence_ref)<0);oe.length>0&&(m[E]=oe),de.length>0&&(b[E]=de)}else m[E]=T}),this.syncDiff(s,{joins:m,leaves:b},i,r)}static syncDiff(t,e,i,r){const{joins:s,leaves:u}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(s,(m,b)=>{var E;const T=null!==(E=t[m])&&void 0!==E?E:[];if(t[m]=this.cloneDeep(b),T.length>0){const O=t[m].map(q=>q.presence_ref),H=T.filter(q=>O.indexOf(q.presence_ref)<0);t[m].unshift(...H)}i(m,T,b)}),this.map(u,(m,b)=>{let E=t[m];if(!E)return;const T=b.map(O=>O.presence_ref);E=E.filter(O=>T.indexOf(O.presence_ref)<0),t[m]=E,r(m,E,b),0===E.length&&delete t[m]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(i=>e(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,i)=>{const r=t[i];return e[i]="metas"in r?r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var vn=(()=>((vn=vn||{}).abstime="abstime",vn.bool="bool",vn.date="date",vn.daterange="daterange",vn.float4="float4",vn.float8="float8",vn.int2="int2",vn.int4="int4",vn.int4range="int4range",vn.int8="int8",vn.int8range="int8range",vn.json="json",vn.jsonb="jsonb",vn.money="money",vn.numeric="numeric",vn.oid="oid",vn.reltime="reltime",vn.text="text",vn.time="time",vn.timestamp="timestamp",vn.timestamptz="timestamptz",vn.timetz="timetz",vn.tsrange="tsrange",vn.tstzrange="tstzrange",vn))();const gF=(n,t,e={})=>{var i;const r=null!==(i=e.skipTypes)&&void 0!==i?i:[];return Object.keys(t).reduce((s,u)=>(s[u]=yq(u,n,t,r),s),{})},yq=(n,t,e,i)=>{const r=t.find(m=>m.name===n),s=r?.type,u=e[n];return s&&!i.includes(s)?_F(s,u):iM(u)},_F=(n,t)=>{if("_"===n.charAt(0)){const e=n.slice(1,n.length);return wq(t,e)}switch(n){case vn.bool:return vq(t);case vn.float4:case vn.float8:case vn.int2:case vn.int4:case vn.int8:case vn.numeric:case vn.oid:return bq(t);case vn.json:case vn.jsonb:return xq(t);case vn.timestamp:return Cq(t);default:return iM(t)}},iM=n=>n,vq=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},bq=n=>{if("string"==typeof n){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},xq=n=>{if("string"==typeof n)try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},wq=(n,t)=>{if("string"!=typeof n)return n;const e=n.length-1;if("{"===n[0]&&"}"===n[e]){let s;const u=n.slice(1,e);try{s=JSON.parse("["+u+"]")}catch{s=u?u.split(","):[]}return s.map(m=>_F(t,m))}return n},Cq=n=>"string"==typeof n?n.replace(" ","T"):n;var yF=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};class rM{constructor(t,e={config:{}},i){this.topic=t,this.params=e,this.socket=i,this.bindings={},this.state=No.closed,this.joinedOnce=!1,this.pushBuffer=[],this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},e.config),this.timeout=this.socket.timeout,this.joinPush=new nM(this,ns.join,this.params,this.timeout),this.rejoinTimer=new mF(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=No.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=No.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=No.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=No.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ns.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new Ob(this)}subscribe(t,e=this.timeout){var i,r;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:u}}=this.params;this._onError(E=>t&&t("CHANNEL_ERROR",E)),this._onClose(()=>t&&t("CLOSED"));const m={},b={broadcast:s,presence:u,postgres_changes:null!==(r=null===(i=this.bindings.postgres_changes)||void 0===i?void 0:i.map(E=>E.filter))&&void 0!==r?r:[]};this.socket.accessToken&&(m.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:b},m)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",({postgres_changes:E})=>{var T;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0!==E){const O=this.bindings.postgres_changes,H=null!==(T=O?.length)&&void 0!==T?T:0,q=[];for(let oe=0;oe<H;oe++){const de=O[oe],{filter:{event:xe,schema:Pe,table:we,filter:ht}}=de,Ct=E&&E[oe];if(!Ct||Ct.event!==xe||Ct.schema!==Pe||Ct.table!==we||Ct.filter!==ht)return this.unsubscribe(),void(t&&t("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes")));q.push(Object.assign(Object.assign({},de),{id:Ct.id}))}return this.bindings.postgres_changes=q,void(t&&t("SUBSCRIBED"))}t&&t("SUBSCRIBED")}).receive("error",E=>{t&&t("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(E).join(", ")||"error")))}).receive("timeout",()=>{t&&t("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(t,e={}){return yF(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(t={}){return yF(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,i){return this._on(t,e,i)}send(t,e={}){return new Promise(i=>{var r,s,u;const m=this._push(t.type,t,e.timeout||this.timeout);m.rateLimited&&i("rate limited"),"broadcast"===t.type&&!(null!==(u=null===(s=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===s?void 0:s.broadcast)&&void 0!==u&&u.ack)&&i("ok"),m.receive("ok",()=>i("ok")),m.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=No.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ns.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(i=>{const r=new nM(this,ns.leave,{},t);r.receive("ok",()=>{e(),i("ok")}).receive("timeout",()=>{e(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_push(t,e,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new nM(this,t,e,i);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(t,e,i){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,i){var r,s;const u=t.toLocaleLowerCase(),{close:m,error:b,leave:E,join:T}=ns;if(i&&[m,b,E,T].indexOf(u)>=0&&i!==this._joinRef())return;let H=this._onMessage(u,e,i);if(e&&!H)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(q=>{var oe,de,xe;return"*"===(null===(oe=q.filter)||void 0===oe?void 0:oe.event)||(null===(xe=null===(de=q.filter)||void 0===de?void 0:de.event)||void 0===xe?void 0:xe.toLocaleLowerCase())===u}).map(q=>q.callback(H,i)):null===(s=this.bindings[u])||void 0===s||s.filter(q=>{var oe,de,xe,Pe,we,ht;if(["broadcast","presence","postgres_changes"].includes(u)){if("id"in q){const Ct=q.id,$t=null===(oe=q.filter)||void 0===oe?void 0:oe.event;return Ct&&(null===(de=e.ids)||void 0===de?void 0:de.includes(Ct))&&("*"===$t||$t?.toLocaleLowerCase()===(null===(xe=e.data)||void 0===xe?void 0:xe.type.toLocaleLowerCase()))}{const Ct=null===(we=null===(Pe=q?.filter)||void 0===Pe?void 0:Pe.event)||void 0===we?void 0:we.toLocaleLowerCase();return"*"===Ct||Ct===(null===(ht=e?.event)||void 0===ht?void 0:ht.toLocaleLowerCase())}}return q.type.toLocaleLowerCase()===u}).map(q=>{if("object"==typeof H&&"ids"in H){const oe=H.data,{schema:de,table:xe,commit_timestamp:Pe,type:we,errors:ht}=oe;H=Object.assign(Object.assign({},{schema:de,table:xe,commit_timestamp:Pe,eventType:we,new:{},old:{},errors:ht}),this._getPayloadRecords(oe))}q.callback(H,i)})}_isClosed(){return this.state===No.closed}_isJoined(){return this.state===No.joined}_isJoining(){return this.state===No.joining}_isLeaving(){return this.state===No.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,i){const r=t.toLocaleLowerCase(),s={type:r,filter:e,callback:i};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(t,e){const i=t.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(r=>{var s;return!((null===(s=r.type)||void 0===s?void 0:s.toLocaleLowerCase())===i&&rM.isEqual(r.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(t[i]!==e[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ns.close,{},t)}_onError(t){this._on(ns.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=No.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return("INSERT"===t.type||"UPDATE"===t.type)&&(e.new=gF(t.columns,t.record)),("UPDATE"===t.type||"DELETE"===t.type)&&(e.old=gF(t.columns,t.old_record)),e}}var oM=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};const Eq=()=>{};class Dq{constructor(t,e){var i;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=fq,this.params={},this.timeout=1e4,this.transport=pq.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Eq,this.conn=null,this.sendBuffer=[],this.serializer=new _q,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this.endPoint=`${t}/${Pb.websocket}`,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.transport&&(this.transport=e.transport),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const r=null===(i=e?.params)||void 0===i?void 0:i.eventsPerSecond;r&&(this.eventsPerSecondLimitMs=Math.floor(1e3/r)),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e?.encode?e.encode:(s,u)=>u(JSON.stringify(s)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new mF(()=>oM(this,void 0,void 0,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t)))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return oM(this,void 0,void 0,function*(){const e=yield t.unsubscribe();return 0===this.channels.length&&this.disconnect(),e})}removeAllChannels(){return oM(this,void 0,void 0,function*(){const t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t})}log(t,e,i){this.logger(t,e,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Aa.connecting:return Gl.Connecting;case Aa.open:return Gl.Open;case Aa.closing:return Gl.Closing;default:return Gl.Closed}}isConnected(){return this.connectionState()===Gl.Open}channel(t,e={config:{}}){this.isConnected()||this.connect();const i=new rM(`realtime:${t}`,e,this);return this.channels.push(i),i}push(t){const{topic:e,event:i,payload:r,ref:s}=t;let u=()=>{this.encode(t,m=>{var b;null===(b=this.conn)||void 0===b||b.send(m)})};if(this.log("push",`${e} ${i} (${s})`,r),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(i)){if(this._throttle(u)())return"rate limited"}else u();else this.sendBuffer.push(u)}setAuth(t){this.accessToken=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(ns.access_token,{access_token:t})})}_makeRef(){let t=this.ref+1;return this.ref=t===this.ref?0:t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:i,event:r,payload:s,ref:u}=e;(u&&u===this.pendingHeartbeatRef||r===s?.type)&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${i} ${r} ${u&&"("+u+")"||""}`,s),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(r,s,u)),this.stateChangeCallbacks.message.forEach(m=>m(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(ns.error))}_appendParams(t,e){if(0===Object.keys(e).length)return t;const i=t.match(/\?/)?"&":"?";return`${t}${i}${new URLSearchParams(e)}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(t=this.conn)||void 0===t||t.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(t,e=this.eventsPerSecondLimitMs){return()=>!!this.inThrottle||(t(),e>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},e)),!1)}}class sM extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Hs(n){return"object"==typeof n&&null!==n&&"__isStorageError"in n}class Sq extends sM{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class vF extends sM{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var bF=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};const xF=n=>{let t;return t=n||(typeof fetch>"u"?(...e)=>bF(void 0,void 0,void 0,function*(){return yield(yield Promise.resolve().then(zi.t.bind(zi,472,23))).fetch(...e)}):fetch),(...e)=>t(...e)};var N_=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};const aM=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Tq=(n,t)=>N_(void 0,void 0,void 0,function*(){const e=yield bF(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Promise.resolve().then(zi.t.bind(zi,472,23))).Response:Response});n instanceof e?n.json().then(i=>{t(new Sq(aM(i),n.status||500))}).catch(i=>{t(new vF(aM(i),i))}):t(new vF(aM(n),n))}),Aq=(n,t,e,i)=>{const r={method:n,headers:t?.headers||{}};return"GET"===n?r:(r.headers=Object.assign({"Content-Type":"application/json"},t?.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),e))};function b1(n,t,e,i,r,s){return N_(this,void 0,void 0,function*(){return new Promise((u,m)=>{n(e,Aq(t,i,r,s)).then(b=>{if(!b.ok)throw b;return i?.noResolveJson?b:b.json()}).then(b=>u(b)).catch(b=>Tq(b,m))})})}function lM(n,t,e,i){return N_(this,void 0,void 0,function*(){return b1(n,"GET",t,e,i)})}function Cp(n,t,e,i,r){return N_(this,void 0,void 0,function*(){return b1(n,"POST",t,i,r,e)})}function Iq(n,t,e,i,r){return N_(this,void 0,void 0,function*(){return b1(n,"PUT",t,i,r,e)})}function wF(n,t,e,i,r){return N_(this,void 0,void 0,function*(){return b1(n,"DELETE",t,i,r,e)})}var ql=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};const kq={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},CF={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Rq{constructor(t,e={},i,r){this.url=t,this.headers=e,this.bucketId=i,this.fetch=xF(r)}uploadOrUpdate(t,e,i,r){return ql(this,void 0,void 0,function*(){try{let s;const u=Object.assign(Object.assign({},CF),r),m=Object.assign(Object.assign({},this.headers),"POST"===t&&{"x-upsert":String(u.upsert)});typeof Blob<"u"&&i instanceof Blob?(s=new FormData,s.append("cacheControl",u.cacheControl),s.append("",i)):typeof FormData<"u"&&i instanceof FormData?(s=i,s.append("cacheControl",u.cacheControl)):(s=i,m["cache-control"]=`max-age=${u.cacheControl}`,m["content-type"]=u.contentType);const b=this._removeEmptyFolders(e),E=this._getFinalPath(b),T=yield this.fetch(`${this.url}/object/${E}`,Object.assign({method:t,body:s,headers:m},u?.duplex?{duplex:u.duplex}:{}));return T.ok?{data:{path:b},error:null}:{data:null,error:yield T.json()}}catch(s){if(Hs(s))return{data:null,error:s};throw s}})}upload(t,e,i){return ql(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,i)})}uploadToSignedUrl(t,e,i,r){return ql(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),u=this._getFinalPath(s),m=new URL(this.url+`/object/upload/sign/${u}`);m.searchParams.set("token",e);try{let b;const E=Object.assign({upsert:CF.upsert},r),T=Object.assign(Object.assign({},this.headers),{"x-upsert":String(E.upsert)});typeof Blob<"u"&&i instanceof Blob?(b=new FormData,b.append("cacheControl",E.cacheControl),b.append("",i)):typeof FormData<"u"&&i instanceof FormData?(b=i,b.append("cacheControl",E.cacheControl)):(b=i,T["cache-control"]=`max-age=${E.cacheControl}`,T["content-type"]=E.contentType);const O=yield this.fetch(m.toString(),{method:"PUT",body:b,headers:T});return O.ok?{data:{path:s},error:null}:{data:null,error:yield O.json()}}catch(b){if(Hs(b))return{data:null,error:b};throw b}})}createSignedUploadUrl(t){return ql(this,void 0,void 0,function*(){try{let e=this._getFinalPath(t);const i=yield Cp(this.fetch,`${this.url}/object/upload/sign/${e}`,{},{headers:this.headers}),r=new URL(this.url+i.url),s=r.searchParams.get("token");if(!s)throw new sM("No token returned by API");return{data:{signedUrl:r.toString(),path:t,token:s},error:null}}catch(e){if(Hs(e))return{data:null,error:e};throw e}})}update(t,e,i){return ql(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,i)})}move(t,e){return ql(this,void 0,void 0,function*(){try{return{data:yield Cp(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers}),error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}copy(t,e){return ql(this,void 0,void 0,function*(){try{return{data:{path:(yield Cp(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers})).Key},error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}createSignedUrl(t,e,i){return ql(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),s=yield Cp(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:e},i?.transform?{transform:i.transform}:{}),{headers:this.headers});const u=i?.download?`&download=${!0===i.download?"":i.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${u}`)},{data:s,error:null}}catch(r){if(Hs(r))return{data:null,error:r};throw r}})}createSignedUrls(t,e,i){return ql(this,void 0,void 0,function*(){try{const r=yield Cp(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=i?.download?`&download=${!0===i.download?"":i.download}`:"";return{data:r.map(u=>Object.assign(Object.assign({},u),{signedUrl:u.signedURL?encodeURI(`${this.url}${u.signedURL}${s}`):null})),error:null}}catch(r){if(Hs(r))return{data:null,error:r};throw r}})}download(t,e){return ql(this,void 0,void 0,function*(){const r=typeof e?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(e?.transform||{}),u=s?`?${s}`:"";try{const m=this._getFinalPath(t);return{data:yield(yield lM(this.fetch,`${this.url}/${r}/${m}${u}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(m){if(Hs(m))return{data:null,error:m};throw m}})}getPublicUrl(t,e){const i=this._getFinalPath(t),r=[],s=e?.download?`download=${!0===e.download?"":e.download}`:"";""!==s&&r.push(s);const m=typeof e?.transform<"u"?"render/image":"object",b=this.transformOptsToQueryString(e?.transform||{});""!==b&&r.push(b);let E=r.join("&");return""!==E&&(E=`?${E}`),{data:{publicUrl:encodeURI(`${this.url}/${m}/public/${i}${E}`)}}}remove(t){return ql(this,void 0,void 0,function*(){try{return{data:yield wF(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(Hs(e))return{data:null,error:e};throw e}})}list(t,e,i){return ql(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},kq),e),{prefix:t||""});return{data:yield Cp(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(Hs(r))return{data:null,error:r};throw r}})}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const Pq={"X-Client-Info":"storage-js/2.5.1"};var B_=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};class Oq{constructor(t,e={},i){this.url=t,this.headers=Object.assign(Object.assign({},Pq),e),this.fetch=xF(i)}listBuckets(){return B_(this,void 0,void 0,function*(){try{return{data:yield lM(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Hs(t))return{data:null,error:t};throw t}})}getBucket(t){return B_(this,void 0,void 0,function*(){try{return{data:yield lM(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(Hs(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return B_(this,void 0,void 0,function*(){try{return{data:yield Cp(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}updateBucket(t,e){return B_(this,void 0,void 0,function*(){try{return{data:yield Iq(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(Hs(i))return{data:null,error:i};throw i}})}emptyBucket(t){return B_(this,void 0,void 0,function*(){try{return{data:yield Cp(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(Hs(e))return{data:null,error:e};throw e}})}deleteBucket(t){return B_(this,void 0,void 0,function*(){try{return{data:yield wF(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(Hs(e))return{data:null,error:e};throw e}})}}class Fq extends Oq{constructor(t,e={},i){super(t,e,i)}from(t){return new Rq(this.url,this.headers,t,this.fetch)}}const Vq=(n,t,e)=>{const i=(n=>{let t;return t=n||(typeof fetch>"u"?pF():fetch),(...e)=>t(...e)})(e),r=typeof Headers>"u"?hF.Headers:Headers;return(s,u)=>function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})}(void 0,void 0,void 0,function*(){var m;const b=null!==(m=yield t())&&void 0!==m?m:n;let E=new r(u?.headers);return E.has("apikey")||E.set("apikey",n),E.has("Authorization")||E.set("Authorization",`Bearer ${b}`),i(s,Object.assign(Object.assign({},u),{headers:E}))})};var mm=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};const Zu=()=>typeof document<"u",gm={tested:!1,writable:!1},x1=()=>{if(!Zu())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch{return!1}if(gm.tested)return gm.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),gm.tested=!0,gm.writable=!0}catch{gm.tested=!0,gm.writable=!1}return gm.writable};function Ia(n,t){var e;t||(t=(null===(e=window?.location)||void 0===e?void 0:e.href)||""),n=n.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+n+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}const EF=n=>{let t;return t=n||(typeof fetch>"u"?(...e)=>mm(void 0,void 0,void 0,function*(){return yield(yield Promise.resolve().then(zi.t.bind(zi,472,23))).fetch(...e)}):fetch),(...e)=>t(...e)},Gq=n=>"object"==typeof n&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"==typeof n.json,Fb=(n,t,e)=>mm(void 0,void 0,void 0,function*(){yield n.setItem(t,JSON.stringify(e))}),w1=(n,t)=>mm(void 0,void 0,void 0,function*(){const e=yield n.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),cM=(n,t)=>mm(void 0,void 0,void 0,function*(){yield n.removeItem(t)});class C1{constructor(){this.promise=new C1.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}function DF(n){const e=n.split(".");if(3!==e.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");return JSON.parse(function qq(n){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let i,r,s,u,m,b,E,e="",T=0;for(n=n.replace("-","+").replace("_","/");T<n.length;)u=t.indexOf(n.charAt(T++)),m=t.indexOf(n.charAt(T++)),b=t.indexOf(n.charAt(T++)),E=t.indexOf(n.charAt(T++)),i=u<<2|m>>4,r=(15&m)<<4|b>>2,s=(3&b)<<6|E,e+=String.fromCharCode(i),64!=b&&0!=r&&(e+=String.fromCharCode(r)),64!=E&&0!=s&&(e+=String.fromCharCode(s));return e}(e[1]))}function Yq(n){return("0"+n.toString(16)).substr(-2)}function E1(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=e.length;let r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(t),Array.from(t,Yq).join("")}function D1(n){return mm(this,void 0,void 0,function*(){if(typeof crypto>"u")return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=yield function Xq(n){return mm(this,void 0,void 0,function*(){const e=(new TextEncoder).encode(n),i=yield crypto.subtle.digest("SHA-256",e),r=new Uint8Array(i);return Array.from(r).map(s=>String.fromCharCode(s)).join("")})}(n);return function Kq(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(t)})}C1.promiseConstructor=Promise;class dM extends Error{constructor(t,e){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e}}function Ti(n){return"object"==typeof n&&null!==n&&"__isAuthError"in n}class Jq extends dM{constructor(t,e){super(t,e),this.name="AuthApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class SF extends dM{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class z_ extends dM{constructor(t,e,i){super(t),this.name=e,this.status=i}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class V_ extends z_{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class uM extends z_{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class S1 extends z_{constructor(t){super(t,"AuthInvalidCredentialsError",400)}}class Yu extends z_{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class hM extends z_{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class pM extends z_{constructor(t,e){super(t,"AuthRetryableFetchError",e)}}function MF(n){return Ti(n)&&"AuthRetryableFetchError"===n.name}var fM=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};const Lb=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),tW=[502,503,504];function TF(n){return fM(this,void 0,void 0,function*(){if(!Gq(n))throw new pM(Lb(n),0);if(tW.includes(n.status))throw new pM(Lb(n),n.status);let t;try{t=yield n.json()}catch(e){throw new SF(Lb(e),e)}throw new Jq(Lb(t),n.status||500)})}function Li(n,t,e,i){var r;return fM(this,void 0,void 0,function*(){const s=Object.assign({},i?.headers);i?.jwt&&(s.Authorization=`Bearer ${i.jwt}`);const u=null!==(r=i?.query)&&void 0!==r?r:{};i?.redirectTo&&(u.redirect_to=i.redirectTo);const m=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",b=yield function iW(n,t,e,i,r,s){return fM(this,void 0,void 0,function*(){const u=((n,t,e,i)=>{const r={method:n,headers:t?.headers||{}};return"GET"===n?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),e))})(t,i,r,s);let m;try{m=yield n(e,u)}catch(b){throw console.error(b),new pM(Lb(b),0)}if(m.ok||(yield TF(m)),i?.noResolveJson)return m;try{return yield m.json()}catch(b){yield TF(b)}})}(n,t,e+m,{headers:s,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(b):{data:Object.assign({},b),error:null}})}function Ep(n){var t;let e=null;return function aW(n){return n.access_token&&n.refresh_token&&n.expires_in}(n)&&(e=Object.assign({},n),e.expires_at=function Hq(n){return Math.round(Date.now()/1e3)+n}(n.expires_in)),{data:{session:e,user:null!==(t=n.user)&&void 0!==t?t:n},error:null}}function _m(n){var t;return{data:{user:null!==(t=n.user)&&void 0!==t?t:n},error:null}}function rW(n){return{data:n,error:null}}function oW(n){const{action_link:t,email_otp:e,hashed_token:i,redirect_to:r,verification_type:s}=n,u=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e}(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:e,hashed_token:i,redirect_to:r,verification_type:s},user:Object.assign({},u)},error:null}}function sW(n){return n}var Nd=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};class cW{constructor({url:t="",headers:e={},fetch:i}){this.url=t,this.headers=e,this.fetch=EF(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t,e="global"){return Nd(this,void 0,void 0,function*(){try{return yield Li(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Ti(i))return{data:null,error:i};throw i}})}inviteUserByEmail(t,e={}){return Nd(this,void 0,void 0,function*(){try{return yield Li(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:_m})}catch(i){if(Ti(i))return{data:{user:null},error:i};throw i}})}generateLink(t){return Nd(this,void 0,void 0,function*(){try{const{options:e}=t,i=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e}(t,["options"]),r=Object.assign(Object.assign({},i),e);return"newEmail"in i&&(r.new_email=i?.newEmail,delete r.newEmail),yield Li(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:oW,redirectTo:e?.redirectTo})}catch(e){if(Ti(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return Nd(this,void 0,void 0,function*(){try{return yield Li(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:_m})}catch(e){if(Ti(e))return{data:{user:null},error:e};throw e}})}listUsers(t){var e,i,r,s,u,m,b;return Nd(this,void 0,void 0,function*(){try{const E={nextPage:null,lastPage:0,total:0},T=yield Li(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(i=null===(e=t?.page)||void 0===e?void 0:e.toString())&&void 0!==i?i:"",per_page:null!==(s=null===(r=t?.perPage)||void 0===r?void 0:r.toString())&&void 0!==s?s:""},xform:sW});if(T.error)throw T.error;const O=yield T.json(),H=null!==(u=T.headers.get("x-total-count"))&&void 0!==u?u:0,q=null!==(b=null===(m=T.headers.get("link"))||void 0===m?void 0:m.split(","))&&void 0!==b?b:[];return q.length>0&&(q.forEach(oe=>{const de=parseInt(oe.split(";")[0].split("=")[1].substring(0,1)),xe=JSON.parse(oe.split(";")[1].split("=")[1]);E[`${xe}Page`]=de}),E.total=parseInt(H)),{data:Object.assign(Object.assign({},O),E),error:null}}catch(E){if(Ti(E))return{data:{users:[]},error:E};throw E}})}getUserById(t){return Nd(this,void 0,void 0,function*(){try{return yield Li(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:_m})}catch(e){if(Ti(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return Nd(this,void 0,void 0,function*(){try{return yield Li(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:_m})}catch(i){if(Ti(i))return{data:{user:null},error:i};throw i}})}deleteUser(t,e=!1){return Nd(this,void 0,void 0,function*(){try{return yield Li(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:_m})}catch(i){if(Ti(i))return{data:{user:null},error:i};throw i}})}_listFactors(t){return Nd(this,void 0,void 0,function*(){try{const{data:e,error:i}=yield Li(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:e,error:i}}catch(e){if(Ti(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return Nd(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(Ti(e))return{data:null,error:e};throw e}})}}const IF={getItem:n=>x1()?globalThis.localStorage.getItem(n):null,setItem:(n,t)=>{x1()&&globalThis.localStorage.setItem(n,t)},removeItem:n=>{x1()&&globalThis.localStorage.removeItem(n)}};var Rn=function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})};!function fW(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}();const mW={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:{"X-Client-Info":"gotrue-js/2.39.0"},flowType:"implicit",debug:!1};let gW=(()=>{class n{constructor(e){var i;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null,this.instanceID=n.nextInstanceID,n.nextInstanceID+=1,this.instanceID>0&&Zu()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},mW),e);if(this.logDebugMessages=r.debug,this.inMemorySession=null,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.storage=r.storage||IF,this.admin=new cW({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=EF(r.fetch),this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession&&this.storage===IF&&!x1()&&console.warn("No storage option exists to persist the session, which may result in unexpected behavior when using auth.\n        If you want to set persistSession to true, please provide a storage option or you may set persistSession to false to disable this warning."),Zu()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}null===(i=this.broadcastChannel)||void 0===i||i.addEventListener("message",s=>Rn(this,void 0,void 0,function*(){this._debug("received broadcast notification from other tab or client",s),yield this._notifyAllSubscribers(s.data.event,s.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&console.log(`GoTrueClient@${this.instanceID} ${(new Date).toISOString()}`,...e),this}initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}_initialize(){return Rn(this,void 0,void 0,function*(){if(this.initializePromise)return this.initializePromise;try{const e=!!Zu()&&(yield this._isPKCEFlow());if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:i,error:r}=yield this._getSessionFromUrl(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),yield this._removeSession(),{error:r};const{session:s,redirectType:u}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",u),yield this._saveSession(s),setTimeout(()=>Rn(this,void 0,void 0,function*(){"recovery"===u?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",s):yield this._notifyAllSubscribers("SIGNED_IN",s)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(e){return Ti(e)?{error:e}:{error:new SF("Unexpected error during initialization",e)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signUp(e){var i,r,s;return Rn(this,void 0,void 0,function*(){try{let u;if(yield this._removeSession(),"email"in e){const{email:O,password:H,options:q}=e;let oe=null,de=null;if("pkce"===this.flowType){const xe=E1();yield Fb(this.storage,`${this.storageKey}-code-verifier`,xe),oe=yield D1(xe),de=xe===oe?"plain":"s256"}u=yield Li(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:q?.emailRedirectTo,body:{email:O,password:H,data:null!==(i=q?.data)&&void 0!==i?i:{},gotrue_meta_security:{captcha_token:q?.captchaToken},code_challenge:oe,code_challenge_method:de},xform:Ep})}else{if(!("phone"in e))throw new S1("You must provide either an email or phone number and a password");{const{phone:O,password:H,options:q}=e;u=yield Li(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:O,password:H,data:null!==(r=q?.data)&&void 0!==r?r:{},channel:null!==(s=q?.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:q?.captchaToken}},xform:Ep})}}const{data:m,error:b}=u;if(b||!m)return{data:{user:null,session:null},error:b};const E=m.session,T=m.user;return m.session&&(yield this._saveSession(m.session),yield this._notifyAllSubscribers("SIGNED_IN",E)),{data:{user:T,session:E},error:null}}catch(u){if(Ti(u))return{data:{user:null,session:null},error:u};throw u}})}signInWithPassword(e){return Rn(this,void 0,void 0,function*(){try{let i;if(yield this._removeSession(),"email"in e){const{email:u,password:m,options:b}=e;i=yield Li(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:u,password:m,gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:Ep})}else{if(!("phone"in e))throw new S1("You must provide either an email or phone number and a password");{const{phone:u,password:m,options:b}=e;i=yield Li(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:u,password:m,gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:Ep})}}const{data:r,error:s}=i;return s?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(yield this._saveSession(r.session),yield this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:{user:r.user,session:r.session},error:s}):{data:{user:null,session:null},error:new uM}}catch(i){if(Ti(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithOAuth(e){var i,r,s,u;return Rn(this,void 0,void 0,function*(){return yield this._removeSession(),yield this._handleProviderSignIn(e.provider,{redirectTo:null===(i=e.options)||void 0===i?void 0:i.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(u=e.options)||void 0===u?void 0:u.skipBrowserRedirect})})}exchangeCodeForSession(e){return Rn(this,void 0,void 0,function*(){const i=yield w1(this.storage,`${this.storageKey}-code-verifier`),{data:r,error:s}=yield Li(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:Ep});return yield cM(this.storage,`${this.storageKey}-code-verifier`),s?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(yield this._saveSession(r.session),yield this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:s}):{data:{user:null,session:null},error:new uM}})}signInWithIdToken(e){return Rn(this,void 0,void 0,function*(){yield this._removeSession();try{const{options:i,provider:r,token:s,access_token:u,nonce:m}=e,b=yield Li(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:u,nonce:m,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:Ep}),{data:E,error:T}=b;return T?{data:{user:null,session:null},error:T}:E&&E.session&&E.user?(E.session&&(yield this._saveSession(E.session),yield this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:E,error:T}):{data:{user:null,session:null},error:new uM}}catch(i){if(Ti(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithOtp(e){var i,r,s,u,m;return Rn(this,void 0,void 0,function*(){try{if(yield this._removeSession(),"email"in e){const{email:b,options:E}=e;let T=null,O=null;if("pkce"===this.flowType){const q=E1();yield Fb(this.storage,`${this.storageKey}-code-verifier`,q),T=yield D1(q),O=q===T?"plain":"s256"}const{error:H}=yield Li(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:b,data:null!==(i=E?.data)&&void 0!==i?i:{},create_user:null===(r=E?.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:E?.captchaToken},code_challenge:T,code_challenge_method:O},redirectTo:E?.emailRedirectTo});return{data:{user:null,session:null},error:H}}if("phone"in e){const{phone:b,options:E}=e,{data:T,error:O}=yield Li(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:b,data:null!==(s=E?.data)&&void 0!==s?s:{},create_user:null===(u=E?.shouldCreateUser)||void 0===u||u,gotrue_meta_security:{captcha_token:E?.captchaToken},channel:null!==(m=E?.channel)&&void 0!==m?m:"sms"}});return{data:{user:null,session:null,messageId:T?.message_id},error:O}}throw new S1("You must provide either an email or phone number.")}catch(b){if(Ti(b))return{data:{user:null,session:null},error:b};throw b}})}verifyOtp(e){var i,r;return Rn(this,void 0,void 0,function*(){try{"email_change"!==e.type&&"phone_change"!==e.type&&(yield this._removeSession());const{data:s,error:u}=yield Li(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:null===(i=e.options)||void 0===i?void 0:i.captchaToken}}),redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,xform:Ep});if(u)throw u;if(!s)throw new Error("An error occurred on token verification.");const m=s.session,b=s.user;return m?.access_token&&(yield this._saveSession(m),yield this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:b,session:m},error:null}}catch(s){if(Ti(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithSSO(e){var i,r,s;return Rn(this,void 0,void 0,function*(){try{return yield this._removeSession(),yield Li(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(i=e.options)||void 0===i?void 0:i.redirectTo)&&void 0!==r?r:void 0}),null!==(s=e?.options)&&void 0!==s&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:rW})}catch(u){if(Ti(u))return{data:null,error:u};throw u}})}reauthenticate(){return Rn(this,void 0,void 0,function*(){try{const{data:{session:e},error:i}=yield this.getSession();if(i)throw i;if(!e)throw new V_;const{error:r}=yield Li(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:r}}catch(e){if(Ti(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return Rn(this,void 0,void 0,function*(){try{yield this._removeSession();const i=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:u}=e,{error:m}=yield Li(this.fetch,"POST",i,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:u?.captchaToken}}});return{data:{user:null,session:null},error:m}}if("phone"in e){const{phone:r,type:s,options:u}=e,{data:m,error:b}=yield Li(this.fetch,"POST",i,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:u?.captchaToken}}});return{data:{user:null,session:null,messageId:m?.message_id},error:b}}throw new S1("You must provide either an email or phone number and a type")}catch(i){if(Ti(i))return{data:{user:null,session:null},error:i};throw i}})}getSession(){return Rn(this,void 0,void 0,function*(){yield this.initializePromise,this._debug("#getSession()","begin");try{let e=null;if(this.persistSession){const u=yield w1(this.storage,this.storageKey);this._debug("#getSession()","session from storage",u),null!==u&&(this._isValidSession(u)?e=u:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession()))}else e=this.inMemorySession,this._debug("#getSession()","session from memory",e);if(!e)return{data:{session:null},error:null};const i=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#getSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i)return{data:{session:e},error:null};const{session:r,error:s}=yield this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#getSession()","end")}})}getUser(e){var i,r;return Rn(this,void 0,void 0,function*(){try{if(!e){const{data:s,error:u}=yield this.getSession();if(u)throw u;e=null!==(r=null===(i=s.session)||void 0===i?void 0:i.access_token)&&void 0!==r?r:void 0}return yield Li(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:_m})}catch(s){if(Ti(s))return{data:{user:null},error:s};throw s}})}updateUser(e,i={}){return Rn(this,void 0,void 0,function*(){try{const{data:r,error:s}=yield this.getSession();if(s)throw s;if(!r.session)throw new V_;const u=r.session,{data:m,error:b}=yield Li(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:i?.emailRedirectTo,body:e,jwt:u.access_token,xform:_m});if(b)throw b;return u.user=m.user,yield this._saveSession(u),yield this._notifyAllSubscribers("USER_UPDATED",u),{data:{user:u.user},error:null}}catch(r){if(Ti(r))return{data:{user:null},error:r};throw r}})}_decodeJWT(e){return DF(e)}setSession(e){return Rn(this,void 0,void 0,function*(){try{if(!e.access_token||!e.refresh_token)throw new V_;const i=Date.now()/1e3;let r=i,s=!0,u=null;const m=DF(e.access_token);if(m.exp&&(r=m.exp,s=r<=i),s){const{session:b,error:E}=yield this._callRefreshToken(e.refresh_token);if(E)return{data:{user:null,session:null},error:E};if(!b)return{data:{user:null,session:null},error:null};u=b}else{const{data:b,error:E}=yield this.getUser(e.access_token);if(E)throw E;u={access_token:e.access_token,refresh_token:e.refresh_token,user:b.user,token_type:"bearer",expires_in:r-i,expires_at:r},yield this._saveSession(u),yield this._notifyAllSubscribers("SIGNED_IN",u)}return{data:{user:u.user,session:u},error:null}}catch(i){if(Ti(i))return{data:{session:null,user:null},error:i};throw i}})}refreshSession(e){var i;return Rn(this,void 0,void 0,function*(){try{if(!e){const{data:u,error:m}=yield this.getSession();if(m)throw m;e=null!==(i=u.session)&&void 0!==i?i:void 0}if(!e?.refresh_token)throw new V_;const{session:r,error:s}=yield this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}catch(r){if(Ti(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromUrl(e){return Rn(this,void 0,void 0,function*(){try{if(!Zu())throw new Yu("No browser detected.");if("implicit"===this.flowType&&!this._isImplicitGrantFlow())throw new Yu("Not a valid implicit grant flow url.");if("pkce"==this.flowType&&!e)throw new hM("Not a valid PKCE flow url.");if(e){const Pe=Ia("code");if(!Pe)throw new hM("No code detected.");const{data:we,error:ht}=yield this.exchangeCodeForSession(Pe);if(ht)throw ht;if(!we.session)throw new hM("No session detected.");let Ct=new URL(window.location.href);return Ct.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Ct.toString()),{data:{session:we.session,redirectType:null},error:null}}const i=Ia("error_description");if(i){const Pe=Ia("error_code");if(!Pe)throw new Yu("No error_code detected.");const we=Ia("error");throw we?new Yu(i,{error:we,code:Pe}):new Yu("No error detected.")}const r=Ia("provider_token"),s=Ia("provider_refresh_token"),u=Ia("access_token");if(!u)throw new Yu("No access_token detected.");const m=Ia("expires_in");if(!m)throw new Yu("No expires_in detected.");const b=Ia("refresh_token");if(!b)throw new Yu("No refresh_token detected.");const E=Ia("token_type");if(!E)throw new Yu("No token_type detected.");const O=Math.round(Date.now()/1e3)+parseInt(m),{data:H,error:q}=yield this.getUser(u);if(q)throw q;const oe=H.user,de={provider_token:r,provider_refresh_token:s,access_token:u,expires_in:parseInt(m),expires_at:O,refresh_token:b,token_type:E,user:oe},xe=Ia("type");return window.location.hash="",this._debug("#_getSessionFromUrl()","clearing window.location.hash"),{data:{session:de,redirectType:xe},error:null}}catch(i){if(Ti(i))return{data:{session:null,redirectType:null},error:i};throw i}})}_isImplicitGrantFlow(){return Zu()&&(!!Ia("access_token")||!!Ia("error_description"))}_isPKCEFlow(){return Rn(this,void 0,void 0,function*(){const e=yield w1(this.storage,`${this.storageKey}-code-verifier`);return!!Ia("code")&&!!e})}signOut({scope:e}={scope:"global"}){var i;return Rn(this,void 0,void 0,function*(){const{data:r,error:s}=yield this.getSession();if(s)return{error:s};const u=null===(i=r.session)||void 0===i?void 0:i.access_token;if(u){const{error:m}=yield this.admin.signOut(u,e);if(m&&(!function Qq(n){return Ti(n)&&"AuthApiError"===n.name}(m)||404!==m.status&&401!==m.status))return{error:m}}return"others"!==e&&(yield this._removeSession(),yield cM(this.storage,`${this.storageKey}-code-verifier`),yield this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const i=function $q(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const t=16*Math.random()|0;return("x"==n?t:3&t|8).toString(16)})}(),r={id:i,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,r),this._emitInitialSession(i),{data:{subscription:r}}}_emitInitialSession(e){var i,r;return Rn(this,void 0,void 0,function*(){try{const{data:{session:s},error:u}=yield this.getSession();if(u)throw u;yield null===(i=this.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback("INITIAL_SESSION",s),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){yield null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}resetPasswordForEmail(e,i={}){return Rn(this,void 0,void 0,function*(){let r=null,s=null;if("pkce"===this.flowType){const u=E1();yield Fb(this.storage,`${this.storageKey}-code-verifier`,u),r=yield D1(u),s=u===r?"plain":"s256"}try{return yield Li(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:this.headers,redirectTo:i.redirectTo})}catch(u){if(Ti(u))return{data:null,error:u};throw u}})}_refreshAccessToken(e){return Rn(this,void 0,void 0,function*(){const i=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{const r=Date.now();return yield function Zq(n,t){return new Promise((i,r)=>{mm(this,void 0,void 0,function*(){for(let s=0;s<1/0;s++)try{const u=yield n(s);if(!t(s,null,u))return void i(u)}catch(u){if(!t(s,u))return void r(u)}})})}(s=>Rn(this,void 0,void 0,function*(){return yield function Wq(n){return new Promise(t=>{setTimeout(()=>t(null),n)})}(200*s),this._debug(i,"refreshing attempt",s),yield Li(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ep})}),(s,u,m)=>m&&m.error&&MF(m.error)&&Date.now()+200*(s+1)-r<3e4)}catch(r){if(this._debug(i,"error",r),Ti(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(i,"end")}})}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,i){return Rn(this,void 0,void 0,function*(){const r=yield this._getUrlForProvider(e,{redirectTo:i.redirectTo,scopes:i.scopes,queryParams:i.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",i,"url",r),Zu()&&!i.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}})}_recoverAndRefresh(){var e;return Rn(this,void 0,void 0,function*(){const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=yield w1(this.storage,this.storageKey);if(this._debug(i,"session from storage",r),!this._isValidSession(r))return this._debug(i,"session is not valid"),void(null!==r&&(yield this._removeSession()));const s=Math.round(Date.now()/1e3),u=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)<s+10;if(this._debug(i,`session has${u?"":" not"} expired with margin of 10s`),u){if(this.autoRefreshToken&&r.refresh_token){const{error:m}=yield this._callRefreshToken(r.refresh_token);m&&(console.error(m),MF(m)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",m),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(i,"error",r),void console.error(r)}finally{this._debug(i,"end")}})}_callRefreshToken(e){var i,r;return Rn(this,void 0,void 0,function*(){if(!e)throw new V_;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new C1;const{data:u,error:m}=yield this._refreshAccessToken(e);if(m)throw m;if(!u.session)throw new V_;yield this._saveSession(u.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",u.session);const b={session:u.session,error:null};return this.refreshingDeferred.resolve(b),b}catch(u){if(this._debug(s,"error",u),Ti(u)){const m={session:null,error:u};return null===(i=this.refreshingDeferred)||void 0===i||i.resolve(m),m}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(u),u}finally{this.refreshingDeferred=null,this._debug(s,"end")}})}_notifyAllSubscribers(e,i,r=!0){return Rn(this,void 0,void 0,function*(){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",i,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:i});const u=[],m=Array.from(this.stateChangeEmitters.values()).map(b=>Rn(this,void 0,void 0,function*(){try{yield b.callback(e,i)}catch(E){u.push(E)}}));if(yield Promise.all(m),u.length>0){for(let b=0;b<u.length;b+=1)console.error(u[b]);throw u[0]}}finally{this._debug(s,"end")}})}_saveSession(e){return Rn(this,void 0,void 0,function*(){this._debug("#_saveSession()",e),this.persistSession||(this.inMemorySession=e),this.persistSession&&e.expires_at&&(yield this._persistSession(e))})}_persistSession(e){return this._debug("#_persistSession()",e),Fb(this.storage,this.storageKey,e)}_removeSession(){return Rn(this,void 0,void 0,function*(){this._debug("#_removeSession()"),this.persistSession?yield cM(this.storage,this.storageKey):this.inMemorySession=null})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Zu()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(i){console.error("removing visibilitychange callback failed",i)}}_startAutoRefresh(){return Rn(this,void 0,void 0,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():typeof Deno<"u"&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),yield this._autoRefreshTokenTick()})}_stopAutoRefresh(){return Rn(this,void 0,void 0,function*(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return Rn(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return Rn(this,void 0,void 0,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return Rn(this,void 0,void 0,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{const e=Date.now();try{const{data:{session:i}}=yield this.getSession();if(!i||!i.refresh_token||!i.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*i.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&(yield this._callRefreshToken(i.refresh_token))}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}_handleVisibilityChange(){return Rn(this,void 0,void 0,function*(){if(this._debug("#_handleVisibilityChange()"),!Zu()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>Rn(this,void 0,void 0,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return Rn(this,void 0,void 0,function*(){this._debug(`#_onVisibilityChanged(${e})`,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(e||(yield this.initializePromise,yield this._recoverAndRefresh(),this._debug("#_onVisibilityChanged()","finished waiting for initialize, _recoverAndRefresh")),this.autoRefreshToken&&this._startAutoRefresh()):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,i){return Rn(this,void 0,void 0,function*(){const r=[`provider=${encodeURIComponent(e)}`];if(i?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),"pkce"===this.flowType){const s=E1();yield Fb(this.storage,`${this.storageKey}-code-verifier`,s);const u=yield D1(s),m=s===u?"plain":"s256";this._debug("PKCE","code verifier",`${s.substring(0,5)}...`,"code challenge",u,"method",m);const b=new URLSearchParams({code_challenge:`${encodeURIComponent(u)}`,code_challenge_method:`${encodeURIComponent(m)}`});r.push(b.toString())}if(i?.queryParams){const s=new URLSearchParams(i.queryParams);r.push(s.toString())}return`${this.url}/authorize?${r.join("&")}`})}_unenroll(e){var i;return Rn(this,void 0,void 0,function*(){try{const{data:r,error:s}=yield this.getSession();return s?{data:null,error:s}:yield Li(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(i=r?.session)||void 0===i?void 0:i.access_token})}catch(r){if(Ti(r))return{data:null,error:r};throw r}})}_enroll(e){var i,r;return Rn(this,void 0,void 0,function*(){try{const{data:s,error:u}=yield this.getSession();if(u)return{data:null,error:u};const{data:m,error:b}=yield Li(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:null===(i=s?.session)||void 0===i?void 0:i.access_token});return b?{data:null,error:b}:(!(null===(r=m?.totp)||void 0===r)&&r.qr_code&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})}catch(s){if(Ti(s))return{data:null,error:s};throw s}})}_verify(e){var i;return Rn(this,void 0,void 0,function*(){try{const{data:r,error:s}=yield this.getSession();if(s)return{data:null,error:s};const{data:u,error:m}=yield Li(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(i=r?.session)||void 0===i?void 0:i.access_token});return m?{data:null,error:m}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),{data:u,error:m})}catch(r){if(Ti(r))return{data:null,error:r};throw r}})}_challenge(e){var i;return Rn(this,void 0,void 0,function*(){try{const{data:r,error:s}=yield this.getSession();return s?{data:null,error:s}:yield Li(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:null===(i=r?.session)||void 0===i?void 0:i.access_token})}catch(r){if(Ti(r))return{data:null,error:r};throw r}})}_challengeAndVerify(e){return Rn(this,void 0,void 0,function*(){const{data:i,error:r}=yield this._challenge({factorId:e.factorId});return r?{data:null,error:r}:yield this._verify({factorId:e.factorId,challengeId:i.id,code:e.code})})}_listFactors(){return Rn(this,void 0,void 0,function*(){const{data:{user:e},error:i}=yield this.getUser();if(i)return{data:null,error:i};const r=e?.factors||[],s=r.filter(u=>"totp"===u.factor_type&&"verified"===u.status);return{data:{all:r,totp:s},error:null}})}_getAuthenticatorAssuranceLevel(){var e,i;return Rn(this,void 0,void 0,function*(){const{data:{session:r},error:s}=yield this.getSession();if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const u=this._decodeJWT(r.access_token);let m=null;u.aal&&(m=u.aal);let b=m;return(null!==(i=null===(e=r.user.factors)||void 0===e?void 0:e.filter(O=>"verified"===O.status))&&void 0!==i?i:[]).length>0&&(b="aal2"),{data:{currentLevel:m,nextLevel:b,currentAuthenticationMethods:u.amr||[]},error:null}})}}return n.nextInstanceID=0,n})();class _W extends gW{constructor(t){super(t)}}const vW={headers:{"X-Client-Info":"supabase-js/2.26.0"}},bW={schema:"public"},xW={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wW={};class CW{constructor(t,e,i){var r,s,u,m,b,E,T,O;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const H=function Uq(n){return n.replace(/\/$/,"")}(t);this.realtimeUrl=`${H}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${H}/auth/v1`,this.storageUrl=`${H}/storage/v1`,this.functionsUrl=`${H}/functions/v1`;const q=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,de=function jq(n,t){const{db:e,auth:i,realtime:r,global:s}=n,{db:u,auth:m,realtime:b,global:E}=t;return{db:Object.assign(Object.assign({},u),e),auth:Object.assign(Object.assign({},m),i),realtime:Object.assign(Object.assign({},b),r),global:Object.assign(Object.assign({},E),s)}}(i??{},{db:bW,realtime:wW,auth:Object.assign(Object.assign({},xW),{storageKey:q}),global:vW});this.storageKey=null!==(s=null===(r=de.auth)||void 0===r?void 0:r.storageKey)&&void 0!==s?s:"",this.headers=null!==(m=null===(u=de.global)||void 0===u?void 0:u.headers)&&void 0!==m?m:{},this.auth=this._initSupabaseAuthClient(null!==(b=de.auth)&&void 0!==b?b:{},this.headers,null===(E=de.global)||void 0===E?void 0:E.fetch),this.fetch=Vq(e,this._getAccessToken.bind(this),null===(T=de.global)||void 0===T?void 0:T.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},de.realtime)),this.rest=new hq(`${H}/rest/v1`,{headers:this.headers,schema:null===(O=de.db)||void 0===O?void 0:O.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new aq(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Fq(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}rpc(t,e={},i){return this.rest.rpc(t,e,i)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return function(n,t,e,i){return new(e||(e=Promise))(function(s,u){function m(T){try{E(i.next(T))}catch(O){u(O)}}function b(T){try{E(i.throw(T))}catch(O){u(O)}}function E(T){T.done?s(T.value):function r(s){return s instanceof e?s:new e(function(u){u(s)})}(T.value).then(m,b)}E((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){const{data:i}=yield this.auth.getSession();return null!==(e=null===(t=i.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:r,storageKey:s,flowType:u},m,b){return new _W({url:this.authUrl,headers:Object.assign(Object.assign({},{Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`}),m),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:r,flowType:u,fetch:b})}_initRealtimeClient(t){return new Dq(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,i)=>{this._handleTokenChanged(e,"CLIENT",i?.access_token)})}_handleTokenChanged(t,e,i){"TOKEN_REFRESHED"!==t&&"SIGNED_IN"!==t||this.changedAccessToken===i?"SIGNED_OUT"===t&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==e&&this.auth.signOut(),this.changedAccessToken=void 0):(this.realtime.setAuth(i??null),this.changedAccessToken=i)}}let DW=(()=>{class n{constructor(e,i,r){this._session=null,this.loading=!1,this.supabase=((n,t,e)=>new CW(n,t,void 0))(e.supabase,i.supabase),this.user=r.supabase}get(){return lw(()=>this.getData())}getData(){var e=this;return F_(function*(){try{yield e.signIn();const{data:i,error:r}=yield e.supabase.from("festivals").select();if(r)throw r;return i}catch(i){return i instanceof Error&&console.error(i.message),[]}})()}festivals(){return this.supabase.from("festivals").select("*")}signIn(){var e=this;return F_(function*(){try{const{error:i}=yield e.supabase.auth.signInWithPassword(e.user);if(i)throw i}catch(i){if(i instanceof Error)throw console.error(i.message),i}})()}}return n.\u0275fac=function(e){return new(e||n)(Ne(uT),Ne(eC),Ne(MN))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),mM=(()=>{class n{constructor(e){this.supabase=e,this.exampleFest={title:"\u0424\u0435\u0441\u0442\u0438\u0432\u0430\u043b\u044c \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043c\u0443\u0437\u044b\u043a\u0438 ",place:"\u041a\u0440\u0430\u0441\u043d\u043e\u0434\u0430\u0440",date:{start:new Date(2023,6,10),end:new Date(2023,6,15)}}}swapCoordinates(e){return e.map(i=>(i.coordinates.forEach(r=>r.reverse()),i))}deserializeDate(e){return e.map(i=>({...i,coordinates:i.coordinates,date:i.date?.map(r=>({start:new Date(r.start),end:new Date(r.end)}))||null}))}get(){return this.supabase.get().pipe(xt(this.swapCoordinates),xt(this.deserializeDate))}getAllFestivalsCoordinates(e){return e.map(i=>i.coordinates).flat()}}return n.\u0275fac=function(e){return new(e||n)(Ne(DW))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const RF="festivals";let SW=(()=>{class n{constructor(e){this.festService=e,this.storage=window.localStorage}set(e){this.setLocalState(e)}clear(){this.storage.clear()}reset(){this.festService.get().subscribe(e=>this.setLocalState(e))}setLocalState(e){this.storage.setItem(RF,JSON.stringify(e))}get(){const e=this.storage.getItem(RF);return e?this.festService.deserializeDate(JSON.parse(e)):null}}return n.\u0275fac=function(e){return new(e||n)(Ne(mM))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),PF=(()=>{class n{constructor(e,i,r){this.storageService=e,this.festService=i,this.mapService=r,this.filterFunctions={date:this.dateFilter,range:this.rangeFilter,[Rc.russia]:this.russiaFilter,[Rc.europe]:this.europeFilter,[Rc.asia]:this.asiaFilter,[Rc.america]:this.americaFilter,passed:this.passedFilter,notPassed:this.notPassedFilter}}getData(){const e=this.storageService.get();return(e?qt(e):this.festService.get()).pipe(Vr(r=>{this.mapService.allFestivalCoordinates=this.festService.getAllFestivalsCoordinates(r)}))}setData(e){this.storageService.set(e)}dateFilter(e){if(e.date)return!0}rangeFilter(e,i){if(!i.start&&!i.end)return!0;if(!e.date||!e.date[0].start||!i.start)return!1;const r=e.date[0].start,s=e.date[e.date.length-1].end,u=i.end&&new Date(i.end.setHours(3)),m=new Date(i.start.setHours(3));return!!(r>=m&&u&&r<=u||s&&u&&s>=m&&s<=u)}russiaFilter(){return!0}europeFilter(){return!0}asiaFilter(){return!0}americaFilter(){return!0}passedFilter(e){if(e.date&&e.date[0].start&&e.date[0].start<new Date)return!0}notPassedFilter(e){if(e.date&&e.date[0].start&&e.date[0].start>new Date)return!0}}return n.\u0275fac=function(e){return new(e||n)(Ne(SW),Ne(mM),Ne(v1))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const MW=["*"];let T1;function Nb(n){return function TW(){if(void 0===T1&&(T1=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(T1=n.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return T1}()?.createHTML(n)||n}function OF(n){return Error(`Unable to find icon with the name "${n}"`)}function FF(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function LF(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class ym{constructor(t,e,i){this.url=t,this.svgText=e,this.options=i}}let Bb=(()=>{class n{constructor(e,i,r,s){this._httpClient=e,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(e,i,r){return this.addSvgIconInNamespace("",e,i,r)}addSvgIconLiteral(e,i,r){return this.addSvgIconLiteralInNamespace("",e,i,r)}addSvgIconInNamespace(e,i,r,s){return this._addSvgIconConfig(e,i,new ym(r,null,s))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,i,r,s){const u=this._sanitizer.sanitize(hi.HTML,r);if(!u)throw LF(r);const m=Nb(u);return this._addSvgIconConfig(e,i,new ym("",m,s))}addSvgIconSet(e,i){return this.addSvgIconSetInNamespace("",e,i)}addSvgIconSetLiteral(e,i){return this.addSvgIconSetLiteralInNamespace("",e,i)}addSvgIconSetInNamespace(e,i,r){return this._addSvgIconSetConfig(e,new ym(i,null,r))}addSvgIconSetLiteralInNamespace(e,i,r){const s=this._sanitizer.sanitize(hi.HTML,i);if(!s)throw LF(i);const u=Nb(s);return this._addSvgIconSetConfig(e,new ym("",u,r))}registerFontClassAlias(e,i=e){return this._fontCssClassesByAlias.set(e,i),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const i=this._sanitizer.sanitize(hi.RESOURCE_URL,e);if(!i)throw FF(e);const r=this._cachedIconsByUrl.get(i);return r?qt(A1(r)):this._loadSvgIconFromConfig(new ym(e,null)).pipe(Vr(s=>this._cachedIconsByUrl.set(i,s)),xt(s=>A1(s)))}getNamedSvgIcon(e,i=""){const r=NF(i,e);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,e),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const u=this._iconSetConfigs.get(i);return u?this._getSvgFromIconSetConfigs(e,u):u_(OF(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?qt(A1(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(xt(i=>A1(i)))}_getSvgFromIconSetConfigs(e,i){const r=this._extractIconWithNameFromAnySet(e,i);return r?qt(r):VP(i.filter(u=>!u.svgText).map(u=>this._loadSvgIconSetFromConfig(u).pipe(mp(m=>{const E=`Loading icon set URL: ${this._sanitizer.sanitize(hi.RESOURCE_URL,u.url)} failed: ${m.message}`;return this._errorHandler.handleError(new Error(E)),qt(null)})))).pipe(xt(()=>{const u=this._extractIconWithNameFromAnySet(e,i);if(!u)throw OF(e);return u}))}_extractIconWithNameFromAnySet(e,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(e)>-1){const u=this._svgElementFromConfig(s),m=this._extractSvgIconFromSet(u,e,s.options);if(m)return m}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Vr(i=>e.svgText=i),xt(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?qt(null):this._fetchIcon(e).pipe(Vr(i=>e.svgText=i))}_extractSvgIconFromSet(e,i,r){const s=e.querySelector(`[id="${i}"]`);if(!s)return null;const u=s.cloneNode(!0);if(u.removeAttribute("id"),"svg"===u.nodeName.toLowerCase())return this._setSvgAttributes(u,r);if("symbol"===u.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(u),r);const m=this._svgElementFromString(Nb("<svg></svg>"));return m.appendChild(u),this._setSvgAttributes(m,r)}_svgElementFromString(e){const i=this._document.createElement("DIV");i.innerHTML=e;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(e){const i=this._svgElementFromString(Nb("<svg></svg>")),r=e.attributes;for(let s=0;s<r.length;s++){const{name:u,value:m}=r[s];"id"!==u&&i.setAttribute(u,m)}for(let s=0;s<e.childNodes.length;s++)e.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(e.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(e,i){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),i&&i.viewBox&&e.setAttribute("viewBox",i.viewBox),e}_fetchIcon(e){const{url:i,options:r}=e,s=r?.withCredentials??!1;if(!this._httpClient)throw function AW(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const u=this._sanitizer.sanitize(hi.RESOURCE_URL,i);if(!u)throw FF(i);const m=this._inProgressUrlFetches.get(u);if(m)return m;const b=this._httpClient.get(u,{responseType:"text",withCredentials:s}).pipe(xt(E=>Nb(E)),dw(()=>this._inProgressUrlFetches.delete(u)),oh());return this._inProgressUrlFetches.set(u,b),b}_addSvgIconConfig(e,i,r){return this._svgIconConfigs.set(NF(e,i),r),this}_addSvgIconSetConfig(e,i){const r=this._iconSetConfigs.get(e);return r?r.push(i):this._iconSetConfigs.set(e,[i]),this}_svgElementFromConfig(e){if(!e.svgElement){const i=this._svgElementFromString(e.svgText);this._setSvgAttributes(i,e.options),e.svgElement=i}return e.svgElement}_getIconConfigFromResolvers(e,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,e);if(s)return kW(s)?new ym(s.url,null,s.options):new ym(s,null)}}}return n.\u0275fac=function(e){return new(e||n)(Ne(y1,8),Ne(sw),Ne(Nn,8),Ne(Ol))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function A1(n){return n.cloneNode(!0)}function NF(n,t){return n+":"+t}function kW(n){return!(!n.url||!n.options)}const RW=Tb(class{constructor(n){this._elementRef=n}}),PW=new Ke("MAT_ICON_DEFAULT_OPTIONS"),OW=new Ke("mat-icon-location",{providedIn:"root",factory:function FW(){const n=gt(Nn),t=n?n.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),BF=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],LW=BF.map(n=>`[${n}]`).join(", "),NW=/^url\(['"]?#(.*?)['"]?\)$/;let BW=(()=>{class n extends RW{get inline(){return this._inline}set inline(e){this._inline=Bn(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const i=this._cleanupFontValue(e);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const i=this._cleanupFontValue(e);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(e,i,r,s,u,m){super(e),this._iconRegistry=i,this._location=s,this._errorHandler=u,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=Ie.EMPTY,m&&(m.color&&(this.color=this.defaultColor=m.color),m.fontSet&&(this.fontSet=m.fontSet)),r||e.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];const i=e.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let i=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=e.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>e.classList.remove(r)),i.forEach(r=>e.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(u=>{s.setAttribute(u.name,`url('${e}#${u.value}')`)})})}_cacheChildrenWithExternalReferences(e){const i=e.querySelectorAll(LW),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)BF.forEach(u=>{const m=i[s],b=m.getAttribute(u),E=b?b.match(NW):null;if(E){let T=r.get(m);T||(T=[],r.set(m,T)),T.push({name:u,value:E[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[i,r]=this._splitIconName(e);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Jr(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(Bb),Os("aria-hidden"),J(OW),J(Ol),J(PW,8))},n.\u0275cmp=Fn({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(e,i){2&e&&(Ln("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),Xn("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Et],ngContentSelectors:MW,decls:1,vars:0,template:function(e,i){1&e&&(fo(),qn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),zW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[ur,ur]}),n})();const VW=[{name:"cancel",path:"assets/icons/cancel_black_24dp.svg"},{name:"plus",path:"assets/icons/add_circle_outline_black_24dp.svg"},{name:"save",path:"assets/icons/done_black_24dp.svg"},{name:"close",path:"assets/icons/close_black_24dp.svg"},{name:"location",path:"assets/icons/my_location_black_24dp.svg"},{name:"eq",path:"assets/icons/eq.svg"}];let UW=(()=>{class n{constructor(e,i){this.matIconRegistry=e,this.domSanitizer=i,VW.forEach(r=>this.add(r))}add(e){this.matIconRegistry.addSvgIcon(e.name,this.domSanitizer.bypassSecurityTrustResourceUrl(e.path))}}return n.\u0275fac=function(e){return new(e||n)(Ne(Bb),Ne(sw))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jW=["mat-button",""],HW=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],$W=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],qW=["mat-icon-button",""],WW=["*"],zF={capture:!0},VF=["focus","click","mouseenter","touchstart"],zb="mat-button-ripple-uninitialized";let ZW=(()=>{class n{constructor(){this._document=gt(Nn,{optional:!0}),this._animationMode=gt(ko,{optional:!0}),this._globalRippleOptions=gt(p1,{optional:!0}),this._platform=gt(Qr),this._ngZone=gt(rn),this._onInteraction=e=>{if(e.target===this._document)return;const r=e.target.closest(`[${zb}]`);r&&(r.removeAttribute(zb),this._appendRipple(r))},this._ngZone.runOutsideAngular(()=>{for(const e of VF)this._document?.addEventListener(e,this._onInteraction,zF)})}ngOnDestroy(){for(const e of VF)this._document?.removeEventListener(e,this._onInteraction,zF)}_appendRipple(e){if(!this._document)return;const i=this._document.createElement("span");i.classList.add("mat-mdc-button-ripple");const r=new YW(e,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);r.rippleConfig.centered=e.hasAttribute("mat-icon-button"),new R_(r,this._ngZone,i,this._platform).setupTriggerEvents(e),e.append(i)}_createMatRipple(e){if(!this._document)return;e.querySelector(".mat-mdc-button-ripple")?.remove(),e.removeAttribute(zb);const i=this._document.createElement("span");i.classList.add("mat-mdc-button-ripple");const r=new wp(new jt(i),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return r._isInitialized=!0,r.trigger=e,e.append(i),r}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class YW{constructor(t,e,i){this._button=t,this._globalRippleOptions=e,this._setRippleConfig(e,i)}_setRippleConfig(t,e){this.rippleConfig=t||{},"NoopAnimations"===e&&(this.rippleConfig.animation={enterDuration:0,exitDuration:0})}get rippleDisabled(){return this._button.hasAttribute("disabled")||!!this._globalRippleOptions?.disabled}}const XW=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],KW=Tb(jS(u1(class{constructor(n){this._elementRef=n}})));let UF=(()=>{class n extends KW{get ripple(){return!this._ripple&&this._rippleLoader&&(this._ripple=this._rippleLoader._createMatRipple(this._elementRef.nativeElement)),this._ripple}set ripple(e){this._ripple=e}constructor(e,i,r,s){super(e),this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=gt(d1),this._rippleLoader=gt(ZW),this._isFab=!1;const u=e.nativeElement.classList;for(const m of XW)this._hasHostAttributes(m.selector)&&m.mdcClasses.forEach(b=>{u.add(b)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",i){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...e){return e.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_isRippleDisabled(){this._ripple&&(this._ripple.disabled=this.disableRipple||this.disabled)}}return n.\u0275fac=function(e){Iu()},n.\u0275dir=rt({type:n,features:[Et]}),n})(),jF=(()=>{class n extends UF{constructor(e,i,r,s){super(e,i,r,s)}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(Qr),J(rn),J(ko,8))},n.\u0275cmp=Fn({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostAttrs:["mat-button-ripple-uninitialized",""],hostVars:9,hostBindings:function(e,i){2&e&&(Ln("disabled",i.disabled||null)("mat-button-disabled",i._isRippleDisabled())("mat-button-is-fab",i._isFab),Xn("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Et],attrs:jW,ngContentSelectors:$W,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(e,i){1&e&&(fo(HW),_n(0,"span",0),qn(1),Ye(2,"span",1),qn(3,1),ot(),qn(4,2),_n(5,"span",2)(6,"span",3)),2&e&&Xn("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),gM=(()=>{class n extends UF{get ripple(){return!this._ripple&&this._rippleLoader&&(this._ripple=this._rippleLoader._createMatRipple(this._elementRef.nativeElement),this._ripple.centered=!0),this._ripple}constructor(e,i,r,s){super(e,i,r,s)}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(Qr),J(rn),J(ko,8))},n.\u0275cmp=Fn({type:n,selectors:[["button","mat-icon-button",""]],hostAttrs:["mat-button-ripple-uninitialized",""],hostVars:9,hostBindings:function(e,i){2&e&&(Ln("disabled",i.disabled||null)("mat-button-disabled",i._isRippleDisabled())("mat-button-is-fab",i._isFab),Xn("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Et],attrs:qW,ngContentSelectors:WW,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(e,i){1&e&&(fo(),_n(0,"span",0),qn(1),_n(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),_M=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[ur,f1,ur]}),n})();const HF=E_({passive:!0});let e9=(()=>{class n{constructor(e,i){this._platform=e,this._ngZone=i,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return Es;const i=ju(e),r=this._monitoredElements.get(i);if(r)return r.subject;const s=new Xt,u="cdk-text-field-autofilled",m=b=>{"cdk-text-field-autofill-start"!==b.animationName||i.classList.contains(u)?"cdk-text-field-autofill-end"===b.animationName&&i.classList.contains(u)&&(i.classList.remove(u),this._ngZone.run(()=>s.next({target:b.target,isAutofilled:!1}))):(i.classList.add(u),this._ngZone.run(()=>s.next({target:b.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{i.addEventListener("animationstart",m,HF),i.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(i,{subject:s,unlisten:()=>{i.removeEventListener("animationstart",m,HF)}}),s}stopMonitoring(e){const i=ju(e),r=this._monitoredElements.get(i);r&&(r.unlisten(),r.subject.complete(),i.classList.remove("cdk-text-field-autofill-monitored"),i.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(i))}ngOnDestroy(){this._monitoredElements.forEach((e,i)=>this.stopMonitoring(i))}}return n.\u0275fac=function(e){return new(e||n)(Ne(Qr),Ne(rn))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),t9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})();const n9=["matFormFieldNotchedOutline",""],i9=["*"],r9=["textField"],o9=["iconPrefixContainer"],s9=["textPrefixContainer"];function a9(n,t){1&n&&_n(0,"span",19)}function l9(n,t){if(1&n){const e=rl();Ye(0,"label",17),Kt("cdkObserveContent",function(){return ti(e),on(Nt(2)._refreshOutlineNotchWidth())}),qn(1,1),kt(2,a9,1,0,"span",18),ot()}if(2&n){const e=Nt(2);et("floating",e._shouldLabelFloat())("cdkObserveContentDisabled",!e._hasOutline())("id",e._labelId),Ln("for",e._control.id)("aria-owns",e._control.id),Ze(2),et("ngIf",!e.hideRequiredMarker&&e._control.required)}}function c9(n,t){1&n&&kt(0,l9,3,6,"label",16),2&n&&et("ngIf",Nt()._hasFloatingLabel())}function d9(n,t){1&n&&_n(0,"div",20)}function u9(n,t){}function h9(n,t){1&n&&kt(0,u9,0,0,"ng-template",22),2&n&&(Nt(2),et("ngTemplateOutlet",Sa(1)))}function p9(n,t){if(1&n&&(Ye(0,"div",21),kt(1,h9,1,1,"ng-template",9),ot()),2&n){const e=Nt();et("matFormFieldNotchedOutlineOpen",e._shouldLabelFloat())("matFormFieldNotchedOutlineLabelWidth",e._labelWidth),Ze(1),et("ngIf",!e._forceDisplayInfixLabel())}}function f9(n,t){1&n&&(Ye(0,"div",23,24),qn(2,2),ot())}function m9(n,t){1&n&&(Ye(0,"div",25,26),qn(2,3),ot())}function g9(n,t){}function _9(n,t){1&n&&kt(0,g9,0,0,"ng-template",22),2&n&&(Nt(),et("ngTemplateOutlet",Sa(1)))}function y9(n,t){1&n&&(Ye(0,"div",27),qn(1,4),ot())}function v9(n,t){1&n&&(Ye(0,"div",28),qn(1,5),ot())}function b9(n,t){1&n&&_n(0,"div",29)}function x9(n,t){1&n&&(Ye(0,"div",30),qn(1,6),ot()),2&n&&et("@transitionMessages",Nt()._subscriptAnimationState)}function w9(n,t){if(1&n&&(Ye(0,"mat-hint",34),Kn(1),ot()),2&n){const e=Nt(2);et("id",e._hintLabelId),Ze(1),Ma(e.hintLabel)}}function C9(n,t){if(1&n&&(Ye(0,"div",31),kt(1,w9,2,2,"mat-hint",32),qn(2,7),_n(3,"div",33),qn(4,8),ot()),2&n){const e=Nt();et("@transitionMessages",e._subscriptAnimationState),Ze(1),et("ngIf",e.hintLabel)}}const E9=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],D9=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];let yM=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n,selectors:[["mat-label"]]}),n})();const S9=new Ke("MatError");let M9=0,$F=(()=>{class n{constructor(){this.align="start",this.id="mat-mdc-hint-"+M9++}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(e,i){2&e&&(ia("id",i.id),Ln("align",null),Xn("mat-mdc-form-field-hint-end","end"===i.align))},inputs:{align:"align",id:"id"}}),n})();const T9=new Ke("MatPrefix"),GF=new Ke("MatSuffix");let A9=(()=>{class n{constructor(){this._isText=!1}set _isTextSelector(e){this._isText=!0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:["matTextSuffix","_isTextSelector"]},features:[Zt([{provide:GF,useExisting:n}])]}),n})(),qF=(()=>{class n{constructor(e){this._elementRef=e,this.floating=!1}getWidth(){return function I9(n){if(null!==n.offsetParent)return n.scrollWidth;const e=n.cloneNode(!0);e.style.setProperty("position","absolute"),e.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(e);const i=e.scrollWidth;return e.remove(),i}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}}return n.\u0275fac=function(e){return new(e||n)(J(jt))},n.\u0275dir=rt({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(e,i){2&e&&Xn("mdc-floating-label--float-above",i.floating)},inputs:{floating:"floating"}}),n})();const WF="mdc-line-ripple--active",I1="mdc-line-ripple--deactivating";let ZF=(()=>{class n{constructor(e,i){this._elementRef=e,this._handleTransitionEnd=r=>{const s=this._elementRef.nativeElement.classList,u=s.contains(I1);"opacity"===r.propertyName&&u&&s.remove(WF,I1)},i.runOutsideAngular(()=>{e.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const e=this._elementRef.nativeElement.classList;e.remove(I1),e.add(WF)}deactivate(){this._elementRef.nativeElement.classList.add(I1)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(rn))},n.\u0275dir=rt({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]}),n})(),YF=(()=>{class n{constructor(e,i){this._elementRef=e,this._ngZone=i,this.labelWidth=0,this.open=!1}ngAfterViewInit(){const e=this._elementRef.nativeElement.querySelector(".mdc-floating-label");e?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(e.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>e.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_getNotchWidth(){return this.open?this.labelWidth>0?`calc(${this.labelWidth}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:"0px":null}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(rn))},n.\u0275cmp=Fn({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(e,i){2&e&&Xn("mdc-notched-outline--notched",i.open)},inputs:{labelWidth:["matFormFieldNotchedOutlineLabelWidth","labelWidth"],open:["matFormFieldNotchedOutlineOpen","open"]},attrs:n9,ngContentSelectors:i9,decls:4,vars:2,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(e,i){1&e&&(fo(),_n(0,"div",0),Ye(1,"div",1),qn(2),ot(),_n(3,"div",2)),2&e&&(Ze(1),Ad("width",i._getNotchWidth()))},encapsulation:2,changeDetection:0}),n})();const k9={transitionMessages:sa("transitionMessages",[Sr("enter",Vn({opacity:1,transform:"translateY(0%)"})),Mr("void => enter",[Vn({opacity:0,transform:"translateY(-5px)"}),Ur("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let k1=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n}),n})();const U_=new Ke("MatFormField"),XF=new Ke("MAT_FORM_FIELD_DEFAULT_OPTIONS");let KF=0,O9=(()=>{class n{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=Bn(e)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(e){const i=this._appearance;this._appearance=e||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==i&&(this._refreshOutlineNotchWidth(),this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(e){this._subscriptSizing=e||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(e){this._explicitFormFieldControl=e}constructor(e,i,r,s,u,m,b,E){this._elementRef=e,this._changeDetectorRef=i,this._ngZone=r,this._dir=s,this._platform=u,this._defaults=m,this._animationMode=b,this._document=E,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+KF++,this._hintLabelId="mat-mdc-hint-"+KF++,this._subscriptAnimationState="",this._labelWidth=0,this._destroyed=new Xt,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,m&&(m.appearance&&(this.appearance=m.appearance),this._hideRequiredMarker=!!m?.hideRequiredMarker,m.color&&(this.color=m.color))}ngAfterViewInit(){this._updateFocusState(),this._refreshOutlineNotchWidth(),this._document?.fonts?.ready?this._document.fonts.ready.then(()=>{this._refreshOutlineNotchWidth(),this._changeDetectorRef.markForCheck()}):setTimeout(()=>this._refreshOutlineNotchWidth(),100),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${e.controlType}`),e.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(eo(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(e=>!e._isText),this._hasTextPrefix=!!this._prefixChildren.find(e=>e._isText),this._hasIconSuffix=!!this._suffixChildren.find(e=>!e._isText),this._hasTextSuffix=!!this._suffixChildren.find(e=>e._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),$i(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(eo(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(eo(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(e){const i=this._control?this._control.ngControl:null;return i&&i[e]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||(this._labelWidth=this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const i=this._hintChildren?this._hintChildren.find(s=>"start"===s.align):null,r=this._hintChildren?this._hintChildren.find(s=>"end"===s.align):null;i?e.push(i.id):this._hintLabel&&e.push(this._hintLabelId),r&&e.push(r.id)}else this._errorChildren&&e.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(e)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const e=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(e.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const i=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,s=i?.getBoundingClientRect().width??0,u=r?.getBoundingClientRect().width??0;e.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${s+u}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const e=this._elementRef.nativeElement;if(e.getRootNode){const i=e.getRootNode();return i&&i!==e}return document.documentElement.contains(e)}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(zr),J(rn),J(kc),J(Qr),J(XF,8),J(ko,8),J(Nn))},n.\u0275cmp=Fn({type:n,selectors:[["mat-form-field"]],contentQueries:function(e,i,r){if(1&e&&(Ri(r,yM,5),Ri(r,yM,7),Ri(r,k1,5),Ri(r,T9,5),Ri(r,GF,5),Ri(r,S9,5),Ri(r,$F,5)),2&e){let s;Bt(s=zt())&&(i._labelChildNonStatic=s.first),Bt(s=zt())&&(i._labelChildStatic=s.first),Bt(s=zt())&&(i._formFieldControl=s.first),Bt(s=zt())&&(i._prefixChildren=s),Bt(s=zt())&&(i._suffixChildren=s),Bt(s=zt())&&(i._errorChildren=s),Bt(s=zt())&&(i._hintChildren=s)}},viewQuery:function(e,i){if(1&e&&(ci(r9,5),ci(o9,5),ci(s9,5),ci(qF,5),ci(YF,5),ci(ZF,5)),2&e){let r;Bt(r=zt())&&(i._textField=r.first),Bt(r=zt())&&(i._iconPrefixContainer=r.first),Bt(r=zt())&&(i._textPrefixContainer=r.first),Bt(r=zt())&&(i._floatingLabel=r.first),Bt(r=zt())&&(i._notchedOutline=r.first),Bt(r=zt())&&(i._lineRipple=r.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(e,i){2&e&&Xn("mat-mdc-form-field-label-always-float",i._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",i._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",i._hasIconSuffix)("mat-form-field-invalid",i._control.errorState)("mat-form-field-disabled",i._control.disabled)("mat-form-field-autofilled",i._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===i._animationMode)("mat-form-field-appearance-fill","fill"==i.appearance)("mat-form-field-appearance-outline","outline"==i.appearance)("mat-form-field-hide-placeholder",i._hasFloatingLabel()&&!i._shouldLabelFloat())("mat-focused",i._control.focused)("mat-primary","accent"!==i.color&&"warn"!==i.color)("mat-accent","accent"===i.color)("mat-warn","warn"===i.color)("ng-untouched",i._shouldForward("untouched"))("ng-touched",i._shouldForward("touched"))("ng-pristine",i._shouldForward("pristine"))("ng-dirty",i._shouldForward("dirty"))("ng-valid",i._shouldForward("valid"))("ng-invalid",i._shouldForward("invalid"))("ng-pending",i._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Zt([{provide:U_,useExisting:n}])],ngContentSelectors:D9,decls:18,vars:23,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay",4,"ngIf"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth",4,"ngIf"],["class","mat-mdc-form-field-icon-prefix",4,"ngIf"],["class","mat-mdc-form-field-text-prefix",4,"ngIf"],[1,"mat-mdc-form-field-infix"],[3,"ngIf"],["class","mat-mdc-form-field-text-suffix",4,"ngIf"],["class","mat-mdc-form-field-icon-suffix",4,"ngIf"],["matFormFieldLineRipple","",4,"ngIf"],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align",3,"ngSwitch"],["class","mat-mdc-form-field-error-wrapper",4,"ngSwitchCase"],["class","mat-mdc-form-field-hint-wrapper",4,"ngSwitchCase"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent",4,"ngIf"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required",4,"ngIf"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id",4,"ngIf"],[1,"mat-mdc-form-field-hint-spacer"],[3,"id"]],template:function(e,i){1&e&&(fo(E9),kt(0,c9,1,1,"ng-template",null,0,Hv),Ye(2,"div",1,2),Kt("click",function(s){return i._control.onContainerClick(s)}),kt(4,d9,1,0,"div",3),Ye(5,"div",4),kt(6,p9,2,3,"div",5),kt(7,f9,3,0,"div",6),kt(8,m9,3,0,"div",7),Ye(9,"div",8),kt(10,_9,1,1,"ng-template",9),qn(11),ot(),kt(12,y9,2,0,"div",10),kt(13,v9,2,0,"div",11),ot(),kt(14,b9,1,0,"div",12),ot(),Ye(15,"div",13),kt(16,x9,2,1,"div",14),kt(17,C9,5,2,"div",15),ot()),2&e&&(Ze(2),Xn("mdc-text-field--filled",!i._hasOutline())("mdc-text-field--outlined",i._hasOutline())("mdc-text-field--no-label",!i._hasFloatingLabel())("mdc-text-field--disabled",i._control.disabled)("mdc-text-field--invalid",i._control.errorState),Ze(2),et("ngIf",!i._hasOutline()&&!i._control.disabled),Ze(2),et("ngIf",i._hasOutline()),Ze(1),et("ngIf",i._hasIconPrefix),Ze(1),et("ngIf",i._hasTextPrefix),Ze(2),et("ngIf",!i._hasOutline()||i._forceDisplayInfixLabel()),Ze(2),et("ngIf",i._hasTextSuffix),Ze(1),et("ngIf",i._hasIconSuffix),Ze(1),et("ngIf",!i._hasOutline()),Ze(1),Xn("mat-mdc-form-field-subscript-dynamic-size","dynamic"===i.subscriptSizing),et("ngSwitch",i._getDisplayedMessages()),Ze(1),et("ngSwitchCase","error"),Ze(1),et("ngSwitchCase","hint"))},dependencies:[Nu,vD,tm,Zv,u8,$F,qF,YF,ZF],styles:['.mdc-text-field{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px * 2)}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{line-height:normal;pointer-events:all}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}'],encapsulation:2,data:{animation:[k9.transitionMessages]},changeDetection:0}),n})(),R1=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[ur,Tc,y2,ur]}),n})();const eL=new Ke("MAT_INPUT_VALUE_ACCESSOR"),F9=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let L9=0;const N9=HS(class{constructor(n,t,e,i){this._defaultErrorStateMatcher=n,this._parentForm=t,this._parentFormGroup=e,this.ngControl=i,this.stateChanges=new Xt}});let B9=(()=>{class n extends N9{get disabled(){return this._disabled}set disabled(e){this._disabled=Bn(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(lm.required)??!1}set required(e){this._required=Bn(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&o2().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=Bn(e)}constructor(e,i,r,s,u,m,b,E,T,O){super(m,s,u,r),this._elementRef=e,this._platform=i,this._autofillMonitor=E,this._formField=O,this._uid="mat-input-"+L9++,this.focused=!1,this.stateChanges=new Xt,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(oe=>o2().has(oe)),this._iOSKeyupListener=oe=>{const de=oe.target;!de.value&&0===de.selectionStart&&0===de.selectionEnd&&(de.setSelectionRange(1,1),de.setSelectionRange(0,0))};const H=this._elementRef.nativeElement,q=H.nodeName.toLowerCase();this._inputValueAccessor=b||H,this._previousNativeValue=this.value,this.id=this.id,i.IOS&&T.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===q,this._isTextarea="textarea"===q,this._isInFormField=!!O,this._isNativeSelect&&(this.controlType=H.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_dirtyCheckPlaceholder(){const e=this._getPlaceholder();if(e!==this._previousPlaceholder){const i=this._elementRef.nativeElement;this._previousPlaceholder=e,e?i.setAttribute("placeholder",e):i.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){F9.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,i=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&i&&i.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(Qr),J(Ic,10),J(bp,8),J(Vu,8),J(k_),J(eL,10),J(e9),J(rn),J(U_,8))},n.\u0275dir=rt({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(e,i){1&e&&Kt("focus",function(){return i._focusChanged(!0)})("blur",function(){return i._focusChanged(!1)})("input",function(){return i._onInput()}),2&e&&(ia("id",i.id)("disabled",i.disabled)("required",i.required),Ln("name",i.name||null)("readonly",i.readonly&&!i._isNativeSelect||null)("aria-invalid",i.empty&&i.required?null:i.errorState)("aria-required",i.required)("id",i.id),Xn("mat-input-server",i._isServer)("mat-mdc-form-field-textarea-control",i._isInFormField&&i._isTextarea)("mat-mdc-form-field-input-control",i._isInFormField)("mdc-text-field__input",i._isInFormField)("mat-mdc-native-select-inline",i._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[Zt([{provide:k1,useExisting:n}]),Et,M]}),n})(),z9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[ur,R1,R1,t9,ur]}),n})();class vM{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class bM extends vM{constructor(t,e,i,r,s){super(),this.component=t,this.viewContainerRef=e,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class tL extends vM{constructor(t,e,i,r){super(),this.templateRef=t,this.viewContainerRef=e,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class V9 extends vM{constructor(t){super(),this.element=t instanceof jt?t.nativeElement:t}}class nL{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof bM?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof tL?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof V9?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class U9 extends nL{constructor(t,e,i,r,s){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=u=>{const m=u.element,b=this._document.createComment("dom-portal");m.parentNode.insertBefore(b,m),this.outletElement.appendChild(m),this._attachedPortal=u,super.setDisposeFn(()=>{b.parentNode&&b.parentNode.replaceChild(m,b)})},this._document=s}attachComponentPortal(t){const i=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let r;return t.viewContainerRef?(r=t.viewContainerRef.createComponent(i,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(t.injector||this._defaultInjector||Ro.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=t,r}attachTemplatePortal(t){let e=t.viewContainerRef,i=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=e.indexOf(i);-1!==r&&e.remove(r)}),this._attachedPortal=t,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let iL=(()=>{class n extends nL{constructor(e,i,r){super(),this._componentFactoryResolver=e,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new Tt,this.attachDomPortal=s=>{const u=s.element,m=this._document.createComment("dom-portal");s.setAttachedHost(this),u.parentNode.insertBefore(m,u),this._getRootNode().appendChild(u),this._attachedPortal=s,super.setDisposeFn(()=>{m.parentNode&&m.parentNode.replaceChild(u,m)})},this._document=r}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);const i=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,s=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),u=i.createComponent(s,i.length,e.injector||i.injector,e.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(u.hostView.rootNodes[0]),super.setDisposeFn(()=>u.destroy()),this._attachedPortal=e,this._attachedRef=u,this.attached.emit(u),u}attachTemplatePortal(e){e.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return n.\u0275fac=function(e){return new(e||n)(J(op),J(Oo),J(Nn))},n.\u0275dir=rt({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Et]}),n})(),rL=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})();const oL=m6();class j9{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=yo(-this._previousScrollPosition.left),t.style.top=yo(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,i=t.style,r=this._document.body.style,s=i.scrollBehavior||"",u=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),oL&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),oL&&(i.scrollBehavior=s,r.scrollBehavior=u)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,i=this._viewportRuler.getViewportSize();return e.scrollHeight>i.height||e.scrollWidth>i.width}}class H9{constructor(t,e,i,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0).pipe(Lo(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class sL{enable(){}disable(){}attach(){}}function xM(n,t){return t.some(e=>n.bottom<e.top||n.top>e.bottom||n.right<e.left||n.left>e.right)}function aL(n,t){return t.some(e=>n.top<e.top||n.bottom>e.bottom||n.left<e.left||n.right>e.right)}class $9{constructor(t,e,i,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();xM(e,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let G9=(()=>{class n{constructor(e,i,r,s){this._scrollDispatcher=e,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new sL,this.close=u=>new H9(this._scrollDispatcher,this._ngZone,this._viewportRuler,u),this.block=()=>new j9(this._viewportRuler,this._document),this.reposition=u=>new $9(this._scrollDispatcher,this._viewportRuler,this._ngZone,u),this._document=s}}return n.\u0275fac=function(e){return new(e||n)(Ne(N6),Ne(Ww),Ne(rn),Ne(Nn))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class wM{constructor(t){if(this.scrollStrategy=new sL,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const i of e)void 0!==t[i]&&(this[i]=t[i])}}}class q9{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let lL=(()=>{class n{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const i=this._attachedOverlays.indexOf(e);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),W9=(()=>{class n extends lL{constructor(e,i){super(e),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let u=s.length-1;u>-1;u--)if(s[u]._keydownEvents.observers.length>0){const m=s[u]._keydownEvents;this._ngZone?this._ngZone.run(()=>m.next(r)):m.next(r);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn),Ne(rn,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Z9=(()=>{class n extends lL{constructor(e,i,r){super(e),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Hu(s)},this._clickListener=s=>{const u=Hu(s),m="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:u;this._pointerDownEventTarget=null;const b=this._attachedOverlays.slice();for(let E=b.length-1;E>-1;E--){const T=b[E];if(T._outsidePointerEvents.observers.length<1||!T.hasAttached())continue;if(T.overlayElement.contains(u)||T.overlayElement.contains(m))break;const O=T._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>O.next(s)):O.next(s)}}}add(e){if(super.add(e),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn),Ne(Qr),Ne(rn,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),cL=(()=>{class n{constructor(e,i){this._platform=i,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||TS()){const r=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(e),TS()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn),Ne(Qr))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Y9{constructor(t,e,i,r,s,u,m,b,E,T=!1){this._portalOutlet=t,this._host=e,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=u,this._document=m,this._location=b,this._outsideClickDispatcher=E,this._animationsDisabled=T,this._backdropElement=null,this._backdropClick=new Xt,this._attachments=new Xt,this._detachments=new Xt,this._locationChanges=Ie.EMPTY,this._backdropClickHandler=O=>this._backdropClick.next(O),this._backdropTransitionendHandler=O=>{this._disposeBackdrop(O.target)},this._keydownEvents=new Xt,this._outsidePointerEvents=new Xt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Jr(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=yo(this._config.width),t.height=yo(this._config.height),t.minWidth=yo(this._config.minWidth),t.minHeight=yo(this._config.minHeight),t.maxWidth=yo(this._config.maxWidth),t.maxHeight=yo(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,e,i){const r=Hw(e||[]).filter(s=>!!s);r.length&&(i?t.classList.add(...r):t.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(eo($i(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const dL="cdk-overlay-connected-position-bounding-box",X9=/([A-Za-z%]+)$/;class uL{get positions(){return this._preferredPositions}constructor(t,e,i,r,s){this._viewportRuler=e,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Xt,this._resizeSubscription=Ie.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._validatePositions(),t.hostElement.classList.add(dL),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let u;for(let m of this._preferredPositions){let b=this._getOriginPoint(t,r,m),E=this._getOverlayPoint(b,e,m),T=this._getOverlayFit(E,e,i,m);if(T.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(m,b);this._canFitWithFlexibleDimensions(T,E,i)?s.push({position:m,origin:b,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(b,m)}):(!u||u.overlayFit.visibleArea<T.visibleArea)&&(u={overlayFit:T,overlayPoint:E,originPoint:b,position:m,overlayRect:e})}if(s.length){let m=null,b=-1;for(const E of s){const T=E.boundingBoxRect.width*E.boundingBoxRect.height*(E.position.weight||1);T>b&&(b=T,m=E)}return this._isPushed=!1,void this._applyPosition(m.position,m.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(u.position,u.originPoint);this._applyPosition(u.position,u.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&vm(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(dL),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,i){let r,s;if("center"==i.originX)r=t.left+t.width/2;else{const u=this._isRtl()?t.right:t.left,m=this._isRtl()?t.left:t.right;r="start"==i.originX?u:m}return e.left<0&&(r-=e.left),s="center"==i.originY?t.top+t.height/2:"top"==i.originY?t.top:t.bottom,e.top<0&&(s-=e.top),{x:r,y:s}}_getOverlayPoint(t,e,i){let r,s;return r="center"==i.overlayX?-e.width/2:"start"===i.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,s="center"==i.overlayY?-e.height/2:"top"==i.overlayY?0:-e.height,{x:t.x+r,y:t.y+s}}_getOverlayFit(t,e,i,r){const s=pL(e);let{x:u,y:m}=t,b=this._getOffset(r,"x"),E=this._getOffset(r,"y");b&&(u+=b),E&&(m+=E);let H=0-m,q=m+s.height-i.height,oe=this._subtractOverflows(s.width,0-u,u+s.width-i.width),de=this._subtractOverflows(s.height,H,q),xe=oe*de;return{visibleArea:xe,isCompletelyWithinViewport:s.width*s.height===xe,fitsInViewportVertically:de===s.height,fitsInViewportHorizontally:oe==s.width}}_canFitWithFlexibleDimensions(t,e,i){if(this._hasFlexibleDimensions){const r=i.bottom-e.y,s=i.right-e.x,u=hL(this._overlayRef.getConfig().minHeight),m=hL(this._overlayRef.getConfig().minWidth);return(t.fitsInViewportVertically||null!=u&&u<=r)&&(t.fitsInViewportHorizontally||null!=m&&m<=s)}return!1}_pushOverlayOnScreen(t,e,i){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=pL(e),s=this._viewportRect,u=Math.max(t.x+r.width-s.width,0),m=Math.max(t.y+r.height-s.height,0),b=Math.max(s.top-i.top-t.y,0),E=Math.max(s.left-i.left-t.x,0);let T=0,O=0;return T=r.width<=s.width?E||-u:t.x<this._viewportMargin?s.left-i.left-t.x:0,O=r.height<=s.height?b||-m:t.y<this._viewportMargin?s.top-i.top-t.y:0,this._previousPushAmount={x:T,y:O},{x:t.x+T,y:t.y+O}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new q9(t,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=t.overlayY;i="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let s=0;s<e.length;s++)e[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(t,e){const i=this._viewportRect,r=this._isRtl();let s,u,m,T,O,H;if("top"===e.overlayY)u=t.y,s=i.height-u+this._viewportMargin;else if("bottom"===e.overlayY)m=i.height-t.y+2*this._viewportMargin,s=i.height-m+this._viewportMargin;else{const q=Math.min(i.bottom-t.y+i.top,t.y),oe=this._lastBoundingBoxSize.height;s=2*q,u=t.y-q,s>oe&&!this._isInitialRender&&!this._growAfterOpen&&(u=t.y-oe/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)H=i.width-t.x+this._viewportMargin,T=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)O=t.x,T=i.right-t.x;else{const q=Math.min(i.right-t.x+i.left,t.x),oe=this._lastBoundingBoxSize.width;T=2*q,O=t.x-q,T>oe&&!this._isInitialRender&&!this._growAfterOpen&&(O=t.x-oe/2)}return{top:u,left:O,bottom:m,right:H,width:T,height:s}}_setBoundingBoxStyles(t,e){const i=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,u=this._overlayRef.getConfig().maxWidth;r.height=yo(i.height),r.top=yo(i.top),r.bottom=yo(i.bottom),r.width=yo(i.width),r.left=yo(i.left),r.right=yo(i.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=yo(s)),u&&(r.maxWidth=yo(u))}this._lastBoundingBoxSize=i,vm(this._boundingBox.style,r)}_resetBoundingBoxStyles(){vm(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){vm(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,u=this._overlayRef.getConfig();if(r){const T=this._viewportRuler.getViewportScrollPosition();vm(i,this._getExactOverlayY(e,t,T)),vm(i,this._getExactOverlayX(e,t,T))}else i.position="static";let m="",b=this._getOffset(e,"x"),E=this._getOffset(e,"y");b&&(m+=`translateX(${b}px) `),E&&(m+=`translateY(${E}px)`),i.transform=m.trim(),u.maxHeight&&(r?i.maxHeight=yo(u.maxHeight):s&&(i.maxHeight="")),u.maxWidth&&(r?i.maxWidth=yo(u.maxWidth):s&&(i.maxWidth="")),vm(this._pane.style,i)}_getExactOverlayY(t,e,i){let r={top:"",bottom:""},s=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===t.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=yo(s.y),r}_getExactOverlayX(t,e,i){let u,r={left:"",right:""},s=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),u=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===u?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=yo(s.x),r}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:aL(t,i),isOriginOutsideView:xM(t,i),isOverlayClipped:aL(e,i),isOverlayOutsideView:xM(e,i)}}_subtractOverflows(t,...e){return e.reduce((i,r)=>i-Math.max(r,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+t-this._viewportMargin,bottom:i.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&Hw(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof jt)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,i=t.height||0;return{top:t.y,bottom:t.y+i,left:t.x,right:t.x+e,height:i,width:e}}}function vm(n,t){for(let e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function hL(n){if("number"!=typeof n&&null!=n){const[t,e]=n.split(X9);return e&&"px"!==e?null:parseFloat(t)}return n||null}function pL(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const fL="cdk-global-overlay-wrapper";class K9{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(fL),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:u,maxHeight:m}=i,b=!("100%"!==r&&"100vw"!==r||u&&"100%"!==u&&"100vw"!==u),E=!("100%"!==s&&"100vh"!==s||m&&"100%"!==m&&"100vh"!==m),T=this._xPosition,O=this._xOffset,H="rtl"===this._overlayRef.getConfig().direction;let q="",oe="",de="";b?de="flex-start":"center"===T?(de="center",H?oe=O:q=O):H?"left"===T||"end"===T?(de="flex-end",q=O):("right"===T||"start"===T)&&(de="flex-start",oe=O):"left"===T||"start"===T?(de="flex-start",q=O):("right"===T||"end"===T)&&(de="flex-end",oe=O),t.position=this._cssPosition,t.marginLeft=b?"0":q,t.marginTop=E?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=b?"0":oe,e.justifyContent=de,e.alignItems=E?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,i=e.style;e.classList.remove(fL),i.justifyContent=i.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let J9=(()=>{class n{constructor(e,i,r,s){this._viewportRuler=e,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new K9}flexibleConnectedTo(e){return new uL(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Ww),Ne(Nn),Ne(Qr),Ne(cL))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Q9=0,Dp=(()=>{class n{constructor(e,i,r,s,u,m,b,E,T,O,H,q){this.scrollStrategies=e,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=u,this._injector=m,this._ngZone=b,this._document=E,this._directionality=T,this._location=O,this._outsideClickDispatcher=H,this._animationsModuleType=q}create(e){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),u=new wM(e);return u.direction=u.direction||this._directionality.value,new Y9(s,i,r,u,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(e){const i=this._document.createElement("div");return i.id="cdk-overlay-"+Q9++,i.classList.add("cdk-overlay-pane"),e.appendChild(i),i}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(hp)),new U9(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(e){return new(e||n)(Ne(G9),Ne(cL),Ne(op),Ne(J9),Ne(W9),Ne(Ro),Ne(rn),Ne(Nn),Ne(kc),Ne($x),Ne(Z9),Ne(ko,8))},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const n7={provide:new Ke("cdk-connected-overlay-scroll-strategy"),deps:[Dp],useFactory:function t7(n){return()=>n.scrollStrategies.reposition()}};let P1=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[Dp,n7],imports:[xb,rL,IS,IS]}),n})();const r7=["mat-calendar-body",""];function o7(n,t){if(1&n&&(Ye(0,"tr",3)(1,"td",4),Kn(2),ot()()),2&n){const e=Nt();Ze(1),Ad("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),Ln("colspan",e.numCols),Ze(1),zs(" ",e.label," ")}}function s7(n,t){if(1&n&&(Ye(0,"td",4),Kn(1),ot()),2&n){const e=Nt(2);Ad("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),Ln("colspan",e._firstRowOffset),Ze(1),zs(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function a7(n,t){if(1&n){const e=rl();Ye(0,"td",8)(1,"button",9),Kt("click",function(r){const u=ti(e).$implicit;return on(Nt(2)._cellClicked(u,r))})("focus",function(r){const u=ti(e).$implicit;return on(Nt(2)._emitActiveDateChange(u,r))}),Ye(2,"span",10),Kn(3),ot(),_n(4,"span",11),ot()()}if(2&n){const e=t.$implicit,i=t.index,r=Nt().index,s=Nt();Ad("width",s._cellWidth)("padding-top",s._cellPadding)("padding-bottom",s._cellPadding),Ln("data-mat-row",r)("data-mat-col",i),Ze(1),Xn("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",s._isActiveCell(r,i))("mat-calendar-body-range-start",s._isRangeStart(e.compareValue))("mat-calendar-body-range-end",s._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",s._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",s._isComparisonBridgeStart(e.compareValue,r,i))("mat-calendar-body-comparison-bridge-end",s._isComparisonBridgeEnd(e.compareValue,r,i))("mat-calendar-body-comparison-start",s._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",s._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",s._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",s._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",s._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",s._isInPreview(e.compareValue)),et("ngClass",e.cssClasses)("tabindex",s._isActiveCell(r,i)?0:-1),Ln("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",s._isSelected(e.compareValue))("aria-current",s.todayValue===e.compareValue?"date":null)("aria-describedby",s._getDescribedby(e.compareValue)),Ze(1),Xn("mat-calendar-body-selected",s._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",s._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",s.todayValue===e.compareValue),Ze(1),zs(" ",e.displayValue," ")}}function l7(n,t){if(1&n&&(Ye(0,"tr",5),kt(1,s7,2,6,"td",6),kt(2,a7,5,48,"td",7),ot()),2&n){const e=t.$implicit,i=t.index,r=Nt();Ze(1),et("ngIf",0===i&&r._firstRowOffset),Ze(1),et("ngForOf",e)}}function c7(n,t){if(1&n&&(Ye(0,"th",5)(1,"span",6),Kn(2),ot(),Ye(3,"span",7),Kn(4),ot()()),2&n){const e=t.$implicit;Ze(2),Ma(e.long),Ze(2),Ma(e.narrow)}}const d7=["*"];function u7(n,t){}function h7(n,t){if(1&n){const e=rl();Ye(0,"mat-month-view",5),Kt("activeDateChange",function(r){return ti(e),on(Nt().activeDate=r)})("_userSelection",function(r){return ti(e),on(Nt()._dateSelected(r))})("dragStarted",function(r){return ti(e),on(Nt()._dragStarted(r))})("dragEnded",function(r){return ti(e),on(Nt()._dragEnded(r))}),ot()}if(2&n){const e=Nt();et("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)("startDateAccessibleName",e.startDateAccessibleName)("endDateAccessibleName",e.endDateAccessibleName)("activeDrag",e._activeDrag)}}function p7(n,t){if(1&n){const e=rl();Ye(0,"mat-year-view",6),Kt("activeDateChange",function(r){return ti(e),on(Nt().activeDate=r)})("monthSelected",function(r){return ti(e),on(Nt()._monthSelectedInYearView(r))})("selectedChange",function(r){return ti(e),on(Nt()._goToDateInView(r,"month"))}),ot()}if(2&n){const e=Nt();et("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function f7(n,t){if(1&n){const e=rl();Ye(0,"mat-multi-year-view",7),Kt("activeDateChange",function(r){return ti(e),on(Nt().activeDate=r)})("yearSelected",function(r){return ti(e),on(Nt()._yearSelectedInMultiYearView(r))})("selectedChange",function(r){return ti(e),on(Nt()._goToDateInView(r,"year"))}),ot()}if(2&n){const e=Nt();et("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function m7(n,t){}const g7=["button"];function _7(n,t){1&n&&(ba(),Ye(0,"svg",3),_n(1,"path",4),ot())}const y7=[[["","matDatepickerToggleIcon",""]]],v7=["[matDatepickerToggleIcon]"],b7=[[["input","matStartDate",""]],[["input","matEndDate",""]]],x7=["input[matStartDate]","input[matEndDate]"];let Vb=(()=>{class n{constructor(){this.changes=new Xt,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(e,i){return`${e} \u2013 ${i}`}formatYearRangeLabel(e,i){return`${e} to ${i}`}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class CM{constructor(t,e,i,r,s={},u=t,m){this.value=t,this.displayValue=e,this.ariaLabel=i,this.enabled=r,this.cssClasses=s,this.compareValue=u,this.rawValue=m}}let w7=1,j_=(()=>{class n{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(e,i){this._elementRef=e,this._ngZone=i,this._platform=gt(Qr),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new Tt,this.previewChange=new Tt,this.activeDateChange=new Tt,this.dragStarted=new Tt,this.dragEnded=new Tt,this._didDragSinceMouseDown=!1,this._enterHandler=r=>{if(this._skipNextFocus&&"focus"===r.type)this._skipNextFocus=!1;else if(r.target&&this.isRange){const s=this._getCellFromElement(r.target);s&&this._ngZone.run(()=>this.previewChange.emit({value:s.enabled?s:null,event:r}))}},this._touchmoveHandler=r=>{if(!this.isRange)return;const s=mL(r),u=s?this._getCellFromElement(s):null;s!==r.target&&(this._didDragSinceMouseDown=!0),DM(r.target)&&r.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:u?.enabled?u:null,event:r}))},this._leaveHandler=r=>{null!==this.previewEnd&&this.isRange&&("blur"!==r.type&&(this._didDragSinceMouseDown=!0),r.target&&this._getCellFromElement(r.target)&&(!r.relatedTarget||!this._getCellFromElement(r.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:r})))},this._mousedownHandler=r=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;const s=r.target&&this._getCellFromElement(r.target);!s||!this._isInRange(s.rawValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:s.rawValue,event:r})})},this._mouseupHandler=r=>{if(!this.isRange)return;const s=DM(r.target);s?s.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{const u=this._getCellFromElement(s);this.dragEnded.emit({value:u?.rawValue??null,event:r})}):this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:r})})},this._touchendHandler=r=>{const s=mL(r);s&&this._mouseupHandler({target:s})},this._id="mat-calendar-body-"+w7++,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,i.runOutsideAngular(()=>{const r=e.nativeElement;r.addEventListener("mouseenter",this._enterHandler,!0),r.addEventListener("touchmove",this._touchmoveHandler,!0),r.addEventListener("focus",this._enterHandler,!0),r.addEventListener("mouseleave",this._leaveHandler,!0),r.addEventListener("blur",this._leaveHandler,!0),r.addEventListener("mousedown",this._mousedownHandler),r.addEventListener("touchstart",this._mousedownHandler),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(e,i){this._didDragSinceMouseDown||e.enabled&&this.selectedValueChange.emit({value:e.value,event:i})}_emitActiveDateChange(e,i){e.enabled&&this.activeDateChange.emit({value:e.value,event:i})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){const i=e.numCols,{rows:r,numCols:s}=this;(e.rows||i)&&(this._firstRowOffset=r&&r.length&&r[0].length?s-r[0].length:0),(e.cellAspectRatio||i||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/s+"%"),(i||!this._cellWidth)&&(this._cellWidth=100/s+"%")}ngOnDestroy(){const e=this._elementRef.nativeElement;e.removeEventListener("mouseenter",this._enterHandler,!0),e.removeEventListener("touchmove",this._touchmoveHandler,!0),e.removeEventListener("focus",this._enterHandler,!0),e.removeEventListener("mouseleave",this._leaveHandler,!0),e.removeEventListener("blur",this._leaveHandler,!0),e.removeEventListener("mousedown",this._mousedownHandler),e.removeEventListener("touchstart",this._mousedownHandler),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(e,i){let r=e*this.numCols+i;return e&&(r-=this._firstRowOffset),r==this.activeCell}_focusActiveCell(e=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Jr(1)).subscribe(()=>{setTimeout(()=>{const i=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");i&&(e||(this._skipNextFocus=!0),i.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return SM(e,this.startValue,this.endValue)}_isRangeEnd(e){return MM(e,this.startValue,this.endValue)}_isInRange(e){return TM(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return SM(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,i,r){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let s=this.rows[i][r-1];if(!s){const u=this.rows[i-1];s=u&&u[u.length-1]}return s&&!this._isRangeEnd(s.compareValue)}_isComparisonBridgeEnd(e,i,r){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let s=this.rows[i][r+1];if(!s){const u=this.rows[i+1];s=u&&u[0]}return s&&!this._isRangeStart(s.compareValue)}_isComparisonEnd(e){return MM(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return TM(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return SM(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return MM(e,this.previewStart,this.previewEnd)}_isInPreview(e){return TM(e,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(e){return this.isRange?this.startValue===e&&this.endValue===e?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===e?this._startDateLabelId:this.endValue===e?this._endDateLabelId:null:null}_getCellFromElement(e){const i=DM(e);if(i){const r=i.getAttribute("data-mat-row"),s=i.getAttribute("data-mat-col");if(r&&s)return this.rows[parseInt(r)][parseInt(s)]}return null}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(rn))},n.\u0275cmp=Fn({type:n,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[M],attrs:r7,decls:6,vars:6,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],[1,"mat-calendar-body-hidden-label",3,"id"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click","focus"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(e,i){1&e&&(kt(0,o7,3,6,"tr",0),kt(1,l7,3,2,"tr",1),Ye(2,"label",2),Kn(3),ot(),Ye(4,"label",2),Kn(5),ot()),2&e&&(et("ngIf",i._firstRowOffset<i.labelMinRequiredCells),Ze(1),et("ngForOf",i.rows),Ze(1),et("id",i._startDateLabelId),Ze(1),zs(" ",i.startDateAccessibleName,"\n"),Ze(1),et("id",i._endDateLabelId),Ze(1),zs(" ",i.endDateAccessibleName,"\n"))},dependencies:[ew,tw,Nu],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}'],encapsulation:2,changeDetection:0}),n})();function EM(n){return"TD"===n?.nodeName}function DM(n){let t;return EM(n)?t=n:EM(n.parentNode)?t=n.parentNode:EM(n.parentNode?.parentNode)&&(t=n.parentNode.parentNode),null!=t?.getAttribute("data-mat-row")?t:null}function SM(n,t,e){return null!==e&&t!==e&&n<e&&n===t}function MM(n,t,e){return null!==t&&t!==e&&n>=t&&n===e}function TM(n,t,e,i){return i&&null!==t&&null!==e&&t!==e&&n>=t&&n<=e}function mL(n){const t=n.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)}class ys{constructor(t,e){this.start=t,this.end=e}}let Sp=(()=>{class n{constructor(e,i){this.selection=e,this._adapter=i,this._selectionChanged=new Xt,this.selectionChanged=this._selectionChanged,this.selection=e}updateSelection(e,i){const r=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:i,oldValue:r})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}}return n.\u0275fac=function(e){Iu()},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})(),C7=(()=>{class n extends Sp{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const e=new n(this._adapter);return e.updateSelection(this.selection,this),e}}return n.\u0275fac=function(e){return new(e||n)(Ne(to))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})(),E7=(()=>{class n extends Sp{constructor(e){super(new ys(null,null),e)}add(e){let{start:i,end:r}=this.selection;null==i?i=e:null==r?r=e:(i=e,r=null),super.updateSelection(new ys(i,r),this)}isValid(){const{start:e,end:i}=this.selection;return null==e&&null==i||(null!=e&&null!=i?this._isValidDateInstance(e)&&this._isValidDateInstance(i)&&this._adapter.compareDate(e,i)<=0:(null==e||this._isValidDateInstance(e))&&(null==i||this._isValidDateInstance(i)))}isComplete(){return null!=this.selection.start&&null!=this.selection.end}clone(){const e=new n(this._adapter);return e.updateSelection(this.selection,this),e}}return n.\u0275fac=function(e){return new(e||n)(Ne(to))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const S7={provide:Sp,deps:[[new Er,new br,Sp],to],useFactory:function D7(n,t){return n||new C7(t)}},T7={provide:Sp,deps:[[new Er,new br,Sp],to],useFactory:function M7(n,t){return n||new E7(t)}},O1=new Ke("MAT_DATE_RANGE_SELECTION_STRATEGY");let A7=(()=>{class n{constructor(e){this._dateAdapter=e}selectionFinished(e,i){let{start:r,end:s}=i;return null==r?r=e:null==s&&e&&this._dateAdapter.compareDate(e,r)>=0?s=e:(r=e,s=null),new ys(r,s)}createPreview(e,i){let r=null,s=null;return i.start&&!i.end&&e&&(r=i.start,s=e),new ys(r,s)}createDrag(e,i,r){let s=i.start,u=i.end;if(!s||!u)return null;const m=this._dateAdapter,b=0!==m.compareDate(s,u),E=m.getYear(r)-m.getYear(e),T=m.getMonth(r)-m.getMonth(e),O=m.getDate(r)-m.getDate(e);return b&&m.sameDate(e,i.start)?(s=r,m.compareDate(r,u)>0&&(u=m.addCalendarYears(u,E),u=m.addCalendarMonths(u,T),u=m.addCalendarDays(u,O))):b&&m.sameDate(e,i.end)?(u=r,m.compareDate(r,s)<0&&(s=m.addCalendarYears(s,E),s=m.addCalendarMonths(s,T),s=m.addCalendarDays(s,O))):(s=m.addCalendarYears(s,E),s=m.addCalendarMonths(s,T),s=m.addCalendarDays(s,O),u=m.addCalendarYears(u,E),u=m.addCalendarMonths(u,T),u=m.addCalendarDays(u,O)),new ys(s,u)}}return n.\u0275fac=function(e){return new(e||n)(Ne(to))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();const k7={provide:O1,deps:[[new Er,new br,O1],to],useFactory:function I7(n,t){return n||new A7(t)}};let gL=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){const i=this._activeDate,r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this._hasSameMonthAndYear(i,this._activeDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ys?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,r,s,u){this._changeDetectorRef=e,this._dateFormats=i,this._dateAdapter=r,this._dir=s,this._rangeStrategy=u,this._rerenderSubscription=Ie.EMPTY,this.activeDrag=null,this.selectedChange=new Tt,this._userSelection=new Tt,this.dragStarted=new Tt,this.dragEnded=new Tt,this.activeDateChange=new Tt,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Rd(null)).subscribe(()=>this._init())}ngOnChanges(e){const i=e.comparisonStart||e.comparisonEnd;i&&!i.firstChange&&this._setRanges(this.selected),e.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){const i=e.value,r=this._getDateFromDayOfMonth(i);let s,u;this._selected instanceof ys?(s=this._getDateInCurrentMonth(this._selected.start),u=this._getDateInCurrentMonth(this._selected.end)):s=u=this._getDateInCurrentMonth(this._selected),(s!==i||u!==i)&&this.selectedChange.emit(r),this._userSelection.emit({value:r,event:e.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&e.preventDefault());case 27:return void(null!=this._previewEnd&&!sl(e)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:e}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e})),e.preventDefault(),e.stopPropagation()));default:return}this._dateAdapter.compareDate(i,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:i}){if(this._rangeStrategy){const r=i?i.rawValue:null,s=this._rangeStrategy.createPreview(r,this.selected,e);if(this._previewStart=this._getCellCompareValue(s.start),this._previewEnd=this._getCellCompareValue(s.end),this.activeDrag&&r){const u=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,r,e);u&&(this._previewStart=this._getCellCompareValue(u.start),this._previewEnd=this._getCellCompareValue(u.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(e){if(this.activeDrag)if(e.value){const i=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,e.value,e.event);this.dragEnded.emit({value:i??null,event:e.event})}else this.dragEnded.emit({value:null,event:e.event})}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){const e=this._dateAdapter.getFirstDayOfWeek(),i=this._dateAdapter.getDayOfWeekNames("narrow");let s=this._dateAdapter.getDayOfWeekNames("long").map((u,m)=>({long:u,narrow:i[m]}));this._weekdays=s.slice(e).concat(s.slice(0,e))}_createWeekCells(){const e=this._dateAdapter.getNumDaysInMonth(this.activeDate),i=this._dateAdapter.getDateNames();this._weeks=[[]];for(let r=0,s=this._firstWeekOffset;r<e;r++,s++){7==s&&(this._weeks.push([]),s=0);const u=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),r+1),m=this._shouldEnableDate(u),b=this._dateAdapter.format(u,this._dateFormats.display.dateA11yLabel),E=this.dateClass?this.dateClass(u,"month"):void 0;this._weeks[this._weeks.length-1].push(new CM(r+1,i[r],b,m,E,this._getCellCompareValue(u),u))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,i){return!(!e||!i||this._dateAdapter.getMonth(e)!=this._dateAdapter.getMonth(i)||this._dateAdapter.getYear(e)!=this._dateAdapter.getYear(i))}_getCellCompareValue(e){if(e){const i=this._dateAdapter.getYear(e),r=this._dateAdapter.getMonth(e),s=this._dateAdapter.getDate(e);return new Date(i,r,s).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(e){e instanceof ys?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}_clearPreview(){this._previewStart=this._previewEnd=null}}return n.\u0275fac=function(e){return new(e||n)(J(zr),J(Fd,8),J(to,8),J(kc,8),J(O1,8))},n.\u0275cmp=Fn({type:n,selectors:[["mat-month-view"]],viewQuery:function(e,i){if(1&e&&ci(j_,5),2&e){let r;Bt(r=zt())&&(i._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[M],decls:7,vars:15,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName","selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown"],["scope","col"],[1,"cdk-visually-hidden"],["aria-hidden","true"]],template:function(e,i){1&e&&(Ye(0,"table",0)(1,"thead",1)(2,"tr"),kt(3,c7,5,2,"th",2),ot(),Ye(4,"tr"),_n(5,"th",3),ot()(),Ye(6,"tbody",4),Kt("selectedValueChange",function(s){return i._dateSelected(s)})("activeDateChange",function(s){return i._updateActiveDate(s)})("previewChange",function(s){return i._previewChanged(s)})("dragStarted",function(s){return i.dragStarted.emit(s)})("dragEnded",function(s){return i._dragEnded(s)})("keyup",function(s){return i._handleCalendarBodyKeyup(s)})("keydown",function(s){return i._handleCalendarBodyKeydown(s)}),ot()()),2&e&&(Ze(3),et("ngForOf",i._weekdays),Ze(3),et("label",i._monthLabel)("rows",i._weeks)("todayValue",i._todayDate)("startValue",i._rangeStart)("endValue",i._rangeEnd)("comparisonStart",i._comparisonRangeStart)("comparisonEnd",i._comparisonRangeEnd)("previewStart",i._previewStart)("previewEnd",i._previewEnd)("isRange",i._isRange)("labelMinRequiredCells",3)("activeCell",i._dateAdapter.getDate(i.activeDate)-1)("startDateAccessibleName",i.startDateAccessibleName)("endDateAccessibleName",i.endDateAccessibleName))},dependencies:[tw,j_],encapsulation:2,changeDetection:0}),n})();const al=24;let _L=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){let i=this._activeDate;const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),yL(this._dateAdapter,i,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ys?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,r){this._changeDetectorRef=e,this._dateAdapter=i,this._dir=r,this._rerenderSubscription=Ie.EMPTY,this.selectedChange=new Tt,this.yearSelected=new Tt,this.activeDateChange=new Tt,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Rd(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const i=this._dateAdapter.getYear(this._activeDate)-Ub(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let r=0,s=[];r<al;r++)s.push(i+r),4==s.length&&(this._years.push(s.map(u=>this._createCellForYear(u))),s=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){const i=e.value,r=this._dateAdapter.createDate(i,0,1),s=this._getDateFromYear(i);this.yearSelected.emit(r),this.selectedChange.emit(s)}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromYear(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-Ub(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,al-Ub(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*-al:-al);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*al:al);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return Ub(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){const i=this._dateAdapter.getMonth(this.activeDate),r=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,i,1));return this._dateAdapter.createDate(e,i,Math.min(this._dateAdapter.getDate(this.activeDate),r))}_createCellForYear(e){const i=this._dateAdapter.createDate(e,0,1),r=this._dateAdapter.getYearName(i),s=this.dateClass?this.dateClass(i,"multi-year"):void 0;return new CM(e,r,r,this._shouldEnableYear(e),s)}_shouldEnableYear(e){if(null==e||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let r=this._dateAdapter.createDate(e,0,1);this._dateAdapter.getYear(r)==e;r=this._dateAdapter.addCalendarDays(r,1))if(this.dateFilter(r))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(e){if(this._selectedYear=null,e instanceof ys){const i=e.start||e.end;i&&(this._selectedYear=this._dateAdapter.getYear(i))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}}return n.\u0275fac=function(e){return new(e||n)(J(zr),J(to,8),J(kc,8))},n.\u0275cmp=Fn({type:n,selectors:[["mat-multi-year-view"]],viewQuery:function(e,i){if(1&e&&ci(j_,5),2&e){let r;Bt(r=zt())&&(i._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(e,i){1&e&&(Ye(0,"table",0)(1,"thead",1)(2,"tr"),_n(3,"th",2),ot()(),Ye(4,"tbody",3),Kt("selectedValueChange",function(s){return i._yearSelected(s)})("activeDateChange",function(s){return i._updateActiveDate(s)})("keyup",function(s){return i._handleCalendarBodyKeyup(s)})("keydown",function(s){return i._handleCalendarBodyKeydown(s)}),ot()()),2&e&&(Ze(4),et("rows",i._years)("todayValue",i._todayYear)("startValue",i._selectedYear)("endValue",i._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",i._getActiveCell()))},dependencies:[j_],encapsulation:2,changeDetection:0}),n})();function yL(n,t,e,i,r){const s=n.getYear(t),u=n.getYear(e),m=vL(n,i,r);return Math.floor((s-m)/al)===Math.floor((u-m)/al)}function Ub(n,t,e,i){return function R7(n,t){return(n%t+t)%t}(n.getYear(t)-vL(n,e,i),al)}function vL(n,t,e){let i=0;return e?i=n.getYear(e)-al+1:t&&(i=n.getYear(t)),i}let bL=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){let i=this._activeDate;const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this._dateAdapter.getYear(i)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ys?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,r,s){this._changeDetectorRef=e,this._dateFormats=i,this._dateAdapter=r,this._dir=s,this._rerenderSubscription=Ie.EMPTY,this.selectedChange=new Tt,this.monthSelected=new Tt,this.activeDateChange=new Tt,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Rd(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){const i=e.value,r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),i,1);this.monthSelected.emit(r);const s=this._getDateFromMonth(i);this.selectedChange.emit(s)}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromMonth(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(i,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(i=>i.map(r=>this._createCellForMonth(r,e[r]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){const i=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),r=this._dateAdapter.getNumDaysInMonth(i);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),r))}_createCellForMonth(e,i){const r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),s=this._dateAdapter.format(r,this._dateFormats.display.monthYearA11yLabel),u=this.dateClass?this.dateClass(r,"year"):void 0;return new CM(e,i.toLocaleUpperCase(),s,this._shouldEnableMonth(e),u)}_shouldEnableMonth(e){const i=this._dateAdapter.getYear(this.activeDate);if(null==e||this._isYearAndMonthAfterMaxDate(i,e)||this._isYearAndMonthBeforeMinDate(i,e))return!1;if(!this.dateFilter)return!0;for(let s=this._dateAdapter.createDate(i,e,1);this._dateAdapter.getMonth(s)==e;s=this._dateAdapter.addCalendarDays(s,1))if(this.dateFilter(s))return!0;return!1}_isYearAndMonthAfterMaxDate(e,i){if(this.maxDate){const r=this._dateAdapter.getYear(this.maxDate),s=this._dateAdapter.getMonth(this.maxDate);return e>r||e===r&&i>s}return!1}_isYearAndMonthBeforeMinDate(e,i){if(this.minDate){const r=this._dateAdapter.getYear(this.minDate),s=this._dateAdapter.getMonth(this.minDate);return e<r||e===r&&i<s}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(e){this._selectedMonth=e instanceof ys?this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._getMonthInCurrentYear(e)}}return n.\u0275fac=function(e){return new(e||n)(J(zr),J(Fd,8),J(to,8),J(kc,8))},n.\u0275cmp=Fn({type:n,selectors:[["mat-year-view"]],viewQuery:function(e,i){if(1&e&&ci(j_,5),2&e){let r;Bt(r=zt())&&(i._matCalendarBody=r.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(e,i){1&e&&(Ye(0,"table",0)(1,"thead",1)(2,"tr"),_n(3,"th",2),ot()(),Ye(4,"tbody",3),Kt("selectedValueChange",function(s){return i._monthSelected(s)})("activeDateChange",function(s){return i._updateActiveDate(s)})("keyup",function(s){return i._handleCalendarBodyKeyup(s)})("keydown",function(s){return i._handleCalendarBodyKeydown(s)}),ot()()),2&e&&(Ze(4),et("label",i._yearLabel)("rows",i._months)("todayValue",i._todayMonth)("startValue",i._selectedMonth)("endValue",i._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",i._dateAdapter.getMonth(i.activeDate)))},dependencies:[j_],encapsulation:2,changeDetection:0}),n})(),P7=1,O7=(()=>{class n{constructor(e,i,r,s,u){this._intl=e,this.calendar=i,this._dateAdapter=r,this._dateFormats=s,this._id="mat-calendar-header-"+P7++,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>u.markForCheck())}get periodButtonText(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-al)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:al)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,i){return"month"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(i)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(i):"year"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(i):yL(this._dateAdapter,e,i,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){const i=this._dateAdapter.getYear(this.calendar.activeDate)-Ub(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),r=i+al-1;return[this._dateAdapter.getYearName(this._dateAdapter.createDate(i,0,1)),this._dateAdapter.getYearName(this._dateAdapter.createDate(r,0,1))]}}return n.\u0275fac=function(e){return new(e||n)(J(Vb),J(Pn(()=>kM)),J(to,8),J(Fd,8),J(zr))},n.\u0275cmp=Fn({type:n,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:d7,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"],[1,"mat-calendar-hidden-label",3,"id"]],template:function(e,i){1&e&&(fo(),Ye(0,"div",0)(1,"div",1)(2,"button",2),Kt("click",function(){return i.currentPeriodClicked()}),Ye(3,"span",3),Kn(4),ot(),ba(),Ye(5,"svg",4),_n(6,"polygon",5),ot()(),function uc(){!function iC(){Le.lFrame.currentNamespace=null}()}(),_n(7,"div",6),qn(8),Ye(9,"button",7),Kt("click",function(){return i.previousClicked()}),ot(),Ye(10,"button",8),Kt("click",function(){return i.nextClicked()}),ot()()(),Ye(11,"label",9),Kn(12),ot()),2&e&&(Ze(2),Ln("aria-label",i.periodButtonLabel)("aria-describedby",i._periodButtonLabelId),Ze(2),Ma(i.periodButtonText),Ze(1),Xn("mat-calendar-invert","month"!==i.calendar.currentView),Ze(4),et("disabled",!i.previousEnabled()),Ln("aria-label",i.prevButtonLabel),Ze(1),et("disabled",!i.nextEnabled()),Ln("aria-label",i.nextButtonLabel),Ze(1),et("id",i._periodButtonLabelId),Ze(1),Ma(i.periodButtonDescription))},dependencies:[jF,gM],encapsulation:2,changeDetection:0}),n})(),kM=(()=>{class n{get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get selected(){return this._selected}set selected(e){this._selected=e instanceof ys?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(e){const i=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),i&&this.viewChanged.emit(i)}constructor(e,i,r,s){this._dateAdapter=i,this._dateFormats=r,this._changeDetectorRef=s,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new Tt,this.yearSelected=new Tt,this.monthSelected=new Tt,this.viewChanged=new Tt(!0),this._userSelection=new Tt,this._userDragDrop=new Tt,this._activeDrag=null,this.stateChanges=new Xt,this._intlChanges=e.changes.subscribe(()=>{s.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new bM(this.headerComponent||O7),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){const i=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,r=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,s=i||r||e.dateFilter;if(s&&!s.firstChange){const u=this._getCurrentViewComponent();u&&(this._changeDetectorRef.detectChanges(),u._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){const i=e.value;(this.selected instanceof ys||i&&!this._dateAdapter.sameDate(i,this.selected))&&this.selectedChange.emit(i),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,i){this.activeDate=e,this.currentView=i}_dragStarted(e){this._activeDrag=e}_dragEnded(e){this._activeDrag&&(e.value&&this._userDragDrop.emit(e),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}}return n.\u0275fac=function(e){return new(e||n)(J(Vb),J(to,8),J(Fd,8),J(zr))},n.\u0275cmp=Fn({type:n,selectors:[["mat-calendar"]],viewQuery:function(e,i){if(1&e&&(ci(gL,5),ci(bL,5),ci(_L,5)),2&e){let r;Bt(r=zt())&&(i.monthView=r.first),Bt(r=zt())&&(i.yearView=r.first),Bt(r=zt())&&(i.multiYearView=r.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[Zt([S7]),M],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(e,i){1&e&&(kt(0,u7,0,0,"ng-template",0),Ye(1,"div",1),kt(2,h7,1,11,"mat-month-view",2),kt(3,p7,1,6,"mat-year-view",3),kt(4,f7,1,6,"mat-multi-year-view",4),ot()),2&e&&(et("cdkPortalOutlet",i._calendarHeaderPortal),Ze(1),et("ngSwitch",i.currentView),Ze(1),et("ngSwitchCase","month"),Ze(1),et("ngSwitchCase","year"),Ze(1),et("ngSwitchCase","multi-year"))},dependencies:[tm,Zv,I2,iL,gL,bL,_L],styles:['.mat-calendar{display:block}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}.mat-calendar-hidden-label{display:none}'],encapsulation:2,changeDetection:0}),n})();const xL={transformPanel:sa("transformPanel",[Mr("void => enter-dropdown",Ur("120ms cubic-bezier(0, 0, 0.2, 1)",w_([Vn({opacity:0,transform:"scale(1, 0.8)"}),Vn({opacity:1,transform:"scale(1, 1)"})]))),Mr("void => enter-dialog",Ur("150ms cubic-bezier(0, 0, 0.2, 1)",w_([Vn({opacity:0,transform:"scale(0.7)"}),Vn({transform:"none",opacity:1})]))),Mr("* => void",Ur("100ms linear",Vn({opacity:0})))]),fadeInCalendar:sa("fadeInCalendar",[Sr("void",Vn({opacity:0})),Sr("enter",Vn({opacity:1})),Mr("void => *",Ur("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let F7=0;const wL=new Ke("mat-datepicker-scroll-strategy"),N7={provide:wL,deps:[Dp],useFactory:function L7(n){return()=>n.scrollStrategies.reposition()}},B7=Tb(class{constructor(n){this._elementRef=n}});let z7=(()=>{class n extends B7{constructor(e,i,r,s,u,m){super(e),this._changeDetectorRef=i,this._globalModel=r,this._dateAdapter=s,this._rangeSelectionStrategy=u,this._subscriptions=new Ie,this._animationDone=new Xt,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=m.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){const i=this._model.selection,r=e.value,s=i instanceof ys;if(s&&this._rangeSelectionStrategy){const u=this._rangeSelectionStrategy.selectionFinished(r,i,e.event);this._model.updateSelection(u,this)}else r&&(s||!this._dateAdapter.sameDate(r,i))&&this._model.add(r);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(e){this._model.updateSelection(e.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(e){this._isAnimating="start"===e.phaseName,this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,i){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,i&&this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(zr),J(Sp),J(to),J(O1,8),J(Vb))},n.\u0275cmp=Fn({type:n,selectors:[["mat-datepicker-content"]],viewQuery:function(e,i){if(1&e&&ci(kM,5),2&e){let r;Bt(r=zt())&&(i._calendar=r.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(e,i){1&e&&hE("@transformPanel.start",function(s){return i._handleAnimationEvent(s)})("@transformPanel.done",function(s){return i._handleAnimationEvent(s)}),2&e&&(yE("@transformPanel",i._animationState),Xn("mat-datepicker-content-touch",i.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[Et],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(e,i){if(1&e&&(Ye(0,"div",0)(1,"mat-calendar",1),Kt("yearSelected",function(s){return i.datepicker._selectYear(s)})("monthSelected",function(s){return i.datepicker._selectMonth(s)})("viewChanged",function(s){return i.datepicker._viewChanged(s)})("_userSelection",function(s){return i._handleUserSelection(s)})("_userDragDrop",function(s){return i._handleUserDragDrop(s)}),ot(),kt(2,m7,0,0,"ng-template",2),Ye(3,"button",3),Kt("focus",function(){return i._closeButtonFocused=!0})("blur",function(){return i._closeButtonFocused=!1})("click",function(){return i.datepicker.close()}),Kn(4),ot()()),2&e){let r;Xn("mat-datepicker-content-container-with-custom-header",i.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",i._actionsPortal),Ln("aria-modal",!0)("aria-labelledby",null!==(r=i._dialogLabelId)&&void 0!==r?r:void 0),Ze(1),et("id",i.datepicker.id)("ngClass",i.datepicker.panelClass)("startAt",i.datepicker.startAt)("startView",i.datepicker.startView)("minDate",i.datepicker._getMinDate())("maxDate",i.datepicker._getMaxDate())("dateFilter",i.datepicker._getDateFilter())("headerComponent",i.datepicker.calendarHeaderComponent)("selected",i._getSelected())("dateClass",i.datepicker.dateClass)("comparisonStart",i.comparisonStart)("comparisonEnd",i.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",i.startDateAccessibleName)("endDateAccessibleName",i.endDateAccessibleName),Ze(1),et("cdkPortalOutlet",i._actionsPortal),Ze(1),Xn("cdk-visually-hidden",!i._closeButtonFocused),et("color",i.color||"primary"),Ze(1),Ma(i._closeButtonText)}},dependencies:[ew,jF,P8,iL,kM],styles:[".mat-datepicker-content{display:block;border-radius:4px}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[xL.transformPanel,xL.fadeInCalendar]},changeDetection:0}),n})(),CL=(()=>{class n{get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(e){this._color=e}get touchUi(){return this._touchUi}set touchUi(e){this._touchUi=Bn(e)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(e){const i=Bn(e);i!==this._disabled&&(this._disabled=i,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(e){this._restoreFocus=Bn(e)}get panelClass(){return this._panelClass}set panelClass(e){this._panelClass=n2(e)}get opened(){return this._opened}set opened(e){Bn(e)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}constructor(e,i,r,s,u,m,b){this._overlay=e,this._ngZone=i,this._viewContainerRef=r,this._dateAdapter=u,this._dir=m,this._model=b,this._inputStateChanges=Ie.EMPTY,this._document=gt(Nn),this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new Tt,this.monthSelected=new Tt,this.viewChanged=new Tt(!0),this.openedStream=new Tt,this.closedStream=new Tt,this._opened=!1,this.id="mat-datepicker-"+F7++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new Xt,this._scrollStrategy=s}ngOnChanges(e){const i=e.xPosition||e.yPosition;if(i&&!i.firstChange&&this._overlayRef){const r=this._overlayRef.getConfig().positionStrategy;r instanceof uL&&(this._setConnectedPositions(r),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(e){this._model.add(e)}_selectYear(e){this.yearSelected.emit(e)}_selectMonth(e){this.monthSelected.emit(e)}_viewChanged(e){this.viewChanged.emit(e)}registerInput(e){return this._inputStateChanges.unsubscribe(),this.datepickerInput=e,this._inputStateChanges=e.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(e){this._actionsPortal=e,this._componentRef?.instance._assignActions(e,!0)}removeActions(e){e===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this._focusedElementBeforeOpen=s2(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;const e=this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus,i=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){const{instance:r,location:s}=this._componentRef;r._startExitAnimation(),r._animationDone.pipe(Jr(1)).subscribe(()=>{const u=this._document.activeElement;e&&(!u||u===this._document.activeElement||s.nativeElement.contains(u))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}e?setTimeout(i):i()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(e){e.datepicker=this,e.color=this.color,e._dialogLabelId=this.datepickerInput.getOverlayLabelId(),e._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();const e=this.touchUi,i=new bM(z7,this._viewContainerRef),r=this._overlayRef=this._overlay.create(new wM({positionStrategy:e?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[e?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:e?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(e?"dialog":"popup")}));this._getCloseStream(r).subscribe(s=>{s&&s.preventDefault(),this.close()}),r.keydownEvents().subscribe(s=>{const u=s.keyCode;(38===u||40===u||37===u||39===u||33===u||34===u)&&s.preventDefault()}),this._componentRef=r.attach(i),this._forwardContentValues(this._componentRef.instance),e||this._ngZone.onStable.pipe(Jr(1)).subscribe(()=>r.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const e=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){const i="end"===this.xPosition?"end":"start",r="start"===i?"end":"start",s="above"===this.yPosition?"bottom":"top",u="top"===s?"bottom":"top";return e.withPositions([{originX:i,originY:u,overlayX:i,overlayY:s},{originX:i,originY:s,overlayX:i,overlayY:u},{originX:r,originY:u,overlayX:r,overlayY:s},{originX:r,originY:s,overlayX:r,overlayY:u}])}_getCloseStream(e){const i=["ctrlKey","shiftKey","metaKey"];return $i(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(Lo(r=>27===r.keyCode&&!sl(r)||this.datepickerInput&&sl(r,"altKey")&&38===r.keyCode&&i.every(s=>!sl(r,s)))))}}return n.\u0275fac=function(e){return new(e||n)(J(Dp),J(rn),J(Oo),J(wL),J(to,8),J(kc,8),J(Sp))},n.\u0275dir=rt({type:n,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[M]}),n})();class F1{constructor(t,e){this.target=t,this.targetElement=e,this.value=this.target.value}}let EL=(()=>{class n{get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(e){this._assignValueProgrammatically(e)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(e){const i=Bn(e),r=this._elementRef.nativeElement;this._disabled!==i&&(this._disabled=i,this.stateChanges.next(void 0)),i&&this._isInitialized&&r.blur&&r.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(e){this._model=e,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(i=>{if(this._shouldHandleChangeEvent(i)){const r=this._getValueFromModel(i.selection);this._lastValueValid=this._isValidValue(r),this._cvaOnChange(r),this._onTouched(),this._formatValue(r),this.dateInput.emit(new F1(this,this._elementRef.nativeElement)),this.dateChange.emit(new F1(this,this._elementRef.nativeElement))}})}constructor(e,i,r){this._elementRef=e,this._dateAdapter=i,this._dateFormats=r,this.dateChange=new Tt,this.dateInput=new Tt,this.stateChanges=new Xt,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=Ie.EMPTY,this._localeSubscription=Ie.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=s=>{const u=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value));return!u||this._matchesFilter(u)?null:{matDatepickerFilter:!0}},this._minValidator=s=>{const u=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value)),m=this._getMinDate();return!m||!u||this._dateAdapter.compareDate(m,u)<=0?null:{matDatepickerMin:{min:m,actual:u}}},this._maxValidator=s=>{const u=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(s.value)),m=this._getMaxDate();return!m||!u||this._dateAdapter.compareDate(m,u)>=0?null:{matDatepickerMax:{max:m,actual:u}}},this._lastValueValid=!1,this._localeSubscription=i.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(e){DL(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}writeValue(e){this._assignValueProgrammatically(e)}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){sl(e,"altKey")&&40===e.keyCode&&["ctrlKey","shiftKey","metaKey"].every(s=>!sl(e,s))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),e.preventDefault())}_onInput(e){const i=this._lastValueValid;let r=this._dateAdapter.parse(e,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(r),r=this._dateAdapter.getValidDateOrNull(r);const s=!this._dateAdapter.sameDate(r,this.value);!r||s?this._cvaOnChange(r):(e&&!this.value&&this._cvaOnChange(r),i!==this._lastValueValid&&this._validatorOnChange()),s&&(this._assignValue(r),this.dateInput.emit(new F1(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new F1(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(e){this._elementRef.nativeElement.value=null!=e?this._dateAdapter.format(e,this._dateFormats.display.dateInput):""}_assignValue(e){this._model?(this._assignValueToModel(e),this._pendingValue=null):this._pendingValue=e}_isValidValue(e){return!e||this._dateAdapter.isValid(e)}_parentDisabled(){return!1}_assignValueProgrammatically(e){e=this._dateAdapter.deserialize(e),this._lastValueValid=this._isValidValue(e),e=this._dateAdapter.getValidDateOrNull(e),this._assignValue(e),this._formatValue(e)}_matchesFilter(e){const i=this._getDateFilter();return!i||i(e)}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(to,8),J(Fd,8))},n.\u0275dir=rt({type:n,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[M]}),n})();function DL(n,t){const e=Object.keys(n);for(let i of e){const{previousValue:r,currentValue:s}=n[i];if(!t.isDateInstance(r)||!t.isDateInstance(s))return!0;if(!t.sameDate(r,s))return!0}return!1}let j7=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rt({type:n,selectors:[["","matDatepickerToggleIcon",""]]}),n})(),H7=(()=>{class n{get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=Bn(e)}constructor(e,i,r){this._intl=e,this._changeDetectorRef=i,this._stateChanges=Ie.EMPTY;const s=Number(r);this.tabIndex=s||0===s?s:null}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){const e=this.datepicker?this.datepicker.stateChanges:qt(),i=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:qt(),r=this.datepicker?$i(this.datepicker.openedStream,this.datepicker.closedStream):qt();this._stateChanges.unsubscribe(),this._stateChanges=$i(this._intl.changes,e,i,r).subscribe(()=>this._changeDetectorRef.markForCheck())}}return n.\u0275fac=function(e){return new(e||n)(J(Vb),J(zr),Os("tabindex"))},n.\u0275cmp=Fn({type:n,selectors:[["mat-datepicker-toggle"]],contentQueries:function(e,i,r){if(1&e&&Ri(r,j7,5),2&e){let s;Bt(s=zt())&&(i._customIcon=s.first)}},viewQuery:function(e,i){if(1&e&&ci(g7,5),2&e){let r;Bt(r=zt())&&(i._button=r.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(e,i){1&e&&Kt("click",function(s){return i._open(s)}),2&e&&(Ln("tabindex",null)("data-mat-calendar",i.datepicker?i.datepicker.id:null),Xn("mat-datepicker-toggle-active",i.datepicker&&i.datepicker.opened)("mat-accent",i.datepicker&&"accent"===i.datepicker.color)("mat-warn",i.datepicker&&"warn"===i.datepicker.color))},inputs:{datepicker:["for","datepicker"],tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],disabled:"disabled",disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[M],ngContentSelectors:v7,decls:4,vars:6,consts:[["mat-icon-button","","type","button",3,"disabled","disableRipple"],["button",""],["class","mat-datepicker-toggle-default-icon","viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",4,"ngIf"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(e,i){1&e&&(fo(y7),Ye(0,"button",0,1),kt(2,_7,2,0,"svg",2),qn(3),ot()),2&e&&(et("disabled",i.disabled)("disableRipple",i.disableRipple),Ln("aria-haspopup",i.datepicker?"dialog":null)("aria-label",i.ariaLabel||i._intl.openCalendarLabel)("tabindex",i.disabled?-1:i.tabIndex),Ze(2),et("ngIf",!i._customIcon))},dependencies:[Nu,gM],styles:[".mat-datepicker-toggle{pointer-events:auto}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0}),n})();function $7(n){return RM(n,!0)}function ML(n){return n.nodeType===Node.ELEMENT_NODE}function RM(n,t){if(ML(n)&&t){const i=(n.getAttribute?.("aria-labelledby")?.split(/\s+/g)||[]).reduce((r,s)=>{const u=document.getElementById(s);return u&&r.push(u),r},[]);if(i.length)return i.map(r=>RM(r,!1)).join(" ")}if(ML(n)){const e=n.getAttribute("aria-label")?.trim();if(e)return e}if(function G7(n){return"INPUT"===n.nodeName}(n)||function q7(n){return"TEXTAREA"===n.nodeName}(n)){if(n.labels?.length)return Array.from(n.labels).map(r=>RM(r,!1)).join(" ");const e=n.getAttribute("placeholder")?.trim();if(e)return e;const i=n.getAttribute("title")?.trim();if(i)return i}return(n.textContent||"").replace(/\s+/g," ").trim()}const L1=new Ke("MAT_DATE_RANGE_INPUT_PARENT"),TL=HS((()=>{class n extends EL{constructor(e,i,r,s,u,m,b,E){super(i,b,E),this._rangeInput=e,this._elementRef=i,this._defaultErrorStateMatcher=r,this._injector=s,this._parentForm=u,this._parentFormGroup=m,this._dir=gt(kc,{optional:!0})}ngOnInit(){const e=this._injector.get(Ic,null,{optional:!0,self:!0});e&&(this.ngControl=e)}ngDoCheck(){this.ngControl&&this.updateErrorState()}isEmpty(){return 0===this._elementRef.nativeElement.value.length}_getPlaceholder(){return this._elementRef.nativeElement.placeholder}focus(){this._elementRef.nativeElement.focus()}getMirrorValue(){const e=this._elementRef.nativeElement,i=e.value;return i.length>0?i:e.placeholder}_onInput(e){super._onInput(e),this._rangeInput._handleChildValueChange()}_openPopup(){this._rangeInput._openDatepicker()}_getMinDate(){return this._rangeInput.min}_getMaxDate(){return this._rangeInput.max}_getDateFilter(){return this._rangeInput.dateFilter}_parentDisabled(){return this._rangeInput._groupDisabled}_shouldHandleChangeEvent({source:e}){return e!==this._rangeInput._startInput&&e!==this._rangeInput._endInput}_assignValueProgrammatically(e){super._assignValueProgrammatically(e),(this===this._rangeInput._startInput?this._rangeInput._endInput:this._rangeInput._startInput)?._validatorOnChange()}_getAccessibleName(){return $7(this._elementRef.nativeElement)}}return n.\u0275fac=function(e){return new(e||n)(J(L1),J(jt),J(k_),J(Ro),J(bp,8),J(Vu,8),J(to,8),J(Fd,8))},n.\u0275dir=rt({type:n,features:[Et]}),n})());let AL=(()=>{class n extends TL{constructor(e,i,r,s,u,m,b,E){super(e,i,r,s,u,m,b,E),this._startValidator=T=>{const O=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(T.value)),H=this._model?this._model.selection.end:null;return!O||!H||this._dateAdapter.compareDate(O,H)<=0?null:{matStartDateInvalid:{end:H,actual:O}}},this._validator=lm.compose([...super._getValidators(),this._startValidator])}_getValueFromModel(e){return e.start}_shouldHandleChangeEvent(e){return!(!super._shouldHandleChangeEvent(e)||(e.oldValue?.start?e.selection.start&&!this._dateAdapter.compareDate(e.oldValue.start,e.selection.start):!e.selection.start))}_assignValueToModel(e){if(this._model){const i=new ys(e,this._model.selection.end);this._model.updateSelection(i,this)}}_formatValue(e){super._formatValue(e),this._rangeInput._handleChildValueChange()}_onKeydown(e){const i=this._rangeInput._endInput,r=this._elementRef.nativeElement,s="rtl"!==this._dir?.value;(39===e.keyCode&&s||37===e.keyCode&&!s)&&r.selectionStart===r.value.length&&r.selectionEnd===r.value.length?(e.preventDefault(),i._elementRef.nativeElement.setSelectionRange(0,0),i.focus()):super._onKeydown(e)}}return n.\u0275fac=function(e){return new(e||n)(J(L1),J(jt),J(k_),J(Ro),J(bp,8),J(Vu,8),J(to,8),J(Fd,8))},n.\u0275dir=rt({type:n,selectors:[["input","matStartDate",""]],hostAttrs:["type","text",1,"mat-start-date","mat-date-range-input-inner"],hostVars:5,hostBindings:function(e,i){1&e&&Kt("input",function(s){return i._onInput(s.target.value)})("change",function(){return i._onChange()})("keydown",function(s){return i._onKeydown(s)})("blur",function(){return i._onBlur()}),2&e&&(ia("disabled",i.disabled),Ln("aria-haspopup",i._rangeInput.rangePicker?"dialog":null)("aria-owns",(null==i._rangeInput.rangePicker?null:i._rangeInput.rangePicker.opened)&&i._rangeInput.rangePicker.id||null)("min",i._getMinDate()?i._dateAdapter.toIso8601(i._getMinDate()):null)("max",i._getMaxDate()?i._dateAdapter.toIso8601(i._getMaxDate()):null))},inputs:{errorStateMatcher:"errorStateMatcher"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[Zt([{provide:Us,useExisting:n,multi:!0},{provide:_o,useExisting:n,multi:!0}]),Et]}),n})(),IL=(()=>{class n extends TL{constructor(e,i,r,s,u,m,b,E){super(e,i,r,s,u,m,b,E),this._endValidator=T=>{const O=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(T.value)),H=this._model?this._model.selection.start:null;return!O||!H||this._dateAdapter.compareDate(O,H)>=0?null:{matEndDateInvalid:{start:H,actual:O}}},this._validator=lm.compose([...super._getValidators(),this._endValidator])}_getValueFromModel(e){return e.end}_shouldHandleChangeEvent(e){return!(!super._shouldHandleChangeEvent(e)||(e.oldValue?.end?e.selection.end&&!this._dateAdapter.compareDate(e.oldValue.end,e.selection.end):!e.selection.end))}_assignValueToModel(e){if(this._model){const i=new ys(this._model.selection.start,e);this._model.updateSelection(i,this)}}_onKeydown(e){const i=this._rangeInput._startInput,r=this._elementRef.nativeElement,s="rtl"!==this._dir?.value;if(8!==e.keyCode||r.value)if((37===e.keyCode&&s||39===e.keyCode&&!s)&&0===r.selectionStart&&0===r.selectionEnd){e.preventDefault();const u=i._elementRef.nativeElement.value.length;i._elementRef.nativeElement.setSelectionRange(u,u),i.focus()}else super._onKeydown(e);else i.focus()}}return n.\u0275fac=function(e){return new(e||n)(J(L1),J(jt),J(k_),J(Ro),J(bp,8),J(Vu,8),J(to,8),J(Fd,8))},n.\u0275dir=rt({type:n,selectors:[["input","matEndDate",""]],hostAttrs:["type","text",1,"mat-end-date","mat-date-range-input-inner"],hostVars:5,hostBindings:function(e,i){1&e&&Kt("input",function(s){return i._onInput(s.target.value)})("change",function(){return i._onChange()})("keydown",function(s){return i._onKeydown(s)})("blur",function(){return i._onBlur()}),2&e&&(ia("disabled",i.disabled),Ln("aria-haspopup",i._rangeInput.rangePicker?"dialog":null)("aria-owns",(null==i._rangeInput.rangePicker?null:i._rangeInput.rangePicker.opened)&&i._rangeInput.rangePicker.id||null)("min",i._getMinDate()?i._dateAdapter.toIso8601(i._getMinDate()):null)("max",i._getMaxDate()?i._dateAdapter.toIso8601(i._getMaxDate()):null))},inputs:{errorStateMatcher:"errorStateMatcher"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[Zt([{provide:Us,useExisting:n,multi:!0},{provide:_o,useExisting:n,multi:!0}]),Et]}),n})(),W7=0,Z7=(()=>{class n{get value(){return this._model?this._model.selection:null}get shouldLabelFloat(){return this.focused||!this.empty}get placeholder(){const e=this._startInput?._getPlaceholder()||"",i=this._endInput?._getPlaceholder()||"";return e||i?`${e} ${this.separator} ${i}`:""}get rangePicker(){return this._rangePicker}set rangePicker(e){e&&(this._model=e.registerInput(this),this._rangePicker=e,this._closedSubscription.unsubscribe(),this._closedSubscription=e.closedStream.subscribe(()=>{this._startInput?._onTouched(),this._endInput?._onTouched()}),this._registerModel(this._model))}get required(){return this._required??(this._isTargetRequired(this)||this._isTargetRequired(this._startInput)||this._isTargetRequired(this._endInput))??!1}set required(e){this._required=Bn(e)}get dateFilter(){return this._dateFilter}set dateFilter(e){const i=this._startInput,r=this._endInput,s=i&&i._matchesFilter(i.value),u=r&&r._matchesFilter(i.value);this._dateFilter=e,i&&i._matchesFilter(i.value)!==s&&i._validatorOnChange(),r&&r._matchesFilter(r.value)!==u&&r._validatorOnChange()}get min(){return this._min}set min(e){const i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(i,this._min)||(this._min=i,this._revalidate())}get max(){return this._max}set max(e){const i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(i,this._max)||(this._max=i,this._revalidate())}get disabled(){return this._startInput&&this._endInput?this._startInput.disabled&&this._endInput.disabled:this._groupDisabled}set disabled(e){const i=Bn(e);i!==this._groupDisabled&&(this._groupDisabled=i,this.stateChanges.next(void 0))}get errorState(){return!(!this._startInput||!this._endInput)&&(this._startInput.errorState||this._endInput.errorState)}get empty(){const e=!!this._startInput&&this._startInput.isEmpty(),i=!!this._endInput&&this._endInput.isEmpty();return e&&i}constructor(e,i,r,s,u){this._changeDetectorRef=e,this._elementRef=i,this._dateAdapter=s,this._formField=u,this._closedSubscription=Ie.EMPTY,this.id="mat-date-range-input-"+W7++,this.focused=!1,this.controlType="mat-date-range-input",this._groupDisabled=!1,this._ariaDescribedBy=null,this.separator="\u2013",this.comparisonStart=null,this.comparisonEnd=null,this.stateChanges=new Xt,u?._elementRef.nativeElement.classList.contains("mat-mdc-form-field")&&i.nativeElement.classList.add("mat-mdc-input-element","mat-mdc-form-field-input-control","mdc-text-field__input"),this.ngControl=r}setDescribedByIds(e){this._ariaDescribedBy=e.length?e.join(" "):null}onContainerClick(){!this.focused&&!this.disabled&&(this._model&&this._model.selection.start?this._endInput.focus():this._startInput.focus())}ngAfterContentInit(){this._model&&this._registerModel(this._model),$i(this._startInput.stateChanges,this._endInput.stateChanges).subscribe(()=>{this.stateChanges.next(void 0)})}ngOnChanges(e){DL(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._closedSubscription.unsubscribe(),this.stateChanges.complete()}getStartValue(){return this.value?this.value.start:null}getThemePalette(){return this._formField?this._formField.color:void 0}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():null}_getInputMirrorValue(e){const i="start"===e?this._startInput:this._endInput;return i?i.getMirrorValue():""}_shouldHidePlaceholders(){return!!this._startInput&&!this._startInput.isEmpty()}_handleChildValueChange(){this.stateChanges.next(void 0),this._changeDetectorRef.markForCheck()}_openDatepicker(){this._rangePicker&&this._rangePicker.open()}_shouldHideSeparator(){return(!this._formField||this._formField.getLabelId()&&!this._formField._shouldLabelFloat())&&this.empty}_getAriaLabelledby(){const e=this._formField;return e&&e._hasFloatingLabel()?e._labelId:null}_getStartDateAccessibleName(){return this._startInput._getAccessibleName()}_getEndDateAccessibleName(){return this._endInput._getAccessibleName()}_updateFocus(e){this.focused=null!==e,this.stateChanges.next()}_revalidate(){this._startInput&&this._startInput._validatorOnChange(),this._endInput&&this._endInput._validatorOnChange()}_registerModel(e){this._startInput&&this._startInput._registerModel(e),this._endInput&&this._endInput._registerModel(e)}_isTargetRequired(e){return e?.ngControl?.control?.hasValidator(lm.required)}}return n.\u0275fac=function(e){return new(e||n)(J(zr),J(jt),J(js,10),J(to,8),J(U_,8))},n.\u0275cmp=Fn({type:n,selectors:[["mat-date-range-input"]],contentQueries:function(e,i,r){if(1&e&&(Ri(r,AL,5),Ri(r,IL,5)),2&e){let s;Bt(s=zt())&&(i._startInput=s.first),Bt(s=zt())&&(i._endInput=s.first)}},hostAttrs:["role","group",1,"mat-date-range-input"],hostVars:8,hostBindings:function(e,i){2&e&&(Ln("id",i.id)("aria-labelledby",i._getAriaLabelledby())("aria-describedby",i._ariaDescribedBy)("data-mat-calendar",i.rangePicker?i.rangePicker.id:null),Xn("mat-date-range-input-hide-placeholders",i._shouldHidePlaceholders())("mat-date-range-input-required",i.required))},inputs:{rangePicker:"rangePicker",required:"required",dateFilter:"dateFilter",min:"min",max:"max",disabled:"disabled",separator:"separator",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd"},exportAs:["matDateRangeInput"],features:[Zt([{provide:k1,useExisting:n},{provide:L1,useExisting:n}]),M],ngContentSelectors:x7,decls:11,vars:5,consts:[["cdkMonitorSubtreeFocus","",1,"mat-date-range-input-container",3,"cdkFocusChange"],[1,"mat-date-range-input-wrapper"],["aria-hidden","true",1,"mat-date-range-input-mirror"],[1,"mat-date-range-input-separator"],[1,"mat-date-range-input-wrapper","mat-date-range-input-end-wrapper"]],template:function(e,i){1&e&&(fo(b7),Ye(0,"div",0),Kt("cdkFocusChange",function(s){return i._updateFocus(s)}),Ye(1,"div",1),qn(2),Ye(3,"span",2),Kn(4),ot()(),Ye(5,"span",3),Kn(6),ot(),Ye(7,"div",4),qn(8,1),Ye(9,"span",2),Kn(10),ot()()()),2&e&&(Ze(4),Ma(i._getInputMirrorValue("start")),Ze(1),Xn("mat-date-range-input-separator-hidden",i._shouldHideSeparator()),Ze(1),Ma(i.separator),Ze(4),Ma(i._getInputMirrorValue("end")))},dependencies:[I2],styles:[".mat-date-range-input{display:block;width:100%}.mat-date-range-input-container{display:flex;align-items:center}.mat-date-range-input-separator{transition:opacity 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);margin:0 4px}._mat-animation-noopable .mat-date-range-input-separator{transition:none}.mat-date-range-input-separator-hidden{-webkit-user-select:none;user-select:none;opacity:0;transition:none}.mat-date-range-input-wrapper{position:relative;overflow:hidden;max-width:calc(50% - 4px)}.mat-date-range-input-end-wrapper{flex-grow:1}.mat-date-range-input-inner{position:absolute;top:0;left:0;font:inherit;background:rgba(0,0,0,0);color:currentColor;border:none;outline:none;padding:0;margin:0;vertical-align:bottom;text-align:inherit;-webkit-appearance:none;width:100%;height:100%}.mat-date-range-input-inner:-moz-ui-invalid{box-shadow:none}.mat-date-range-input-inner::placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-date-range-input-inner::-moz-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-date-range-input-inner::-webkit-input-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-date-range-input-inner:-ms-input-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-date-range-input-inner::placeholder,.mat-date-range-input-hide-placeholders .mat-date-range-input-inner::placeholder{-webkit-user-select:none;user-select:none;color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-date-range-input-inner::placeholder,.cdk-high-contrast-active .mat-date-range-input-hide-placeholders .mat-date-range-input-inner::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-date-range-input-inner::-moz-placeholder,.mat-date-range-input-hide-placeholders .mat-date-range-input-inner::-moz-placeholder{-webkit-user-select:none;user-select:none;color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-date-range-input-inner::-moz-placeholder,.cdk-high-contrast-active .mat-date-range-input-hide-placeholders .mat-date-range-input-inner::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-date-range-input-inner::-webkit-input-placeholder,.mat-date-range-input-hide-placeholders .mat-date-range-input-inner::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-date-range-input-inner::-webkit-input-placeholder,.cdk-high-contrast-active .mat-date-range-input-hide-placeholders .mat-date-range-input-inner::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-date-range-input-inner:-ms-input-placeholder,.mat-date-range-input-hide-placeholders .mat-date-range-input-inner:-ms-input-placeholder{-webkit-user-select:none;user-select:none;color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-date-range-input-inner:-ms-input-placeholder,.cdk-high-contrast-active .mat-date-range-input-hide-placeholders .mat-date-range-input-inner:-ms-input-placeholder{opacity:0}._mat-animation-noopable .mat-date-range-input-inner::placeholder{transition:none}._mat-animation-noopable .mat-date-range-input-inner::-moz-placeholder{transition:none}._mat-animation-noopable .mat-date-range-input-inner::-webkit-input-placeholder{transition:none}._mat-animation-noopable .mat-date-range-input-inner:-ms-input-placeholder{transition:none}.mat-date-range-input-mirror{-webkit-user-select:none;user-select:none;visibility:hidden;white-space:nowrap;display:inline-block;min-width:2px}.mat-mdc-form-field-type-mat-date-range-input .mat-mdc-form-field-infix{width:200px}"],encapsulation:2,changeDetection:0}),n})(),Y7=(()=>{class n extends CL{_forwardContentValues(e){super._forwardContentValues(e);const i=this.datepickerInput;i&&(e.comparisonStart=i.comparisonStart,e.comparisonEnd=i.comparisonEnd,e.startDateAccessibleName=i._getStartDateAccessibleName(),e.endDateAccessibleName=i._getEndDateAccessibleName())}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275cmp=Fn({type:n,selectors:[["mat-date-range-picker"]],exportAs:["matDateRangePicker"],features:[Zt([T7,k7,{provide:CL,useExisting:n}]),Et],decls:0,vars:0,template:function(e,i){},encapsulation:2,changeDetection:0}),n})(),X7=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[Vb,N7],imports:[Tc,_M,P1,O2,rL,ur,S_]}),n})();function K7(n,t){1&n&&(Ye(0,"span",8),qn(1,1),ot())}function J7(n,t){1&n&&(Ye(0,"span",9),qn(1,2),ot())}const kL=["*",[["mat-chip-avatar"],["","matChipAvatar",""]],[["mat-chip-trailing-icon"],["","matChipRemove",""],["","matChipTrailingIcon",""]]],RL=["*","mat-chip-avatar, [matChipAvatar]","mat-chip-trailing-icon,[matChipRemove],[matChipTrailingIcon]"];function Q7(n,t){1&n&&(Ye(0,"span",9),qn(1,1),Ye(2,"span",10),ba(),Ye(3,"svg",11),_n(4,"path",12),ot()()())}function eZ(n,t){1&n&&(Ye(0,"span",13),qn(1,2),ot())}const PM=["*"],N1=new Ke("mat-chips-default-options"),OM=new Ke("MatChipAvatar"),FM=new Ke("MatChipTrailingIcon"),LM=new Ke("MatChipRemove"),B1=new Ke("MatChip");class dZ{}const uZ=h1(dZ,-1);let H_=(()=>{class n extends uZ{get disabled(){return this._disabled||this._parentChip.disabled}set disabled(e){this._disabled=Bn(e)}_getDisabledAttribute(){return this.disabled&&!this._allowFocusWhenDisabled?"":null}_getTabindex(){return this.disabled&&!this._allowFocusWhenDisabled||!this.isInteractive?null:this.tabIndex.toString()}constructor(e,i){super(),this._elementRef=e,this._parentChip=i,this.isInteractive=!0,this._isPrimary=!0,this._disabled=!1,this._allowFocusWhenDisabled=!1,"BUTTON"===e.nativeElement.nodeName&&e.nativeElement.setAttribute("type","button")}focus(){this._elementRef.nativeElement.focus()}_handleClick(e){!this.disabled&&this.isInteractive&&this._isPrimary&&(e.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!this.disabled&&this.isInteractive&&this._isPrimary&&!this._parentChip._isEditing&&(e.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(B1))},n.\u0275dir=rt({type:n,selectors:[["","matChipAction",""]],hostAttrs:[1,"mdc-evolution-chip__action","mat-mdc-chip-action"],hostVars:9,hostBindings:function(e,i){1&e&&Kt("click",function(s){return i._handleClick(s)})("keydown",function(s){return i._handleKeydown(s)}),2&e&&(Ln("tabindex",i._getTabindex())("disabled",i._getDisabledAttribute())("aria-disabled",i.disabled),Xn("mdc-evolution-chip__action--primary",i._isPrimary)("mdc-evolution-chip__action--presentational",!i.isInteractive)("mdc-evolution-chip__action--trailing",!i._isPrimary))},inputs:{disabled:"disabled",tabIndex:"tabIndex",isInteractive:"isInteractive",_allowFocusWhenDisabled:"_allowFocusWhenDisabled"},features:[Et]}),n})(),FL=(()=>{class n extends H_{constructor(){super(...arguments),this._isPrimary=!1}_handleClick(e){this.disabled||(e.stopPropagation(),e.preventDefault(),this._parentChip.remove())}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!this.disabled&&(e.stopPropagation(),e.preventDefault(),this._parentChip.remove())}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["","matChipRemove",""]],hostAttrs:["role","button",1,"mat-mdc-chip-remove","mat-mdc-chip-trailing-icon","mat-mdc-focus-indicator","mdc-evolution-chip__icon","mdc-evolution-chip__icon--trailing"],hostVars:1,hostBindings:function(e,i){2&e&&Ln("aria-hidden",null)},features:[Zt([{provide:LM,useExisting:n}]),Et]}),n})(),fZ=0;const mZ=h1(Tb(u1(jS(class{constructor(n){this._elementRef=n}})),"primary"),-1);let bm=(()=>{class n extends mZ{_hasFocus(){return this._hasFocusInternal}get value(){return void 0!==this._value?this._value:this._textElement.textContent.trim()}set value(e){this._value=e}get removable(){return this._removable}set removable(e){this._removable=Bn(e)}get highlighted(){return this._highlighted}set highlighted(e){this._highlighted=Bn(e)}constructor(e,i,r,s,u,m,b,E){super(i),this._changeDetectorRef=e,this._ngZone=r,this._focusMonitor=s,this._globalRippleOptions=b,this._isRippleCentered=!1,this._onFocus=new Xt,this._onBlur=new Xt,this.role=null,this._hasFocusInternal=!1,this.id="mat-mdc-chip-"+fZ++,this.ariaLabel=null,this.ariaDescription=null,this._ariaDescriptionId=`${this.id}-aria-description`,this._removable=!0,this._highlighted=!1,this.removed=new Tt,this.destroyed=new Tt,this.basicChipAttrName="mat-basic-chip",this._document=u,this._animationsDisabled="NoopAnimations"===m,null!=E&&(this.tabIndex=parseInt(E)??this.defaultTabIndex),this._monitorFocus()}ngOnInit(){const e=this._elementRef.nativeElement;this._isBasicChip=e.hasAttribute(this.basicChipAttrName)||e.tagName.toLowerCase()===this.basicChipAttrName}ngAfterViewInit(){this._textElement=this._elementRef.nativeElement.querySelector(".mat-mdc-chip-action-label"),this._pendingFocus&&(this._pendingFocus=!1,this.focus())}ngAfterContentInit(){this._actionChanges=$i(this._allLeadingIcons.changes,this._allTrailingIcons.changes,this._allRemoveIcons.changes).subscribe(()=>this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._actionChanges?.unsubscribe(),this.destroyed.emit({chip:this}),this.destroyed.complete()}remove(){this.removable&&this.removed.emit({chip:this})}_isRippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||this._isBasicChip||!!this._globalRippleOptions?.disabled}_hasTrailingIcon(){return!(!this.trailingIcon&&!this.removeIcon)}_handleKeydown(e){(8===e.keyCode||46===e.keyCode)&&(e.preventDefault(),this.remove())}focus(){this.disabled||(this.primaryAction?this.primaryAction.focus():this._pendingFocus=!0)}_getSourceAction(e){return this._getActions().find(i=>{const r=i._elementRef.nativeElement;return r===e||r.contains(e)})}_getActions(){const e=[];return this.primaryAction&&e.push(this.primaryAction),this.removeIcon&&e.push(this.removeIcon),this.trailingIcon&&e.push(this.trailingIcon),e}_handlePrimaryActionInteraction(){}_monitorFocus(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{const i=null!==e;i!==this._hasFocusInternal&&(this._hasFocusInternal=i,i?this._onFocus.next({chip:this}):this._ngZone.onStable.pipe(Jr(1)).subscribe(()=>this._ngZone.run(()=>this._onBlur.next({chip:this}))))})}}return n.\u0275fac=function(e){return new(e||n)(J(zr),J(jt),J(rn),J(d1),J(Nn),J(ko,8),J(p1,8),Os("tabindex"))},n.\u0275cmp=Fn({type:n,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(e,i,r){if(1&e&&(Ri(r,OM,5),Ri(r,FM,5),Ri(r,LM,5),Ri(r,OM,5),Ri(r,FM,5),Ri(r,LM,5)),2&e){let s;Bt(s=zt())&&(i.leadingIcon=s.first),Bt(s=zt())&&(i.trailingIcon=s.first),Bt(s=zt())&&(i.removeIcon=s.first),Bt(s=zt())&&(i._allLeadingIcons=s),Bt(s=zt())&&(i._allTrailingIcons=s),Bt(s=zt())&&(i._allRemoveIcons=s)}},viewQuery:function(e,i){if(1&e&&(ci(wp,5),ci(H_,5)),2&e){let r;Bt(r=zt())&&(i.ripple=r.first),Bt(r=zt())&&(i.primaryAction=r.first)}},hostAttrs:[1,"mat-mdc-chip"],hostVars:30,hostBindings:function(e,i){1&e&&Kt("keydown",function(s){return i._handleKeydown(s)}),2&e&&(ia("id",i.id),Ln("role",i.role)("tabindex",i.role?i.tabIndex:null)("aria-label",i.ariaLabel),Xn("mdc-evolution-chip",!i._isBasicChip)("mdc-evolution-chip--disabled",i.disabled)("mdc-evolution-chip--with-trailing-action",i._hasTrailingIcon())("mdc-evolution-chip--with-primary-graphic",i.leadingIcon)("mdc-evolution-chip--with-primary-icon",i.leadingIcon)("mdc-evolution-chip--with-avatar",i.leadingIcon)("mat-mdc-chip-with-avatar",i.leadingIcon)("mat-mdc-chip-highlighted",i.highlighted)("mat-mdc-chip-disabled",i.disabled)("mat-mdc-basic-chip",i._isBasicChip)("mat-mdc-standard-chip",!i._isBasicChip)("mat-mdc-chip-with-trailing-icon",i._hasTrailingIcon())("_mat-animation-noopable",i._animationsDisabled))},inputs:{color:"color",disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",role:"role",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaDescription:["aria-description","ariaDescription"],value:"value",removable:"removable",highlighted:"highlighted"},outputs:{removed:"removed",destroyed:"destroyed"},exportAs:["matChip"],features:[Zt([{provide:B1,useExisting:n}]),Et],ngContentSelectors:RL,decls:9,vars:6,consts:[["matRipple","",1,"mat-mdc-chip-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","",3,"isInteractive"],["class","mdc-evolution-chip__graphic mat-mdc-chip-graphic",4,"ngIf"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-mdc-focus-indicator"],["class","mdc-evolution-chip__cell mdc-evolution-chip__cell--trailing",4,"ngIf"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(e,i){1&e&&(fo(kL),_n(0,"span",0)(1,"span",1),Ye(2,"span",2)(3,"span",3),kt(4,K7,2,0,"span",4),Ye(5,"span",5),qn(6),_n(7,"span",6),ot()()(),kt(8,J7,2,0,"span",7)),2&e&&(et("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",i._isRippleCentered)("matRippleTrigger",i._elementRef.nativeElement),Ze(3),et("isInteractive",!1),Ze(1),et("ngIf",i.leadingIcon),Ze(4),et("ngIf",i._hasTrailingIcon()))},dependencies:[Nu,wp,H_],styles:['.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}.mdc-evolution-chip__action--primary{overflow-x:hidden}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mdc-evolution-chip__action--primary:before{box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1}.mdc-evolution-chip--touch{margin-top:8px;margin-bottom:8px}.mdc-evolution-chip__action-touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-evolution-chip__text-label{white-space:nowrap;user-select:none;text-overflow:ellipsis;overflow:hidden}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mdc-evolution-chip__checkmark-background{opacity:0}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__graphic{transition:width 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark{transition:opacity 50ms 0ms linear,transform 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-50%, -50%)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@keyframes mdc-evolution-chip-enter{from{transform:scale(0.8);opacity:.4}to{transform:scale(1);opacity:1}}.mdc-evolution-chip--enter{animation:mdc-evolution-chip-enter 100ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-evolution-chip-exit{from{opacity:1}to{opacity:0}}.mdc-evolution-chip--exit{animation:mdc-evolution-chip-exit 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-evolution-chip--hidden{opacity:0;pointer-events:none;transition:width 150ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-standard-chip .mdc-evolution-chip__checkmark{height:20px;width:20px}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:24px}.mdc-evolution-chip--with-avatar .mdc-evolution-chip__graphic{height:24px;width:24px;font-size:24px}.mdc-evolution-chip--with-avatar .mdc-evolution-chip__icon--primary{height:24px;width:24px;font-size:24px}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0);border-radius:var(--mdc-chip-container-shape-radius, 16px 16px 16px 16px);height:var(--mdc-chip-container-height, 32px)}.mat-mdc-standard-chip .mdc-evolution-chip__ripple{border-radius:var(--mdc-chip-container-shape-radius, 16px 16px 16px 16px)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-radius:var(--mdc-chip-container-shape-radius, 16px 16px 16px 16px)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius, 14px 14px 14px 14px)}.mat-mdc-standard-chip.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:var(--mdc-chip-with-avatar-avatar-size, 28px)}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{height:var(--mdc-chip-with-avatar-avatar-size, 28px);width:var(--mdc-chip-with-avatar-avatar-size, 28px);font-size:var(--mdc-chip-with-avatar-avatar-size, 28px)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-width:var(--mdc-chip-outline-width, 1px)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-width:var(--mdc-chip-flat-outline-width, 1px)}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__action--primary:before{border-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--selected) .mdc-evolution-chip__action--primary:before{border-width:var(--mdc-chip-flat-unselected-outline-width, 1px)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color, transparent)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color, transparent)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color, transparent)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color, currentColor)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{height:var(--mdc-chip-with-icon-icon-size, 18px);width:var(--mdc-chip-with-icon-icon-size, 18px);font-size:var(--mdc-chip-with-icon-icon-size, 18px)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color, currentColor)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color, currentColor)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color, currentColor)}.cdk-high-contrast-active .mat-mdc-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-mdc-standard-chip .mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:.4}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary{width:100%}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{opacity:.04}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{opacity:.12}.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-chip-remove{opacity:.54}.mat-mdc-chip-remove:focus{opacity:1}.mat-mdc-chip-remove::before{margin:calc(var(--mat-mdc-focus-indicator-border-width, 3px) * -1);left:8px;right:8px}.mat-mdc-chip-remove .mat-icon{width:inherit;height:inherit;font-size:inherit;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}.cdk-high-contrast-active .mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}.mat-mdc-chip-action:focus .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})(),NM=(()=>{class n extends bm{constructor(){super(...arguments),this._defaultOptions=gt(N1,{optional:!0}),this.chipListSelectable=!0,this._chipListMultiple=!1,this._chipListHideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._selectable=!0,this._selected=!1,this.basicChipAttrName="mat-basic-chip-option",this.selectionChange=new Tt}get selectable(){return this._selectable&&this.chipListSelectable}set selectable(e){this._selectable=Bn(e),this._changeDetectorRef.markForCheck()}get selected(){return this._selected}set selected(e){this._setSelectedState(Bn(e),!1,!0)}get ariaSelected(){return this.selectable?this.selected.toString():null}ngOnInit(){super.ngOnInit(),this.role="presentation"}select(){this._setSelectedState(!0,!1,!0)}deselect(){this._setSelectedState(!1,!1,!0)}selectViaInteraction(){this._setSelectedState(!0,!0,!0)}toggleSelected(e=!1){return this._setSelectedState(!this.selected,e,!0),this.selected}_handlePrimaryActionInteraction(){this.selectable&&!this.disabled&&this.toggleSelected(!0)}_hasLeadingGraphic(){return!!this.leadingIcon||!this._chipListHideSingleSelectionIndicator||this._chipListMultiple}_setSelectedState(e,i,r){e!==this.selected&&(this._selected=e,r&&this.selectionChange.emit({source:this,isUserInput:i,selected:this.selected}),this._changeDetectorRef.markForCheck())}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275cmp=Fn({type:n,selectors:[["mat-basic-chip-option"],["","mat-basic-chip-option",""],["mat-chip-option"],["","mat-chip-option",""]],hostAttrs:[1,"mat-mdc-chip","mat-mdc-chip-option"],hostVars:37,hostBindings:function(e,i){2&e&&(ia("id",i.id),Ln("tabindex",null)("aria-label",null)("aria-description",null)("role",i.role),Xn("mdc-evolution-chip",!i._isBasicChip)("mdc-evolution-chip--filter",!i._isBasicChip)("mdc-evolution-chip--selectable",!i._isBasicChip)("mat-mdc-chip-selected",i.selected)("mat-mdc-chip-multiple",i._chipListMultiple)("mat-mdc-chip-disabled",i.disabled)("mat-mdc-chip-with-avatar",i.leadingIcon)("mdc-evolution-chip--disabled",i.disabled)("mdc-evolution-chip--selected",i.selected)("mdc-evolution-chip--selecting",!i._animationsDisabled)("mdc-evolution-chip--with-trailing-action",i._hasTrailingIcon())("mdc-evolution-chip--with-primary-icon",i.leadingIcon)("mdc-evolution-chip--with-primary-graphic",i._hasLeadingGraphic())("mdc-evolution-chip--with-avatar",i.leadingIcon)("mat-mdc-chip-highlighted",i.highlighted)("mat-mdc-chip-with-trailing-icon",i._hasTrailingIcon()))},inputs:{color:"color",disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",selectable:"selectable",selected:"selected"},outputs:{selectionChange:"selectionChange"},features:[Zt([{provide:bm,useExisting:n},{provide:B1,useExisting:n}]),Et],ngContentSelectors:RL,decls:11,vars:12,consts:[["matRipple","",1,"mat-mdc-chip-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","","role","option",3,"tabIndex","_allowFocusWhenDisabled"],["class","mdc-evolution-chip__graphic mat-mdc-chip-graphic",4,"ngIf"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-mdc-focus-indicator"],["class","mdc-evolution-chip__cell mdc-evolution-chip__cell--trailing",4,"ngIf"],[1,"cdk-visually-hidden",3,"id"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__checkmark"],["viewBox","-2 -3 30 30","focusable","false",1,"mdc-evolution-chip__checkmark-svg"],["fill","none","stroke","currentColor","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-evolution-chip__checkmark-path"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(e,i){1&e&&(fo(kL),_n(0,"span",0)(1,"span",1),Ye(2,"span",2)(3,"button",3),kt(4,Q7,5,0,"span",4),Ye(5,"span",5),qn(6),_n(7,"span",6),ot()()(),kt(8,eZ,2,0,"span",7),Ye(9,"span",8),Kn(10),ot()),2&e&&(et("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",i._isRippleCentered)("matRippleTrigger",i._elementRef.nativeElement),Ze(3),et("tabIndex",i.tabIndex)("_allowFocusWhenDisabled",!0),Ln("aria-selected",i.ariaSelected)("aria-label",i.ariaLabel)("aria-describedby",i._ariaDescriptionId),Ze(1),et("ngIf",i._hasLeadingGraphic()),Ze(4),et("ngIf",i._hasTrailingIcon()),Ze(1),et("id",i._ariaDescriptionId),Ze(1),Ma(i.ariaDescription))},dependencies:[Nu,wp,H_],styles:['.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}.mdc-evolution-chip__action--primary{overflow-x:hidden}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mdc-evolution-chip__action--primary:before{box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1}.mdc-evolution-chip--touch{margin-top:8px;margin-bottom:8px}.mdc-evolution-chip__action-touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-evolution-chip__text-label{white-space:nowrap;user-select:none;text-overflow:ellipsis;overflow:hidden}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mdc-evolution-chip__checkmark-background{opacity:0}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__graphic{transition:width 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark{transition:opacity 50ms 0ms linear,transform 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-50%, -50%)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@keyframes mdc-evolution-chip-enter{from{transform:scale(0.8);opacity:.4}to{transform:scale(1);opacity:1}}.mdc-evolution-chip--enter{animation:mdc-evolution-chip-enter 100ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-evolution-chip-exit{from{opacity:1}to{opacity:0}}.mdc-evolution-chip--exit{animation:mdc-evolution-chip-exit 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-evolution-chip--hidden{opacity:0;pointer-events:none;transition:width 150ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-standard-chip .mdc-evolution-chip__checkmark{height:20px;width:20px}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:24px}.mdc-evolution-chip--with-avatar .mdc-evolution-chip__graphic{height:24px;width:24px;font-size:24px}.mdc-evolution-chip--with-avatar .mdc-evolution-chip__icon--primary{height:24px;width:24px;font-size:24px}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0);border-radius:var(--mdc-chip-container-shape-radius, 16px 16px 16px 16px);height:var(--mdc-chip-container-height, 32px)}.mat-mdc-standard-chip .mdc-evolution-chip__ripple{border-radius:var(--mdc-chip-container-shape-radius, 16px 16px 16px 16px)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-radius:var(--mdc-chip-container-shape-radius, 16px 16px 16px 16px)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius, 14px 14px 14px 14px)}.mat-mdc-standard-chip.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:var(--mdc-chip-with-avatar-avatar-size, 28px)}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{height:var(--mdc-chip-with-avatar-avatar-size, 28px);width:var(--mdc-chip-with-avatar-avatar-size, 28px);font-size:var(--mdc-chip-with-avatar-avatar-size, 28px)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-width:var(--mdc-chip-outline-width, 1px)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-width:var(--mdc-chip-flat-outline-width, 1px)}.mat-mdc-standard-chip.mdc-evolution-chip--selected .mdc-evolution-chip__action--primary:before{border-width:var(--mdc-chip-flat-selected-outline-width, 0)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--selected) .mdc-evolution-chip__action--primary:before{border-width:var(--mdc-chip-flat-unselected-outline-width, 1px)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color, transparent)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color, transparent)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color, transparent)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color, currentColor)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{height:var(--mdc-chip-with-icon-icon-size, 18px);width:var(--mdc-chip-with-icon-icon-size, 18px);font-size:var(--mdc-chip-with-icon-icon-size, 18px)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color, currentColor)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color, currentColor)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color, currentColor)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color, currentColor)}.cdk-high-contrast-active .mat-mdc-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-mdc-standard-chip .mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:.4}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary{width:100%}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{opacity:.04}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{opacity:.12}.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-chip-remove{opacity:.54}.mat-mdc-chip-remove:focus{opacity:1}.mat-mdc-chip-remove::before{margin:calc(var(--mat-mdc-focus-indicator-border-width, 3px) * -1);left:8px;right:8px}.mat-mdc-chip-remove .mat-icon{width:inherit;height:inherit;font-size:inherit;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}.cdk-high-contrast-active .mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}.mat-mdc-chip-action:focus .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})();class gZ{constructor(t){}}const _Z=h1(gZ);let BM=(()=>{class n extends _Z{get chipFocusChanges(){return this._getChipStream(e=>e._onFocus)}get chipDestroyedChanges(){return this._getChipStream(e=>e.destroyed)}get disabled(){return this._disabled}set disabled(e){this._disabled=Bn(e),this._syncChipsState()}get empty(){return 0===this._chips.length}get role(){return this._explicitRole?this._explicitRole:this.empty?null:this._defaultRole}set role(e){this._explicitRole=e}get focused(){return this._hasFocusedChip()}constructor(e,i,r){super(e),this._elementRef=e,this._changeDetectorRef=i,this._dir=r,this._lastDestroyedFocusedChipIndex=null,this._destroyed=new Xt,this._defaultRole="presentation",this._disabled=!1,this._explicitRole=null,this._chipActions=new a_}ngAfterViewInit(){this._setUpFocusManagement(),this._trackChipSetChanges(),this._trackDestroyedFocusedChip()}ngOnDestroy(){this._keyManager?.destroy(),this._chipActions.destroy(),this._destroyed.next(),this._destroyed.complete()}_hasFocusedChip(){return this._chips&&this._chips.some(e=>e._hasFocus())}_syncChipsState(){this._chips&&this._chips.forEach(e=>{e.disabled=this._disabled,e._changeDetectorRef.markForCheck()})}focus(){}_handleKeydown(e){this._originatesFromChip(e)&&this._keyManager.onKeydown(e)}_isValidIndex(e){return e>=0&&e<this._chips.length}_allowFocusEscape(){if(-1!==this.tabIndex){const e=this.tabIndex;this.tabIndex=-1,setTimeout(()=>this.tabIndex=e)}}_getChipStream(e){return this._chips.changes.pipe(Rd(null),Vs(()=>$i(...this._chips.map(e))))}_originatesFromChip(e){let i=e.target;for(;i&&i!==this._elementRef.nativeElement;){if(i.classList.contains("mat-mdc-chip"))return!0;i=i.parentElement}return!1}_setUpFocusManagement(){this._chips.changes.pipe(Rd(this._chips)).subscribe(e=>{const i=[];e.forEach(r=>r._getActions().forEach(s=>i.push(s))),this._chipActions.reset(i),this._chipActions.notifyOnChanges()}),this._keyManager=new v8(this._chipActions).withVerticalOrientation().withHorizontalOrientation(this._dir?this._dir.value:"ltr").withHomeAndEnd().skipPredicate(e=>this._skipPredicate(e)),this.chipFocusChanges.pipe(eo(this._destroyed)).subscribe(({chip:e})=>{const i=e._getSourceAction(document.activeElement);i&&this._keyManager.updateActiveItem(i)}),this._dir?.change.pipe(eo(this._destroyed)).subscribe(e=>this._keyManager.withHorizontalOrientation(e))}_skipPredicate(e){return!e.isInteractive||e.disabled}_trackChipSetChanges(){this._chips.changes.pipe(Rd(null),eo(this._destroyed)).subscribe(()=>{this.disabled&&Promise.resolve().then(()=>this._syncChipsState()),this._redirectDestroyedChipFocus()})}_trackDestroyedFocusedChip(){this.chipDestroyedChanges.pipe(eo(this._destroyed)).subscribe(e=>{const r=this._chips.toArray().indexOf(e.chip);this._isValidIndex(r)&&e.chip._hasFocus()&&(this._lastDestroyedFocusedChipIndex=r)})}_redirectDestroyedChipFocus(){if(null!=this._lastDestroyedFocusedChipIndex){if(this._chips.length){const e=Math.min(this._lastDestroyedFocusedChipIndex,this._chips.length-1),i=this._chips.toArray()[e];i.disabled?1===this._chips.length?this.focus():this._keyManager.setPreviousItemActive():i.focus()}else this.focus();this._lastDestroyedFocusedChipIndex=null}}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(zr),J(kc,8))},n.\u0275cmp=Fn({type:n,selectors:[["mat-chip-set"]],contentQueries:function(e,i,r){if(1&e&&Ri(r,bm,5),2&e){let s;Bt(s=zt())&&(i._chips=s)}},hostAttrs:[1,"mat-mdc-chip-set","mdc-evolution-chip-set"],hostVars:1,hostBindings:function(e,i){1&e&&Kt("keydown",function(s){return i._handleKeydown(s)}),2&e&&Ln("role",i.role)},inputs:{disabled:"disabled",role:"role"},features:[Et],ngContentSelectors:PM,decls:2,vars:0,consts:[["role","presentation",1,"mdc-evolution-chip-set__chips"]],template:function(e,i){1&e&&(fo(),Ye(0,"div",0),qn(1),ot())},styles:[".mdc-evolution-chip-set{display:flex}.mdc-evolution-chip-set:focus{outline:none}.mdc-evolution-chip-set__chips{display:flex;flex-flow:wrap;min-width:0}.mdc-evolution-chip-set--overflow .mdc-evolution-chip-set__chips{flex-flow:nowrap}.mdc-evolution-chip-set .mdc-evolution-chip-set__chips{margin-left:-8px;margin-right:0}[dir=rtl] .mdc-evolution-chip-set .mdc-evolution-chip-set__chips,.mdc-evolution-chip-set .mdc-evolution-chip-set__chips[dir=rtl]{margin-left:0;margin-right:-8px}.mdc-evolution-chip-set .mdc-evolution-chip{margin-left:8px;margin-right:0}[dir=rtl] .mdc-evolution-chip-set .mdc-evolution-chip,.mdc-evolution-chip-set .mdc-evolution-chip[dir=rtl]{margin-left:0;margin-right:8px}.mdc-evolution-chip-set .mdc-evolution-chip{margin-top:4px;margin-bottom:4px}.mat-mdc-chip-set .mdc-evolution-chip-set__chips{min-width:100%}.mat-mdc-chip-set-stacked{flex-direction:column;align-items:flex-start}.mat-mdc-chip-set-stacked .mat-mdc-chip{width:100%}input.mat-mdc-chip-input{flex:1 0 150px;margin-left:8px}[dir=rtl] input.mat-mdc-chip-input{margin-left:0;margin-right:8px}"],encapsulation:2,changeDetection:0}),n})();class yZ{constructor(t,e){this.source=t,this.value=e}}const vZ={provide:Us,useExisting:Pn(()=>zM),multi:!0};let zM=(()=>{class n extends BM{constructor(){super(...arguments),this._onTouched=()=>{},this._onChange=()=>{},this._defaultRole="listbox",this._defaultOptions=gt(N1,{optional:!0}),this._multiple=!1,this.ariaOrientation="horizontal",this._selectable=!0,this.compareWith=(e,i)=>e===i,this._required=!1,this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this.change=new Tt,this._chips=void 0}get multiple(){return this._multiple}set multiple(e){this._multiple=Bn(e),this._syncListboxProperties()}get selected(){const e=this._chips.toArray().filter(i=>i.selected);return this.multiple?e:e[0]}get selectable(){return this._selectable}set selectable(e){this._selectable=Bn(e),this._syncListboxProperties()}get required(){return this._required}set required(e){this._required=Bn(e)}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=Bn(e),this._syncListboxProperties()}get chipSelectionChanges(){return this._getChipStream(e=>e.selectionChange)}get chipBlurChanges(){return this._getChipStream(e=>e._onBlur)}get value(){return this._value}set value(e){this.writeValue(e),this._value=e}ngAfterContentInit(){void 0!==this._pendingInitialValue&&Promise.resolve().then(()=>{this._setSelectionByValue(this._pendingInitialValue,!1),this._pendingInitialValue=void 0}),this._chips.changes.pipe(Rd(null),eo(this._destroyed)).subscribe(()=>{this._syncListboxProperties()}),this.chipBlurChanges.pipe(eo(this._destroyed)).subscribe(()=>this._blur()),this.chipSelectionChanges.pipe(eo(this._destroyed)).subscribe(e=>{this.multiple||this._chips.forEach(i=>{i!==e.source&&i._setSelectedState(!1,!1,!1)}),e.isUserInput&&this._propagateChanges()})}focus(){if(this.disabled)return;const e=this._getFirstSelectedChip();e&&!e.disabled?e.focus():this._chips.length>0?this._keyManager.setFirstItemActive():this._elementRef.nativeElement.focus()}writeValue(e){this._chips?this._setSelectionByValue(e,!1):null!=e&&(this._pendingInitialValue=e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_setSelectionByValue(e,i=!0){this._clearSelection(),Array.isArray(e)?e.forEach(r=>this._selectValue(r,i)):this._selectValue(e,i)}_blur(){this.disabled||setTimeout(()=>{this.focused||this._markAsTouched()})}_keydown(e){9===e.keyCode&&super._allowFocusEscape()}_markAsTouched(){this._onTouched(),this._changeDetectorRef.markForCheck()}_propagateChanges(){let e=null;e=Array.isArray(this.selected)?this.selected.map(i=>i.value):this.selected?this.selected.value:void 0,this._value=e,this.change.emit(new yZ(this,e)),this._onChange(e),this._changeDetectorRef.markForCheck()}_clearSelection(e){this._chips.forEach(i=>{i!==e&&i.deselect()})}_selectValue(e,i){const r=this._chips.find(s=>null!=s.value&&this.compareWith(s.value,e));return r&&(i?r.selectViaInteraction():r.select()),r}_syncListboxProperties(){this._chips&&Promise.resolve().then(()=>{this._chips.forEach(e=>{e._chipListMultiple=this.multiple,e.chipListSelectable=this._selectable,e._chipListHideSingleSelectionIndicator=this.hideSingleSelectionIndicator,e._changeDetectorRef.markForCheck()})})}_getFirstSelectedChip(){return Array.isArray(this.selected)?this.selected.length?this.selected[0]:void 0:this.selected}_skipPredicate(e){return!e.isInteractive}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275cmp=Fn({type:n,selectors:[["mat-chip-listbox"]],contentQueries:function(e,i,r){if(1&e&&Ri(r,NM,5),2&e){let s;Bt(s=zt())&&(i._chips=s)}},hostAttrs:["ngSkipHydration","true",1,"mdc-evolution-chip-set","mat-mdc-chip-listbox"],hostVars:11,hostBindings:function(e,i){1&e&&Kt("focus",function(){return i.focus()})("blur",function(){return i._blur()})("keydown",function(s){return i._keydown(s)}),2&e&&(ia("tabIndex",i.empty?-1:i.tabIndex),Ln("role",i.role)("aria-describedby",i._ariaDescribedby||null)("aria-required",i.role?i.required:null)("aria-disabled",i.disabled.toString())("aria-multiselectable",i.multiple)("aria-orientation",i.ariaOrientation),Xn("mat-mdc-chip-list-disabled",i.disabled)("mat-mdc-chip-list-required",i.required))},inputs:{tabIndex:"tabIndex",multiple:"multiple",ariaOrientation:["aria-orientation","ariaOrientation"],selectable:"selectable",compareWith:"compareWith",required:"required",hideSingleSelectionIndicator:"hideSingleSelectionIndicator",value:"value"},outputs:{change:"change"},features:[Zt([vZ]),Et],ngContentSelectors:PM,decls:2,vars:0,consts:[["role","presentation",1,"mdc-evolution-chip-set__chips"]],template:function(e,i){1&e&&(fo(),Ye(0,"div",0),qn(1),ot())},styles:[".mdc-evolution-chip-set{display:flex}.mdc-evolution-chip-set:focus{outline:none}.mdc-evolution-chip-set__chips{display:flex;flex-flow:wrap;min-width:0}.mdc-evolution-chip-set--overflow .mdc-evolution-chip-set__chips{flex-flow:nowrap}.mdc-evolution-chip-set .mdc-evolution-chip-set__chips{margin-left:-8px;margin-right:0}[dir=rtl] .mdc-evolution-chip-set .mdc-evolution-chip-set__chips,.mdc-evolution-chip-set .mdc-evolution-chip-set__chips[dir=rtl]{margin-left:0;margin-right:-8px}.mdc-evolution-chip-set .mdc-evolution-chip{margin-left:8px;margin-right:0}[dir=rtl] .mdc-evolution-chip-set .mdc-evolution-chip,.mdc-evolution-chip-set .mdc-evolution-chip[dir=rtl]{margin-left:0;margin-right:8px}.mdc-evolution-chip-set .mdc-evolution-chip{margin-top:4px;margin-bottom:4px}.mat-mdc-chip-set .mdc-evolution-chip-set__chips{min-width:100%}.mat-mdc-chip-set-stacked{flex-direction:column;align-items:flex-start}.mat-mdc-chip-set-stacked .mat-mdc-chip{width:100%}input.mat-mdc-chip-input{flex:1 0 150px;margin-left:8px}[dir=rtl] input.mat-mdc-chip-input{margin-left:0;margin-right:8px}"],encapsulation:2,changeDetection:0}),n})(),DZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[k_,{provide:N1,useValue:{separatorKeyCodes:[13]}}],imports:[ur,Tc,f1,ur]}),n})();function NL(n,t){return t?e=>Kv(t.pipe(Jr(1),function SZ(){return Ui((n,t)=>{n.subscribe(fi(t,ro))})}()),e.pipe(NL(n))):Ki((e,i)=>Lt(n(e,i)).pipe(Jr(1),LR(e)))}const TZ=["panel"];function AZ(n,t){if(1&n&&(Ye(0,"div",0,1),qn(2),ot()),2&n){const e=t.id,i=Nt();et("id",i.id)("ngClass",i._classList)("@panelAnimation",i.isOpen?"visible":"hidden"),Ln("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby(e))}}const IZ=["*"],kZ=sa("panelAnimation",[Sr("void, hidden",Vn({opacity:0,transform:"scaleY(0.8)"})),Mr(":enter, hidden => visible",[c6([Ur("0.03s linear",Vn({opacity:1})),Ur("0.12s cubic-bezier(0, 0, 0.2, 1)",Vn({transform:"scaleY(1)"}))])]),Mr(":leave, visible => hidden",[Ur("0.075s linear",Vn({opacity:0}))])]);let RZ=0;class PZ{constructor(t,e){this.source=t,this.option=e}}const OZ=u1(class{}),BL=new Ke("mat-autocomplete-default-options",{providedIn:"root",factory:function FZ(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1}}});let LZ=(()=>{class n extends OZ{get isOpen(){return this._isOpen&&this.showPanel}_setColor(e){this._color=e,this._setThemeClasses(this._classList)}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(e){this._autoActiveFirstOption=Bn(e)}get autoSelectActiveOption(){return this._autoSelectActiveOption}set autoSelectActiveOption(e){this._autoSelectActiveOption=Bn(e)}set classList(e){this._classList=e&&e.length?n2(e).reduce((i,r)=>(i[r]=!0,i),{}):{},this._setVisibilityClasses(this._classList),this._setThemeClasses(this._classList),this._elementRef.nativeElement.className=""}constructor(e,i,r,s){super(),this._changeDetectorRef=e,this._elementRef=i,this._defaults=r,this._activeOptionChanges=Ie.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new Tt,this.opened=new Tt,this.closed=new Tt,this.optionActivated=new Tt,this._classList={},this.id="mat-autocomplete-"+RZ++,this.inertGroups=s?.SAFARI||!1,this._autoActiveFirstOption=!!r.autoActiveFirstOption,this._autoSelectActiveOption=!!r.autoSelectActiveOption}ngAfterContentInit(){this._keyManager=new y8(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(e=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[e]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe()}_setScrollTop(e){this.panel&&(this.panel.nativeElement.scrollTop=e)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(e){const i=new PZ(this,e);this.optionSelected.emit(i)}_getPanelAriaLabelledby(e){return this.ariaLabel?null:this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_setVisibilityClasses(e){e[this._visibleClass]=this.showPanel,e[this._hiddenClass]=!this.showPanel}_setThemeClasses(e){e["mat-primary"]="primary"===this._color,e["mat-warn"]="warn"===this._color,e["mat-accent"]="accent"===this._color}_skipPredicate(e){return e.disabled}}return n.\u0275fac=function(e){return new(e||n)(J(zr),J(jt),J(BL),J(Qr))},n.\u0275dir=rt({type:n,viewQuery:function(e,i){if(1&e&&(ci(ts,7),ci(TZ,5)),2&e){let r;Bt(r=zt())&&(i.template=r.first),Bt(r=zt())&&(i.panel=r.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",autoSelectActiveOption:"autoSelectActiveOption",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[Et]}),n})(),NZ=(()=>{class n extends LZ{constructor(){super(...arguments),this._visibleClass="mat-mdc-autocomplete-visible",this._hiddenClass="mat-mdc-autocomplete-hidden",this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=Bn(e),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const e of this.options)e._changeDetectorRef.markForCheck()}_skipPredicate(e){return!1}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275cmp=Fn({type:n,selectors:[["mat-autocomplete"]],contentQueries:function(e,i,r){if(1&e&&(Ri(r,H2,5),Ri(r,G2,5)),2&e){let s;Bt(s=zt())&&(i.optionGroups=s),Bt(s=zt())&&(i.options=s)}},hostAttrs:["ngSkipHydration","true",1,"mat-mdc-autocomplete"],inputs:{disableRipple:"disableRipple",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matAutocomplete"],features:[Zt([{provide:j2,useExisting:n}]),Et],ngContentSelectors:IZ,decls:1,vars:0,consts:[["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id","ngClass"],["panel",""]],template:function(e,i){1&e&&(fo(),kt(0,AZ,3,5,"ng-template"))},dependencies:[ew],styles:[".mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:none}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(0.8);opacity:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0}[dir=rtl] .mdc-menu-surface,.mdc-menu-surface[dir=rtl]{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}.mdc-menu-surface{max-width:calc(100vw - 32px);max-width:var(--mdc-menu-max-width, calc(100vw - 32px));max-height:calc(100vh - 32px);max-height:var(--mdc-menu-max-height, calc(100vh - 32px));z-index:8;border-radius:4px;border-radius:var(--mdc-shape-medium, 4px)}.mdc-menu-surface.mat-mdc-autocomplete-panel{width:100%;max-height:256px;position:static;visibility:hidden;transform-origin:center top;margin:0;padding:8px 0;list-style-type:none}.mdc-menu-surface.mat-mdc-autocomplete-panel:focus{outline:none}.cdk-high-contrast-active .mdc-menu-surface.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) .mdc-menu-surface.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above .mdc-menu-surface.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}.mdc-menu-surface.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}.mdc-menu-surface.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[kZ]},changeDetection:0}),n})();const BZ={provide:Us,useExisting:Pn(()=>VL),multi:!0},zL=new Ke("mat-autocomplete-scroll-strategy"),VZ={provide:zL,deps:[Dp],useFactory:function zZ(n){return()=>n.scrollStrategies.reposition()}};let UZ=(()=>{class n{get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(e){this._autocompleteDisabled=Bn(e)}constructor(e,i,r,s,u,m,b,E,T,O,H){this._element=e,this._overlay=i,this._viewContainerRef=r,this._zone=s,this._changeDetectorRef=u,this._dir=b,this._formField=E,this._document=T,this._viewportRuler=O,this._defaults=H,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=Ie.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new Xt,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=lw(()=>{const q=this.autocomplete?this.autocomplete.options:null;return q?q.changes.pipe(Rd(q),Vs(()=>$i(...q.map(oe=>oe.onSelectionChange)))):this._zone.onStable.pipe(Jr(1),Vs(()=>this.optionSelections))}),this._scrollStrategy=m}ngAfterViewInit(){const e=this._getWindow();typeof e<"u"&&this._zone.runOutsideAngular(()=>e.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(e){e.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const e=this._getWindow();typeof e<"u"&&e.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._componentDestroyed||this._changeDetectorRef.detectChanges())}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return $i(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(Lo(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(Lo(()=>this._overlayAttached)):qt()).pipe(xt(e=>e instanceof $2?e:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return $i(D_(this._document,"click"),D_(this._document,"auxclick"),D_(this._document,"touchend")).pipe(Lo(e=>{const i=Hu(e),r=this._formField?this._formField._elementRef.nativeElement:null,s=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&i!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!r||!r.contains(i))&&(!s||!s.contains(i))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(i)}))}writeValue(e){Promise.resolve(null).then(()=>this._assignOptionValue(e))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._element.nativeElement.disabled=e}_handleKeydown(e){const i=e.keyCode,r=sl(e);if(27===i&&!r&&e.preventDefault(),this.activeOption&&13===i&&this.panelOpen&&!r)this.activeOption._selectViaInteraction(),this._resetActiveItem(),e.preventDefault();else if(this.autocomplete){const s=this.autocomplete._keyManager.activeItem,u=38===i||40===i;9===i||u&&!r&&this.panelOpen?this.autocomplete._keyManager.onKeydown(e):u&&this._canOpen()&&this.openPanel(),(u||this.autocomplete._keyManager.activeItem!==s)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._element.nativeElement.value),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(e){let i=e.target,r=i.value;"number"===i.type&&(r=""==r?null:parseFloat(r)),this._previousValue!==r&&(this._previousValue=r,this._pendingAutoselectedOption=null,this._onChange(r),this._canOpen()&&this._document.activeElement===e.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this.openPanel()}_floatLabel(e=!1){this._formField&&"auto"===this._formField.floatLabel&&(e?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){const e=this._zone.onStable.pipe(Jr(1)),i=this.autocomplete.options.changes.pipe(Vr(()=>this._positionStrategy.reapplyLastPosition()),function MZ(n,t=Uw){const e=c2(n,t);return NL(()=>e)}(0));return $i(e,i).pipe(Vs(()=>(this._zone.run(()=>{const r=this.panelOpen;this._resetActiveItem(),this.autocomplete._setVisibility(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),r!==this.panelOpen&&(this.panelOpen?this.autocomplete.opened.emit():this.autocomplete.closed.emit())}),this.panelClosingActions)),Jr(1)).subscribe(r=>this._setValueAndClose(r))}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_assignOptionValue(e){const i=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(e):e;this._updateNativeInputValue(i??"")}_updateNativeInputValue(e){this._formField?this._formField._control.value=e:this._element.nativeElement.value=e,this._previousValue=e}_setValueAndClose(e){const i=e?e.source:this._pendingAutoselectedOption;i&&(this._clearPreviousSelectedOption(i),this._assignOptionValue(i.value),this._onChange(i.value),this.autocomplete._emitSelectEvent(i),this._element.nativeElement.focus()),this.closePanel()}_clearPreviousSelectedOption(e){this.autocomplete.options.forEach(i=>{i!==e&&i.selected&&i.deselect()})}_attachOverlay(){let e=this._overlayRef;e?(this._positionStrategy.setOrigin(this._getConnectedElement()),e.updateSize({width:this._getPanelWidth()})):(this._portal=new tL(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),e=this._overlay.create(this._getOverlayConfig()),this._overlayRef=e,this._handleOverlayEvents(e),this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&e&&e.updateSize({width:this._getPanelWidth()})})),e&&!e.hasAttached()&&(e.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const i=this.panelOpen;this.autocomplete._setVisibility(),this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._setColor(this._formField?.color),this.panelOpen&&i!==this.panelOpen&&this.autocomplete.opened.emit()}_getOverlayConfig(){return new wM({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){const e=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(e),this._positionStrategy=e,e}_setStrategyPositions(e){const i=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],r=this._aboveClass,s=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:r},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:r}];let u;u="above"===this.position?s:"below"===this.position?i:[...i,...s],e.withPositions(u)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const e=this.autocomplete;if(e.autoActiveFirstOption){let i=-1;for(let r=0;r<e.options.length;r++)if(!e.options.get(r).disabled){i=r;break}e._keyManager.setActiveItem(i)}else e._keyManager.setActiveItem(-1)}_canOpen(){const e=this._element.nativeElement;return!e.readOnly&&!e.disabled&&!this._autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(e){const i=this.autocomplete,r=function dG(n,t,e){if(e.length){let i=t.toArray(),r=e.toArray(),s=0;for(let u=0;u<n+1;u++)i[u].group&&i[u].group===r[s]&&s++;return s}return 0}(e,i.options,i.optionGroups);if(0===e&&1===r)i._setScrollTop(0);else if(i.panel){const s=i.options.toArray()[e];if(s){const u=s._getHostElement(),m=function uG(n,t,e,i){return n<e?n:n+t>e+i?Math.max(0,n-i+t):e}(u.offsetTop,u.offsetHeight,i._getScrollTop(),i.panel.nativeElement.offsetHeight);i._setScrollTop(m)}}}_handleOverlayEvents(e){e.keydownEvents().subscribe(i=>{(27===i.keyCode&&!sl(i)||38===i.keyCode&&sl(i,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),i.stopPropagation(),i.preventDefault())}),e.outsidePointerEvents().subscribe()}}return n.\u0275fac=function(e){return new(e||n)(J(jt),J(Dp),J(Oo),J(rn),J(zr),J(zL),J(kc,8),J(U_,9),J(Nn,8),J(Ww),J(BL,8))},n.\u0275dir=rt({type:n,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[M]}),n})(),VL=(()=>{class n extends UZ{constructor(){super(...arguments),this._aboveClass="mat-mdc-autocomplete-panel-above"}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Un(n)))(i||n)}}(),n.\u0275dir=rt({type:n,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(e,i){1&e&&Kt("focusin",function(){return i._handleFocus()})("blur",function(){return i._onTouched()})("input",function(s){return i._handleInput(s)})("keydown",function(s){return i._handleKeydown(s)})("click",function(){return i._handleClick()}),2&e&&Ln("autocomplete",i.autocompleteAttribute)("role",i.autocompleteDisabled?null:"combobox")("aria-autocomplete",i.autocompleteDisabled?null:"list")("aria-activedescendant",i.panelOpen&&i.activeOption?i.activeOption.id:null)("aria-expanded",i.autocompleteDisabled?null:i.panelOpen.toString())("aria-owns",i.autocompleteDisabled||!i.panelOpen||null==i.autocomplete?null:i.autocomplete.id)("aria-haspopup",i.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[Zt([BZ]),Et]}),n})(),jZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[VZ],imports:[P1,m1,ur,Tc,S_,m1,ur]}),n})();const HZ=["plus"],$Z=["dateRangeChip"],GZ=["dateChipListBox"];function qZ(n,t){if(1&n&&(Ye(0,"mat-chip-option",28),Kn(1),ot()),2&n){const e=t.$implicit,i=Nt();et("value",e.value)("selected",i.selectedFilters.includes(e.value)),Ze(1),zs(" ",e.title," ")}}function WZ(n,t){if(1&n){const e=rl();Ye(0,"button",29,30),Kt("click",function(){return ti(e),on(Nt().add())}),_n(2,"mat-icon",31),ot()}}function ZZ(n,t){1&n&&Vl(0)}const YZ=function(n,t,e,i){return{$implicit:n,cancelFn:t,saveFn:e,clearPlaceMapAction:i,updateMode:!1}};function XZ(n,t){if(1&n&&kt(0,ZZ,1,0,"ng-container",32),2&n){const e=Nt();et("ngTemplateOutlet",Sa(41))("ngTemplateOutletContext",gI(2,YZ,e.createUpdateForm,e.cancelAdding,e.addNew,e.onCancelLastSelect))}}function KZ(n,t){if(1&n&&(Ye(0,"mat-header-cell"),Kn(1),ot()),2&n){const e=Nt(2).$implicit,i=Nt();Ze(1),Ov("",i.titles[e]," (",i.dataSource.filteredData.length,")")}}function JZ(n,t){1&n&&(Qo(0),kt(1,KZ,2,2,"mat-header-cell",22),es())}function QZ(n,t){if(1&n&&(Ye(0,"mat-header-cell"),Kn(1),ot()),2&n){const e=Nt(2).$implicit,i=Nt();Ze(1),Ma(i.titles[e])}}function eY(n,t){1&n&&(Qo(0),kt(1,QZ,2,1,"mat-header-cell",22),es())}function tY(n,t){if(1&n&&(Ye(0,"mat-cell")(1,"a",36),Kn(2),ot()()),2&n){const e=t.$implicit,i=Nt(2).$implicit;et("@editHide",Nt().editableRow!=e?"show":"hide"),Ze(1),et("href",e.website||"#",$y)("target",e.website?"_blank":"_self"),Ze(1),zs("",e[i]," ")}}function nY(n,t){1&n&&(Qo(0),kt(1,tY,3,4,"mat-cell",23),es())}function iY(n,t){if(1&n&&(Ye(0,"mat-chip",39),Kn(1),s_(2,"date"),s_(3,"date"),ot()),2&n){const e=t.$implicit;Ze(1),Ov(" ",Uv(2,2,e.start,"d MMM yyyy")," \u2014 ",Uv(3,5,e.end,"d MMM yyyy")," ")}}function rY(n,t){if(1&n&&(Qo(0),kt(1,iY,4,8,"mat-chip",38),es()),2&n){const e=Nt().$implicit,i=Nt(2).$implicit;Ze(1),et("ngForOf",e[i])}}function oY(n,t){if(1&n&&(Ye(0,"mat-cell"),kt(1,rY,2,1,"ng-container",37),ot()),2&n){const e=t.$implicit,i=Nt(2).$implicit;et("@editHide",Nt().editableRow!=e?"show":"hide"),Ze(1),et("ngIf",e[i]&&e[i][0].start)}}function sY(n,t){1&n&&(Qo(0),kt(1,oY,2,2,"mat-cell",23),es())}function aY(n,t){if(1&n&&(Qo(0,33)(1,34),kt(2,JZ,2,0,"ng-container",35),kt(3,eY,2,0,"ng-container",35),es(),Qo(4,34),kt(5,nY,2,0,"ng-container",35),kt(6,sY,2,0,"ng-container",35),es()()),2&n){const e=t.$implicit;Ix("matColumnDef",e),Ze(1),et("ngSwitch",e),Ze(1),et("ngSwitchCase","title"),Ze(1),et("ngSwitchCase","date"),Ze(1),et("ngSwitch",e),Ze(1),et("ngSwitchCase","title"),Ze(1),et("ngSwitchCase","date")}}function lY(n,t){1&n&&(Ye(0,"mat-header-cell"),Kn(1,"\xa0"),ot())}function cY(n,t){if(1&n){const e=rl();Ye(0,"mat-cell")(1,"button",40),Kt("click",function(r){const u=ti(e).$implicit;return on(Nt().edit(r,u))}),Ye(2,"mat-icon"),Kn(3,"edit"),ot()(),Ye(4,"button",41),Kt("click",function(r){const u=ti(e).$implicit;return on(Nt().delete(r,u))}),Ye(5,"mat-icon"),Kn(6,"delete"),ot()()()}if(2&n){const e=t.$implicit,i=Nt();Ze(1),et("@editHide",i.editableRow!=e?"show":"hide"),Ze(3),et("@editHide",i.editableRow!=e?"show":"hide")}}function dY(n,t){1&n&&(Ye(0,"mat-header-cell"),Kn(1,"\xa0"),ot())}function uY(n,t){1&n&&Vl(0)}const hY=function(n,t,e,i,r){return{$implicit:n,cancelFn:t,saveFn:e,row:i,updateMode:!0,clearPlaceMapAction:r}};function pY(n,t){if(1&n&&(Qo(0),kt(1,uY,1,0,"ng-container",32),es()),2&n){const e=Nt().$implicit,i=Nt(),r=Sa(41);Ze(1),et("ngTemplateOutlet",r)("ngTemplateOutletContext",function _I(n,t,e,i,r,s,u,m){const b=ir()+n,E=qe(),T=zl(E,b,e,i,r,s);return Bs(E,b+4,u)||T?Td(E,b+5,m?t.call(m,e,i,r,s,u):t(e,i,r,s,u)):function Tv(n,t){return n[t]}(E,b+5)}(2,hY,i.createUpdateForm,i.cancelEditing,i.update,e,i.onRemoveFestival))}}function fY(n,t){if(1&n&&(Ye(0,"mat-cell"),kt(1,pY,2,8,"ng-container",37),ot()),2&n){const e=t.$implicit,i=Nt();et("@editView",i.editableRow==e?"show":"hide"),Ze(1),et("ngIf",i.editableRow==e)}}function mY(n,t){1&n&&_n(0,"mat-header-row")}function gY(n,t){if(1&n){const e=rl();Ye(0,"mat-row",42),Kt("click",function(){const s=ti(e).$implicit;return on(Nt().selectRow(s))}),ot()}}function _Y(n,t){if(1&n){const e=rl();Ye(0,"button",61),Kt("click",function(){return ti(e),on(Nt(2).createUpdateForm.controls.title.reset())}),Ye(1,"mat-icon"),Kn(2,"close"),ot()()}}function yY(n,t){if(1&n&&(Ye(0,"mat-option",66),Kn(1),ot()),2&n){const e=t.$implicit;Ix("id",t.index),et("value",e.place),Ze(1),zs(" ",e.place," ")}}function vY(n,t){if(1&n){const e=rl();Ye(0,"button",61),Kt("click",function(){ti(e);const r=Nt().clearPlaceMapAction;return on(Nt().clearPlaceField(r))}),_n(1,"mat-icon",67),ot()}}function bY(n,t){if(1&n){const e=rl();Ye(0,"button",68,69),Kt("click",function(r){ti(e);const s=Sa(1);return on(Nt(2).selectPoint(r,s))}),_n(2,"mat-icon",70),ot()}}function xY(n,t){if(1&n){const e=rl();Ye(0,"form",43),Kt("ngSubmit",function(r){const s=ti(e);return on((0,s.saveFn)(s.$implicit.value,r,s.row))}),Ye(1,"mat-form-field",44)(2,"mat-label"),Kn(3,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),ot(),_n(4,"input",45,46),kt(6,_Y,3,0,"button",47),ot(),Ye(7,"mat-form-field",48)(8,"mat-label"),Kn(9,"\u041c\u0435\u0441\u0442\u043e"),ot(),_n(10,"input",49,50),Ye(12,"mat-autocomplete",51,52),Kt("optionSelected",function(r){return ti(e),on(Nt().selectOption(r))}),kt(14,yY,2,3,"mat-option",53),s_(15,"async"),ot(),kt(16,vY,2,0,"button",47),_n(17,"div",null,54),kt(19,bY,3,0,"button",55),ot(),Ye(20,"mat-form-field",56)(21,"mat-date-range-input",57,58),_n(23,"input",59)(24,"input",60),ot(),Ye(25,"button",61),Kt("click",function(){return ti(e),on(Nt().createUpdateForm.controls.date.reset())}),Ye(26,"mat-icon"),Kn(27,"close"),ot()(),_n(28,"mat-datepicker-toggle",10)(29,"mat-date-range-picker",null,11),ot(),Ye(31,"button",62),_n(32,"mat-icon",63),ot(),Ye(33,"button",64),Kt("click",function(r){return on((0,ti(e).cancelFn)(r))}),_n(34,"mat-icon",65),ot()()}if(2&n){const e=t.$implicit,i=t.updateMode,r=Sa(5),s=Sa(11),u=Sa(13),m=Sa(30),b=Nt();et("formGroup",e),Ze(6),et("ngIf",r.value),Ze(4),et("matAutocomplete",u),Ze(4),et("ngForOf",CI(15,9,b.places)),Ze(2),et("ngIf",s.value&&!i),Ze(3),et("ngIf",!i),Ze(2),et("rangePicker",m),Ze(7),et("for",m),Ze(3),et("disabled",b.createUpdateForm.invalid||b.saveButtonDisable)}}let UL=(()=>{class n{set filters(e){this._filters=e,this.filter(e.reduce((i,r)=>i+"."+r,""))}get filters(){return this._filters}constructor(e,i,r,s,u,m){this.dataService=e,this.fb=i,this.festService=r,this.mapService=s,this.icons=u,this.routes=m,this.unsubscribe=new Xt,this.displayedColumns=["title","date"],this.displayedColumnsWithControls=[...this.displayedColumns,"controls","edit"],this.titles={title:"\u0424\u0435\u0441\u0442\u0438\u0432\u0430\u043b\u0438",website:"\u0421\u0430\u0439\u0442",coordinates:"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b",date:"\u0414\u0430\u0442\u044b",place:"\u041c\u0435\u0441\u0442\u043e"},this.initialSelection=[],this.allowMultiSelect=!1,this.editableRow=null,this.CHIPS=r6,this.selectedFilters=[],this._filters=[],this.plus=!1,this.exampleFest=this.festService.exampleFest,this.placeSelected=!1,this.tempPoint=!1,this.counter=0,this.dateSortRangeValid=!1,this.saveButtonDisable=!1,this.mapIsReady=!1,this.onSelectionChange=new Tt,this.onSelectNewPlace=new Tt,this.onTurnSelectMapMode=new Tt,this.onCancelSelectMapMode=new Tt,this.onCancelLastSelect=new Tt,this.onRemoveFestival=new Tt,this.onSaveFestival=new Tt,this.addNew=(b,E)=>{E.stopPropagation();const T={...b,date:[b.date]};this.dataSource.setData([T,...this.dataSource.data]),this.closeForm(),this.onSaveFestival.emit()},this.update=(b,E,T)=>{E.preventDefault();const O=this.dataSource.data.findIndex(q=>q==T),H=this.dataSource.data.map((q,oe)=>{if(oe!=O)return q;let de;return(!q.date||1==q.date.length)&&(de=[b.date]),q.date&&q.date.length>1&&(de=[b.date,...q.date.slice(1)]),{...q,title:b.title,date:de}});this.dataSource.setData(H),this.editableRow=null,this.plusBtn.disabled=!1,this.closeForm()},this.cancelAdding=b=>{b.stopPropagation(),(this.tempPoint||this.placeSelected)&&this.onCancelLastSelect.emit(),this.closeForm(),this.counter--,this.selectPointStream&&(this.onCancelSelectMapMode.emit(),this.selectPointStream.complete())},this.cancelEditing=b=>{b.stopPropagation(),this.editableRow=null,this.plusBtn.disabled=!1,this.closeForm(),this.places.next([])},this.filterPredicate=(b,E)=>{let T=E.split(".").slice(1),O=!1;for(let H=0;H<T.length;H++)if(this.dataService.filterFunctions[T[H]](b,this.dateSortRange.value)){O=!0;break}return O},this.data=this.routes.snapshot.data.data,this.selection=new a$(this.allowMultiSelect,this.initialSelection),this.selection.changed.subscribe(()=>{this.onSelectionChange.emit(this.selection.selected[0])}),this.createUpdateForm=this.fb.group({title:this.fb.control(this.exampleFest.title+this.counter),place:this.fb.control(null,{validators:lm.required}),date:this.fb.group({start:this.fb.control(this.exampleFest.date.start),end:this.fb.control(this.exampleFest.date.end)}),coordinates:this.fb.control(null)}),this.dateSortRange=this.fb.group({start:this.fb.control(null),end:this.fb.control(null)}),this.places=new _s([{place:"",point:null}]),this.followPlaceTitle(),this.dateSortRange.statusChanges.subscribe(b=>{const E="VALID"==b;this.dateSortRangeValid=E,this.dateRangeChip.selected=E,this.dateRangeChip.selectionChange.emit({source:this.dateRangeChip,selected:E,isUserInput:!0})})}ngOnInit(){this.dataSource=new DG(this.data,this.dataService),this.dataSource.filterPredicate=this.filterPredicate,this.places.next([])}ngOnDestroy(){this.unsubscribe.complete()}followPlaceTitle(){this.createUpdateForm.controls.place.valueChanges.pipe(jw(1500),WO(),Lo(e=>!this.placeSelected),Lo(e=>!!e),Vs(e=>this.mapService.geoCodingGetAddress(e)),Vr(e=>{this.places.next(e)})).subscribe()}add(){this.plus||(this.plus=!0,this.createUpdateForm.patchValue({title:this.exampleFest.title+ ++this.counter,date:{start:this.exampleFest.date.start,end:this.exampleFest.date.end}}))}edit(e,i){this.editableRow=i,this.plusBtn.disabled=!0,this.createUpdateForm.patchValue({title:i.title,coordinates:i.coordinates,date:{start:i.date?i.date[0].start:null,end:i.date?i.date[0].end:null},place:i.place||null}),this.createUpdateForm.value.place||this.mapService.geoCodingGetAddress(i.coordinates[0]).subscribe(r=>{this.createUpdateForm.patchValue({place:r[0].place})}),this.createUpdateForm.controls.place.disable()}delete(e,i){e.stopPropagation();const r=this.dataSource.data.findIndex(s=>s===i);this.dataSource.setData(this.dataSource.data.filter((s,u)=>u!=r)),this.onRemoveFestival.emit(r)}closeForm(){this.plus=!1,this.createUpdateForm.reset(),this.placeSelected=!1,this.tempPoint=!1,this.createUpdateForm.controls.place.enable()}selectRow(e){this.selection.select(e),this.onSelectionChange.emit(this.selection.selected[0])}filter(e){this.dataSource.filter=e}selectPoint(e,i){this.saveButtonDisable=!0,e.stopPropagation(),(this.tempPoint||this.placeSelected)&&this.onCancelLastSelect.emit(),i.disabled=!0,this.createUpdateForm.controls.place.reset(),this.createUpdateForm.controls.place.disable();const r=new Xt;this.onTurnSelectMapMode.emit(r),r.pipe(Vs(s=>(this.createUpdateForm.patchValue({coordinates:[s]}),this.mapService.geoCodingGetAddress(s)))).subscribe(s=>{let u;this.tempPoint=!0,u=s.length?s[0].place:"\u0433\u0434\u0435-\u0442\u043e \u0434\u0430\u043b\u0435\u043a\u043e",this.createUpdateForm.patchValue({place:u}),this.placeSelected=!0,this.createUpdateForm.controls.place.enable(),i.disabled=!1,this.saveButtonDisable=!1}),this.selectPointStream=r}clearPlaceField(e){this.createUpdateForm.controls.place.reset(),this.places.next([]),this.placeSelected&&e.emit(),this.placeSelected=!1,this.tempPoint=!1}selectOption(e){this.placeSelected=!0;const i=this.places.getValue()[Number(e.option.id)].point.coordinates;this.places.next([]),this.createUpdateForm.patchValue({coordinates:[i]}),this.onSelectNewPlace.emit(i)}}return n.\u0275fac=function(e){return new(e||n)(J(PF),J(t6),J(mM),J(v1),J(UW),J(_p))},n.\u0275cmp=Fn({type:n,selectors:[["app-data-table"]],viewQuery:function(e,i){if(1&e&&(ci(HZ,5),ci($Z,5),ci(GZ,5)),2&e){let r;Bt(r=zt())&&(i.plusBtn=r.first),Bt(r=zt())&&(i.dateRangeChip=r.first),Bt(r=zt())&&(i.dateChipListBox=r.first)}},inputs:{mapIsReady:"mapIsReady",allPointsStream:"allPointsStream"},outputs:{onSelectionChange:"onSelectionChange",onSelectNewPlace:"onSelectNewPlace",onTurnSelectMapMode:"onTurnSelectMapMode",onCancelSelectMapMode:"onCancelSelectMapMode",onCancelLastSelect:"onCancelLastSelect",onRemoveFestival:"onRemoveFestival",onSaveFestival:"onSaveFestival"},decls:42,vars:21,consts:[[1,"logo"],["svgIcon","eq",1,"eq"],[1,"left"],["selectable","","multiple","",3,"change"],["dateChipListBox",""],["disableRipple","",3,"value","selected",4,"ngFor","ngForOf"],["removable","","value","range",3,"disabled"],["dateRangeChip",""],["matChipRemove","",1,"date-range-chip-remove-btn",3,"click"],[1,"right"],["matIconSuffix","",3,"for"],["picker",""],["subscriptSizing","dynamic",1,"datepicker"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","start","required",""],["matEndDate","","formControlName","end","required",""],[1,"middle"],["class","plus","mat-icon-button","","color","primary",3,"click",4,"ngIf","ngIfElse"],["addForm",""],[3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","controls"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","edit"],[4,"matHeaderRowDef"],["class","table-row",3,"click",4,"matRowDef","matRowDefColumns"],["create_update_form",""],["disableRipple","",3,"value","selected"],["mat-icon-button","","color","primary",1,"plus",3,"click"],["plus",""],["svgIcon","plus"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"matColumnDef"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"href","target"],[4,"ngIf"],["disableRipple","","class","date-chip",4,"ngFor","ngForOf"],["disableRipple","",1,"date-chip"],["mat-icon-button","",1,"control","control-edit",3,"click"],["mat-icon-button","",1,"control","control-delete",3,"click"],[1,"table-row",3,"click"],[3,"formGroup","ngSubmit"],["subscriptSizing","dynamic",1,"inputs-title"],["matInput","","formControlName","title"],["titleInput",""],["type","button","matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["subscriptSizing","dynamic",1,"inputs-place"],["matInput","","formControlName","place","placeholder","\u0412\u0432\u0435\u0441\u0442\u0438 \u043c\u0435\u0441\u0442\u043e \u0438\u043b\u0438 \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0447\u043a\u0443 \u043d\u0430 \u043a\u0430\u0440\u0442\u0443",3,"matAutocomplete"],["placeInput",""],[3,"optionSelected"],["pl","matAutocomplete"],[3,"value","id",4,"ngFor","ngForOf"],["someDiv",""],["type","button","class","select-place","matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["subscriptSizing","dynamic"],["formGroupName","date",3,"rangePicker"],["dateRangeInput",""],["matStartDate","","formControlName","start","placeholder","\u043d\u0430\u0447\u043d\u0435\u0442\u0441\u044f"],["matEndDate","","formControlName","end","placeholder","\u0437\u0430\u043a\u043e\u043d\u0447\u0438\u0442\u0441\u044f"],["type","button","matSuffix","","mat-icon-button","",3,"click"],["mat-icon-button","",1,"save",3,"disabled"],["svgIcon","save"],["type","button","mat-icon-button","",1,"cancel",3,"click"],["svgIcon","cancel"],[3,"value","id"],["svgIcon","close"],["type","button","matSuffix","","mat-icon-button","",1,"select-place",3,"click"],["selectPointButton",""],["svgIcon","location"]],template:function(e,i){if(1&e&&(Ye(0,"header")(1,"div",0)(2,"span"),Kn(3,"space club"),ot(),_n(4,"mat-icon",1),ot(),Ye(5,"div",2)(6,"mat-chip-listbox",3,4),Kt("change",function(s){return i.filters=s.value}),kt(8,qZ,2,3,"mat-chip-option",5),Ye(9,"mat-chip-option",6,7),Kn(11),s_(12,"date"),s_(13,"date"),Ye(14,"button",8),Kt("click",function(){return i.dateSortRange.reset()}),Ye(15,"mat-icon"),Kn(16,"cancel"),ot()()()()(),Ye(17,"div",9),_n(18,"mat-datepicker-toggle",10)(19,"mat-date-range-picker",null,11),Ye(21,"mat-form-field",12)(22,"mat-date-range-input",13),_n(23,"input",14)(24,"input",15),ot()()()(),Ye(25,"section",16),kt(26,WZ,3,0,"button",17),kt(27,XZ,1,7,"ng-template",null,18,Hv),ot(),Ye(29,"main")(30,"mat-table",19),kt(31,aY,7,7,"ng-container",20),Qo(32,21),kt(33,lY,2,0,"mat-header-cell",22),kt(34,cY,7,2,"mat-cell",23),es(),Qo(35,24),kt(36,dY,2,0,"mat-header-cell",22),kt(37,fY,2,2,"mat-cell",23),es(),kt(38,mY,1,0,"mat-header-row",25),kt(39,gY,1,0,"mat-row",26),ot()(),kt(40,xY,35,11,"ng-template",null,27,Hv)),2&e){const r=Sa(20),s=Sa(28);Ze(8),et("ngForOf",i.CHIPS),Ze(1),et("disabled",!i.dateSortRangeValid),Ze(2),Ov(" ",Uv(12,15,i.dateSortRange.controls.start.value,"d MMM yyyy")||"\u043d\u0430\u0447\u0430\u043b\u043e"," \u2014 ",Uv(13,18,i.dateSortRange.controls.end.value,"d MMM yyyy")||"\u043a\u043e\u043d\u0435\u0446"," "),Ze(7),et("for",r),Ze(4),et("formGroup",i.dateSortRange)("rangePicker",r),Ze(4),et("ngIf",!i.plus)("ngIfElse",s),Ze(3),Xn("disable",i.plus),Ze(1),et("dataSource",i.dataSource),Ze(1),et("ngForOf",i.displayedColumns),Ze(7),et("matHeaderRowDef",i.displayedColumnsWithControls),Ze(1),et("matRowDefColumns",i.displayedColumnsWithControls)}},dependencies:[tw,Nu,vD,tm,Zv,MO,Sw,hO,pO,zw,Vu,vS,Bw,q2,qS,W2,WS,GS,Z2,ZS,YS,Y2,X2,gM,B9,O9,yM,A9,BW,H7,Z7,AL,IL,Y7,bm,zM,NM,FL,NZ,G2,VL,nR,iR],styles:['.logo[_ngcontent-%COMP%]{position:absolute;width:66%;top:20px;left:34%;flex-grow:1;text-align:center;white-space:nowrap}.logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{letter-spacing:25px;text-transform:uppercase;opacity:1;-webkit-user-select:none;user-select:none;white-space:nowrap;font-size:18px;animation:_ngcontent-%COMP%_logo-text 8s ease-out;animation-fill-mode:forwards}@media (max-width: 767.98px){.logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{animation:none}}@media (max-width: 575.98px){.logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{letter-spacing:20px}}@media (max-width: 991.98px){.logo[_ngcontent-%COMP%]{top:5px;left:0;width:100%}}@media (max-height: 700px){.logo[_ngcontent-%COMP%]{display:none}}mat-icon.eq[_ngcontent-%COMP%]{position:relative;top:4px;width:40px;animation:_ngcontent-%COMP%_logo .8s ease-out;animation-delay:7.5s;animation-fill-mode:forwards;opacity:0;transform:translate(40px);animation-timing-function:cubic-bezier(0,.83,.36,.94)}@media (max-width: 767.98px){mat-icon.eq[_ngcontent-%COMP%]{animation:none;transform:translate(0);opacity:1}}mat-icon.eq[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:auto;height:auto;vertical-align:bottom}header[_ngcontent-%COMP%]{display:flex;padding:10px 10px 10px 25px}@media (max-width: 991.98px){header[_ngcontent-%COMP%]{padding:60px 10px 10px 25px}}@media (max-width: 575.98px){header[_ngcontent-%COMP%]{padding:40px 10px 0 5px}}@media (max-height: 700px){header[_ngcontent-%COMP%]{padding:0 10px}}@keyframes _ngcontent-%COMP%_logo-text{0%{opacity:0;letter-spacing:60px;text-shadow:none}20%{opacity:0;letter-spacing:60px}to{opacity:1}}@keyframes _ngcontent-%COMP%_logo{to{opacity:1;transform:translate(0)}}.top[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.left[_ngcontent-%COMP%]{display:flex;flex-grow:1;align-items:center;flex-wrap:wrap;overflow-x:auto}.left[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.right[_ngcontent-%COMP%]{position:relative;display:flex}.date-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column}mat-form-field.datepicker[_ngcontent-%COMP%]{position:absolute;z-index:-1;top:0;left:0;width:100%;height:100%}section.middle[_ngcontent-%COMP%]{text-align:center}main[_ngcontent-%COMP%]{overflow-y:auto;position:relative}main[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px;height:5px}main[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:50px}main[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent;border-radius:50px}main.disable[_ngcontent-%COMP%]{overflow-y:visible}main.disable[_ngcontent-%COMP%]:after{z-index:0;opacity:1}main[_ngcontent-%COMP%]:after{z-index:-1;opacity:0;position:absolute;top:0;left:0;content:"";width:100%;height:100%;transition:opacity .4s}.date-chip[_ngcontent-%COMP%]{pointer-events:none;touch-action:none}@media (max-width: 575px),(max-height: 700px){.date-chip[_ngcontent-%COMP%]:first-child{margin:5px 0}.date-chip[_ngcontent-%COMP%]:last-child{margin-bottom:5px}}.date-chip[_ngcontent-%COMP%]:not(:last-child){margin-right:10px}mat-row.mat-mdc-row[_ngcontent-%COMP%]{position:relative;flex-wrap:wrap}mat-row.mat-mdc-row[_ngcontent-%COMP%]:hover{cursor:pointer}@media (max-width: 767px),(max-height: 700px){mat-row.mat-mdc-row[_ngcontent-%COMP%]{padding-top:10px}}a[_ngcontent-%COMP%]{text-decoration:none}.mat-mdc-header-cell[_ngcontent-%COMP%]{border:none;text-transform:uppercase;letter-spacing:3px;-webkit-user-select:none;user-select:none;white-space:nowrap}@media (max-width: 767px),(max-height: 700px){.mat-mdc-header-cell[_ngcontent-%COMP%]{align-items:flex-start}.mat-mdc-header-cell.mat-column-date[_ngcontent-%COMP%]{display:none}}.mat-mdc-header-cell[_ngcontent-%COMP%], .mat-mdc-cell[_ngcontent-%COMP%]{flex:0 1 auto}@media (max-width: 767px),(max-height: 700px){.mat-mdc-header-cell[_ngcontent-%COMP%]:first-of-type, .mat-mdc-cell[_ngcontent-%COMP%]:first-of-type{border-bottom:none}}.control[_ngcontent-%COMP%]{visibility:hidden}@media (max-width: 991px),(max-height: 700px){.control[_ngcontent-%COMP%]{visibility:visible}}.mat-column-title[_ngcontent-%COMP%]{min-height:60px;flex:1 1 0}@media (max-width: 767px),(max-height: 700px){.mat-column-title[_ngcontent-%COMP%]{min-height:auto;flex:1 1 100%;padding-left:20px}}@media (max-width: 575px),(max-height: 700px){.mat-column-title[_ngcontent-%COMP%]{padding-left:15px}}.mat-column-date[_ngcontent-%COMP%]{flex:1 0 50%}@media (max-width: 575px),(max-height: 700px){.mat-column-date[_ngcontent-%COMP%]{flex-direction:column;align-items:start;padding-left:10px}}.mat-column-controls[_ngcontent-%COMP%]{flex:0 0 auto}@media (max-width: 767px),(max-height: 700px){.mat-column-controls[_ngcontent-%COMP%]{padding:0}}.mat-column-edit[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;z-index:-1;padding:0}@media (max-width: 991px),(max-height: 700px){.mat-column-edit[_ngcontent-%COMP%]{height:auto;border:none}}form[_ngcontent-%COMP%]{padding:0 10px;display:flex;flex-grow:1;align-items:center;justify-content:center}form[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-right:10px}@media (max-width: 991px),(max-height: 700px){form[_ngcontent-%COMP%]{flex-wrap:wrap;padding:10px;margin:10px;border-radius:10px}form[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}}.inputs-title[_ngcontent-%COMP%]{flex-grow:1;min-width:150px}.inputs-place[_ngcontent-%COMP%]{flex-grow:4}'],data:{animation:[sa("editView",[Sr("hide",Vn({opacity:0})),Sr("show",Vn({"z-index":1,opacity:1})),Mr("show <=> hide",Ur("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))]),sa("editHide",[Sr("hide",Vn({visibility:"hidden"})),Sr("show",Vn({}))])]}}),n})();var wY=zi(898),jL=zi.n(wY);let HL=(()=>{class n{constructor(e,i,r){var s=this;this.routes=e,this.mapService=i,this.mapLoaded=!1,this.onMapLoaded=new Tt,this.onPointCreated=new Tt,this.mobileView=!1,this.mobileZoom=1.5,this.bigZoom=3,this.zoom=this.bigZoom,this.createGeoJson=u=>({type:"FeatureCollection",features:u.map(E=>({type:"Feature",geometry:{type:"Point",coordinates:E}}))}),this.addPointMode=u=>{const m=this.mapbox.getCanvasContainer();m.style.cursor="crosshair",this.selectPointListener=b=>{const E=[b.lngLat.lng,b.lngLat.lat];this.createPoint(E),u.next(E),u.complete(),m.style.cursor=""},this.mapbox.once("click",this.selectPointListener)},this.configureMap=F_(function*(){s.mapbox.on("mouseenter","circle",()=>{s.mapbox.getCanvas().style.cursor="pointer"}),s.mapbox.on("mouseleave","circle",()=>{s.mapbox.getCanvas().style.cursor=""})}),this.createPoint=u=>{this.allPointsCoordinates.unshift(u),this.refreshPoints(),this.mapbox.flyTo({center:u,zoom:this.mapbox.getStyle().zoom+3})},this.allPointsCoordinates=this.mapService.allFestivalCoordinates,this.starting\u0421enter=this.allPointsCoordinates[0],jL().accessToken=gt(eC).mapbox,r.observe(["(max-width: 767px)","(max-height: 700px)"]).subscribe(u=>{u.matches?(this.mobileView=!0,this.zoom=this.mobileZoom,this.mapbox?.zoomTo(this.zoom)):(this.mobileView=!1,this.zoom=this.bigZoom,this.mapbox?.zoomTo(this.zoom))})}ngOnInit(){var e=this;return F_(function*(){e.mapbox=yield e.createMap(),e.onMapLoaded.emit(!0),e.mapLoaded=!0,e.configureMap(),e.addFestivalsPoints()})()}addFestivalsPoints(){this.mapbox.addSource("points",{type:"geojson",data:this.createGeoJson(this.allPointsCoordinates)}),this.mapbox.addLayer({id:"circle",type:"circle",source:"points",paint:{"circle-color":"#4264fb","circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}})}selectPoint(e){this.mapLoaded&&this.mapbox.flyTo({center:e[0],zoom:this.zoom})}cancelAddPointMode(){const e=this.mapbox.getCanvasContainer();this.mapbox.off("click",this.selectPointListener),e.style.cursor=""}createMap(){var e=this;return F_(function*(){const i=new(jL().Map)({container:"map",style:"mapbox://styles/mapbox/streets-v12",center:e.starting\u0421enter,zoom:e.zoom,antialias:!1});return yield new Promise(r=>{i.on("load",()=>r("\u041a\u0430\u0440\u0442\u0430 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430"))}),i})()}removeLastPoint(){this.allPointsCoordinates.shift(),this.refreshPoints(),this.mapbox.zoomTo(this.zoom)}removePoint(e){this.allPointsCoordinates=this.allPointsCoordinates.filter((i,r)=>r!=e),this.refreshPoints()}refreshPoints(){const e=this.createGeoJson(this.allPointsCoordinates);this.mapbox.getSource("points").setData(e)}afterSave(){this.mapbox.zoomTo(this.zoom)}}return n.\u0275fac=function(e){return new(e||n)(J(_p),J(v1),J(b2))},n.\u0275cmp=Fn({type:n,selectors:[["app-map"]],hostAttrs:["id","map"],outputs:{onMapLoaded:"onMapLoaded",onPointCreated:"onPointCreated"},decls:0,vars:0,template:function(e,i){}}),n})(),$L=(()=>{class n{constructor(){this.mapIsReady=!1}selectFestival(e){this.map.selectPoint(e.coordinates)}newPoint(e){this.map.createPoint(e)}removeLastPoint(){this.map.removeLastPoint()}turnSelectMapMode(e){this.map.addPointMode(e)}cancelSelectMapMode(){this.map.cancelAddPointMode()}removePoint(e){this.map.removePoint(e)}afterSaveFestival(){this.map.afterSave()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Fn({type:n,selectors:[["app-controller"]],viewQuery:function(e,i){if(1&e&&(ci(UL,5),ci(HL,5)),2&e){let r;Bt(r=zt())&&(i.dataTable=r.first),Bt(r=zt())&&(i.map=r.first)}},decls:8,vars:1,consts:[[3,"onMapLoaded"],[3,"mapIsReady","onSelectionChange","onSelectNewPlace","onCancelLastSelect","onTurnSelectMapMode","onCancelSelectMapMode","onSaveFestival","onRemoveFestival"],[1,"space-objects"],["src","assets/icons/globe_planet_jupiter_2773.png",1,"planet","planet-one"],["src","assets/icons/globe_planetNeptune_glob_2775.png",1,"planet","planet-two"],["src","assets/icons/shuttle.png",1,"space-ship","space-ship-one"],["src","assets/icons/station.png",1,"space-ship","space-ship-two"],["src","assets/icons/china-station.png",1,"space-ship","space-ship-three"]],template:function(e,i){1&e&&(Ye(0,"app-map",0),Kt("onMapLoaded",function(){return i.mapIsReady=!0}),ot(),Ye(1,"app-data-table",1),Kt("onSelectionChange",function(s){return i.selectFestival(s)})("onSelectNewPlace",function(s){return i.newPoint(s)})("onCancelLastSelect",function(){return i.removeLastPoint()})("onTurnSelectMapMode",function(s){return i.turnSelectMapMode(s)})("onCancelSelectMapMode",function(){return i.cancelSelectMapMode()})("onSaveFestival",function(){return i.afterSaveFestival()})("onRemoveFestival",function(s){return i.removePoint(s)}),ot(),Ye(2,"div",2),_n(3,"img",3)(4,"img",4)(5,"img",5)(6,"img",6)(7,"img",7),ot()),2&e&&(Ze(1),et("mapIsReady",i.mapIsReady))},styles:["[_nghost-%COMP%]{height:100%;overflow:hidden;z-index:0;position:relative;display:flex;align-items:flex-end;justify-content:center;background-color:#3c5b7b}@media (max-height: 700px){[_nghost-%COMP%]{justify-content:flex-end}}app-map[_ngcontent-%COMP%]{position:absolute;top:-30%;left:0;width:100%;height:150%;background-color:#0303043b;transition:top .3s}@media (max-width: 991.98px){app-map[_ngcontent-%COMP%]{top:-50%}}@media (max-height: 700px){app-map[_ngcontent-%COMP%]{top:0;width:50%;height:100%}}app-data-table[_ngcontent-%COMP%]{height:50%;border-radius:20px;padding:5px 0;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);box-shadow:0 0 30px #0003;display:flex;flex-grow:1;flex-direction:column;z-index:2;overflow:hidden;margin:10px 20px;max-width:1200px;transition:height .3s}@media (max-width: 991.98px){app-data-table[_ngcontent-%COMP%]{max-width:100%;height:65%}}@media (max-width: 575.98px){app-data-table[_ngcontent-%COMP%]{margin:0;border-radius:20px 20px 0 0}}@media (max-height: 700px){app-data-table[_ngcontent-%COMP%]{width:50%;height:100%;max-width:none;flex-grow:0;margin:0;border-radius:0}}.space-objects[_ngcontent-%COMP%]{z-index:1;position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;transform-style:preserve-3d;perspective:500px}@media (max-width: 991.98px){.space-objects[_ngcontent-%COMP%]{display:none}}@media (max-height: 700px){.space-objects[_ngcontent-%COMP%]{display:none}}.planet[_ngcontent-%COMP%]{position:absolute;--size: 180px;width:var(--size);height:var(--size)}.planet-one[_ngcontent-%COMP%]{left:0%;top:30%;filter:blur(5px);animation:_ngcontent-%COMP%_planet-flight-throw-display 5s;animation-fill-mode:forwards;animation-delay:1s;animation-timing-function:cubic-bezier(1,.1,1,.06);transform:scale(.05) translate(30vh)}.planet-two[_ngcontent-%COMP%]{--size: 250px;right:-20vw;top:50vh;filter:blur(2px);animation:_ngcontent-%COMP%_planet-two 60s linear infinite;animation-delay:3s}.space-ship[_ngcontent-%COMP%]{position:absolute;width:100px}.space-ship-one[_ngcontent-%COMP%]{width:100px;top:-20vh;left:50vw;animation:_ngcontent-%COMP%_shuttle-orbit 40s linear infinite}.space-ship-two[_ngcontent-%COMP%]{width:50px;top:40vh;left:0;animation:_ngcontent-%COMP%_station-one 40s linear infinite}.space-ship-three[_ngcontent-%COMP%]{width:50px;top:30vh;right:0;animation:_ngcontent-%COMP%_station-two 10s linear infinite}@keyframes _ngcontent-%COMP%_planet-flight-throw-display{97%{filter:blur(3px);transform:scale(.6) translate(30vh)}99%{opacity:1;transform:scale(5) translate(30vh)}to{opacity:0;transform:scale(9) translate(30vh);filter:blur(0px)}}@keyframes _ngcontent-%COMP%_planet-two{0%{transform:rotate(0) translate3d(5vw,0,0)}50%,to{transform:rotate(25deg) translate3d(-110vw,100vh,0)}}@keyframes _ngcontent-%COMP%_station-one{0%{transform:rotate(0) translate3d(-5vw,0,0)}50%,to{transform:rotate(-40deg) translate3d(110vw,70vh,0)}}@keyframes _ngcontent-%COMP%_station-two{0%{transform:rotate(0) translate3d(5vw,0,0)}50%,to{transform:rotate(30deg) translate3d(-110vw,80vh,0)}}@keyframes _ngcontent-%COMP%_shuttle-orbit{0%{transform:rotate(0) translate(-65vw)}to{transform:rotate(360deg) translate(-65vw)}}"]}),n})();const CY=[{path:"",component:$L,pathMatch:"full",resolve:{data:()=>gt(PF).getData()}},{path:"**",redirectTo:""}];let EY=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[LP.forRoot(CY),LP]}),n})(),DY=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Fn({type:n,selectors:[["space-club"]],decls:1,vars:0,template:function(e,i){1&e&&_n(0,"router-outlet")},dependencies:[YD]}),n})();function GL(n){return new ke(3e3,!1)}function Mp(n){switch(n.length){case 0:return new bb;case 1:return n[0];default:return new QO(n)}}function qL(n,t,e=new Map,i=new Map){const r=[],s=[];let u=-1,m=null;if(t.forEach(b=>{const E=b.get("offset"),T=E==u,O=T&&m||new Map;b.forEach((H,q)=>{let oe=q,de=H;if("offset"!==q)switch(oe=n.normalizePropertyName(oe,r),de){case DS:de=e.get(q);break;case Uu:de=i.get(q);break;default:de=n.normalizeStyleValue(q,oe,de,r)}O.set(oe,de)}),T||s.push(O),m=O,u=E}),r.length)throw function ZY(n){return new ke(3502,!1)}();return s}function VM(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&UM(e,"start",n)));break;case"done":n.onDone(()=>i(e&&UM(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&UM(e,"destroy",n)))}}function UM(n,t,e){const s=jM(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),u=n._data;return null!=u&&(s._data=u),s}function jM(n,t,e,i,r="",s=0,u){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:r,totalTime:s,disabled:!!u}}function ll(n,t,e){let i=n.get(t);return i||n.set(t,i=e),i}function WL(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}const sX=(()=>typeof document>"u"?null:document.documentElement)();function HM(n){const t=n.parentNode||n.host||null;return t===sX?null:t}let xm=null,ZL=!1;function YL(n,t){for(;t;){if(t===n)return!0;t=HM(t)}return!1}function XL(n,t,e){if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]}let KL=(()=>{class n{validateStyleProperty(e){return function lX(n){xm||(xm=function cX(){return typeof document<"u"?document.body:null}()||{},ZL=!!xm.style&&"WebkitAppearance"in xm.style);let t=!0;return xm.style&&!function aX(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in xm.style,!t&&ZL&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in xm.style)),t}(e)}matchesElement(e,i){return!1}containsElement(e,i){return YL(e,i)}getParentElement(e){return HM(e)}query(e,i,r){return XL(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,s,u,m=[],b){return new bb(r,s)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})(),$M=(()=>{class n{}return n.NOOP=new KL,n})();const dX=1e3,GM="ng-enter",V1="ng-leave",U1="ng-trigger",j1=".ng-trigger",QL="ng-animating",qM=".ng-animating";function Xu(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:WM(parseFloat(t[1]),t[2])}function WM(n,t){return"s"===t?n*dX:n}function H1(n,t,e){return n.hasOwnProperty("duration")?n:function hX(n,t,e){let r,s=0,u="";if("string"==typeof n){const m=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===m)return t.push(GL()),{duration:0,delay:0,easing:""};r=WM(parseFloat(m[1]),m[2]);const b=m[3];null!=b&&(s=WM(parseFloat(b),m[4]));const E=m[5];E&&(u=E)}else r=n;if(!e){let m=!1,b=t.length;r<0&&(t.push(function SY(){return new ke(3100,!1)}()),m=!0),s<0&&(t.push(function MY(){return new ke(3101,!1)}()),m=!0),m&&t.splice(b,0,GL())}return{duration:r,delay:s,easing:u}}(n,t,e)}function jb(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function eN(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function Tp(n,t=new Map,e){if(e)for(let[i,r]of e)t.set(i,r);for(let[i,r]of n)t.set(i,r);return t}function Bd(n,t,e){t.forEach((i,r)=>{const s=YM(r);e&&!e.has(r)&&e.set(r,n.style[s]),n.style[s]=i})}function wm(n,t){t.forEach((e,i)=>{const r=YM(i);n.style[r]=""})}function Hb(n){return Array.isArray(n)?1==n.length?n[0]:YO(n):n}const ZM=new RegExp("{{\\s*(.+?)\\s*}}","g");function nN(n){let t=[];if("string"==typeof n){let e;for(;e=ZM.exec(n);)t.push(e[1]);ZM.lastIndex=0}return t}function $b(n,t,e){const i=n.toString(),r=i.replace(ZM,(s,u)=>{let m=t[u];return null==m&&(e.push(function AY(n){return new ke(3003,!1)}()),m=""),m.toString()});return r==i?n:r}function $1(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const mX=/-+([a-z0-9])/g;function YM(n){return n.replace(mX,(...t)=>t[1].toUpperCase())}function cl(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function IY(n){return new ke(3004,!1)}()}}function iN(n,t){return window.getComputedStyle(n)[t]}const G1="*";function yX(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function vX(n,t,e){if(":"==n[0]){const b=function bX(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function $Y(n){return new ke(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof b)return void t.push(b);n=b}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function HY(n){return new ke(3015,!1)}()),t;const r=i[1],s=i[2],u=i[3];t.push(rN(r,u));"<"==s[0]&&!(r==G1&&u==G1)&&t.push(rN(u,r))}(i,e,t)):e.push(n),e}const q1=new Set(["true","1"]),W1=new Set(["false","0"]);function rN(n,t){const e=q1.has(n)||W1.has(n),i=q1.has(t)||W1.has(t);return(r,s)=>{let u=n==G1||n==r,m=t==G1||t==s;return!u&&e&&"boolean"==typeof r&&(u=r?q1.has(n):W1.has(n)),!m&&i&&"boolean"==typeof s&&(m=s?q1.has(t):W1.has(t)),u&&m}}const xX=new RegExp("s*:selfs*,?","g");function XM(n,t,e,i){return new wX(n).build(t,e,i)}class wX{constructor(t){this._driver=t}build(t,e,i){const r=new DX(e);return this._resetContextStyleTimingState(r),cl(this,Hb(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,r=e.depCount=0;const s=[],u=[];return"@"==t.name.charAt(0)&&e.errors.push(function RY(){return new ke(3006,!1)}()),t.definitions.forEach(m=>{if(this._resetContextStyleTimingState(e),0==m.type){const b=m,E=b.name;E.toString().split(/\s*,\s*/).forEach(T=>{b.name=T,s.push(this.visitState(b,e))}),b.name=E}else if(1==m.type){const b=this.visitTransition(m,e);i+=b.queryCount,r+=b.depCount,u.push(b)}else e.errors.push(function PY(){return new ke(3007,!1)}())}),{type:7,name:t.name,states:s,transitions:u,queryCount:i,depCount:r,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const s=new Set,u=r||{};i.styles.forEach(m=>{m instanceof Map&&m.forEach(b=>{nN(b).forEach(E=>{u.hasOwnProperty(E)||s.add(E)})})}),s.size&&($1(s.values()),e.errors.push(function OY(n,t){return new ke(3008,!1)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=cl(this,Hb(t.animation),e);return{type:1,matchers:yX(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Cm(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>cl(this,i,e)),options:Cm(t.options)}}visitGroup(t,e){const i=e.currentTime;let r=0;const s=t.steps.map(u=>{e.currentTime=i;const m=cl(this,u,e);return r=Math.max(r,e.currentTime),m});return e.currentTime=r,{type:3,steps:s,options:Cm(t.options)}}visitAnimate(t,e){const i=function MX(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return KM(H1(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=KM(0,0,"");return s.dynamic=!0,s.strValue=e,s}const r=H1(e,t);return KM(r.duration,r.delay,r.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let r,s=t.styles?t.styles:Vn({});if(5==s.type)r=this.visitKeyframes(s,e);else{let u=t.styles,m=!1;if(!u){m=!0;const E={};i.easing&&(E.easing=i.easing),u=Vn(E)}e.currentTime+=i.duration+i.delay;const b=this.visitStyle(u,e);b.isEmptyStep=m,r=b}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let m of r)"string"==typeof m?m===Uu?i.push(m):e.errors.push(new ke(3002,!1)):i.push(eN(m));let s=!1,u=null;return i.forEach(m=>{if(m instanceof Map&&(m.has("easing")&&(u=m.get("easing"),m.delete("easing")),!s))for(let b of m.values())if(b.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:u,offset:t.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let r=e.currentTime,s=e.currentTime;i&&s>0&&(s-=i.duration+i.delay),t.styles.forEach(u=>{"string"!=typeof u&&u.forEach((m,b)=>{const E=e.collectedStyles.get(e.currentQuerySelector),T=E.get(b);let O=!0;T&&(s!=r&&s>=T.startTime&&r<=T.endTime&&(e.errors.push(function LY(n,t,e,i,r){return new ke(3010,!1)}()),O=!1),s=T.startTime),O&&E.set(b,{startTime:s,endTime:r}),e.options&&function fX(n,t,e){const i=t.params||{},r=nN(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||e.push(function TY(n){return new ke(3001,!1)}())})}(m,e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function NY(){return new ke(3011,!1)}()),i;let s=0;const u=[];let m=!1,b=!1,E=0;const T=t.steps.map(Pe=>{const we=this._makeStyleAst(Pe,e);let ht=null!=we.offset?we.offset:function SX(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(we.styles),Ct=0;return null!=ht&&(s++,Ct=we.offset=ht),b=b||Ct<0||Ct>1,m=m||Ct<E,E=Ct,u.push(Ct),we});b&&e.errors.push(function BY(){return new ke(3012,!1)}()),m&&e.errors.push(function zY(){return new ke(3200,!1)}());const O=t.steps.length;let H=0;s>0&&s<O?e.errors.push(function VY(){return new ke(3202,!1)}()):0==s&&(H=1/(O-1));const q=O-1,oe=e.currentTime,de=e.currentAnimateTimings,xe=de.duration;return T.forEach((Pe,we)=>{const ht=H>0?we==q?1:H*we:u[we],Ct=ht*xe;e.currentTime=oe+de.delay+Ct,de.duration=Ct,this._validateStyleAst(Pe,e),Pe.offset=ht,i.styles.push(Pe)}),i}visitReference(t,e){return{type:8,animation:cl(this,Hb(t.animation),e),options:Cm(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Cm(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Cm(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[s,u]=function CX(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(xX,"")),n=n.replace(/@\*/g,j1).replace(/@\w+/g,e=>j1+"-"+e.slice(1)).replace(/:animating/g,qM),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+s:s,ll(e.collectedStyles,e.currentQuerySelector,new Map);const m=cl(this,Hb(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:u,animation:m,originalSelector:t.selector,options:Cm(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function UY(){return new ke(3013,!1)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:H1(t.timings,e.errors,!0);return{type:12,animation:cl(this,Hb(t.animation),e),timings:i,options:null}}}class DX{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Cm(n){return n?(n=jb(n)).params&&(n.params=function EX(n){return n?jb(n):null}(n.params)):n={},n}function KM(n,t,e){return{duration:n,delay:t,easing:e}}function JM(n,t,e,i,r,s,u=null,m=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:u,subTimeline:m}}class Z1{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const IX=new RegExp(":enter","g"),RX=new RegExp(":leave","g");function QM(n,t,e,i,r,s=new Map,u=new Map,m,b,E=[]){return(new PX).buildKeyframes(n,t,e,i,r,s,u,m,b,E)}class PX{buildKeyframes(t,e,i,r,s,u,m,b,E,T=[]){E=E||new Z1;const O=new eT(t,e,E,r,s,T,[]);O.options=b;const H=b.delay?Xu(b.delay):0;O.currentTimeline.delayNextStep(H),O.currentTimeline.setStyles([u],null,O.errors,b),cl(this,i,O);const q=O.timelines.filter(oe=>oe.containsAnimation());if(q.length&&m.size){let oe;for(let de=q.length-1;de>=0;de--){const xe=q[de];if(xe.element===e){oe=xe;break}}oe&&!oe.allowOnlyTimelineStyles()&&oe.setStyles([m],null,O.errors,b)}return q.length?q.map(oe=>oe.buildKeyframes()):[JM(e,[],[],[],0,H,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(t.options),s=e.currentTimeline.currentTime,u=this._visitSubInstructions(i,r,r.options);s!=u&&e.transformIntoNewTimeline(u)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,i),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,i){for(const r of t){const s=r?.delay;if(s){const u="number"==typeof s?s:Xu($b(s,r?.params??{},e.errors));i.delayNextStep(u)}}}_visitSubInstructions(t,e,i){let s=e.currentTimeline.currentTime;const u=null!=i.duration?Xu(i.duration):null,m=null!=i.delay?Xu(i.delay):null;return 0!==u&&t.forEach(b=>{const E=e.appendInstructionToTimeline(b,u,m);s=Math.max(s,E.duration+E.delay)}),s}visitReference(t,e){e.updateOptions(t.options,!0),cl(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let r=e;const s=t.options;if(s&&(s.params||s.delay)&&(r=e.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Y1);const u=Xu(s.delay);r.delayNextStep(u)}t.steps.length&&(t.steps.forEach(u=>cl(this,u,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let r=e.currentTimeline.currentTime;const s=t.options&&t.options.delay?Xu(t.options.delay):0;t.steps.forEach(u=>{const m=e.createSubContext(t.options);s&&m.delayNextStep(s),cl(this,u,m),r=Math.max(r,m.currentTimeline.currentTime),i.push(m.currentTimeline)}),i.forEach(u=>e.currentTimeline.mergeTimelineCollectedStyles(u)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return H1(e.params?$b(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(i.duration),this.visitStyle(s,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(s):i.setStyles(t.styles,s,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,s=i.duration,m=e.createSubContext().currentTimeline;m.easing=i.easing,t.styles.forEach(b=>{m.forwardTime((b.offset||0)*s),m.setStyles(b.styles,b.easing,e.errors,e.options),m.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(m),e.transformIntoNewTimeline(r+s),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,r=t.options||{},s=r.delay?Xu(r.delay):0;s&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Y1);let u=i;const m=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=m.length;let b=null;m.forEach((E,T)=>{e.currentQueryIndex=T;const O=e.createSubContext(t.options,E);s&&O.delayNextStep(s),E===e.element&&(b=O.currentTimeline),cl(this,t.animation,O),O.currentTimeline.applyStylesToKeyframe(),u=Math.max(u,O.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(u),b&&(e.currentTimeline.mergeTimelineCollectedStyles(b),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,r=e.currentTimeline,s=t.timings,u=Math.abs(s.duration),m=u*(e.currentQueryTotal-1);let b=u*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":b=m-b;break;case"full":b=i.currentStaggerTime}const T=e.currentTimeline;b&&T.delayNextStep(b);const O=T.currentTime;cl(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=r.currentTime-O+(r.startTime-i.currentTimeline.startTime)}}const Y1={};class eT{constructor(t,e,i,r,s,u,m,b){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=u,this.timelines=m,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Y1,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=b||new X1(this._driver,e,0),m.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=Xu(i.duration)),null!=i.delay&&(r.delay=Xu(i.delay));const s=i.params;if(s){let u=r.params;u||(u=this.options.params={}),Object.keys(s).forEach(m=>{(!e||!u.hasOwnProperty(m))&&(u[m]=$b(s[m],u,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return t}createSubContext(t=null,e,i){const r=e||this.element,s=new eT(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=Y1,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const r={duration:e??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},s=new OX(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,r,s,u){let m=[];if(r&&m.push(this.element),t.length>0){t=(t=t.replace(IX,"."+this._enterClassName)).replace(RX,"."+this._leaveClassName);let E=this._driver.query(this.element,t,1!=i);0!==i&&(E=i<0?E.slice(E.length+i,E.length):E.slice(0,i)),m.push(...E)}return!s&&0==m.length&&u.push(function jY(n){return new ke(3014,!1)}()),m}}class X1{constructor(t,e,i,r){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new X1(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||Uu),this._currentKeyframe.set(e,Uu);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,r){e&&this._previousKeyframe.set("easing",e);const s=r&&r.params||{},u=function FX(n,t){const e=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||t.keys();for(let s of i)e.set(s,Uu)}else Tp(r,e)}),e}(t,this._globalTimelineStyles);for(let[m,b]of u){const E=$b(b,s,i);this._pendingStyles.set(m,E),this._localTimelineStyles.has(m)||this._backFill.set(m,this._globalTimelineStyles.get(m)??Uu),this._updateStyle(m,E)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((m,b)=>{const E=Tp(m,new Map,this._backFill);E.forEach((T,O)=>{T===DS?t.add(O):T===Uu&&e.add(O)}),i||E.set("offset",b/this.duration),r.push(E)});const s=t.size?$1(t.values()):[],u=e.size?$1(e.values()):[];if(i){const m=r[0],b=new Map(m);m.set("offset",0),b.set("offset",1),r=[m,b]}return JM(this.element,r,s,u,this.duration,this.startTime,this.easing,!1)}}class OX extends X1{constructor(t,e,i,r,s,u,m=!1){super(t,e,u.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=m,this.timings={duration:u.duration,delay:u.delay,easing:u.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],u=i+e,m=e/u,b=Tp(t[0]);b.set("offset",0),s.push(b);const E=Tp(t[0]);E.set("offset",aN(m)),s.push(E);const T=t.length-1;for(let O=1;O<=T;O++){let H=Tp(t[O]);const q=H.get("offset");H.set("offset",aN((e+q*i)/u)),s.push(H)}i=u,e=0,r="",t=s}return JM(this.element,t,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function aN(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class tT{}const LX=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class NX extends tT{normalizePropertyName(t,e){return YM(t)}normalizeStyleValue(t,e,i,r){let s="";const u=i.toString().trim();if(LX.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const m=i.match(/^[+-]?[\d\.]+([a-z]*)$/);m&&0==m[1].length&&r.push(function kY(n,t){return new ke(3005,!1)}())}return u+s}}function lN(n,t,e,i,r,s,u,m,b,E,T,O,H){return{type:0,element:n,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:s,toState:i,toStyles:u,timelines:m,queriedElements:b,preStyleProps:E,postStyleProps:T,totalTime:O,errors:H}}const nT={};class cN{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,r){return function BX(n,t,e,i,r){return n.some(s=>s(t,e,i,r))}(this.ast.matchers,t,e,i,r)}buildStyles(t,e,i){let r=this._stateStyles.get("*");return void 0!==t&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(e,i):new Map}build(t,e,i,r,s,u,m,b,E,T){const O=[],H=this.ast.options&&this.ast.options.params||nT,oe=this.buildStyles(i,m&&m.params||nT,O),de=b&&b.params||nT,xe=this.buildStyles(r,de,O),Pe=new Set,we=new Map,ht=new Map,Ct="void"===r,$t={params:zX(de,H),delay:this.ast.options?.delay},hr=T?[]:QM(t,e,this.ast.animation,s,u,oe,xe,$t,E,O);let bo=0;if(hr.forEach(Ku=>{bo=Math.max(Ku.duration+Ku.delay,bo)}),O.length)return lN(e,this._triggerName,i,r,Ct,oe,xe,[],[],we,ht,bo,O);hr.forEach(Ku=>{const Ju=Ku.element,TN=ll(we,Ju,new Set);Ku.preStyleProps.forEach(Em=>TN.add(Em));const Wb=ll(ht,Ju,new Set);Ku.postStyleProps.forEach(Em=>Wb.add(Em)),Ju!==e&&Pe.add(Ju)});const Oc=$1(Pe.values());return lN(e,this._triggerName,i,r,Ct,oe,xe,hr,Oc,we,ht,bo)}}function zX(n,t){const e=jb(t);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(e[i]=n[i]);return e}class VX{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i=new Map,r=jb(this.defaultParams);return Object.keys(t).forEach(s=>{const u=t[s];null!==u&&(r[s]=u)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((u,m)=>{u&&(u=$b(u,r,e));const b=this.normalizer.normalizePropertyName(m,e);u=this.normalizer.normalizeStyleValue(m,b,u,e),i.set(m,u)})}),i}}class jX{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new VX(r.style,r.options&&r.options.params||{},i))}),dN(this.states,"true","1"),dN(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new cN(t,r,this.states))}),this.fallbackTransition=function HX(n,t,e){return new cN(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(u,m)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,r){return this.transitionFactories.find(u=>u.match(t,e,i,r))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function dN(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const $X=new Z1;class GX{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const i=[],s=XM(this._driver,e,i,[]);if(i.length)throw function YY(n){return new ke(3503,!1)}();this._animations.set(t,s)}_buildPlayer(t,e,i){const r=t.element,s=qL(this._normalizer,t.keyframes,e,i);return this._driver.animate(r,s,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const r=[],s=this._animations.get(t);let u;const m=new Map;if(s?(u=QM(this._driver,e,s,GM,V1,new Map,new Map,i,$X,r),u.forEach(T=>{const O=ll(m,T.element,new Map);T.postStyleProps.forEach(H=>O.set(H,null))})):(r.push(function XY(){return new ke(3300,!1)}()),u=[]),r.length)throw function KY(n){return new ke(3504,!1)}();m.forEach((T,O)=>{T.forEach((H,q)=>{T.set(q,this._driver.computeStyle(O,q,Uu))})});const E=Mp(u.map(T=>{const O=m.get(T.element);return this._buildPlayer(T,new Map,O)}));return this._playersById.set(t,E),E.onDestroy(()=>this.destroy(t)),this.players.push(E),E}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function JY(n){return new ke(3301,!1)}();return e}listen(t,e,i,r){const s=jM(e,"","","");return VM(this._getPlayer(t),i,s,r),()=>{}}command(t,e,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,e,r[0]||{});const s=this._getPlayer(t);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const uN="ng-animate-queued",iT="ng-animate-disabled",XX=[],hN={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},KX={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Wl="__ng_removed";class rT{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function tK(n){return n??null}(i?t.value:t),i){const s=jb(t);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const Gb="void",oT=new rT(Gb);class JX{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Zl(e,this._hostClassName)}listen(t,e,i,r){if(!this._triggers.has(e))throw function QY(n,t){return new ke(3302,!1)}();if(null==i||0==i.length)throw function eX(n){return new ke(3303,!1)}();if(!function nK(n){return"start"==n||"done"==n}(i))throw function tX(n,t){return new ke(3400,!1)}();const s=ll(this._elementListeners,t,[]),u={name:e,phase:i,callback:r};s.push(u);const m=ll(this._engine.statesByElement,t,new Map);return m.has(e)||(Zl(t,U1),Zl(t,U1+"-"+e),m.set(e,oT)),()=>{this._engine.afterFlush(()=>{const b=s.indexOf(u);b>=0&&s.splice(b,1),this._triggers.has(e)||m.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function nX(n){return new ke(3401,!1)}();return e}trigger(t,e,i,r=!0){const s=this._getTrigger(e),u=new sT(this.id,e,t);let m=this._engine.statesByElement.get(t);m||(Zl(t,U1),Zl(t,U1+"-"+e),this._engine.statesByElement.set(t,m=new Map));let b=m.get(e);const E=new rT(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&b&&E.absorbOptions(b.options),m.set(e,E),b||(b=oT),E.value!==Gb&&b.value===E.value){if(!function oK(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const s=e[r];if(!t.hasOwnProperty(s)||n[s]!==t[s])return!1}return!0}(b.params,E.params)){const de=[],xe=s.matchStyles(b.value,b.params,de),Pe=s.matchStyles(E.value,E.params,de);de.length?this._engine.reportError(de):this._engine.afterFlush(()=>{wm(t,xe),Bd(t,Pe)})}return}const H=ll(this._engine.playersByElement,t,[]);H.forEach(de=>{de.namespaceId==this.id&&de.triggerName==e&&de.queued&&de.destroy()});let q=s.matchTransition(b.value,E.value,t,E.params),oe=!1;if(!q){if(!r)return;q=s.fallbackTransition,oe=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:q,fromState:b,toState:E,player:u,isFallbackTransition:oe}),oe||(Zl(t,uN),u.onStart(()=>{$_(t,uN)})),u.onDone(()=>{let de=this.players.indexOf(u);de>=0&&this.players.splice(de,1);const xe=this._engine.playersByElement.get(t);if(xe){let Pe=xe.indexOf(u);Pe>=0&&xe.splice(Pe,1)}}),this.players.push(u),H.push(u),u}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,j1,!0);i.forEach(r=>{if(r[Wl])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(u=>u.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,i,r){const s=this._engine.statesByElement.get(t),u=new Map;if(s){const m=[];if(s.forEach((b,E)=>{if(u.set(E,b.value),this._triggers.has(E)){const T=this.trigger(t,E,Gb,r);T&&m.push(T)}}),m.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,u),i&&Mp(m).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const r=new Set;e.forEach(s=>{const u=s.name;if(r.has(u))return;r.add(u);const b=this._triggers.get(u).fallbackTransition,E=i.get(u)||oT,T=new rT(Gb),O=new sT(this.id,u,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:u,transition:b,fromState:E,toState:T,player:O,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(t):[];if(s&&s.length)r=!0;else{let u=t;for(;u=u.parentNode;)if(i.statesByElement.get(u)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,e);else{const s=t[Wl];(!s||s===hN)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){Zl(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,u=this._elementListeners.get(s);u&&u.forEach(m=>{if(m.name==i.triggerName){const b=jM(s,i.triggerName,i.fromState.value,i.toState.value);b._data=t,VM(i.player,m.phase,b,m.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const s=i.transition.ast.depCount,u=r.transition.ast.depCount;return 0==s||0==u?s-u:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(i=>i.element===t)||e,e}}class QX{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new JX(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let u=!1,m=this.driver.getParentElement(e);for(;m;){const b=r.get(m);if(b){const E=i.indexOf(b);i.splice(E+1,0,t),u=!0;break}m=this.driver.getParentElement(m)}u||i.unshift(t)}else i.push(t);return r.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let r=this._namespaceLookup[t];r&&r.register(e,i)&&this.totalAnimations++}destroy(t,e){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&e.add(s)}return e}trigger(t,e,i,r){if(K1(e)){const s=this._fetchNamespace(t);if(s)return s.trigger(e,i,r),!0}return!1}insertNode(t,e,i,r){if(!K1(e))return;const s=e[Wl];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const u=this.collectedLeaveElements.indexOf(e);u>=0&&this.collectedLeaveElements.splice(u,1)}if(t){const u=this._fetchNamespace(t);u&&u.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Zl(t,iT)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),$_(t,iT))}removeNode(t,e,i,r){if(K1(e)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),i){const u=this.namespacesByHostElement.get(e);u&&u.id!==t&&u.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,i,r,s){this.collectedLeaveElements.push(e),e[Wl]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(t,e,i,r,s){return K1(e)?this._fetchNamespace(t).listen(e,i,r,s):()=>{}}_buildInstruction(t,e,i,r,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,e,s)}destroyInnerAnimations(t){let e=this.driver.query(t,j1,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,qM,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Mp(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Wl];if(e&&e.setForRemoval){if(t[Wl]=hN,e.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(iT)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Zl(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Mp(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function iX(n){return new ke(3402,!1)}()}_flushAnimations(t,e){const i=new Z1,r=[],s=new Map,u=[],m=new Map,b=new Map,E=new Map,T=new Set;this.disabledNodes.forEach(Wt=>{T.add(Wt);const un=this.driver.query(Wt,".ng-animate-queued",!0);for(let In=0;In<un.length;In++)T.add(un[In])});const O=this.bodyNode,H=Array.from(this.statesByElement.keys()),q=mN(H,this.collectedEnterElements),oe=new Map;let de=0;q.forEach((Wt,un)=>{const In=GM+de++;oe.set(un,In),Wt.forEach(Ai=>Zl(Ai,In))});const xe=[],Pe=new Set,we=new Set;for(let Wt=0;Wt<this.collectedLeaveElements.length;Wt++){const un=this.collectedLeaveElements[Wt],In=un[Wl];In&&In.setForRemoval&&(xe.push(un),Pe.add(un),In.hasAnimation?this.driver.query(un,".ng-star-inserted",!0).forEach(Ai=>Pe.add(Ai)):we.add(un))}const ht=new Map,Ct=mN(H,Array.from(Pe));Ct.forEach((Wt,un)=>{const In=V1+de++;ht.set(un,In),Wt.forEach(Ai=>Zl(Ai,In))}),t.push(()=>{q.forEach((Wt,un)=>{const In=oe.get(un);Wt.forEach(Ai=>$_(Ai,In))}),Ct.forEach((Wt,un)=>{const In=ht.get(un);Wt.forEach(Ai=>$_(Ai,In))}),xe.forEach(Wt=>{this.processLeaveNode(Wt)})});const $t=[],hr=[];for(let Wt=this._namespaceList.length-1;Wt>=0;Wt--)this._namespaceList[Wt].drainQueuedTransitions(e).forEach(In=>{const Ai=In.player,is=In.element;if($t.push(Ai),this.collectedEnterElements.length){const $s=is[Wl];if($s&&$s.setForMove){if($s.previousTriggersValues&&$s.previousTriggersValues.has(In.triggerName)){const Dm=$s.previousTriggersValues.get(In.triggerName),Yl=this.statesByElement.get(In.element);if(Yl&&Yl.has(In.triggerName)){const tC=Yl.get(In.triggerName);tC.value=Dm,Yl.set(In.triggerName,tC)}}return void Ai.destroy()}}const zd=!O||!this.driver.containsElement(O,is),dl=ht.get(is),Ip=oe.get(is),Tr=this._buildInstruction(In,i,Ip,dl,zd);if(Tr.errors&&Tr.errors.length)return void hr.push(Tr);if(zd)return Ai.onStart(()=>wm(is,Tr.fromStyles)),Ai.onDestroy(()=>Bd(is,Tr.toStyles)),void r.push(Ai);if(In.isFallbackTransition)return Ai.onStart(()=>wm(is,Tr.fromStyles)),Ai.onDestroy(()=>Bd(is,Tr.toStyles)),void r.push(Ai);const kN=[];Tr.timelines.forEach($s=>{$s.stretchStartingKeyframe=!0,this.disabledNodes.has($s.element)||kN.push($s)}),Tr.timelines=kN,i.append(is,Tr.timelines),u.push({instruction:Tr,player:Ai,element:is}),Tr.queriedElements.forEach($s=>ll(m,$s,[]).push(Ai)),Tr.preStyleProps.forEach(($s,Dm)=>{if($s.size){let Yl=b.get(Dm);Yl||b.set(Dm,Yl=new Set),$s.forEach((tC,hT)=>Yl.add(hT))}}),Tr.postStyleProps.forEach(($s,Dm)=>{let Yl=E.get(Dm);Yl||E.set(Dm,Yl=new Set),$s.forEach((tC,hT)=>Yl.add(hT))})});if(hr.length){const Wt=[];hr.forEach(un=>{Wt.push(function rX(n,t){return new ke(3505,!1)}())}),$t.forEach(un=>un.destroy()),this.reportError(Wt)}const bo=new Map,Oc=new Map;u.forEach(Wt=>{const un=Wt.element;i.has(un)&&(Oc.set(un,un),this._beforeAnimationBuild(Wt.player.namespaceId,Wt.instruction,bo))}),r.forEach(Wt=>{const un=Wt.element;this._getPreviousPlayers(un,!1,Wt.namespaceId,Wt.triggerName,null).forEach(Ai=>{ll(bo,un,[]).push(Ai),Ai.destroy()})});const Ku=xe.filter(Wt=>_N(Wt,b,E)),Ju=new Map;fN(Ju,this.driver,we,E,Uu).forEach(Wt=>{_N(Wt,b,E)&&Ku.push(Wt)});const Wb=new Map;q.forEach((Wt,un)=>{fN(Wb,this.driver,new Set(Wt),b,DS)}),Ku.forEach(Wt=>{const un=Ju.get(Wt),In=Wb.get(Wt);Ju.set(Wt,new Map([...un?.entries()??[],...In?.entries()??[]]))});const Em=[],AN=[],IN={};u.forEach(Wt=>{const{element:un,player:In,instruction:Ai}=Wt;if(i.has(un)){if(T.has(un))return In.onDestroy(()=>Bd(un,Ai.toStyles)),In.disabled=!0,In.overrideTotalTime(Ai.totalTime),void r.push(In);let is=IN;if(Oc.size>1){let dl=un;const Ip=[];for(;dl=dl.parentNode;){const Tr=Oc.get(dl);if(Tr){is=Tr;break}Ip.push(dl)}Ip.forEach(Tr=>Oc.set(Tr,is))}const zd=this._buildAnimation(In.namespaceId,Ai,bo,s,Wb,Ju);if(In.setRealPlayer(zd),is===IN)Em.push(In);else{const dl=this.playersByElement.get(is);dl&&dl.length&&(In.parentPlayer=Mp(dl)),r.push(In)}}else wm(un,Ai.fromStyles),In.onDestroy(()=>Bd(un,Ai.toStyles)),AN.push(In),T.has(un)&&r.push(In)}),AN.forEach(Wt=>{const un=s.get(Wt.element);if(un&&un.length){const In=Mp(un);Wt.setRealPlayer(In)}}),r.forEach(Wt=>{Wt.parentPlayer?Wt.syncPlayerEvents(Wt.parentPlayer):Wt.destroy()});for(let Wt=0;Wt<xe.length;Wt++){const un=xe[Wt],In=un[Wl];if($_(un,V1),In&&In.hasAnimation)continue;let Ai=[];if(m.size){let zd=m.get(un);zd&&zd.length&&Ai.push(...zd);let dl=this.driver.query(un,qM,!0);for(let Ip=0;Ip<dl.length;Ip++){let Tr=m.get(dl[Ip]);Tr&&Tr.length&&Ai.push(...Tr)}}const is=Ai.filter(zd=>!zd.destroyed);is.length?iK(this,un,is):this.processLeaveNode(un)}return xe.length=0,Em.forEach(Wt=>{this.players.push(Wt),Wt.onDone(()=>{Wt.destroy();const un=this.players.indexOf(Wt);this.players.splice(un,1)}),Wt.play()}),Em}elementContainsData(t,e){let i=!1;const r=e[Wl];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(t).elementContainsData(e)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,r,s){let u=[];if(e){const m=this.playersByQueriedElement.get(t);m&&(u=m)}else{const m=this.playersByElement.get(t);if(m){const b=!s||s==Gb;m.forEach(E=>{E.queued||!b&&E.triggerName!=r||u.push(E)})}}return(i||r)&&(u=u.filter(m=>!(i&&i!=m.namespaceId||r&&r!=m.triggerName))),u}_beforeAnimationBuild(t,e,i){const s=e.element,u=e.isRemovalTransition?void 0:t,m=e.isRemovalTransition?void 0:e.triggerName;for(const b of e.timelines){const E=b.element,T=E!==s,O=ll(i,E,[]);this._getPreviousPlayers(E,T,u,m,e.toState).forEach(q=>{const oe=q.getRealPlayer();oe.beforeDestroy&&oe.beforeDestroy(),q.destroy(),O.push(q)})}wm(s,e.fromStyles)}_buildAnimation(t,e,i,r,s,u){const m=e.triggerName,b=e.element,E=[],T=new Set,O=new Set,H=e.timelines.map(oe=>{const de=oe.element;T.add(de);const xe=de[Wl];if(xe&&xe.removedBeforeQueried)return new bb(oe.duration,oe.delay);const Pe=de!==b,we=function rK(n){const t=[];return gN(n,t),t}((i.get(de)||XX).map(bo=>bo.getRealPlayer())).filter(bo=>!!bo.element&&bo.element===de),ht=s.get(de),Ct=u.get(de),$t=qL(this._normalizer,oe.keyframes,ht,Ct),hr=this._buildPlayer(oe,$t,we);if(oe.subTimeline&&r&&O.add(de),Pe){const bo=new sT(t,m,de);bo.setRealPlayer(hr),E.push(bo)}return hr});E.forEach(oe=>{ll(this.playersByQueriedElement,oe.element,[]).push(oe),oe.onDone(()=>function eK(n,t,e){let i=n.get(t);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&n.delete(t)}return i}(this.playersByQueriedElement,oe.element,oe))}),T.forEach(oe=>Zl(oe,QL));const q=Mp(H);return q.onDestroy(()=>{T.forEach(oe=>$_(oe,QL)),Bd(b,e.toStyles)}),O.forEach(oe=>{ll(r,oe,[]).push(q)}),q}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new bb(t.duration,t.delay)}}class sT{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new bb,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>VM(t,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){ll(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function K1(n){return n&&1===n.nodeType}function pN(n,t){const e=n.style.display;return n.style.display=t??"none",e}function fN(n,t,e,i,r){const s=[];e.forEach(b=>s.push(pN(b)));const u=[];i.forEach((b,E)=>{const T=new Map;b.forEach(O=>{const H=t.computeStyle(E,O,r);T.set(O,H),(!H||0==H.length)&&(E[Wl]=KX,u.push(E))}),n.set(E,T)});let m=0;return e.forEach(b=>pN(b,s[m++])),u}function mN(n,t){const e=new Map;if(n.forEach(m=>e.set(m,[])),0==t.length)return e;const i=1,r=new Set(t),s=new Map;function u(m){if(!m)return i;let b=s.get(m);if(b)return b;const E=m.parentNode;return b=e.has(E)?E:r.has(E)?i:u(E),s.set(m,b),b}return t.forEach(m=>{const b=u(m);b!==i&&e.get(b).push(m)}),e}function Zl(n,t){n.classList?.add(t)}function $_(n,t){n.classList?.remove(t)}function iK(n,t,e){Mp(e).onDone(()=>n.processLeaveNode(t))}function gN(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof QO?gN(i.players,t):t.push(i)}}function _N(n,t,e){const i=e.get(n);if(!i)return!1;let r=t.get(n);return r?i.forEach(s=>r.add(s)):t.set(n,i),e.delete(n),!0}class J1{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new QX(t,e,i),this._timelineEngine=new GX(t,e,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(t,e,i,r,s){const u=t+"-"+r;let m=this._triggerCache[u];if(!m){const b=[],T=XM(this._driver,s,b,[]);if(b.length)throw function WY(n,t){return new ke(3404,!1)}();m=function UX(n,t,e){return new jX(n,t,e)}(r,T,this._normalizer),this._triggerCache[u]=m}this._transitionEngine.registerTrigger(e,r,m)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,r){this._transitionEngine.insertNode(t,e,i,r)}onRemove(t,e,i,r){this._transitionEngine.removeNode(t,e,r||!1,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,r){if("@"==i.charAt(0)){const[s,u]=WL(i);this._timelineEngine.command(s,e,u,r)}else this._transitionEngine.trigger(t,e,i,r)}listen(t,e,i,r,s){if("@"==i.charAt(0)){const[u,m]=WL(i);return this._timelineEngine.listen(u,e,m,s)}return this._transitionEngine.listen(t,e,i,r,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let aK=(()=>{class n{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(e);s||n.initialStylesByElement.set(e,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Bd(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Bd(this._element,this._initialStyles),this._endStyles&&(Bd(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(wm(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(wm(this._element,this._endStyles),this._endStyles=null),Bd(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function aT(n){let t=null;return n.forEach((e,i)=>{(function lK(n){return"display"===n||"position"===n})(i)&&(t=t||new Map,t.set(i,e))}),t}class yN{constructor(t,e,i,r){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(t,e,i){return t.animate(this._convertKeyframesToObject(e),i)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&t.set(r,this._finished?i:iN(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class cK{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return YL(t,e)}getParentElement(t){return HM(t)}query(t,e,i){return XL(t,e,i)}computeStyle(t,e,i){return window.getComputedStyle(t)[e]}animate(t,e,i,r,s,u=[]){const b={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(b.easing=s);const E=new Map,T=u.filter(q=>q instanceof yN);(function gX(n,t){return 0===n||0===t})(i,r)&&T.forEach(q=>{q.currentSnapshot.forEach((oe,de)=>E.set(de,oe))});let O=function pX(n){return n.length?n[0]instanceof Map?n:n.map(t=>eN(t)):[]}(e).map(q=>Tp(q));O=function _X(n,t,e){if(e.size&&t.length){let i=t[0],r=[];if(e.forEach((s,u)=>{i.has(u)||r.push(u),i.set(u,s)}),r.length)for(let s=1;s<t.length;s++){let u=t[s];r.forEach(m=>u.set(m,iN(n,m)))}}return t}(t,O,E);const H=function sK(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=aT(t[0]),t.length>1&&(i=aT(t[t.length-1]))):t instanceof Map&&(e=aT(t)),e||i?new aK(n,e,i):null}(t,O);return new yN(t,O,b,H)}}let dK=(()=>{class n extends ZO{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Do.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?YO(e):e;return vN(this._renderer,null,i,"register",[r]),new uK(i,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(Ne(Eu),Ne(Nn))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();class uK extends l6{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new hK(this._id,t,e||{},this._renderer)}}class hK{constructor(t,e,i,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return vN(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function vN(n,t,e,i,r){return n.setProperty(t,`@@${e}:${i}`,r)}const bN="@.disabled";let pK=(()=>{class n{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,u)=>{const m=u?.parentNode(s);m&&u.removeChild(m,s)}}createRenderer(e,i){const s=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let T=this._rendererCache.get(s);return T||(T=new xN("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,T)),T}const u=i.id,m=i.id+"-"+this._currentId;this._currentId++,this.engine.register(m,e);const b=T=>{Array.isArray(T)?T.forEach(b):this.engine.registerTrigger(u,m,e,T.name,T)};return i.data.animation.forEach(b),new fK(this,m,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[u,m]=s;u(m)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(Ne(Eu),Ne(J1),Ne(rn))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})();class xN{constructor(t,e,i,r){this.namespaceId=t,this.delegate=e,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>e.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,r=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,r){this.delegate.setAttribute(t,e,i,r)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,r){this.delegate.setStyle(t,e,i,r)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==bN?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class fK extends xN{constructor(t,e,i,r,s){super(e,i,r,s),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==bN?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.slice(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const r=function mK(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let s=e.slice(1),u="";return"@"!=s.charAt(0)&&([s,u]=function gK(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(s)),this.engine.listen(this.namespaceId,r,s,u,m=>{this.factory.scheduleListenerCallback(m._data||-1,i,m)})}return this.delegate.listen(t,e,i)}}const wN=[{provide:ZO,useClass:dK},{provide:tT,useFactory:function yK(){return new NX}},{provide:J1,useClass:(()=>{class n extends J1{constructor(e,i,r,s){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(Ne(Nn),Ne($M),Ne(tT),Ne(hp))},n.\u0275prov=at({token:n,factory:n.\u0275fac}),n})()},{provide:Eu,useFactory:function vK(n,t,e){return new pK(n,t,e)},deps:[AD,J1,rn]}],lT=[{provide:$M,useFactory:()=>new cK},{provide:ko,useValue:"BrowserAnimations"},...wN],CN=[{provide:$M,useClass:KL},{provide:ko,useValue:"NoopAnimations"},...wN];let bK=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?CN:lT}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:lT,imports:[DR]}),n})();const DK={provide:new Ke("mat-select-scroll-strategy"),deps:[Dp],useFactory:function EK(n){return()=>n.scrollStrategies.reposition()}};let SK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[DK],imports:[Tc,P1,m1,ur,S_,R1,m1,ur]}),n})();const IK={provide:new Ke("mat-tooltip-scroll-strategy"),deps:[Dp],useFactory:function AK(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}};let RK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[IK],imports:[O2,Tc,P1,ur,ur,S_]}),n})(),cT=(()=>{class n{constructor(){this.changes=new Xt,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(e,i,r)=>{if(0==r||0==i)return`0 of ${r}`;const s=e*i;return`${s+1} \u2013 ${s<(r=Math.max(r,0))?Math.min(s+i,r):s+i} of ${r}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const NK={provide:cT,deps:[[new Er,new br,cT]],useFactory:function LK(n){return n||new cT}};let BK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[NK],imports:[Tc,_M,SK,RK]}),n})(),dT=(()=>{class n{constructor(){this.changes=new Xt}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=at({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const VK={provide:dT,deps:[[new Er,new br,dT]],useFactory:function zK(n){return n||new dT}};let UK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[VK],imports:[Tc,ur]}),n})(),SN=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({}),n})(),eJ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({imports:[ur,f1,SN,ur,SN]}),n})(),tJ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[v1],imports:[YG]}),n})(),nJ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n}),n.\u0275inj=pn({providers:[{provide:XF,useValue:{appearance:"outline"}}],imports:[Tc,n6,tJ,h8,xG,_M,BK,UK,z9,R1,eJ,zW,X7,tG,DZ,jZ]}),n})();!function Qc(n,t,e){const i=n.\u0275cmp;i.directiveDefs=Ss(t,!1),i.pipeDefs=Ss(e,!0)}($L,[HL,UL],[]);const qb={production:!1,mapboxgl:{accessToken:"pk.eyJ1IjoicGl6ZWthdHRvIiwiYSI6ImNqZmtvZ2JwZTA5d3MzMnJxY3ZuMDNsZWIifQ.pv1NlRlPlLascI6fJ78T2g",geocoding_url:"https://api.mapbox.com/geocoding/v5/mapbox.places/"},supabase:{PUBLIC_URL:"https://hnlpyxjhepxaimdsbqnj.supabase.co",accessToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhubHB5eGpoZXB4YWltZHNicW5qIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODQ5NDQyMDksImV4cCI6MjAwMDUyMDIwOX0.-aLmWMoAzgQZQ6pD65vFNAfdYM8NGz4cVvBltL272yo",user:{email:"pizekatto@mail.ru",password:"x548serjio"}}},Pc=void 0,rJ=["ru",[["AM","PM"],Pc,Pc],Pc,[["\u0412","\u041f","\u0412","\u0421","\u0427","\u041f","\u0421"],["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"],["\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043e\u0442\u0430"],["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"]],Pc,[["\u042f","\u0424","\u041c","\u0410","\u041c","\u0418","\u0418","\u0410","\u0421","\u041e","\u041d","\u0414"],["\u044f\u043d\u0432.","\u0444\u0435\u0432\u0440.","\u043c\u0430\u0440.","\u0430\u043f\u0440.","\u043c\u0430\u044f","\u0438\u044e\u043d.","\u0438\u044e\u043b.","\u0430\u0432\u0433.","\u0441\u0435\u043d\u0442.","\u043e\u043a\u0442.","\u043d\u043e\u044f\u0431.","\u0434\u0435\u043a."],["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"]],[["\u042f","\u0424","\u041c","\u0410","\u041c","\u0418","\u0418","\u0410","\u0421","\u041e","\u041d","\u0414"],["\u044f\u043d\u0432.","\u0444\u0435\u0432\u0440.","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440.","\u043c\u0430\u0439","\u0438\u044e\u043d\u044c","\u0438\u044e\u043b\u044c","\u0430\u0432\u0433.","\u0441\u0435\u043d\u0442.","\u043e\u043a\u0442.","\u043d\u043e\u044f\u0431.","\u0434\u0435\u043a."],["\u044f\u043d\u0432\u0430\u0440\u044c","\u0444\u0435\u0432\u0440\u0430\u043b\u044c","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440\u0435\u043b\u044c","\u043c\u0430\u0439","\u0438\u044e\u043d\u044c","\u0438\u044e\u043b\u044c","\u0430\u0432\u0433\u0443\u0441\u0442","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u043e\u043a\u0442\u044f\u0431\u0440\u044c","\u043d\u043e\u044f\u0431\u0440\u044c","\u0434\u0435\u043a\u0430\u0431\u0440\u044c"]],[["\u0434\u043e \u043d.\u044d.","\u043d.\u044d."],["\u0434\u043e \u043d. \u044d.","\u043d. \u044d."],["\u0434\u043e \u0420\u043e\u0436\u0434\u0435\u0441\u0442\u0432\u0430 \u0425\u0440\u0438\u0441\u0442\u043e\u0432\u0430","\u043e\u0442 \u0420\u043e\u0436\u0434\u0435\u0441\u0442\u0432\u0430 \u0425\u0440\u0438\u0441\u0442\u043e\u0432\u0430"]],1,[6,0],["dd.MM.y","d MMM y '\u0433'.","d MMMM y '\u0433'.","EEEE, d MMMM y '\u0433'."],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1}, {0}",Pc,Pc,Pc],[",","\xa0",";","%","+","-","E","\xd7","\u2030","\u221e","\u043d\u0435\xa0\u0447\u0438\u0441\u043b\u043e",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"RUB","\u20bd","\u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0439 \u0440\u0443\u0431\u043b\u044c",{BYN:[Pc,"\u0440."],GEL:[Pc,"\u10da"],PHP:[Pc,"\u20b1"],RON:[Pc,"L"],RUB:["\u20bd"],RUR:["\u0440."],THB:["\u0e3f"],TMT:["\u0422\u041c\u0422"],TWD:["NT$"],UAH:["\u20b4"],XXX:["XXXX"]},"ltr",function iJ(n){const e=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 0===i&&e%10==1&&e%100!=11?1:0===i&&e%10===Math.floor(e%10)&&e%10>=2&&e%10<=4&&!(e%100>=12&&e%100<=14)?3:0===i&&e%10==0||0===i&&e%10===Math.floor(e%10)&&e%10>=5&&e%10<=9||0===i&&e%100===Math.floor(e%100)&&e%100>=11&&e%100<=14?4:5}],eC=new Ke("access tokens"),uT=new Ke("public urls"),MN=new Ke("users");!function J4(n,t,e){(function iz(n,t,e){"string"!=typeof t&&(e=t,t=n[Rt.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),i_[t]=n,e&&(i_[t][Rt.ExtraData]=e)})(n,t,e)}(rJ);let oJ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=En({type:n,bootstrap:[DY]}),n.\u0275inj=pn({providers:[{provide:eC,useValue:{supabase:qb.supabase.accessToken,mapbox:qb.mapboxgl.accessToken}},{provide:uT,useValue:{mapbox:qb.mapboxgl.geocoding_url,supabase:qb.supabase.PUBLIC_URL}},{provide:MN,useValue:{supabase:qb.supabase.user}},{provide:Ec,useValue:"ru"}],imports:[DR,bK,EY,nJ]}),n})();DU().bootstrapModule(oJ).catch(n=>console.error(n))},472:function(Gs,jr){var wr,zi=typeof self<"u"?self:this,mn=function(){function wr(){this.fetch=!1,this.DOMException=zi.DOMException}return wr.prototype=zi,new wr}();wr=mn,function(Ie){var Pi={searchParams:"URLSearchParams"in wr,iterable:"Symbol"in wr&&"iterator"in Symbol,blob:"FileReader"in wr&&"Blob"in wr&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in wr,arrayBuffer:"ArrayBuffer"in wr};if(Pi.arrayBuffer)var hn=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],ln=ArrayBuffer.isView||function(He){return He&&hn.indexOf(Object.prototype.toString.call(He))>-1};function Vi(He){if("string"!=typeof He&&(He=String(He)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(He))throw new TypeError("Invalid character in header field name");return He.toLowerCase()}function Ir(He){return"string"!=typeof He&&(He=String(He)),He}function ro(He){var mt={next:function(){var wt=He.shift();return{done:void 0===wt,value:wt}}};return Pi.iterable&&(mt[Symbol.iterator]=function(){return mt}),mt}function Ci(He){this.map={},He instanceof Ci?He.forEach(function(mt,wt){this.append(wt,mt)},this):Array.isArray(He)?He.forEach(function(mt){this.append(mt[0],mt[1])},this):He&&Object.getOwnPropertyNames(He).forEach(function(mt){this.append(mt,He[mt])},this)}function ka(He){if(He.bodyUsed)return Promise.reject(new TypeError("Already read"));He.bodyUsed=!0}function Ra(He){return new Promise(function(mt,wt){He.onload=function(){mt(He.result)},He.onerror=function(){wt(He.error)}})}function xo(He){var mt=new FileReader,wt=Ra(mt);return mt.readAsArrayBuffer(He),wt}function aa(He){if(He.slice)return He.slice(0);var mt=new Uint8Array(He.byteLength);return mt.set(new Uint8Array(He)),mt.buffer}function vs(){return this.bodyUsed=!1,this._initBody=function(He){this._bodyInit=He,He?"string"==typeof He?this._bodyText=He:Pi.blob&&Blob.prototype.isPrototypeOf(He)?this._bodyBlob=He:Pi.formData&&FormData.prototype.isPrototypeOf(He)?this._bodyFormData=He:Pi.searchParams&&URLSearchParams.prototype.isPrototypeOf(He)?this._bodyText=He.toString():Pi.arrayBuffer&&Pi.blob&&function Ar(He){return He&&DataView.prototype.isPrototypeOf(He)}(He)?(this._bodyArrayBuffer=aa(He.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Pi.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(He)||ln(He))?this._bodyArrayBuffer=aa(He):this._bodyText=He=Object.prototype.toString.call(He):this._bodyText="",this.headers.get("content-type")||("string"==typeof He?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Pi.searchParams&&URLSearchParams.prototype.isPrototypeOf(He)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Pi.blob&&(this.blob=function(){var He=ka(this);if(He)return He;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?ka(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(xo)}),this.text=function(){var He=ka(this);if(He)return He;if(this._bodyBlob)return function Bo(He){var mt=new FileReader,wt=Ra(mt);return mt.readAsText(He),wt}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function oo(He){for(var mt=new Uint8Array(He),wt=new Array(mt.length),Xi=0;Xi<mt.length;Xi++)wt[Xi]=String.fromCharCode(mt[Xi]);return wt.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Pi.formData&&(this.formData=function(){return this.text().then(Pa)}),this.json=function(){return this.text().then(JSON.parse)},this}Ci.prototype.append=function(He,mt){He=Vi(He),mt=Ir(mt);var wt=this.map[He];this.map[He]=wt?wt+", "+mt:mt},Ci.prototype.delete=function(He){delete this.map[Vi(He)]},Ci.prototype.get=function(He){return He=Vi(He),this.has(He)?this.map[He]:null},Ci.prototype.has=function(He){return this.map.hasOwnProperty(Vi(He))},Ci.prototype.set=function(He,mt){this.map[Vi(He)]=Ir(mt)},Ci.prototype.forEach=function(He,mt){for(var wt in this.map)this.map.hasOwnProperty(wt)&&He.call(mt,this.map[wt],wt,this)},Ci.prototype.keys=function(){var He=[];return this.forEach(function(mt,wt){He.push(wt)}),ro(He)},Ci.prototype.values=function(){var He=[];return this.forEach(function(mt){He.push(mt)}),ro(He)},Ci.prototype.entries=function(){var He=[];return this.forEach(function(mt,wt){He.push([wt,mt])}),ro(He)},Pi.iterable&&(Ci.prototype[Symbol.iterator]=Ci.prototype.entries);var rs=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function qs(He,mt){var wt=(mt=mt||{}).body;if(He instanceof qs){if(He.bodyUsed)throw new TypeError("Already read");this.url=He.url,this.credentials=He.credentials,mt.headers||(this.headers=new Ci(He.headers)),this.method=He.method,this.mode=He.mode,this.signal=He.signal,!wt&&null!=He._bodyInit&&(wt=He._bodyInit,He.bodyUsed=!0)}else this.url=String(He);if(this.credentials=mt.credentials||this.credentials||"same-origin",(mt.headers||!this.headers)&&(this.headers=new Ci(mt.headers)),this.method=function pt(He){var mt=He.toUpperCase();return rs.indexOf(mt)>-1?mt:He}(mt.method||this.method||"GET"),this.mode=mt.mode||this.mode||null,this.signal=mt.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&wt)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(wt)}function Pa(He){var mt=new FormData;return He.trim().split("&").forEach(function(wt){if(wt){var Xi=wt.split("="),Vt=Xi.shift().replace(/\+/g," "),gn=Xi.join("=").replace(/\+/g," ");mt.append(decodeURIComponent(Vt),decodeURIComponent(gn))}}),mt}function xn(He){var mt=new Ci;return He.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(Xi){var Vt=Xi.split(":"),gn=Vt.shift().trim();if(gn){var os=Vt.join(":").trim();mt.append(gn,os)}}),mt}function Ei(He,mt){mt||(mt={}),this.type="default",this.status=void 0===mt.status?200:mt.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in mt?mt.statusText:"OK",this.headers=new Ci(mt.headers),this.url=mt.url||"",this._initBody(He)}qs.prototype.clone=function(){return new qs(this,{body:this._bodyInit})},vs.call(qs.prototype),vs.call(Ei.prototype),Ei.prototype.clone=function(){return new Ei(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Ci(this.headers),url:this.url})},Ei.error=function(){var He=new Ei(null,{status:0,statusText:""});return He.type="error",He};var Xl=[301,302,303,307,308];Ei.redirect=function(He,mt){if(-1===Xl.indexOf(mt))throw new RangeError("Invalid status code");return new Ei(null,{status:mt,headers:{location:He}})},Ie.DOMException=wr.DOMException;try{new Ie.DOMException}catch{Ie.DOMException=function(mt,wt){this.message=mt,this.name=wt;var Xi=Error(mt);this.stack=Xi.stack},Ie.DOMException.prototype=Object.create(Error.prototype),Ie.DOMException.prototype.constructor=Ie.DOMException}function ul(He,mt){return new Promise(function(wt,Xi){var Vt=new qs(He,mt);if(Vt.signal&&Vt.signal.aborted)return Xi(new Ie.DOMException("Aborted","AbortError"));var gn=new XMLHttpRequest;function os(){gn.abort()}gn.onload=function(){var Oi={status:gn.status,statusText:gn.statusText,headers:xn(gn.getAllResponseHeaders()||"")};Oi.url="responseURL"in gn?gn.responseURL:Oi.headers.get("X-Request-URL"),wt(new Ei("response"in gn?gn.response:gn.responseText,Oi))},gn.onerror=function(){Xi(new TypeError("Network request failed"))},gn.ontimeout=function(){Xi(new TypeError("Network request failed"))},gn.onabort=function(){Xi(new Ie.DOMException("Aborted","AbortError"))},gn.open(Vt.method,Vt.url,!0),"include"===Vt.credentials?gn.withCredentials=!0:"omit"===Vt.credentials&&(gn.withCredentials=!1),"responseType"in gn&&Pi.blob&&(gn.responseType="blob"),Vt.headers.forEach(function(Oi,bs){gn.setRequestHeader(bs,Oi)}),Vt.signal&&(Vt.signal.addEventListener("abort",os),gn.onreadystatechange=function(){4===gn.readyState&&Vt.signal.removeEventListener("abort",os)}),gn.send(typeof Vt._bodyInit>"u"?null:Vt._bodyInit)})}ul.polyfill=!0,wr.fetch||(wr.fetch=ul,wr.Headers=Ci,wr.Request=qs,wr.Response=Ei),Ie.Headers=Ci,Ie.Request=qs,Ie.Response=Ei,Ie.fetch=ul,Object.defineProperty(Ie,"__esModule",{value:!0})}({}),mn.fetch.ponyfill=!0,delete mn.fetch.polyfill;var io=mn;(jr=io.fetch).default=io.fetch,jr.fetch=io.fetch,jr.Headers=io.Headers,jr.Request=io.Request,jr.Response=io.Response,Gs.exports=jr},878:Gs=>{var jr=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};Gs.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return jr()}try{return __global__||jr()}finally{delete Object.prototype.__global__}}()},898:function(Gs){Gs.exports=function(){"use strict";var jr,zi,mn;function io(f,Ie){if(jr)if(zi){var Pi="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+jr+")(sharedChunk); ("+zi+")(sharedChunk); self.onerror = null;",Ar={};jr(Ar),mn=Ie(Ar),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(mn.workerUrl=window.URL.createObjectURL(new Blob([Pi],{type:"text/javascript"})))}else zi=Ie;else jr=Ie}return io(0,function(f){var Ie=typeof self<"u"?self:{},Pi="2.15.0";let Ar;const hn={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Ar){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Ar=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):a}catch{Ar=a}}return Ar},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!hn.API_URL)return null;try{const a=new URL(hn.API_URL);return"api.mapbox.cn"===a.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===a.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ln={supported:!1,testSupport:function(a){!ro&&Ir&&(Ci?ka(a):Vi=a)}};let Vi,Ir,ro=!1,Ci=!1;function ka(a){const o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Ir),a.isContextLost())return;ln.supported=!0}catch{}a.deleteTexture(o),ro=!0}Ie.document&&(Ir=Ie.document.createElement("img"),Ir.onload=function(){Vi&&ka(Vi),Vi=null,Ci=!0},Ir.onerror=function(){ro=!0,Vi=null},Ir.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ra="01";function xo(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Bo=oo;function oo(a,o,l,d){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(d-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=o,this.p2x=l,this.p2y=d}oo.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,o){if(void 0===o&&(o=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,d=0;d<8;d++){var p=this.sampleCurveX(l)-a;if(Math.abs(p)<o)return l;var _=this.sampleCurveDerivativeX(l);if(Math.abs(_)<1e-6)break;l-=p/_}var v=0,w=1;for(l=a,d=0;d<20&&(p=this.sampleCurveX(l),!(Math.abs(p-a)<o));d++)a>p?v=l:w=l,l=.5*(w-v)+v;return l},solve:function(a,o){return this.sampleCurveY(this.solveCurveX(a,o))}};var aa=xo(Bo),vs=rs;function rs(a,o){this.x=a,this.y=o}rs.prototype={clone:function(){return new rs(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,o){return this.clone()._rotateAround(a,o)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var o=a.x-this.x,l=a.y-this.y;return o*o+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,o){return Math.atan2(this.x*o-this.y*a,this.x*a+this.y*o)},_matMult:function(a){var o=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=o,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var o=Math.cos(a),l=Math.sin(a),d=l*this.x+o*this.y;return this.x=o*this.x-l*this.y,this.y=d,this},_rotateAround:function(a,o){var l=Math.cos(a),d=Math.sin(a),p=o.y+d*(this.x-o.x)+l*(this.y-o.y);return this.x=o.x+l*(this.x-o.x)-d*(this.y-o.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},rs.convert=function(a){return a instanceof rs?a:Array.isArray(a)?new rs(a[0],a[1]):a};var pt=xo(vs);const qs=Math.PI/180,Pa=180/Math.PI;function xn(a){return a*qs}function Ei(a){return a*Pa}const Xl=[[0,0],[1,0],[1,1],[0,1]];function ul(a){if(a<=0)return 0;if(a>=1)return 1;const o=a*a,l=o*a;return 4*(a<.5?l:3*(a-o)+l-.75)}function He(a,o,l,d){const p=new aa(a,o,l,d);return function(_){return p.solve(_)}}const mt=He(.25,.1,.25,1);function wt(a,o,l){return Math.min(l,Math.max(o,a))}function Xi(a,o,l){return(l=wt((l-a)/(o-a),0,1))*l*(3-2*l)}function Vt(a,o,l){const d=l-o,p=((a-o)%d+d)%d+o;return p===o?l:p}function gn(a,o,l){if(!a.length)return l(null,[]);let d=a.length;const p=new Array(a.length);let _=null;a.forEach((v,w)=>{o(v,(D,S)=>{D&&(_=D),p[w]=S,0==--d&&l(_,p)})})}function os(a){const o=[];for(const l in a)o.push(a[l]);return o}function Oi(a,...o){for(const l of o)for(const d in l)a[d]=l[d];return a}let bs=1;function Xt(){return bs++}function Oa(){return function a(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function la(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Ui(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function fi(a,o){a.forEach(l=>{o[l]&&(o[l]=o[l].bind(o))})}function Fc(a,o){return-1!==a.indexOf(o,a.length-o.length)}function xt(a,o,l){const d={};for(const p in a)d[p]=o.call(l||this,a[p],p,a);return d}function hl(a,o,l){const d={};for(const p in a)o.call(l||this,a[p],p,a)&&(d[p]=a[p]);return d}function ss(a){return Array.isArray(a)?a.map(ss):"object"==typeof a&&a?xt(a,ss):a}const Kl={};function ji(a){Kl[a]||(typeof console<"u"&&console.warn(a),Kl[a]=!0)}function xs(a,o,l){return(l.y-a.y)*(o.x-a.x)>(o.y-a.y)*(l.x-a.x)}function Qu(a){let o=0;for(let l,d,p=0,_=a.length,v=_-1;p<_;v=p++)l=a[p],d=a[v],o+=(d.x-l.x)*(l.y+d.y);return o}function pl(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ws(a){const o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,d,p,_)=>{const v=p||_;return o[d]=!v||v.toLowerCase(),""}),o["max-age"]){const l=parseInt(o["max-age"],10);isNaN(l)?delete o["max-age"]:o["max-age"]=l}return o}let eh=null;function Vd(a){if(null==eh){const o=a.navigator?a.navigator.userAgent:null;eh=!!a.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return eh}function Ud(a){try{const o=Ie[a];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}}function Fa(a,o){return[a[4*o],a[4*o+1],a[4*o+2],a[4*o+3]]}const Lc="mapbox-tiles";let zo,La,Nc=500,th=50;function jd(){try{return Ie.caches}catch{}}function Jl(){jd()&&!zo&&(zo=Ie.caches.open(Lc))}function Bc(a){const o=a.indexOf("?");if(o<0)return a;const d=function(p){const _=p.indexOf("?");return _>0?p.slice(_+1).split("&"):[]}(a).filter(p=>{const _=p.split("=");return"language"===_[0]||"worldview"===_[0]});return d.length?`${a.slice(0,o)}?${d.join("&")}`:a.slice(0,o)}let Cs=1/0;const fl={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(fl);class ml extends Error{constructor(o,l,d){401===l&&Ee(d)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=l,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const gl=pl()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Ie.location.protocol?Ie.parent:Ie).location.href,Ql=function(a,o){if(!(/^file:/.test(l=a.url)||/^file:/.test(gl())&&!/^\w+:/.test(l))){if(Ie.fetch&&Ie.Request&&Ie.AbortController&&Ie.Request.prototype.hasOwnProperty("signal"))return function(d,p){const _=new Ie.AbortController,v=new Ie.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:gl(),referrerPolicy:d.referrerPolicy,signal:_.signal});let w=!1,D=!1;const S=(k=v.url).indexOf("sku=")>0&&Ee(k);var k;"json"===d.type&&v.headers.set("Accept","application/json");const P=(B,z,j)=>{if(D)return;if(B&&"SecurityError"!==B.message&&ji(B.toString()),z&&j)return F(z);const Y=Date.now();Ie.fetch(v).then(te=>{if(te.ok){const ce=S?te.clone():null;return F(te,ce,Y)}return p(new ml(te.statusText,te.status,d.url))}).catch(te=>{"AbortError"!==te.name&&p(new Error(`${te.message} ${d.url}`))})},F=(B,z,j)=>{("arrayBuffer"===d.type?B.arrayBuffer():"json"===d.type?B.json():B.text()).then(Y=>{D||(z&&j&&function(te,ce,ne){if(Jl(),!zo)return;const ae={status:ce.status,statusText:ce.statusText,headers:new Ie.Headers};ce.headers.forEach((Te,Se)=>ae.headers.set(Se,Te));const pe=ws(ce.headers.get("Cache-Control")||"");if(pe["no-store"])return;pe["max-age"]&&ae.headers.set("Expires",new Date(ne+1e3*pe["max-age"]).toUTCString());const he=ae.headers.get("Expires");he&&(new Date(he).getTime()-ne<42e4||function(Te,Se){if(void 0===La)try{new Response(new ReadableStream),La=!0}catch{La=!1}La?Se(Te.body):Te.blob().then(Se)}(ce,Te=>{const Se=new Ie.Response(Te,ae);Jl(),zo&&zo.then(Ue=>Ue.put(Bc(te.url),Se)).catch(Ue=>ji(Ue.message))}))}(v,z,j),w=!0,p(null,Y,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch(Y=>{D||p(new Error(Y.message))})};return S?function(B,z){if(Jl(),!zo)return z(null);const j=Bc(B.url);zo.then(Y=>{Y.match(j).then(te=>{const ce=function(ne){if(!ne)return!1;const ae=new Date(ne.headers.get("Expires")||0),pe=ws(ne.headers.get("Cache-Control")||"");return ae>Date.now()&&!pe["no-cache"]}(te);Y.delete(j),ce&&Y.put(j,te.clone()),z(null,te,ce)}).catch(z)}).catch(z)}(v,P):P(null,null),{cancel:()=>{D=!0,w||_.abort()}}}(a,o);if(pl()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,o,void 0,!0)}var l;return function(d,p){const _=new Ie.XMLHttpRequest;_.open(d.method||"GET",d.url,!0),"arrayBuffer"===d.type&&(_.responseType="arraybuffer");for(const v in d.headers)_.setRequestHeader(v,d.headers[v]);return"json"===d.type&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials="include"===d.credentials,_.onerror=()=>{p(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||0===_.status)&&null!==_.response){let v=_.response;if("json"===d.type)try{v=JSON.parse(_.response)}catch(w){return p(w)}p(null,v,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else p(new ml(_.statusText,_.status,d.url))},_.send(d.body),{cancel:()=>_.abort()}}(a,o)},zc=function(a,o){return Ql(Oi(a,{type:"arrayBuffer"}),o)};function nh(a){const o=Ie.document.createElement("a");return o.href=a,o.protocol===Ie.document.location.protocol&&o.host===Ie.document.location.host}const le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let $,G;$=[],G=0;const se=function(a,o){if(ln.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),G>=hn.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:a,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return $.push(_),_}G++;let l=!1;const d=()=>{if(!l)for(l=!0,G--;$.length&&G<hn.MAX_PARALLEL_IMAGE_REQUESTS;){const _=$.shift(),{requestParameters:v,callback:w,cancelled:D}=_;D||(_.cancel=se(v,w).cancel)}},p=zc(a,(_,v,w,D)=>{d(),_?o(_):v&&(Ie.createImageBitmap?function(S,k){const P=new Ie.Blob([new Uint8Array(S)],{type:"image/png"});Ie.createImageBitmap(P).then(F=>{k(null,F)}).catch(F=>{k(new Error(`Could not load image because of ${F.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(S,k)=>o(S,k,w,D)):function(S,k){const P=new Ie.Image,F=Ie.URL;P.onload=()=>{k(null,P),F.revokeObjectURL(P.src),P.onload=null,Ie.requestAnimationFrame(()=>{P.src=le})},P.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const B=new Ie.Blob([new Uint8Array(S)],{type:"image/png"});P.src=S.byteLength?F.createObjectURL(B):le}(v,(S,k)=>o(S,k,w,D)))});return{cancel:()=>{p.cancel(),d()}}},fe="NO_ACCESS_TOKEN";function _e(a){return 0===a.indexOf("mapbox:")}function Ee(a){return hn.API_URL_REGEX.test(a)}function Ce(a){return hn.API_CDN_URL_REGEX.test(a)}function ye(a){return hn.API_STYLE_REGEX.test(a)&&!Oe(a)}function Oe(a){return hn.API_SPRITE_REGEX.test(a)}const ct=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ut(a){const o=a.match(ct);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function it(a){const o=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${o}`}const cn="mapbox.eventData";function wn(a){if(!a)return null;const o=a.split(".");if(!o||3!==o.length)return null;try{return JSON.parse(decodeURIComponent(Ie.atob(o[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Lt{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const l=wn(hn.ACCESS_TOKEN);let d="";return d=l&&l.u?Ie.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(p,_)=>String.fromCharCode(+("0x"+_)))):hn.ACCESS_TOKEN||"",o?`${cn}.${o}:${d}`:`${cn}:${d}`}fetchEventData(){const o=Ud("localStorage"),l=this.getStorageKey(),d=this.getStorageKey("uuid");if(o)try{const p=Ie.localStorage.getItem(l);p&&(this.eventData=JSON.parse(p));const _=Ie.localStorage.getItem(d);_&&(this.anonId=_)}catch{ji("Unable to read from LocalStorage")}}saveEventData(){const o=Ud("localStorage"),l=this.getStorageKey(),d=this.getStorageKey("uuid");if(o)try{Ie.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&Ie.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{ji("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,l,d,p){if(!hn.EVENTS_URL)return;const _=ut(hn.EVENTS_URL);_.params.push(`access_token=${p||hn.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(o).toISOString()},w=l?Oi(v,l):v,D={url:it(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};var k;this.pendingRequest=(k=S=>{this.pendingRequest=null,d(S),this.saveEventData(),this.processRequests(p)},Ql(Oi(D,{method:"POST"}),k))}queueRequest(o,l){this.queue.push(o),this.processRequests(l)}}const kn=new class extends Lt{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,o){hn.EVENTS_URL&&hn.ACCESS_TOKEN&&Array.isArray(a)&&a.some(l=>_e(l)||Ee(l))&&this.queueRequest(Date.now(),o)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=wn(hn.ACCESS_TOKEN),l=o?o.u:hn.ACCESS_TOKEN;let d=l!==this.eventData.tokenU;Ui(this.anonId)||(this.anonId=Oa(),d=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),v=new Date(p),w=(p-this.eventData.lastSuccess)/864e5;d=d||w>=1||w<-1||_.getDate()!==v.getDate()}else d=!0;d?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Pi,skuId:Ra,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=p,this.eventData.tokenU=l)},a):this.processRequests()}},zn=kn.postTurnstileEvent.bind(kn),Hi=new class extends Lt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,o,l,d){this.skuToken=o,this.errorCb=d,hn.EVENTS_URL&&(l||hn.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(fe)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),Ui(this.anonId)||(this.anonId=Oa()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Pi,skuId:Ra,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):o&&(this.success[o]=!0)},a))}},pr=Hi.postMapLoadEvent.bind(Hi),Hr=new class extends Lt{constructor(){super("gljs.performance")}postPerformanceEvent(a,o){hn.EVENTS_URL&&(a||hn.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},a)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:o,performanceData:l}=this.queue.shift(),d=function(p){const _=Ie.performance.getEntriesByType("resource"),v=Ie.performance.getEntriesByType("mark"),w=function(F){const B={};if(F)for(const z in F)if("other"!==z)for(const j of F[z]){const Y=`${z}ResolveRangeMin`,te=`${z}ResolveRangeMax`,ce=`${z}RequestCount`,ne=`${z}RequestCachedCount`;B[Y]=Math.min(B[Y]||1/0,j.startTime),B[te]=Math.max(B[te]||-1/0,j.responseEnd);const ae=pe=>{void 0===B[pe]&&(B[pe]=0),++B[pe]};void 0!==j.transferSize&&0===j.transferSize&&ae(ne),ae(ce)}return B}(function(F,B){const z={};if(F)for(const j of F){const Y=B(j);void 0===z[Y]&&(z[Y]=[]),z[Y].push(j)}return z}(_,Es)),D=Ie.devicePixelRatio,S=Ie.navigator.connection||Ie.navigator.mozConnection||Ie.navigator.webkitConnection,k={counters:[],metadata:[],attributes:[]},P=(F,B,z)=>{null!=z&&F.push({name:B,value:z.toString()})};for(const F in w)P(k.counters,F,w[F]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(P(k.counters,"interactionRangeMin",p.interactionRange[0]),P(k.counters,"interactionRangeMax",p.interactionRange[1])),v)for(const F of Object.keys(Ki)){const B=Ki[F],z=v.find(j=>j.name===B);z&&P(k.counters,B,z.startTime)}return P(k.counters,"visibilityHidden",p.visibilityHidden),P(k.attributes,"style",function(F){if(F)for(const B of F){const z=B.name.split("?")[0];if(ye(z)){const j=z.split("/").slice(-2);if(2===j.length)return`mapbox://styles/${j[0]}/${j[1]}`}}}(_)),P(k.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),P(k.attributes,"fogEnabled",p.fogEnabled?"true":"false"),P(k.attributes,"projection",p.projection),P(k.attributes,"zoom",p.zoom),P(k.metadata,"devicePixelRatio",D),P(k.metadata,"connectionEffectiveType",S?S.effectiveType:void 0),P(k.metadata,"navigatorUserAgent",Ie.navigator.userAgent),P(k.metadata,"screenWidth",Ie.screen.width),P(k.metadata,"screenHeight",Ie.screen.height),P(k.metadata,"windowWidth",Ie.innerWidth),P(k.metadata,"windowHeight",Ie.innerHeight),P(k.metadata,"mapWidth",p.width/D),P(k.metadata,"mapHeight",p.height/D),P(k.metadata,"webglRenderer",p.renderer),P(k.metadata,"webglVendor",p.vendor),P(k.metadata,"sdkVersion",Pi),P(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(l);for(const p of d.metadata);for(const p of d.counters);for(const p of d.attributes);this.postEvent(o,d,()=>{},a)}},vr=Hr.postPerformanceEvent.bind(Hr),ca=new class extends Lt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,o,l,d){if(!hn.API_URL||!hn.SESSION_PATH)return;const p=ut(hn.API_URL+hn.SESSION_PATH);p.params.push(`sku=${o||""}`),p.params.push(`access_token=${d||hn.ACCESS_TOKEN||""}`);const _={url:it(p),headers:{"Content-Type":"text/plain"}};var w;this.pendingRequest=(w=v=>{this.pendingRequest=null,l(v),this.saveEventData(),this.processRequests(d)},Ql(Oi(_,{method:"GET"}),w))}getSessionAPI(a,o,l,d){this.skuToken=o,this.errorCb=d,hn.SESSION_PATH&&hn.API_URL&&(l||hn.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(fe)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||this.getSession(l,this.skuToken,d=>{d?this.errorCb(d):o&&(this.success[o]=!0)},a)}},Ni=ca.getSessionAPI.bind(ca),wo=new Set,Ki={create:"create",load:"load",fullLoad:"fullLoad"},Vc={mark(a){Ie.performance.mark(a)},measure(a,o,l){Ie.performance.measure(a,o,l)}};function Es(a){const o=a.name.split("?")[0];return Ce(o)&&o.includes("mapbox-gl.js")?"javascript":Ce(o)&&o.includes("mapbox-gl.css")?"css":hn.API_FONTS_REGEX.test(o)?"fontRange":Oe(o)?"sprite":ye(o)?"style":hn.API_TILEJSON_REGEX.test(o)?"tilejson":"other"}const ii=Ie.performance;function kp(a){const o=a?a.url.toString():void 0;return ii.getEntriesByName(o)}let Uc,Hd,$d,Vo;const Na={now:()=>void 0!==$d?$d:Ie.performance.now(),setNow(a){$d=a},restoreNow(){$d=void 0},frame(a){const o=Ie.requestAnimationFrame(a);return{cancel:()=>Ie.cancelAnimationFrame(o)}},getImageData(a,o=0){const{width:l,height:d}=a;Vo||(Vo=Ie.document.createElement("canvas"));const p=Vo.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>Vo.width||d>Vo.height)&&(Vo.width=l,Vo.height=d),p.clearRect(-o,-o,l+2*o,d+2*o),p.drawImage(a,0,0,l,d),p.getImageData(-o,-o,l+2*o,d+2*o)},resolveURL:a=>(Uc||(Uc=Ie.document.createElement("a")),Uc.href=a,Uc.href),get devicePixelRatio(){return Ie.devicePixelRatio},get prefersReducedMotion(){return!!Ie.matchMedia&&(null==Hd&&(Hd=Ie.matchMedia("(prefers-reduced-motion: reduce)")),Hd.matches)}};function ih(a,o,l){l[a]&&-1!==l[a].indexOf(o)||(l[a]=l[a]||[],l[a].push(o))}function rh(a,o,l){if(l&&l[a]){const d=l[a].indexOf(o);-1!==d&&l[a].splice(d,1)}}class ec{constructor(o,l={}){Oi(this,l),this.type=o}}class Ba extends ec{constructor(o,l={}){super("error",Oi({error:o},l))}}class Gd{on(o,l){return this._listeners=this._listeners||{},ih(o,l,this._listeners),this}off(o,l){return rh(o,l,this._listeners),rh(o,l,this._oneTimeListeners),this}once(o,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},ih(o,l,this._oneTimeListeners),this):new Promise(d=>this.once(o,d))}fire(o,l){"string"==typeof o&&(o=new ec(o,l||{}));const d=o.type;if(this.listens(d)){o.target=this;const p=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const w of p)w.call(this,o);const _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const w of _)rh(d,w,this._oneTimeListeners),w.call(this,o);const v=this._eventedParent;v&&(Oi(o,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),v.fire(o))}else o instanceof Ba&&console.error(o.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,l){return this._eventedParent=o,this._eventedParentData=l,this}}var ze=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function da(a,...o){for(const l of o)for(const d in l)a[d]=l[d];return a}function fr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function kr(a){if(Array.isArray(a))return a.map(kr);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const o={};for(const l in a)o[l]=kr(a[l]);return o}return fr(a)}class mr extends Error{constructor(o,l){super(l),this.message=l,this.key=o}}var $i=mr;class oh{constructor(o,l=[]){this.parent=o,this.bindings={};for(const[d,p]of l)this.bindings[d]=p}concat(o){return new oh(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}var sh=oh;const Jn={kind:"null"},yt={kind:"number"},Gt={kind:"string"},Cn={kind:"boolean"},as={kind:"color"},Pn={kind:"object"},vt={kind:"value"},Co={kind:"collator"},tc={kind:"formatted"},jc={kind:"resolvedImage"};function ls(a,o){return{kind:"array",itemType:a,N:o}}function ke(a){if("array"===a.kind){const o=ke(a.itemType);return"number"==typeof a.N?`array<${o}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${o}>`}return a.kind}const qd=[Jn,yt,Gt,Cn,as,tc,Pn,ls(vt),jc];function Qt(a,o){if("error"===o.kind)return null;if("array"===a.kind){if("array"===o.kind&&(0===o.N&&"value"===o.itemType.kind||!Qt(a.itemType,o.itemType))&&("number"!=typeof a.N||a.N===o.N))return null}else{if(a.kind===o.kind)return null;if("value"===a.kind)for(const l of qd)if(!Qt(l,o))return null}return`Expected ${ke(a)} but found ${ke(o)} instead.`}function Qn(a,o){return o.some(l=>l.kind===a.kind)}function Wd(a,o){return o.some(l=>"null"===l?null===a:"array"===l?Array.isArray(a):"object"===l?a&&!Array.isArray(a)&&"object"==typeof a:l===typeof a)}var Sm,Mm={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function _l(a){return(a=Math.round(a))<0?0:a>255?255:a}function $r(a){return _l("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function Rp(a){return(o="%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))<0?0:o>1?1:o;var o}function Hc(a,o,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?a+(o-a)*l*6:2*l<1?o:3*l<2?a+(o-a)*(2/3-l)*6:a}try{Sm={}.parseCSSColor=function(a){var o,l=a.replace(/ /g,"").toLowerCase();if(l in Mm)return Mm[l].slice();if("#"===l[0])return 4===l.length?(o=parseInt(l.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:7===l.length&&(o=parseInt(l.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var d=l.indexOf("("),p=l.indexOf(")");if(-1!==d&&p+1===l.length){var _=l.substr(0,d),v=l.substr(d+1,p-(d+1)).split(","),w=1;switch(_){case"rgba":if(4!==v.length)return null;w=Rp(v.pop());case"rgb":return 3!==v.length?null:[$r(v[0]),$r(v[1]),$r(v[2]),w];case"hsla":if(4!==v.length)return null;w=Rp(v.pop());case"hsl":if(3!==v.length)return null;var D=(parseFloat(v[0])%360+360)%360/360,S=Rp(v[1]),k=Rp(v[2]),P=k<=.5?k*(S+1):k+S-k*S,F=2*k-P;return[_l(255*Hc(F,P,D+1/3)),_l(255*Hc(F,P,D)),_l(255*Hc(F,P,D-1/3)),w];default:return null}}return null}}catch{}class cs{constructor(o,l,d,p=1){this.r=o,this.g=l,this.b=d,this.a=p}static parse(o){if(!o)return;if(o instanceof cs)return o;if("string"!=typeof o)return;const l=Sm(o);return l?new cs(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[o,l,d,p]=this.toArray();return`rgba(${Math.round(o)},${Math.round(l)},${Math.round(d)},${p})`}toArray(){const{r:o,g:l,b:d,a:p}=this;return 0===p?[0,0,0,0]:[255*o/p,255*l/p,255*d/p,p]}toArray01(){const{r:o,g:l,b:d,a:p}=this;return 0===p?[0,0,0,0]:[o/p,l/p,d/p,p]}toArray01PremultipliedAlpha(){const{r:o,g:l,b:d,a:p}=this;return[o,l,d,p]}}cs.black=new cs(0,0,0,1),cs.white=new cs(1,1,1,1),cs.transparent=new cs(0,0,0,0),cs.red=new cs(1,0,0,1),cs.blue=new cs(0,0,1,1);var Di=cs;class Tm{constructor(o,l,d){this.sensitivity=o?l?"variant":"case":l?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,l){return this.collator.compare(o,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Am{constructor(o,l,d,p,_){this.text=o.normalize?o.normalize():o,this.image=l,this.scale=d,this.fontStack=p,this.textColor=_}}class ds{constructor(o){this.sections=o}static fromString(o){return new ds([new Am(o,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(o=>0!==o.text.length||o.image&&0!==o.image.name.length)}static factory(o){return o instanceof ds?o:ds.fromString(o)}toString(){return 0===this.sections.length?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const l of this.sections){if(l.image){o.push(["image",l.image.name]);continue}o.push(l.text);const d={};l.fontStack&&(d["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(d["font-scale"]=l.scale),l.textColor&&(d["text-color"]=["rgba"].concat(l.textColor.toArray())),o.push(d)}return o}}class Ws{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Ws({name:o,available:!1}):null}serialize(){return["image",this.name]}}function Im(a,o,l,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof o&&o>=0&&o<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:`Invalid rgba value [${[a,o,l,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof d?[a,o,l,d]:[a,o,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ah(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof Di||a instanceof Tm||a instanceof ds||a instanceof Ws)return!0;if(Array.isArray(a)){for(const o of a)if(!ah(o))return!1;return!0}if("object"==typeof a){for(const o in a)if(!ah(a[o]))return!1;return!0}return!1}function Qi(a){if(null===a)return Jn;if("string"==typeof a)return Gt;if("boolean"==typeof a)return Cn;if("number"==typeof a)return yt;if(a instanceof Di)return as;if(a instanceof Tm)return Co;if(a instanceof ds)return tc;if(a instanceof Ws)return jc;if(Array.isArray(a)){const o=a.length;let l;for(const d of a){const p=Qi(d);if(l){if(l===p)continue;l=vt;break}l=p}return ls(l||vt,o)}return Pn}function lh(a){const o=typeof a;return null===a?"":"string"===o||"number"===o||"boolean"===o?String(a):a instanceof Di||a instanceof ds||a instanceof Ws?a.toString():JSON.stringify(a)}class Uo{constructor(o,l){this.type=o,this.value=l}static parse(o,l){if(2!==o.length)return l.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!ah(o[1]))return l.error("invalid value");const d=o[1];let p=Qi(d);const _=l.expectedType;return"array"!==p.kind||0!==p.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(p=_),new Uo(p,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Di?["rgba"].concat(this.value.toArray()):this.value instanceof ds?this.value.serialize():this.value}}var Zn=Uo,so=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const km={string:Gt,number:yt,boolean:Cn,object:Pn};class Rm{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let d,p=1;const _=o[0];if("array"===_){let w,D;if(o.length>2){const S=o[1];if("string"!=typeof S||!(S in km)||"object"===S)return l.error('The item type argument of "array" must be one of string, number, boolean',1);w=km[S],p++}else w=vt;if(o.length>3){if(null!==o[2]&&("number"!=typeof o[2]||o[2]<0||o[2]!==Math.floor(o[2])))return l.error('The length argument to "array" must be a positive integer literal',2);D=o[2],p++}d=ls(w,D)}else d=km[_];const v=[];for(;p<o.length;p++){const w=l.parse(o[p],p,vt);if(!w)return null;v.push(w)}return new Rm(d,v)}evaluate(o){for(let l=0;l<this.args.length;l++){const d=this.args[l].evaluate(o);if(!Qt(this.type,Qi(d)))return d;if(l===this.args.length-1)throw new so(`Expected value to be of type ${ke(this.type)}, but found ${ke(Qi(d))} instead.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,l=[o.kind];if("array"===o.kind){const d=o.itemType;if("string"===d.kind||"number"===d.kind||"boolean"===d.kind){l.push(d.kind);const p=o.N;("number"==typeof p||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(d=>d.serialize()))}}var at=Rm;class nc{constructor(o){this.type=tc,this.sections=o}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const d=o[1];if(!Array.isArray(d)&&"object"==typeof d)return l.error("First argument must be an image or text section.");const p=[];let _=!1;for(let v=1;v<=o.length-1;++v){const w=o[v];if(_&&"object"==typeof w&&!Array.isArray(w)){_=!1;let D=null;if(w["font-scale"]&&(D=l.parse(w["font-scale"],1,yt),!D))return null;let S=null;if(w["text-font"]&&(S=l.parse(w["text-font"],1,ls(Gt)),!S))return null;let k=null;if(w["text-color"]&&(k=l.parse(w["text-color"],1,as),!k))return null;const P=p[p.length-1];P.scale=D,P.font=S,P.textColor=k}else{const D=l.parse(o[v],1,vt);if(!D)return null;const S=D.type.kind;if("string"!==S&&"value"!==S&&"null"!==S&&"resolvedImage"!==S)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:D,scale:null,font:null,textColor:null})}}return new nc(p)}evaluate(o){return new ds(this.sections.map(l=>{const d=l.content.evaluate(o);return Qi(d)===jc?new Am("",d,null,null,null):new Am(lh(d),null,l.scale?l.scale.evaluate(o):null,l.font?l.font.evaluate(o).join(","):null,l.textColor?l.textColor.evaluate(o):null)}))}eachChild(o){for(const l of this.sections)o(l.content),l.scale&&o(l.scale),l.font&&o(l.font),l.textColor&&o(l.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const l of this.sections){o.push(l.content.serialize());const d={};l.scale&&(d["font-scale"]=l.scale.serialize()),l.font&&(d["text-font"]=l.font.serialize()),l.textColor&&(d["text-color"]=l.textColor.serialize()),o.push(d)}return o}}class pn{constructor(o){this.type=jc,this.input=o}static parse(o,l){if(2!==o.length)return l.error("Expected two arguments.");const d=l.parse(o[1],1,Gt);return d?new pn(d):l.error("No image name provided.")}evaluate(o){const l=this.input.evaluate(o),d=Ws.fromString(l);return d&&o.availableImages&&(d.available=o.availableImages.indexOf(l)>-1),d}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ch={"to-boolean":Cn,"to-color":as,"to-number":yt,"to-string":Gt};class Pp{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const d=o[0];if(("to-boolean"===d||"to-string"===d)&&2!==o.length)return l.error("Expected one argument.");const p=ch[d],_=[];for(let v=1;v<o.length;v++){const w=l.parse(o[v],v,vt);if(!w)return null;_.push(w)}return new Pp(p,_)}evaluate(o){if("boolean"===this.type.kind)return!!this.args[0].evaluate(o);if("color"===this.type.kind){let l,d;for(const p of this.args){if(l=p.evaluate(o),d=null,l instanceof Di)return l;if("string"==typeof l){const _=o.parseColor(l);if(_)return _}else if(Array.isArray(l)&&(d=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Im(l[0],l[1],l[2],l[3]),!d))return new Di(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new so(d||`Could not parse color from value '${"string"==typeof l?l:String(JSON.stringify(l))}'`)}if("number"===this.type.kind){let l=null;for(const d of this.args){if(l=d.evaluate(o),null===l)return 0;const p=Number(l);if(!isNaN(p))return p}throw new so(`Could not convert ${JSON.stringify(l)} to number.`)}return"formatted"===this.type.kind?ds.fromString(lh(this.args[0].evaluate(o))):"resolvedImage"===this.type.kind?Ws.fromString(lh(this.args[0].evaluate(o))):lh(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if("formatted"===this.type.kind)return new nc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new pn(this.args[0]).serialize();const o=[`to-${this.type.kind}`];return this.eachChild(l=>{o.push(l.serialize())}),o}}var ic=Pp;const ua=["Unknown","Point","LineString","Polygon"];var dh=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ua[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:l,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*o-a[0])+this.featureDistanceData.bearing[1]*(d*o-a[1])}return 0}parseColor(a){let o=this._parseColorCache[a];return o||(o=this._parseColorCache[a]=Di.parse(a)),o}};class ha{constructor(o,l,d,p){this.name=o,this.type=l,this._evaluate=d,this.args=p}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,l){const d=o[0],p=ha.definitions[d];if(!p)return l.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,v=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=v.filter(([S])=>!Array.isArray(S)||S.length===o.length-1);let D=null;for(const[S,k]of w){D=new gt(l.registry,l.path,null,l.scope);const P=[];let F=!1;for(let B=1;B<o.length;B++){const z=o[B],j=Array.isArray(S)?S[B-1]:S.type,Y=D.parse(z,1+P.length,j);if(!Y){F=!0;break}P.push(Y)}if(!F)if(Array.isArray(S)&&S.length!==P.length)D.error(`Expected ${S.length} arguments, but found ${P.length} instead.`);else{for(let B=0;B<P.length;B++){const z=Array.isArray(S)?S[B]:S.type,j=P[B];D.concat(B+1).checkSubtype(z,j.type)}if(0===D.errors.length)return new ha(d,_,k,P)}}if(1===w.length)l.errors.push(...D.errors);else{const S=(w.length?w:v).map(([P])=>{return F=P,Array.isArray(F)?`(${F.map(ke).join(", ")})`:`(${ke(F.type)}...)`;var F}).join(" | "),k=[];for(let P=1;P<o.length;P++){const F=l.parse(o[P],1+k.length);if(!F)return null;k.push(ke(F.type))}l.error(`Expected arguments of type ${S}, but found (${k.join(", ")}) instead.`)}return null}static register(o,l){ha.definitions=l;for(const d in l)o[d]=ha}}var Zs=ha;class $c{constructor(o,l,d){this.type=Co,this.locale=d,this.caseSensitive=o,this.diacriticSensitive=l}static parse(o,l){if(2!==o.length)return l.error("Expected one argument.");const d=o[1];if("object"!=typeof d||Array.isArray(d))return l.error("Collator options argument must be an object.");const p=l.parse(void 0!==d["case-sensitive"]&&d["case-sensitive"],1,Cn);if(!p)return null;const _=l.parse(void 0!==d["diacritic-sensitive"]&&d["diacritic-sensitive"],1,Cn);if(!_)return null;let v=null;return d.locale&&(v=l.parse(d.locale,1,Gt),!v)?null:new $c(p,_,v)}evaluate(o){return new Tm(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}const za=8192;function Jt(a,o){a[0]=Math.min(a[0],o[0]),a[1]=Math.min(a[1],o[1]),a[2]=Math.max(a[2],o[0]),a[3]=Math.max(a[3],o[1])}function yl(a,o){return!(a[0]<=o[0]||a[2]>=o[2]||a[1]<=o[1]||a[3]>=o[3])}function Gc(a,o){const l=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,p=Math.pow(2,o.z);return[Math.round(l*p*za),Math.round(d*p*za)]}function Eo(a,o,l){const d=a[0]-o[0],p=a[1]-o[1],_=a[0]-l[0],v=a[1]-l[1];return d*v-_*p==0&&d*_<=0&&p*v<=0}function Zd(a,o){let l=!1;for(let v=0,w=o.length;v<w;v++){const D=o[v];for(let S=0,k=D.length;S<k-1;S++){if(Eo(a,D[S],D[S+1]))return!1;(p=D[S])[1]>(d=a)[1]!=(_=D[S+1])[1]>d[1]&&d[0]<(_[0]-p[0])*(d[1]-p[1])/(_[1]-p[1])+p[0]&&(l=!l)}}var d,p,_;return l}function Pm(a,o){for(let l=0;l<o.length;l++)if(Zd(a,o[l]))return!0;return!1}function Ii(a,o,l,d){const p=d[0]-l[0],_=d[1]-l[1],v=(a[0]-l[0])*_-p*(a[1]-l[1]),w=(o[0]-l[0])*_-p*(o[1]-l[1]);return v>0&&w<0||v<0&&w>0}function Yd(a,o,l){for(const S of l)for(let k=0;k<S.length-1;++k)if((w=[(v=S[k+1])[0]-(_=S[k])[0],v[1]-_[1]])[0]*(D=[(p=o)[0]-(d=a)[0],p[1]-d[1]])[1]-w[1]*D[0]!=0&&Ii(d,p,_,v)&&Ii(_,v,d,p))return!0;var d,p,_,v,w,D;return!1}function ri(a,o){for(let l=0;l<a.length;++l)if(!Zd(a[l],o))return!1;for(let l=0;l<a.length-1;++l)if(Yd(a[l],a[l+1],o))return!1;return!0}function Zb(a,o){for(let l=0;l<o.length;l++)if(ri(a,o[l]))return!0;return!1}function rc(a,o,l){const d=[];for(let p=0;p<a.length;p++){const _=[];for(let v=0;v<a[p].length;v++){const w=Gc(a[p][v],l);Jt(o,w),_.push(w)}d.push(_)}return d}function uh(a,o,l){const d=[];for(let p=0;p<a.length;p++){const _=rc(a[p],o,l);d.push(_)}return d}function qc(a,o,l,d){if(a[0]<l[0]||a[0]>l[2]){const p=.5*d;let _=a[0]-l[0]>p?-d:l[0]-a[0]>p?d:0;0===_&&(_=a[0]-l[2]>p?-d:l[2]-a[0]>p?d:0),a[0]+=_}Jt(o,a)}function Om(a,o,l,d){const p=Math.pow(2,d.z)*za,_=[d.x*za,d.y*za],v=[];if(!a)return v;for(const w of a)for(const D of w){const S=[D.x+_[0],D.y+_[1]];qc(S,o,l,p),v.push(S)}return v}function Op(a,o,l,d){const p=Math.pow(2,d.z)*za,_=[d.x*za,d.y*za],v=[];if(!a)return v;for(const D of a){const S=[];for(const k of D){const P=[k.x+_[0],k.y+_[1]];Jt(o,P),S.push(P)}v.push(S)}if(o[2]-o[0]<=p/2){(w=o)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const D of v)for(const S of D)qc(S,o,l,p)}var w;return v}class Wc{constructor(o,l){this.type=Cn,this.geojson=o,this.geometries=l}static parse(o,l){if(2!==o.length)return l.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(ah(o[1])){const d=o[1];if("FeatureCollection"===d.type)for(let p=0;p<d.features.length;++p){const _=d.features[p].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new Wc(d,d.features[p].geometry)}else if("Feature"===d.type){const p=d.geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new Wc(d,d.geometry)}else if("Polygon"===d.type||"MultiPolygon"===d.type)return new Wc(d,d)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(null!=o.geometry()&&null!=o.canonicalID()){if("Point"===o.geometryType())return function(l,d){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=l.canonicalID();if(!v)return!1;if("Polygon"===d.type){const w=rc(d.coordinates,_,v),D=Om(l.geometry(),p,_,v);if(!yl(p,_))return!1;for(const S of D)if(!Zd(S,w))return!1}if("MultiPolygon"===d.type){const w=uh(d.coordinates,_,v),D=Om(l.geometry(),p,_,v);if(!yl(p,_))return!1;for(const S of D)if(!Pm(S,w))return!1}return!0}(o,this.geometries);if("LineString"===o.geometryType())return function(l,d){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=l.canonicalID();if(!v)return!1;if("Polygon"===d.type){const w=rc(d.coordinates,_,v),D=Op(l.geometry(),p,_,v);if(!yl(p,_))return!1;for(const S of D)if(!ri(S,w))return!1}if("MultiPolygon"===d.type){const w=uh(d.coordinates,_,v),D=Op(l.geometry(),p,_,v);if(!yl(p,_))return!1;for(const S of D)if(!Zb(S,w))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Xd=Wc;function Ys(a){if(a instanceof Zs&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Xd)return!1;let o=!0;return a.eachChild(l=>{o&&!Ys(l)&&(o=!1)}),o}function Va(a){if(a instanceof Zs&&"feature-state"===a.name)return!1;let o=!0;return a.eachChild(l=>{o&&!Va(l)&&(o=!1)}),o}function jo(a,o){if(a instanceof Zs&&o.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(d=>{l&&!jo(d,o)&&(l=!1)}),l}class hh{constructor(o,l){this.type=l.type,this.name=o,this.boundExpression=l}static parse(o,l){if(2!==o.length||"string"!=typeof o[1])return l.error("'var' expression requires exactly one string literal argument.");const d=o[1];return l.scope.has(d)?new hh(d,l.scope.get(d)):l.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Ne=hh;class Zc{constructor(o,l=[],d,p=new sh,_=[]){this.registry=o,this.path=l,this.key=l.map(v=>`[${v}]`).join(""),this.scope=p,this.errors=_,this.expectedType=d}parse(o,l,d,p,_={}){return l?this.concat(l,d,p)._parse(o,_):this._parse(o,_)}_parse(o,l){function d(p,_,v){return"assert"===v?new at(_,[p]):"coerce"===v?new ic(_,[p]):p}if(null!==o&&"string"!=typeof o&&"boolean"!=typeof o&&"number"!=typeof o||(o=["literal",o]),Array.isArray(o)){if(0===o.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=o[0];if("string"!=typeof p)return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[p];if(_){let v=_.parse(o,this);if(!v)return null;if(this.expectedType){const w=this.expectedType,D=v.type;if("string"!==w.kind&&"number"!==w.kind&&"boolean"!==w.kind&&"object"!==w.kind&&"array"!==w.kind||"value"!==D.kind)if("color"!==w.kind&&"formatted"!==w.kind&&"resolvedImage"!==w.kind||"value"!==D.kind&&"string"!==D.kind){if(this.checkSubtype(w,D))return null}else v=d(v,w,l.typeAnnotation||"coerce");else v=d(v,w,l.typeAnnotation||"assert")}if(!(v instanceof Zn)&&"resolvedImage"!==v.type.kind&&Yc(v)){const w=new dh;try{v=new Zn(v.type,v.evaluate(w))}catch(D){return this.error(D.message),null}}return v}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===o?"'undefined' value invalid. Use null instead.":"object"==typeof o?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,l,d){const p="number"==typeof o?this.path.concat(o):this.path,_=d?this.scope.concat(d):this.scope;return new Zc(this.registry,p,l||null,_,this.errors)}error(o,...l){const d=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new $i(d,o))}checkSubtype(o,l){const d=Qt(o,l);return d&&this.error(d),d}}var gt=Zc;function Yc(a){if(a instanceof Ne)return Yc(a.boundExpression);if(a instanceof Zs&&"error"===a.name||a instanceof $c||a instanceof Xd)return!1;const o=a instanceof ic||a instanceof at;let l=!0;return a.eachChild(d=>{l=o?l&&Yc(d):l&&d instanceof Zn}),!!l&&Ys(a)&&jo(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Xc(a,o){const l=a.length-1;let d,p,_=0,v=l,w=0;for(;_<=v;)if(w=Math.floor((_+v)/2),d=a[w],p=a[w+1],d<=o){if(w===l||o<p)return w;_=w+1}else{if(!(d>o))throw new so("Input is not a number.");v=w-1}return 0}class vl{constructor(o,l,d){this.type=o,this.input=l,this.labels=[],this.outputs=[];for(const[p,_]of d)this.labels.push(p),this.outputs.push(_)}static parse(o,l){if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");const d=l.parse(o[1],1,yt);if(!d)return null;const p=[];let _=null;l.expectedType&&"value"!==l.expectedType.kind&&(_=l.expectedType);for(let v=1;v<o.length;v+=2){const w=1===v?-1/0:o[v],D=o[v+1],S=v,k=v+1;if("number"!=typeof w)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(p.length&&p[p.length-1][0]>=w)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);const P=l.parse(D,k,_);if(!P)return null;_=_||P.type,p.push([w,P])}return new vl(_,d,p)}evaluate(o){const l=this.labels,d=this.outputs;if(1===l.length)return d[0].evaluate(o);const p=this.input.evaluate(o);if(p<=l[0])return d[0].evaluate(o);const _=l.length;return p>=l[_-1]?d[_-1].evaluate(o):d[Xc(l,p)].evaluate(o)}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&o.push(this.labels[l]),o.push(this.outputs[l].serialize());return o}}var Fp=vl;function Hn(a,o,l){return a*(1-l)+o*l}var Kd=Object.freeze({__proto__:null,array:function(a,o,l){return a.map((d,p)=>Hn(d,o[p],l))},color:function(a,o,l){return new Di(Hn(a.r,o.r,l),Hn(a.g,o.g,l),Hn(a.b,o.b,l),Hn(a.a,o.a,l))},number:Hn});const Do=4/29,So=6/29,ei=3*So*So,ph=So*So*So,Lp=Math.PI/180,Np=180/Math.PI;function fh(a){return a>ph?Math.pow(a,1/3):a/ei+Do}function Xs(a){return a>So?a*a*a:ei*(a-Do)}function oc(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Jd(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Bp(a){const o=Jd(a.r),l=Jd(a.g),d=Jd(a.b),p=fh((.4124564*o+.3575761*l+.1804375*d)/.95047),_=fh((.2126729*o+.7151522*l+.072175*d)/1);return{l:116*_-16,a:500*(p-_),b:200*(_-fh((.0193339*o+.119192*l+.9503041*d)/1.08883)),alpha:a.a}}function mh(a){let o=(a.l+16)/116,l=isNaN(a.a)?o:o+a.a/500,d=isNaN(a.b)?o:o-a.b/200;return o=1*Xs(o),l=.95047*Xs(l),d=1.08883*Xs(d),new Di(oc(3.2404542*l-1.5371385*o-.4985314*d),oc(-.969266*l+1.8760108*o+.041556*d),oc(.0556434*l-.2040259*o+1.0572252*d),a.alpha)}function Fm(a,o,l){const d=o-a;return a+l*(d>180||d<-180?d-360*Math.round(d/360):d)}const Kc={forward:Bp,reverse:mh,interpolate:function(a,o,l){return{l:Hn(a.l,o.l,l),a:Hn(a.a,o.a,l),b:Hn(a.b,o.b,l),alpha:Hn(a.alpha,o.alpha,l)}}},fa={forward:function(a){const{l:o,a:l,b:d}=Bp(a),p=Math.atan2(d,l)*Np;return{h:p<0?p+360:p,c:Math.sqrt(l*l+d*d),l:o,alpha:a.a}},reverse:function(a){const o=a.h*Lp,l=a.c;return mh({l:a.l,a:Math.cos(o)*l,b:Math.sin(o)*l,alpha:a.alpha})},interpolate:function(a,o,l){return{h:Fm(a.h,o.h,l),c:Hn(a.c,o.c,l),l:Hn(a.l,o.l,l),alpha:Hn(a.alpha,o.alpha,l)}}};var gh=Object.freeze({__proto__:null,hcl:fa,lab:Kc});class Jc{constructor(o,l,d,p,_){this.type=o,this.operator=l,this.interpolation=d,this.input=p,this.labels=[],this.outputs=[];for(const[v,w]of _)this.labels.push(v),this.outputs.push(w)}static interpolationFactor(o,l,d,p){let _=0;if("exponential"===o.name)_=zp(l,o.base,d,p);else if("linear"===o.name)_=zp(l,1,d,p);else if("cubic-bezier"===o.name){const v=o.controlPoints;_=new aa(v[0],v[1],v[2],v[3]).solve(zp(l,1,d,p))}return _}static parse(o,l){let[d,p,_,...v]=o;if(!Array.isArray(p)||0===p.length)return l.error("Expected an interpolation type expression.",1);if("linear"===p[0])p={name:"linear"};else if("exponential"===p[0]){const S=p[1];if("number"!=typeof S)return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:S}}else{if("cubic-bezier"!==p[0])return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const S=p.slice(1);if(4!==S.length||S.some(k=>"number"!=typeof k||k<0||k>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:S}}}if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(_=l.parse(_,2,yt),!_)return null;const w=[];let D=null;"interpolate-hcl"===d||"interpolate-lab"===d?D=as:l.expectedType&&"value"!==l.expectedType.kind&&(D=l.expectedType);for(let S=0;S<v.length;S+=2){const k=v[S],P=v[S+1],F=S+3,B=S+4;if("number"!=typeof k)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(w.length&&w[w.length-1][0]>=k)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const z=l.parse(P,B,D);if(!z)return null;D=D||z.type,w.push([k,z])}return"number"===D.kind||"color"===D.kind||"array"===D.kind&&"number"===D.itemType.kind&&"number"==typeof D.N?new Jc(D,d,p,_,w):l.error(`Type ${ke(D)} is not interpolatable.`)}evaluate(o){const l=this.labels,d=this.outputs;if(1===l.length)return d[0].evaluate(o);const p=this.input.evaluate(o);if(p<=l[0])return d[0].evaluate(o);const _=l.length;if(p>=l[_-1])return d[_-1].evaluate(o);const v=Xc(l,p),w=Jc.interpolationFactor(this.interpolation,p,l[v],l[v+1]),D=d[v].evaluate(o),S=d[v+1].evaluate(o);return"interpolate"===this.operator?Kd[this.type.kind.toLowerCase()](D,S,w):"interpolate-hcl"===this.operator?fa.reverse(fa.interpolate(fa.forward(D),fa.forward(S),w)):Kc.reverse(Kc.interpolate(Kc.forward(D),Kc.forward(S),w))}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,o,this.input.serialize()];for(let d=0;d<this.labels.length;d++)l.push(this.labels[d],this.outputs[d].serialize());return l}}function zp(a,o,l,d){const p=d-l,_=a-l;return 0===p?0:1===o?_/p:(Math.pow(o,_)-1)/(Math.pow(o,p)-1)}var Ks=Jc;class _h{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expectected at least one argument.");let d=null;const p=l.expectedType;p&&"value"!==p.kind&&(d=p);const _=[];for(const w of o.slice(1)){const D=l.parse(w,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!D)return null;d=d||D.type,_.push(D)}const v=p&&_.some(w=>Qt(p,w.type));return new _h(v?vt:d,_)}evaluate(o){let l,d=null,p=0;for(const _ of this.args){if(p++,d=_.evaluate(o),d&&d instanceof Ws&&!d.available&&(l||(l=d),d=null,p===this.args.length))return l;if(null!==d)break}return d}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(l=>{o.push(l.serialize())}),o}}var Vp=_h;class Ho{constructor(o,l){this.type=l.type,this.bindings=[].concat(o),this.result=l}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const l of this.bindings)o(l[1]);o(this.result)}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const d=[];for(let _=1;_<o.length-1;_+=2){const v=o[_];if("string"!=typeof v)return l.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return l.error("Variable names must contain only alphanumeric characters or '_'.",_);const w=l.parse(o[_+1],_+1);if(!w)return null;d.push([v,w])}const p=l.parse(o[o.length-1],o.length-1,l.expectedType,d);return p?new Ho(d,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[l,d]of this.bindings)o.push(l,d.serialize());return o.push(this.result.serialize()),o}}var Lm=Ho;class yh{constructor(o,l,d){this.type=o,this.index=l,this.input=d}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,yt),p=l.parse(o[2],2,ls(l.expectedType||vt));return d&&p?new yh(p.type.itemType,d,p):null}evaluate(o){const l=this.index.evaluate(o),d=this.input.evaluate(o);if(l<0)throw new so(`Array index out of bounds: ${l} < 0.`);if(l>=d.length)throw new so(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l!==Math.floor(l))throw new so(`Array index must be an integer, but found ${l} instead.`);return d[l]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var G_=yh;class Up{constructor(o,l){this.type=Cn,this.needle=o,this.haystack=l}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,vt),p=l.parse(o[2],2,vt);return d&&p?Qn(d.type,[Cn,Gt,yt,Jn,vt])?new Up(d,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ke(d.type)} instead`):null}evaluate(o){const l=this.needle.evaluate(o),d=this.haystack.evaluate(o);if(null==d)return!1;if(!Wd(l,["boolean","string","number","null"]))throw new so(`Expected first argument to be of type boolean, string, number or null, but found ${ke(Qi(l))} instead.`);if(!Wd(d,["string","array"]))throw new so(`Expected second argument to be of type array or string, but found ${ke(Qi(d))} instead.`);return d.indexOf(l)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var vh=Up;class Qd{constructor(o,l,d){this.type=yt,this.needle=o,this.haystack=l,this.fromIndex=d}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,vt),p=l.parse(o[2],2,vt);if(!d||!p)return null;if(!Qn(d.type,[Cn,Gt,yt,Jn,vt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ke(d.type)} instead`);if(4===o.length){const _=l.parse(o[3],3,yt);return _?new Qd(d,p,_):null}return new Qd(d,p)}evaluate(o){const l=this.needle.evaluate(o),d=this.haystack.evaluate(o);if(!Wd(l,["boolean","string","number","null"]))throw new so(`Expected first argument to be of type boolean, string, number or null, but found ${ke(Qi(l))} instead.`);if(!Wd(d,["string","array"]))throw new so(`Expected second argument to be of type array or string, but found ${ke(Qi(d))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(o);return d.indexOf(l,p)}return d.indexOf(l)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var jp=Qd;class Hp{constructor(o,l,d,p,_,v){this.inputType=o,this.type=l,this.input=d,this.cases=p,this.outputs=_,this.otherwise=v}static parse(o,l){if(o.length<5)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return l.error("Expected an even number of arguments.");let d,p;l.expectedType&&"value"!==l.expectedType.kind&&(p=l.expectedType);const _={},v=[];for(let S=2;S<o.length-1;S+=2){let k=o[S];const P=o[S+1];Array.isArray(k)||(k=[k]);const F=l.concat(S);if(0===k.length)return F.error("Expected at least one branch label.");for(const z of k){if("number"!=typeof z&&"string"!=typeof z)return F.error("Branch labels must be numbers or strings.");if("number"==typeof z&&Math.abs(z)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof z&&Math.floor(z)!==z)return F.error("Numeric branch labels must be integer values.");if(d){if(F.checkSubtype(d,Qi(z)))return null}else d=Qi(z);if(void 0!==_[String(z)])return F.error("Branch labels must be unique.");_[String(z)]=v.length}const B=l.parse(P,S,p);if(!B)return null;p=p||B.type,v.push(B)}const w=l.parse(o[1],1,vt);if(!w)return null;const D=l.parse(o[o.length-1],o.length-1,p);return D?"value"!==w.type.kind&&l.concat(1).checkSubtype(d,w.type)?null:new Hp(d,p,w,_,v,D):null}evaluate(o){const l=this.input.evaluate(o);return(Qi(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),d=[],p={};for(const v of l){const w=p[this.cases[v]];void 0===w?(p[this.cases[v]]=d.length,d.push([this.cases[v],[v]])):d[w][1].push(v)}const _=v=>"number"===this.inputType.kind?Number(v):v;for(const[v,w]of d)o.push(1===w.length?_(w[0]):w.map(_)),o.push(this.outputs[v].serialize());return o.push(this.otherwise.serialize()),o}}var q_=Hp;class $p{constructor(o,l,d){this.type=o,this.branches=l,this.otherwise=d}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return l.error("Expected an odd number of arguments.");let d;l.expectedType&&"value"!==l.expectedType.kind&&(d=l.expectedType);const p=[];for(let v=1;v<o.length-1;v+=2){const w=l.parse(o[v],v,Cn);if(!w)return null;const D=l.parse(o[v+1],v+1,d);if(!D)return null;p.push([w,D]),d=d||D.type}const _=l.parse(o[o.length-1],o.length-1,d);return _?new $p(d,p,_):null}evaluate(o){for(const[l,d]of this.branches)if(l.evaluate(o))return d.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[l,d]of this.branches)o(l),o(d);o(this.otherwise)}outputDefined(){return this.branches.every(([o,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(l=>{o.push(l.serialize())}),o}}var Fn=$p;class Qc{constructor(o,l,d,p){this.type=o,this.input=l,this.beginIndex=d,this.endIndex=p}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,vt),p=l.parse(o[2],2,yt);if(!d||!p)return null;if(!Qn(d.type,[ls(vt),Gt,vt]))return l.error(`Expected first argument to be of type array or string, but found ${ke(d.type)} instead`);if(4===o.length){const _=l.parse(o[3],3,yt);return _?new Qc(d.type,d,p,_):null}return new Qc(d.type,d,p)}evaluate(o){const l=this.input.evaluate(o),d=this.beginIndex.evaluate(o);if(!Wd(l,["string","array"]))throw new so(`Expected first argument to be of type array or string, but found ${ke(Qi(l))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(o);return l.slice(d,p)}return l.slice(d)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Nm=Qc;function bh(a,o){return"=="===a||"!="===a?"boolean"===o.kind||"string"===o.kind||"number"===o.kind||"null"===o.kind||"value"===o.kind:"string"===o.kind||"number"===o.kind||"value"===o.kind}function En(a,o,l,d){return 0===d.compare(o,l)}function ed(a,o,l){const d="=="!==a&&"!="!==a;return class RN{constructor(_,v,w){this.type=Cn,this.lhs=_,this.rhs=v,this.collator=w,this.hasUntypedArgument="value"===_.type.kind||"value"===v.type.kind}static parse(_,v){if(3!==_.length&&4!==_.length)return v.error("Expected two or three arguments.");const w=_[0];let D=v.parse(_[1],1,vt);if(!D)return null;if(!bh(w,D.type))return v.concat(1).error(`"${w}" comparisons are not supported for type '${ke(D.type)}'.`);let S=v.parse(_[2],2,vt);if(!S)return null;if(!bh(w,S.type))return v.concat(2).error(`"${w}" comparisons are not supported for type '${ke(S.type)}'.`);if(D.type.kind!==S.type.kind&&"value"!==D.type.kind&&"value"!==S.type.kind)return v.error(`Cannot compare types '${ke(D.type)}' and '${ke(S.type)}'.`);d&&("value"===D.type.kind&&"value"!==S.type.kind?D=new at(S.type,[D]):"value"!==D.type.kind&&"value"===S.type.kind&&(S=new at(D.type,[S])));let k=null;if(4===_.length){if("string"!==D.type.kind&&"string"!==S.type.kind&&"value"!==D.type.kind&&"value"!==S.type.kind)return v.error("Cannot use collator to compare non-string types.");if(k=v.parse(_[3],3,Co),!k)return null}return new RN(D,S,k)}evaluate(_){const v=this.lhs.evaluate(_),w=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){const D=Qi(v),S=Qi(w);if(D.kind!==S.kind||"string"!==D.kind&&"number"!==D.kind)throw new so(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${D.kind}, ${S.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const D=Qi(v),S=Qi(w);if("string"!==D.kind||"string"!==S.kind)return o(_,v,w)}return this.collator?l(_,v,w,this.collator.evaluate(_)):o(_,v,w)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[a];return this.eachChild(v=>{_.push(v.serialize())}),_}}}const Bm=ed("==",function(a,o,l){return o===l},En),rt=ed("!=",function(a,o,l){return o!==l},function(a,o,l,d){return!En(0,o,l,d)}),$o=ed("<",function(a,o,l){return o<l},function(a,o,l,d){return d.compare(o,l)<0}),di=ed(">",function(a,o,l){return o>l},function(a,o,l,d){return d.compare(o,l)>0}),ao=ed("<=",function(a,o,l){return o<=l},function(a,o,l,d){return d.compare(o,l)<=0}),Mo=ed(">=",function(a,o,l){return o>=l},function(a,o,l,d){return d.compare(o,l)>=0});class Ua{constructor(o,l,d,p,_,v){this.type=Gt,this.number=o,this.locale=l,this.currency=d,this.unit=p,this.minFractionDigits=_,this.maxFractionDigits=v}static parse(o,l){if(3!==o.length)return l.error("Expected two arguments.");const d=l.parse(o[1],1,yt);if(!d)return null;const p=o[2];if("object"!=typeof p||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=l.parse(p.locale,1,Gt),!_))return null;let v=null;if(p.currency&&(v=l.parse(p.currency,1,Gt),!v))return null;let w=null;if(p.unit&&(w=l.parse(p.unit,1,Gt),!w))return null;let D=null;if(p["min-fraction-digits"]&&(D=l.parse(p["min-fraction-digits"],1,yt),!D))return null;let S=null;return p["max-fraction-digits"]&&(S=l.parse(p["max-fraction-digits"],1,yt),!S)?null:new Ua(d,_,v,w,D,S)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class Rr{constructor(o){this.type=yt,this.input=o}static parse(o,l){if(2!==o.length)return l.error(`Expected 1 argument, but found ${o.length-1} instead.`);const d=l.parse(o[1],1);return d?"array"!==d.type.kind&&"string"!==d.type.kind&&"value"!==d.type.kind?l.error(`Expected argument of type string or array, but found ${ke(d.type)} instead.`):new Rr(d):null}evaluate(o){const l=this.input.evaluate(o);if("string"==typeof l||Array.isArray(l))return l.length;throw new so(`Expected value to be of type string or array, but found ${ke(Qi(l))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(l=>{o.push(l.serialize())}),o}}const Gp={"==":Bm,"!=":rt,">":di,"<":$o,">=":Mo,"<=":ao,array:at,at:G_,boolean:at,case:Fn,coalesce:Vp,collator:$c,format:nc,image:pn,in:vh,"index-of":jp,interpolate:Ks,"interpolate-hcl":Ks,"interpolate-lab":Ks,length:Rr,let:Lm,literal:Zn,match:q_,number:at,"number-format":Ua,object:at,slice:Nm,step:Fp,string:at,"to-boolean":ic,"to-color":ic,"to-number":ic,"to-string":ic,var:Ne,within:Xd};function qp(a,[o,l,d,p]){o=o.evaluate(a),l=l.evaluate(a),d=d.evaluate(a);const _=p?p.evaluate(a):1,v=Im(o,l,d,_);if(v)throw new so(v);return new Di(o/255*_,l/255*_,d/255*_,_)}function Ss(a,o){return a in o}function xh(a,o){const l=o[a];return void 0===l?null:l}function Ms(a){return{type:a}}Zs.register(Gp,{error:[{kind:"error"},[Gt],(a,[o])=>{throw new so(o.evaluate(a))}],typeof:[Gt,[vt],(a,[o])=>ke(Qi(o.evaluate(a)))],"to-rgba":[ls(yt,4),[as],(a,[o])=>o.evaluate(a).toArray()],rgb:[as,[yt,yt,yt],qp],rgba:[as,[yt,yt,yt,yt],qp],has:{type:Cn,overloads:[[[Gt],(a,[o])=>Ss(o.evaluate(a),a.properties())],[[Gt,Pn],(a,[o,l])=>Ss(o.evaluate(a),l.evaluate(a))]]},get:{type:vt,overloads:[[[Gt],(a,[o])=>xh(o.evaluate(a),a.properties())],[[Gt,Pn],(a,[o,l])=>xh(o.evaluate(a),l.evaluate(a))]]},"feature-state":[vt,[Gt],(a,[o])=>xh(o.evaluate(a),a.featureState||{})],properties:[Pn,[],a=>a.properties()],"geometry-type":[Gt,[],a=>a.geometryType()],id:[vt,[],a=>a.id()],zoom:[yt,[],a=>a.globals.zoom],pitch:[yt,[],a=>a.globals.pitch||0],"distance-from-center":[yt,[],a=>a.distanceFromCenter()],"heatmap-density":[yt,[],a=>a.globals.heatmapDensity||0],"line-progress":[yt,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[yt,[],a=>a.globals.skyRadialProgress||0],accumulated:[vt,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[yt,Ms(yt),(a,o)=>{let l=0;for(const d of o)l+=d.evaluate(a);return l}],"*":[yt,Ms(yt),(a,o)=>{let l=1;for(const d of o)l*=d.evaluate(a);return l}],"-":{type:yt,overloads:[[[yt,yt],(a,[o,l])=>o.evaluate(a)-l.evaluate(a)],[[yt],(a,[o])=>-o.evaluate(a)]]},"/":[yt,[yt,yt],(a,[o,l])=>o.evaluate(a)/l.evaluate(a)],"%":[yt,[yt,yt],(a,[o,l])=>o.evaluate(a)%l.evaluate(a)],ln2:[yt,[],()=>Math.LN2],pi:[yt,[],()=>Math.PI],e:[yt,[],()=>Math.E],"^":[yt,[yt,yt],(a,[o,l])=>Math.pow(o.evaluate(a),l.evaluate(a))],sqrt:[yt,[yt],(a,[o])=>Math.sqrt(o.evaluate(a))],log10:[yt,[yt],(a,[o])=>Math.log(o.evaluate(a))/Math.LN10],ln:[yt,[yt],(a,[o])=>Math.log(o.evaluate(a))],log2:[yt,[yt],(a,[o])=>Math.log(o.evaluate(a))/Math.LN2],sin:[yt,[yt],(a,[o])=>Math.sin(o.evaluate(a))],cos:[yt,[yt],(a,[o])=>Math.cos(o.evaluate(a))],tan:[yt,[yt],(a,[o])=>Math.tan(o.evaluate(a))],asin:[yt,[yt],(a,[o])=>Math.asin(o.evaluate(a))],acos:[yt,[yt],(a,[o])=>Math.acos(o.evaluate(a))],atan:[yt,[yt],(a,[o])=>Math.atan(o.evaluate(a))],min:[yt,Ms(yt),(a,o)=>Math.min(...o.map(l=>l.evaluate(a)))],max:[yt,Ms(yt),(a,o)=>Math.max(...o.map(l=>l.evaluate(a)))],abs:[yt,[yt],(a,[o])=>Math.abs(o.evaluate(a))],round:[yt,[yt],(a,[o])=>{const l=o.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[yt,[yt],(a,[o])=>Math.floor(o.evaluate(a))],ceil:[yt,[yt],(a,[o])=>Math.ceil(o.evaluate(a))],"filter-==":[Cn,[Gt,vt],(a,[o,l])=>a.properties()[o.value]===l.value],"filter-id-==":[Cn,[vt],(a,[o])=>a.id()===o.value],"filter-type-==":[Cn,[Gt],(a,[o])=>a.geometryType()===o.value],"filter-<":[Cn,[Gt,vt],(a,[o,l])=>{const d=a.properties()[o.value],p=l.value;return typeof d==typeof p&&d<p}],"filter-id-<":[Cn,[vt],(a,[o])=>{const l=a.id(),d=o.value;return typeof l==typeof d&&l<d}],"filter->":[Cn,[Gt,vt],(a,[o,l])=>{const d=a.properties()[o.value],p=l.value;return typeof d==typeof p&&d>p}],"filter-id->":[Cn,[vt],(a,[o])=>{const l=a.id(),d=o.value;return typeof l==typeof d&&l>d}],"filter-<=":[Cn,[Gt,vt],(a,[o,l])=>{const d=a.properties()[o.value],p=l.value;return typeof d==typeof p&&d<=p}],"filter-id-<=":[Cn,[vt],(a,[o])=>{const l=a.id(),d=o.value;return typeof l==typeof d&&l<=d}],"filter->=":[Cn,[Gt,vt],(a,[o,l])=>{const d=a.properties()[o.value],p=l.value;return typeof d==typeof p&&d>=p}],"filter-id->=":[Cn,[vt],(a,[o])=>{const l=a.id(),d=o.value;return typeof l==typeof d&&l>=d}],"filter-has":[Cn,[vt],(a,[o])=>o.value in a.properties()],"filter-has-id":[Cn,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[Cn,[ls(Gt)],(a,[o])=>o.value.indexOf(a.geometryType())>=0],"filter-id-in":[Cn,[ls(vt)],(a,[o])=>o.value.indexOf(a.id())>=0],"filter-in-small":[Cn,[Gt,ls(vt)],(a,[o,l])=>l.value.indexOf(a.properties()[o.value])>=0],"filter-in-large":[Cn,[Gt,ls(vt)],(a,[o,l])=>function(d,p,_,v){for(;_<=v;){const w=_+v>>1;if(p[w]===d)return!0;p[w]>d?v=w-1:_=w+1}return!1}(a.properties()[o.value],l.value,0,l.value.length-1)],all:{type:Cn,overloads:[[[Cn,Cn],(a,[o,l])=>o.evaluate(a)&&l.evaluate(a)],[Ms(Cn),(a,o)=>{for(const l of o)if(!l.evaluate(a))return!1;return!0}]]},any:{type:Cn,overloads:[[[Cn,Cn],(a,[o,l])=>o.evaluate(a)||l.evaluate(a)],[Ms(Cn),(a,o)=>{for(const l of o)if(l.evaluate(a))return!0;return!1}]]},"!":[Cn,[Cn],(a,[o])=>!o.evaluate(a)],"is-supported-script":[Cn,[Gt],(a,[o])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(o.evaluate(a))}],upcase:[Gt,[Gt],(a,[o])=>o.evaluate(a).toUpperCase()],downcase:[Gt,[Gt],(a,[o])=>o.evaluate(a).toLowerCase()],concat:[Gt,Ms(vt),(a,o)=>o.map(l=>lh(l.evaluate(a))).join("")],"resolved-locale":[Gt,[Co],(a,[o])=>o.evaluate(a).resolvedLocale()]});var er=Gp;function It(a){return{result:"success",value:a}}function dn(a){return{result:"error",value:a}}function ki(a){return"data-driven"===a["property-type"]}function Go(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function ma(a){return!!a.expression&&a.expression.interpolated}function tn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function ga(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function tr(a){return a}function ja(a,o){const l="color"===o.type,d=a.stops&&"object"==typeof a.stops[0][0],p=d||!(d||void 0!==a.property),_=a.type||(ma(o)?"exponential":"interval");if(l&&((a=da({},a)).stops&&(a.stops=a.stops.map(S=>[S[0],Di.parse(S[1])])),a.default=Di.parse(a.default?a.default:o.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!gh[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let v,w,D;if("exponential"===_)v=_a;else if("interval"===_)v=bl;else if("categorical"===_){v=Dn,w=Object.create(null);for(const S of a.stops)w[S[0]]=S[1];D=typeof a.stops[0][0]}else{if("identity"!==_)throw new Error(`Unknown function type "${_}"`);v=sc}if(d){const S={},k=[];for(let B=0;B<a.stops.length;B++){const z=a.stops[B],j=z[0].zoom;void 0===S[j]&&(S[j]={zoom:j,type:a.type,property:a.property,default:a.default,stops:[]},k.push(j)),S[j].stops.push([z[0].value,z[1]])}const P=[];for(const B of k)P.push([S[B].zoom,ja(S[B],o)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Ks.interpolationFactor.bind(void 0,F),zoomStops:P.map(B=>B[0]),evaluate:({zoom:B},z)=>_a({stops:P,base:a.base},o,B).evaluate(B,z)}}if(p){const S="exponential"===_?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:Ks.interpolationFactor.bind(void 0,S),zoomStops:a.stops.map(k=>k[0]),evaluate:({zoom:k})=>v(a,o,k,w,D)}}return{kind:"source",evaluate(S,k){const P=k&&k.properties?k.properties[a.property]:void 0;return void 0===P?Ts(a.default,o.default):v(a,o,P,w,D)}}}function Ts(a,o,l){return void 0!==a?a:void 0!==o?o:void 0!==l?l:void 0}function Dn(a,o,l,d,p){return Ts(typeof l===p?d[l]:void 0,a.default,o.default)}function bl(a,o,l){if("number"!==tn(l))return Ts(a.default,o.default);const d=a.stops.length;if(1===d||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[d-1][0])return a.stops[d-1][1];const p=Xc(a.stops.map(_=>_[0]),l);return a.stops[p][1]}function _a(a,o,l){const d=void 0!==a.base?a.base:1;if("number"!==tn(l))return Ts(a.default,o.default);const p=a.stops.length;if(1===p||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[p-1][0])return a.stops[p-1][1];const _=Xc(a.stops.map(k=>k[0]),l),v=function(k,P,F,B){const z=B-F,j=k-F;return 0===z?0:1===P?j/z:(Math.pow(P,j)-1)/(Math.pow(P,z)-1)}(l,d,a.stops[_][0],a.stops[_+1][0]),w=a.stops[_][1],D=a.stops[_+1][1];let S=Kd[o.type]||tr;if(a.colorSpace&&"rgb"!==a.colorSpace){const k=gh[a.colorSpace];S=(P,F)=>k.reverse(k.interpolate(k.forward(P),k.forward(F),v))}return"function"==typeof w.evaluate?{evaluate(...k){const P=w.evaluate.apply(void 0,k),F=D.evaluate.apply(void 0,k);if(void 0!==P&&void 0!==F)return S(P,F,v)}}:S(w,D,v)}function sc(a,o,l){return"color"===o.type?l=Di.parse(l):"formatted"===o.type?l=ds.fromString(l.toString()):"resolvedImage"===o.type?l=Ws.fromString(l.toString()):tn(l)===o.type||"enum"===o.type&&o.values[l]||(l=void 0),Ts(l,a.default,o.default)}class nr{constructor(o,l){var d;this.expression=o,this._warningHistory={},this._evaluator=new dh,this._defaultValue=l?"color"===(d=l).type&&(ga(d.default)||Array.isArray(d.default))?new Di(0,0,0,0):"color"===d.type?Di.parse(d.default)||null:void 0===d.default?null:d.default:null,this._enumValues=l&&"enum"===l.type?l.values:null}evaluateWithoutErrorHandling(o,l,d,p,_,v,w,D){return this._evaluator.globals=o,this._evaluator.feature=l,this._evaluator.featureState=d,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=D||null,this.expression.evaluate(this._evaluator)}evaluate(o,l,d,p,_,v,w,D){this._evaluator.globals=o,this._evaluator.feature=l||null,this._evaluator.featureState=d||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=D||null;try{const S=this.expression.evaluate(this._evaluator);if(null==S||"number"==typeof S&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new so(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function ya(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in er}function Js(a,o){const l=new gt(er,[],o?function(p){const _={color:as,string:Gt,number:yt,enum:Gt,boolean:Cn,formatted:tc,resolvedImage:jc};return"array"===p.type?ls(_[p.value]||vt,p.length):_[p.type]}(o):void 0),d=l.parse(a,void 0,void 0,void 0,o&&"string"===o.type?{typeAnnotation:"coerce"}:void 0);return d?It(new nr(d,o)):dn(l.errors)}class As{constructor(o,l){this.kind=o,this._styleExpression=l,this.isStateDependent="constant"!==o&&!Va(l.expression)}evaluateWithoutErrorHandling(o,l,d,p,_,v){return this._styleExpression.evaluateWithoutErrorHandling(o,l,d,p,_,v)}evaluate(o,l,d,p,_,v){return this._styleExpression.evaluate(o,l,d,p,_,v)}}class Ha{constructor(o,l,d,p){this.kind=o,this.zoomStops=d,this._styleExpression=l,this.isStateDependent="camera"!==o&&!Va(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(o,l,d,p,_,v){return this._styleExpression.evaluateWithoutErrorHandling(o,l,d,p,_,v)}evaluate(o,l,d,p,_,v){return this._styleExpression.evaluate(o,l,d,p,_,v)}interpolationFactor(o,l,d){return this.interpolationType?Ks.interpolationFactor(this.interpolationType,o,l,d):0}}function td(a,o){if("error"===(a=Js(a,o)).result)return a;const l=a.value.expression,d=Ys(l);if(!d&&!ki(o))return dn([new $i("","data expressions not supported")]);const p=jo(l,["zoom","pitch","distance-from-center"]);if(!p&&!Go(o))return dn([new $i("","zoom expressions not supported")]);const _=Is(l);return _||p?_ instanceof $i?dn([_]):_ instanceof Ks&&!ma(o)?dn([new $i("",'"interpolate" expressions cannot be used with this property')]):It(_?new Ha(d?"camera":"composite",a.value,_.labels,_ instanceof Ks?_.interpolation:void 0):new As(d?"constant":"source",a.value)):dn([new $i("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Qs{constructor(o,l){this._parameters=o,this._specification=l,da(this,ja(this._parameters,this._specification))}static deserialize(o){return new Qs(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function Is(a){let o=null;if(a instanceof Lm)o=Is(a.result);else if(a instanceof Vp){for(const l of a.args)if(o=Is(l),o)break}else(a instanceof Fp||a instanceof Ks)&&a.input instanceof Zs&&"zoom"===a.input.name&&(o=a);return o instanceof $i||a.eachChild(l=>{const d=Is(l);d instanceof $i?o=d:!o&&d?o=new $i("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&d&&o!==d&&(o=new $i("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}class bt{constructor(o,l,d,p){this.message=(o?`${o}: `:"")+d,p&&(this.identifier=p),null!=l&&l.__line__&&(this.line=l.__line__)}}function qo(a){const o=a.key,l=a.value,d=a.valueSpec||{},p=a.objectElementValidators||{},_=a.style,v=a.styleSpec;let w=[];const D=tn(l);if("object"!==D)return[new bt(o,l,`object expected, ${D} found`)];for(const S in l){const k=S.split(".")[0];let P;p[k]?P=p[k]:d[k]?P=Gr:p["*"]?P=p["*"]:d["*"]&&(P=Gr),P?w=w.concat(P({key:(o&&`${o}.`)+S,value:l[S],valueSpec:d[k]||d["*"],style:_,styleSpec:v,object:l,objectKey:S},l)):w.push(new bt(o,l[S],`unknown property "${S}"`))}for(const S in d)p[S]||d[S].required&&void 0===d[S].default&&void 0===l[S]&&w.push(new bt(o,l,`missing required property "${S}"`));return w}function $n(a){const o=a.value,l=a.valueSpec,d=a.style,p=a.styleSpec,_=a.key,v=a.arrayElementValidator||Gr;if("array"!==tn(o))return[new bt(_,o,`array expected, ${tn(o)} found`)];if(l.length&&o.length!==l.length)return[new bt(_,o,`array length ${l.length} expected, length ${o.length} found`)];if(l["min-length"]&&o.length<l["min-length"])return[new bt(_,o,`array length at least ${l["min-length"]} expected, length ${o.length} found`)];let w={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};p.$version<7&&(w.function=l.function),"object"===tn(l.value)&&(w=l.value);let D=[];for(let S=0;S<o.length;S++)D=D.concat(v({array:o,arrayIndex:S,value:o[S],valueSpec:w,style:d,styleSpec:p,key:`${_}[${S}]`}));return D}function wh(a){const o=a.key,l=a.value,d=a.valueSpec;let p=tn(l);if("number"===p&&l!=l&&(p="NaN"),"number"!==p)return[new bt(o,l,`number expected, ${p} found`)];if("minimum"in d){let _=d.minimum;if("array"===tn(d.minimum)&&(_=d.minimum[a.arrayIndex]),l<_)return[new bt(o,l,`${l} is less than the minimum value ${_}`)]}if("maximum"in d){let _=d.maximum;if("array"===tn(d.maximum)&&(_=d.maximum[a.arrayIndex]),l>_)return[new bt(o,l,`${l} is greater than the maximum value ${_}`)]}return[]}function ac(a){const o=a.valueSpec,l=fr(a.value.type);let d,p,_,v={};const w="categorical"!==l&&void 0===a.value.property,D=!w,S="array"===tn(a.value.stops)&&"array"===tn(a.value.stops[0])&&"object"===tn(a.value.stops[0][0]),k=qo({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(B){if("identity"===l)return[new bt(B.key,B.value,'identity function may not have a "stops" property')];let z=[];const j=B.value;return z=z.concat($n({key:B.key,value:j,valueSpec:B.valueSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:P})),"array"===tn(j)&&0===j.length&&z.push(new bt(B.key,j,"array must have at least one stop")),z},default:function(B){return Gr({key:B.key,value:B.value,valueSpec:o,style:B.style,styleSpec:B.styleSpec})}}});return"identity"===l&&w&&k.push(new bt(a.key,a.value,'missing required property "property"')),"identity"===l||a.value.stops||k.push(new bt(a.key,a.value,'missing required property "stops"')),"exponential"===l&&a.valueSpec.expression&&!ma(a.valueSpec)&&k.push(new bt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(D&&!ki(a.valueSpec)?k.push(new bt(a.key,a.value,"property functions not supported")):w&&!Go(a.valueSpec)&&k.push(new bt(a.key,a.value,"zoom functions not supported"))),"categorical"!==l&&!S||void 0!==a.value.property||k.push(new bt(a.key,a.value,'"property" property is required')),k;function P(B){let z=[];const j=B.value,Y=B.key;if("array"!==tn(j))return[new bt(Y,j,`array expected, ${tn(j)} found`)];if(2!==j.length)return[new bt(Y,j,`array length 2 expected, length ${j.length} found`)];if(S){if("object"!==tn(j[0]))return[new bt(Y,j,`object expected, ${tn(j[0])} found`)];if(void 0===j[0].zoom)return[new bt(Y,j,"object stop key must have zoom")];if(void 0===j[0].value)return[new bt(Y,j,"object stop key must have value")];const te=fr(j[0].zoom);if("number"!=typeof te)return[new bt(Y,j[0].zoom,"stop zoom values must be numbers")];if(_&&_>te)return[new bt(Y,j[0].zoom,"stop zoom values must appear in ascending order")];te!==_&&(_=te,p=void 0,v={}),z=z.concat(qo({key:`${Y}[0]`,value:j[0],valueSpec:{zoom:{}},style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:wh,value:F}}))}else z=z.concat(F({key:`${Y}[0]`,value:j[0],valueSpec:{},style:B.style,styleSpec:B.styleSpec},j));return ya(kr(j[1]))?z.concat([new bt(`${Y}[1]`,j[1],"expressions are not allowed in function stops.")]):z.concat(Gr({key:`${Y}[1]`,value:j[1],valueSpec:o,style:B.style,styleSpec:B.styleSpec}))}function F(B,z){const j=tn(B.value),Y=fr(B.value),te=null!==B.value?B.value:z;if(d){if(j!==d)return[new bt(B.key,te,`${j} stop domain type must match previous stop domain type ${d}`)]}else d=j;if("number"!==j&&"string"!==j&&"boolean"!==j&&"number"!=typeof Y&&"string"!=typeof Y&&"boolean"!=typeof Y)return[new bt(B.key,te,"stop domain value must be a number, string, or boolean")];if("number"!==j&&"categorical"!==l){let ce=`number expected, ${j} found`;return ki(o)&&void 0===l&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new bt(B.key,te,ce)]}return"categorical"!==l||"number"!==j||"number"==typeof Y&&isFinite(Y)&&Math.floor(Y)===Y?"categorical"!==l&&"number"===j&&"number"==typeof Y&&"number"==typeof p&&void 0!==p&&Y<p?[new bt(B.key,te,"stop domain values must appear in ascending order")]:(p=Y,"categorical"===l&&Y in v?[new bt(B.key,te,"stop domain values must be unique")]:(v[Y]=!0,[])):[new bt(B.key,te,`integer expected, found ${String(Y)}`)]}}function Cr(a){const o=("property"===a.expressionContext?td:Js)(kr(a.value),a.valueSpec);if("error"===o.result)return o.value.map(d=>new bt(`${a.key}${d.key}`,a.value,d.message));const l=o.value.expression||o.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!l.outputDefined())return[new bt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Va(l))return[new bt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext)return Wo(l,a);if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!jo(l,["zoom","feature-state"]))return[new bt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!Ys(l))return[new bt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wo(a,o){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const p of o.valueSpec.expression.parameters)l.delete(p);if(0===l.size)return[];const d=[];return a instanceof Zs&&l.has(a.name)?[new bt(o.key,o.value,`["${a.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(a.eachChild(p=>{d.push(...Wo(p,o))}),d)}function lc(a){const o=a.key,l=a.value,d=a.valueSpec,p=[];return Array.isArray(d.values)?-1===d.values.indexOf(fr(l))&&p.push(new bt(o,l,`expected one of [${d.values.join(", ")}], ${JSON.stringify(l)} found`)):-1===Object.keys(d.values).indexOf(fr(l))&&p.push(new bt(o,l,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(l)} found`)),p}function xl(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const o of a.slice(1))if(!xl(o)&&"boolean"!=typeof o)return!1;return!0;default:return!0}}function wl(a,o="fill"){if(null==a)return{filter:()=>!0,needGeometry:!1,needFeature:!1};xl(a)||(a=$a(a));const l=a;let d=!0;try{d=function(S){if(!Or(S))return S;let k=kr(S);return Wp(k),k=Pr(k),k}(l)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(l,null,2)}\n        `)}const p=ze[`filter_${o}`],_=Js(d,p);let v=null;if("error"===_.result)throw new Error(_.value.map(S=>`${S.key}: ${S.message}`).join(", "));v=(S,k,P)=>_.value.evaluate(S,k,{},P);let w=null,D=null;if(d!==l){const S=Js(l,p);if("error"===S.result)throw new Error(S.value.map(k=>`${k.key}: ${k.message}`).join(", "));w=(k,P,F,B,z)=>S.value.evaluate(k,P,{},F,void 0,void 0,B,z),D=!Ys(S.value.expression)}return{filter:v,dynamicFilter:w||void 0,needGeometry:Cl(d),needFeature:!!D}}function Pr(a){if(!Array.isArray(a))return a;const o=function(l){if(lo.has(l[0]))for(let d=1;d<l.length;d++)if(Or(l[d]))return!0;return l}(a);return!0===o?o:o.map(l=>Pr(l))}function Wp(a){let o=!1;const l=[];if("case"===a[0]){for(let d=1;d<a.length-1;d+=2)o=o||Or(a[d]),l.push(a[d+1]);l.push(a[a.length-1])}else if("match"===a[0]){o=o||Or(a[1]);for(let d=2;d<a.length-1;d+=2)l.push(a[d+1]);l.push(a[a.length-1])}else if("step"===a[0]){o=o||Or(a[1]);for(let d=1;d<a.length-1;d+=2)l.push(a[d+1])}o&&(a.length=0,a.push("any",...l));for(let d=1;d<a.length;d++)Wp(a[d])}function Or(a){if(!Array.isArray(a))return!1;if("pitch"===(o=a[0])||"distance-from-center"===o)return!0;var o;for(let l=1;l<a.length;l++)if(Or(a[l]))return!0;return!1}const lo=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Zp(a,o){return a<o?-1:a>o?1:0}function Cl(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let o=1;o<a.length;o++)if(Cl(a[o]))return!0;return!1}function $a(a){if(!a)return!0;const o=a[0];return a.length<=1?"any"!==o:"=="===o?us(a[1],a[2],"=="):"!="===o?Xp(us(a[1],a[2],"==")):"<"===o||">"===o||"<="===o||">="===o?us(a[1],a[2],o):"any"===o?(l=a.slice(1),["any"].concat(l.map($a))):"all"===o?["all"].concat(a.slice(1).map($a)):"none"===o?["all"].concat(a.slice(1).map($a).map(Xp)):"in"===o?eu(a[1],a.slice(2)):"!in"===o?Xp(eu(a[1],a.slice(2))):"has"===o?Yp(a[1]):"!has"===o?Xp(Yp(a[1])):"within"!==o||a;var l}function us(a,o,l){switch(a){case"$type":return[`filter-type-${l}`,o];case"$id":return[`filter-id-${l}`,o];default:return[`filter-${l}`,a,o]}}function eu(a,o){if(0===o.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(l=>typeof l!=typeof o[0])?["filter-in-large",a,["literal",o.sort(Zp)]]:["filter-in-small",a,["literal",o]]}}function Yp(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Xp(a){return["!",a]}function tu(a){return xl(kr(a.value))?Cr(da({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):nu(a)}function nu(a){const o=a.value,l=a.key;if("array"!==tn(o))return[new bt(l,o,`array expected, ${tn(o)} found`)];const d=a.styleSpec;let p,_=[];if(o.length<1)return[new bt(l,o,"filter array must have at least 1 element")];switch(_=_.concat(lc({key:`${l}[0]`,value:o[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),fr(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"===fr(o[1])&&_.push(new bt(l,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":3!==o.length&&_.push(new bt(l,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(p=tn(o[1]),"string"!==p&&_.push(new bt(`${l}[1]`,o[1],`string expected, ${p} found`)));for(let v=2;v<o.length;v++)p=tn(o[v]),"$type"===fr(o[1])?_=_.concat(lc({key:`${l}[${v}]`,value:o[v],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==p&&"number"!==p&&"boolean"!==p&&_.push(new bt(`${l}[${v}]`,o[v],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let v=1;v<o.length;v++)_=_.concat(nu({key:`${l}[${v}]`,value:o[v],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":p=tn(o[1]),2!==o.length?_.push(new bt(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):"string"!==p&&_.push(new bt(`${l}[1]`,o[1],`string expected, ${p} found`));break;case"within":p=tn(o[1]),2!==o.length?_.push(new bt(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):"object"!==p&&_.push(new bt(`${l}[1]`,o[1],`object expected, ${p} found`))}return _}function zm(a,o){const l=a.key,d=a.style,p=a.styleSpec,_=a.value,v=a.objectKey,w=p[`${o}_${a.layerType}`];if(!w)return[];const D=v.match(/^(.*)-transition$/);if("paint"===o&&D&&w[D[1]]&&w[D[1]].transition)return Gr({key:l,value:_,valueSpec:p.transition,style:d,styleSpec:p});const S=a.valueSpec||w[v];if(!S)return[new bt(l,_,`unknown property "${v}"`)];let k;if("string"===tn(_)&&ki(S)&&!S.tokens&&(k=/^{([^}]+)}$/.exec(_))){const F=`\`{ "type": "identity", "property": ${k?JSON.stringify(k[1]):'"_"'} }\``;return[new bt(l,_,`"${v}" does not support interpolation syntax\nUse an identity property function instead: ${F}.`)]}const P=[];return"symbol"===a.layerType&&("text-field"===v&&d&&!d.glyphs&&P.push(new bt(l,_,'use of "text-field" requires a style "glyphs" property')),"text-font"===v&&ga(kr(_))&&"identity"===fr(_.type)&&P.push(new bt(l,_,'"text-font" does not support identity functions'))),P.concat(Gr({key:a.key,value:_,valueSpec:S,style:d,styleSpec:p,expressionContext:"property",propertyType:o,propertyKey:v}))}function W_(a){return zm(a,"paint")}function Vm(a){return zm(a,"layout")}function Z_(a){let o=[];const l=a.value,d=a.key,p=a.style,_=a.styleSpec;l.type||l.ref||o.push(new bt(d,l,'either "type" or "ref" is required'));let v=fr(l.type);const w=fr(l.ref);if(l.id){const D=fr(l.id);for(let S=0;S<a.arrayIndex;S++){const k=p.layers[S];fr(k.id)===D&&o.push(new bt(d,l.id,`duplicate layer id "${l.id}", previously used at line ${k.id.__line__}`))}}if("ref"in l){let D;["type","source","source-layer","filter","layout"].forEach(S=>{S in l&&o.push(new bt(d,l[S],`"${S}" is prohibited for ref layers`))}),p.layers.forEach(S=>{fr(S.id)===w&&(D=S)}),D?D.ref?o.push(new bt(d,l.ref,"ref cannot reference another ref layer")):v=fr(D.type):"string"==typeof w&&o.push(new bt(d,l.ref,`ref layer "${w}" not found`))}else if("background"!==v&&"sky"!==v)if(l.source){const D=p.sources&&p.sources[l.source],S=D&&fr(D.type);D?"vector"===S&&"raster"===v?o.push(new bt(d,l.source,`layer "${l.id}" requires a raster source`)):"raster"===S&&"raster"!==v?o.push(new bt(d,l.source,`layer "${l.id}" requires a vector source`)):"vector"!==S||l["source-layer"]?"raster-dem"===S&&"hillshade"!==v?o.push(new bt(d,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==v||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||"geojson"===S&&D.lineMetrics||o.push(new bt(d,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new bt(d,l,`layer "${l.id}" must specify a "source-layer"`)):o.push(new bt(d,l.source,`source "${l.source}" not found`))}else o.push(new bt(d,l,'missing required property "source"'));return o=o.concat(qo({key:d,value:l,valueSpec:_.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Gr({key:`${d}.type`,value:l.type,valueSpec:_.layer.type,style:a.style,styleSpec:a.styleSpec,object:l,objectKey:"type"}),filter:D=>tu(da({layerType:v},D)),layout:D=>qo({layer:l,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":S=>Vm(da({layerType:v},S))}}),paint:D=>qo({layer:l,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":S=>W_(da({layerType:v},S))}})}})),o}function cc(a){const o=a.value,l=a.key,d=tn(o);return"string"!==d?[new bt(l,o,`string expected, ${d} found`)]:[]}const Y_={promoteId:function({key:a,value:o}){if("string"===tn(o))return cc({key:a,value:o});{const l=[];for(const d in o)l.push(...cc({key:`${a}.${d}`,value:o[d]}));return l}}};function X_(a){const o=a.value,l=a.key,d=a.styleSpec,p=a.style;if(!o.type)return[new bt(l,o,'"type" is required')];const _=fr(o.type);let v;switch(_){case"vector":case"raster":case"raster-dem":return v=qo({key:l,value:o,valueSpec:d[`source_${_.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:Y_}),v;case"geojson":if(v=qo({key:l,value:o,valueSpec:d.source_geojson,style:p,styleSpec:d,objectElementValidators:Y_}),o.cluster)for(const w in o.clusterProperties){const[D,S]=o.clusterProperties[w],k="string"==typeof D?[D,["accumulated"],["get",w]]:D;v.push(...Cr({key:`${l}.${w}.map`,value:S,expressionContext:"cluster-map"})),v.push(...Cr({key:`${l}.${w}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return v;case"video":return qo({key:l,value:o,valueSpec:d.source_video,style:p,styleSpec:d});case"image":return qo({key:l,value:o,valueSpec:d.source_image,style:p,styleSpec:d});case"canvas":return[new bt(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return lc({key:`${l}.type`,value:o.type,valueSpec:{values:Yb(d)},style:p,styleSpec:d})}}function Yb(a){return a.source.reduce((o,l)=>{const d=a[l];return"enum"===d.type.type&&(o=o.concat(Object.keys(d.type.values))),o},[])}function K_(a){const o=a.value,l=a.styleSpec,d=l.light,p=a.style;let _=[];const v=tn(o);if(void 0===o)return _;if("object"!==v)return _=_.concat([new bt("light",o,`object expected, ${v} found`)]),_;for(const w in o){const D=w.match(/^(.*)-transition$/);_=_.concat(D&&d[D[1]]&&d[D[1]].transition?Gr({key:w,value:o[w],valueSpec:l.transition,style:p,styleSpec:l}):d[w]?Gr({key:w,value:o[w],valueSpec:d[w],style:p,styleSpec:l}):[new bt(w,o[w],`unknown property "${w}"`)])}return _}function Um(a){const o=a.value,l=a.key,d=a.style,p=a.styleSpec,_=p.terrain;let v=[];const w=tn(o);if(void 0===o)return v;if("object"!==w)return v=v.concat([new bt("terrain",o,`object expected, ${w} found`)]),v;for(const D in o){const S=D.match(/^(.*)-transition$/);v=v.concat(S&&_[S[1]]&&_[S[1]].transition?Gr({key:D,value:o[D],valueSpec:p.transition,style:d,styleSpec:p}):_[D]?Gr({key:D,value:o[D],valueSpec:_[D],style:d,styleSpec:p}):[new bt(D,o[D],`unknown property "${D}"`)])}if(o.source){const D=d.sources&&d.sources[o.source],S=D&&fr(D.type);D?"raster-dem"!==S&&v.push(new bt(l,o.source,`terrain cannot be used with a source of type ${String(S)}, it only be used with a "raster-dem" source type`)):v.push(new bt(l,o.source,`source "${o.source}" not found`))}else v.push(new bt(l,o,'terrain is missing required property "source"'));return v}function J_(a){const o=a.value,l=a.style,d=a.styleSpec,p=d.fog;let _=[];const v=tn(o);if(void 0===o)return _;if("object"!==v)return _=_.concat([new bt("fog",o,`object expected, ${v} found`)]),_;for(const w in o){const D=w.match(/^(.*)-transition$/);_=_.concat(D&&p[D[1]]&&p[D[1]].transition?Gr({key:w,value:o[w],valueSpec:d.transition,style:l,styleSpec:d}):p[w]?Gr({key:w,value:o[w],valueSpec:p[w],style:l,styleSpec:d}):[new bt(w,o[w],`unknown property "${w}"`)])}return _}const Q_={"*":()=>[],array:$n,boolean:function(a){const o=a.value,l=a.key,d=tn(o);return"boolean"!==d?[new bt(l,o,`boolean expected, ${d} found`)]:[]},number:wh,color:function(a){const o=a.key,l=a.value,d=tn(l);return"string"!==d?[new bt(o,l,`color expected, ${d} found`)]:null===Sm(l)?[new bt(o,l,`color expected, "${l}" found`)]:[]},enum:lc,filter:tu,function:ac,layer:Z_,object:qo,source:X_,light:K_,terrain:Um,fog:J_,string:cc,formatted:function(a){return 0===cc(a).length?[]:Cr(a)},resolvedImage:function(a){return 0===cc(a).length?[]:Cr(a)},projection:function(a){const o=a.value,l=a.styleSpec,d=l.projection,p=a.style;let _=[];const v=tn(o);if("object"===v)for(const w in o)_=_.concat(Gr({key:w,value:o[w],valueSpec:d[w],style:p,styleSpec:l}));else"string"!==v&&(_=_.concat([new bt("projection",o,`object or string expected, ${v} found`)]));return _}};function Gr(a){const o=a.value,l=a.valueSpec,d=a.styleSpec;return l.expression&&ga(fr(o))?ac(a):l.expression&&ya(kr(o))?Cr(a):l.type&&Q_[l.type]?Q_[l.type](a):qo(da({},a,{valueSpec:l.type?d[l.type]:l}))}function jm(a){const o=a.value,l=a.key,d=cc(a);return d.length||(-1===o.indexOf("{fontstack}")&&d.push(new bt(l,o,'"glyphs" url must include a "{fontstack}" token')),-1===o.indexOf("{range}")&&d.push(new bt(l,o,'"glyphs" url must include a "{range}" token'))),d}function ey(a,o=ze){return Fr(Gr({key:"",value:a,valueSpec:o.$root,styleSpec:o,style:a,objectElementValidators:{glyphs:jm,"*":()=>[]}}))}const Xb=a=>Fr(W_(a)),Kb=a=>Fr(Vm(a));function Fr(a){return a.slice().sort((o,l)=>o.line&&l.line?o.line-l.line:0)}function Kp(a,o){let l=!1;if(o&&o.length)for(const d of o)a.fire(new Ba(new Error(d.message))),l=!0;return l}var Jb=ea,hs=3;function ea(a,o,l){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var p=new Int32Array(this.arrayBuffer);a=p[0],this.d=(o=p[1])+2*(l=p[2]);for(var _=0;_<this.d*this.d;_++){var v=p[hs+_],w=p[hs+_+1];d.push(v===w?null:p.subarray(v,w))}var D=p[hs+d.length+1];this.keys=p.subarray(p[hs+d.length],D),this.bboxes=p.subarray(D),this.insert=this._insertReadonly}else{this.d=o+2*l;for(var S=0;S<this.d*this.d;S++)d.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=a,this.padding=l,this.scale=o/a,this.uid=0;var k=l/o*a;this.min=-k,this.max=a+k}ea.prototype.insert=function(a,o,l,d,p){this._forEachCell(o,l,d,p,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(p)},ea.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ea.prototype._insertCell=function(a,o,l,d,p,_){this.cells[p].push(_)},ea.prototype.query=function(a,o,l,d,p){var _=this.min,v=this.max;if(a<=_&&o<=_&&v<=l&&v<=d&&!p)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(a,o,l,d,this._queryCell,w,{},p),w},ea.prototype._queryCell=function(a,o,l,d,p,_,v,w){var D=this.cells[p];if(null!==D)for(var S=this.keys,k=this.bboxes,P=0;P<D.length;P++){var F=D[P];if(void 0===v[F]){var B=4*F;(w?w(k[B+0],k[B+1],k[B+2],k[B+3]):a<=k[B+2]&&o<=k[B+3]&&l>=k[B+0]&&d>=k[B+1])?(v[F]=!0,_.push(S[F])):v[F]=!1}}},ea.prototype._forEachCell=function(a,o,l,d,p,_,v,w){for(var D=this._convertToCellCoord(a),S=this._convertToCellCoord(o),k=this._convertToCellCoord(l),P=this._convertToCellCoord(d),F=D;F<=k;F++)for(var B=S;B<=P;B++){var z=this.d*B+F;if((!w||w(this._convertFromCellCoord(F),this._convertFromCellCoord(B),this._convertFromCellCoord(F+1),this._convertFromCellCoord(B+1)))&&p.call(this,a,o,l,d,z,_,v,w))return}},ea.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},ea.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},ea.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,o=hs+this.cells.length+1+1,l=0,d=0;d<this.cells.length;d++)l+=this.cells[d].length;var p=new Int32Array(o+l+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var _=o,v=0;v<a.length;v++){var w=a[v];p[hs+v]=_,p.set(w,_),_+=w.length}return p[hs+a.length]=_,p.set(this.keys,_),p[hs+a.length+1]=_+=this.keys.length,p.set(this.bboxes,_),_+=this.bboxes.length,p.buffer};var dc=xo(Jb);const Ch={};function Dt(a,o,l={}){Object.defineProperty(a,"_classRegistryKey",{value:o,writeable:!1}),Ch[o]={klass:a,omit:l.omit||[]}}Dt(Object,"Object"),dc.serialize=function(a,o){const l=a.toArrayBuffer();return o&&o.push(l),{buffer:l}},dc.deserialize=function(a){return new dc(a.buffer)},Object.defineProperty(dc,"name",{value:"Grid"}),Dt(dc,"Grid"),Dt(Di,"Color"),Dt(Error,"Error"),Dt(ml,"AJAXError"),Dt(Ws,"ResolvedImage"),Dt(Qs,"StylePropertyFunction"),Dt(nr,"StyleExpression",{omit:["_evaluator"]}),Dt(Ha,"ZoomDependentExpression"),Dt(As,"ZoomConstantExpression"),Dt(Zs,"CompoundExpression",{omit:["_evaluate"]});for(const a in er)Ch[er[a]._classRegistryKey]||Dt(er[a],`Expression${a}`);function Hm(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function Jp(a){return Ie.ImageBitmap&&a instanceof Ie.ImageBitmap}function To(a,o){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Hm(a)||Jp(a))return o&&o.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return o&&o.push(l.buffer),l}if(a instanceof Ie.ImageData)return o&&o.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const d of a)l.push(To(d,o));return l}if("object"==typeof a){const l=a.constructor,d=l._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const p=l.serialize?l.serialize(a,o):{};if(!l.serialize){for(const _ in a)a.hasOwnProperty(_)&&(Ch[d].omit.indexOf(_)>=0||(p[_]=To(a[_],o)));a instanceof Error&&(p.message=a.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==d&&(p.$name=d),p}throw new Error("can't serialize object of type "+typeof a)}function va(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Hm(a)||Jp(a)||ArrayBuffer.isView(a)||a instanceof Ie.ImageData)return a;if(Array.isArray(a))return a.map(va);if("object"==typeof a){const o=a.$name||"Object",{klass:l}=Ch[o];if(!l)throw new Error(`can't deserialize unregistered class ${o}`);if(l.deserialize)return l.deserialize(a);const d=Object.create(l.prototype);for(const p of Object.keys(a))"$name"!==p&&(d[p]=va(a[p]));return d}throw new Error("can't deserialize object of type "+typeof a)}const dt={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Eh(a){for(const o of a)if(iu(o.charCodeAt(0)))return!0;return!1}function Qb(a){for(const o of a)if(!Dh(o.charCodeAt(0)))return!1;return!0}function Dh(a){return!(dt.Arabic(a)||dt["Arabic Supplement"](a)||dt["Arabic Extended-A"](a)||dt["Arabic Presentation Forms-A"](a)||dt["Arabic Presentation Forms-B"](a))}function iu(a){return!(746!==a&&747!==a&&(a<4352||!(dt["Bopomofo Extended"](a)||dt.Bopomofo(a)||dt["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||dt["CJK Compatibility Ideographs"](a)||dt["CJK Compatibility"](a)||dt["CJK Radicals Supplement"](a)||dt["CJK Strokes"](a)||!(!dt["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||dt["CJK Unified Ideographs Extension A"](a)||dt["CJK Unified Ideographs"](a)||dt["Enclosed CJK Letters and Months"](a)||dt["Hangul Compatibility Jamo"](a)||dt["Hangul Jamo Extended-A"](a)||dt["Hangul Jamo Extended-B"](a)||dt["Hangul Jamo"](a)||dt["Hangul Syllables"](a)||dt.Hiragana(a)||dt["Ideographic Description Characters"](a)||dt.Kanbun(a)||dt["Kangxi Radicals"](a)||dt["Katakana Phonetic Extensions"](a)||dt.Katakana(a)&&12540!==a||!(!dt["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!dt["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||dt["Unified Canadian Aboriginal Syllabics"](a)||dt["Unified Canadian Aboriginal Syllabics Extended"](a)||dt["Vertical Forms"](a)||dt["Yijing Hexagram Symbols"](a)||dt["Yi Syllables"](a)||dt["Yi Radicals"](a))))}function ru(a){return!(iu(a)||(o=a,dt["Latin-1 Supplement"](o)&&(167===o||169===o||174===o||177===o||188===o||189===o||190===o||215===o||247===o)||dt["General Punctuation"](o)&&(8214===o||8224===o||8225===o||8240===o||8241===o||8251===o||8252===o||8258===o||8263===o||8264===o||8265===o||8273===o)||dt["Letterlike Symbols"](o)||dt["Number Forms"](o)||dt["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||9003===o||o>=9085&&o<=9114||o>=9150&&o<=9165||9167===o||o>=9169&&o<=9179||o>=9186&&o<=9215)||dt["Control Pictures"](o)&&9251!==o||dt["Optical Character Recognition"](o)||dt["Enclosed Alphanumerics"](o)||dt["Geometric Shapes"](o)||dt["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||dt["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||dt["CJK Symbols and Punctuation"](o)||dt.Katakana(o)||dt["Private Use Area"](o)||dt["CJK Compatibility Forms"](o)||dt["Small Form Variants"](o)||dt["Halfwidth and Fullwidth Forms"](o)||8734===o||8756===o||8757===o||o>=9984&&o<=10087||o>=10102&&o<=10131||65532===o||65533===o));var o}function $m(a){return a>=1424&&a<=2303||dt["Arabic Presentation Forms-A"](a)||dt["Arabic Presentation Forms-B"](a)}function e0(a,o){return!(!o&&$m(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||dt.Khmer(a))}function Gm(a){for(const o of a)if($m(o.charCodeAt(0)))return!0;return!1}const ou="deferred",Qp="loading",nd="loaded";let id=null,g="unavailable",c=null;const h=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(g="error"),id&&id(a)};function y(){x.fire(new ec("pluginStateChange",{pluginStatus:g,pluginURL:c}))}const x=new Gd,C=function(){return g},M=function(){if(g!==ou||!c)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");g=Qp,y(),c&&zc({url:c},a=>{a?h(a):(g=nd,y())})},I={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>g===nd||null!=I.applyArabicShaping,isLoading:()=>g===Qp,setState(a){g=a.pluginStatus,c=a.pluginURL},isParsed:()=>null!=I.applyArabicShaping&&null!=I.processBidirectionalText&&null!=I.processStyledBidirectionalText,getPluginURL:()=>c};class R{constructor(o,l){this.zoom=o,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(o){return function(l,d){for(const p of l)if(!e0(p.charCodeAt(0),d))return!1;return!0}(o,I.isLoaded())}}class N{constructor(o,l){this.property=o,this.value=l,this.expression=function(d,p){if(ga(d))return new Qs(d,p);if(ya(d)){const _=td(d,p);if("error"===_.result)throw new Error(_.value.map(v=>`${v.key}: ${v.message}`).join(", "));return _.value}{let _=d;return"string"==typeof d&&"color"===p.type&&(_=Di.parse(d)),{kind:"constant",evaluate:()=>_}}}(void 0===l?o.specification.default:l,o.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(o,l,d){return this.property.possiblyEvaluate(this,o,l,d)}}class L{constructor(o){this.property=o,this.value=new N(o,void 0)}transitioned(o,l){return new W(this.property,this.value,l,Oi({},o.transition,this.transition),o.now)}untransitioned(){return new W(this.property,this.value,null,{},0)}}class V{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return ss(this._values[o].value.value)}setValue(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new L(this._values[o].property)),this._values[o].value=new N(this._values[o].property,null===l?void 0:ss(l))}getTransition(o){return ss(this._values[o].transition)}setTransition(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new L(this._values[o].property)),this._values[o].transition=ss(l)||void 0}serialize(){const o={};for(const l of Object.keys(this._values)){const d=this.getValue(l);void 0!==d&&(o[l]=d);const p=this.getTransition(l);void 0!==p&&(o[`${l}-transition`]=p)}return o}transitioned(o,l){const d=new X(this._properties);for(const p of Object.keys(this._values))d._values[p]=this._values[p].transitioned(o,l._values[p]);return d}untransitioned(){const o=new X(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].untransitioned();return o}}class W{constructor(o,l,d,p,_){const v=p.delay||0,w=p.duration||0;_=_||0,this.property=o,this.value=l,this.begin=_+v,this.end=this.begin+w,o.specification.transition&&(p.delay||p.duration)&&(this.prior=d)}possiblyEvaluate(o,l,d){const p=o.now||0,_=this.value.possiblyEvaluate(o,l,d),v=this.prior;if(v){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return v.possiblyEvaluate(o,l,d);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(o,l,d),_,ul(w))}}return _}}class X{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,l,d){const p=new ee(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(o,l,d);return p}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class Q{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return ss(this._values[o].value)}setValue(o,l){this._values[o]=new N(this._values[o].property,null===l?void 0:ss(l))}serialize(){const o={};for(const l of Object.keys(this._values)){const d=this.getValue(l);void 0!==d&&(o[l]=d)}return o}possiblyEvaluate(o,l,d){const p=new ee(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(o,l,d);return p}}class K{constructor(o,l,d){this.property=o,this.value=l,this.parameters=d}isConstant(){return"constant"===this.value.kind}constantOr(o){return"constant"===this.value.kind?this.value.value:o}evaluate(o,l,d,p){return this.property.evaluate(this.value,this.parameters,o,l,d,p)}}class ee{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class U{constructor(o){this.specification=o}possiblyEvaluate(o,l){return o.expression.evaluate(l)}interpolate(o,l,d){const p=Kd[this.specification.type];return p?p(o,l,d):o}}class Z{constructor(o,l){this.specification=o,this.overrides=l}possiblyEvaluate(o,l,d,p){return new K(this,"constant"===o.expression.kind||"camera"===o.expression.kind?{kind:"constant",value:o.expression.evaluate(l,null,{},d,p)}:o.expression,l)}interpolate(o,l,d){if("constant"!==o.value.kind||"constant"!==l.value.kind)return o;if(void 0===o.value.value||void 0===l.value.value)return new K(this,{kind:"constant",value:void 0},o.parameters);const p=Kd[this.specification.type];return p?new K(this,{kind:"constant",value:p(o.value.value,l.value.value,d)},o.parameters):o}evaluate(o,l,d,p,_,v){return"constant"===o.kind?o.value:o.evaluate(l,d,p,_,v)}}class ie{constructor(o){this.specification=o}possiblyEvaluate(o,l,d,p){return!!o.expression.evaluate(l,null,{},d,p)}interpolate(){return!1}}class re{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new R(0,{});for(const d in o){const p=o[d];p.specification.overridable&&this.overridableProperties.push(d);const _=this.defaultPropertyValues[d]=new N(p,void 0),v=this.defaultTransitionablePropertyValues[d]=new L(p);this.defaultTransitioningPropertyValues[d]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=_.possiblyEvaluate(l)}}}function ue(a,o){return 256*(a=wt(Math.floor(a),0,255))+wt(Math.floor(o),0,255)}Dt(Z,"DataDrivenProperty"),Dt(U,"DataConstantProperty"),Dt(ie,"ColorRampProperty");const ge={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class me{constructor(o,l){this._structArray=o,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class be{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,l){return o._trim(),l&&(o.isTransferred=!0,l.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const l=Object.create(this.prototype);return l.arrayBuffer=o.arrayBuffer,l.length=o.length,l.capacity=o.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ve(a,o=1){let l=0,d=0;return{members:a.map(p=>{const _=ge[p.type].BYTES_PER_ELEMENT,v=l=Ae(l,Math.max(o,_)),w=p.components||1;return d=Math.max(d,_),l+=_*w,{name:p.name,type:p.type,components:w,offset:v}}),size:Ae(l,Math.max(d,o)),alignment:o}}function Ae(a,o){return Math.ceil(a/o)*o}class Je extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.int16[p+0]=l,this.int16[p+1]=d,o}}Je.prototype.bytesPerElement=4,Dt(Je,"StructArrayLayout2i4");class De extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const _=3*o;return this.int16[_+0]=l,this.int16[_+1]=d,this.int16[_+2]=p,o}}De.prototype.bytesPerElement=6,Dt(De,"StructArrayLayout3i6");class Ve extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const v=4*o;return this.int16[v+0]=l,this.int16[v+1]=d,this.int16[v+2]=p,this.int16[v+3]=_,o}}Ve.prototype.bytesPerElement=8,Dt(Ve,"StructArrayLayout4i8");class Re extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,v,w){const D=this.length;return this.resize(D+1),this.emplace(D,o,l,d,p,_,v,w)}emplace(o,l,d,p,_,v,w,D){const S=6*o,k=12*o,P=3*o;return this.int16[S+0]=l,this.int16[S+1]=d,this.uint8[k+4]=p,this.uint8[k+5]=_,this.uint8[k+6]=v,this.uint8[k+7]=w,this.float32[P+2]=D,o}}Re.prototype.bytesPerElement=12,Dt(Re,"StructArrayLayout2i4ub1f12");class Qe extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const v=4*o;return this.float32[v+0]=l,this.float32[v+1]=d,this.float32[v+2]=p,this.float32[v+3]=_,o}}Qe.prototype.bytesPerElement=16,Dt(Qe,"StructArrayLayout4f16");class Me extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,o,l,d,p,_)}emplace(o,l,d,p,_,v){const w=6*o,D=3*o;return this.uint16[w+0]=l,this.uint16[w+1]=d,this.uint16[w+2]=p,this.uint16[w+3]=_,this.float32[D+2]=v,o}}Me.prototype.bytesPerElement=12,Dt(Me,"StructArrayLayout4ui1f12");class $e extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const v=4*o;return this.uint16[v+0]=l,this.uint16[v+1]=d,this.uint16[v+2]=p,this.uint16[v+3]=_,o}}$e.prototype.bytesPerElement=8,Dt($e,"StructArrayLayout4ui8");class tt extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,d,p,_,v)}emplace(o,l,d,p,_,v,w){const D=6*o;return this.int16[D+0]=l,this.int16[D+1]=d,this.int16[D+2]=p,this.int16[D+3]=_,this.int16[D+4]=v,this.int16[D+5]=w,o}}tt.prototype.bytesPerElement=12,Dt(tt,"StructArrayLayout6i12");class We extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,v,w,D,S,k,P,F){const B=this.length;return this.resize(B+1),this.emplace(B,o,l,d,p,_,v,w,D,S,k,P,F)}emplace(o,l,d,p,_,v,w,D,S,k,P,F,B){const z=12*o;return this.int16[z+0]=l,this.int16[z+1]=d,this.int16[z+2]=p,this.int16[z+3]=_,this.uint16[z+4]=v,this.uint16[z+5]=w,this.uint16[z+6]=D,this.uint16[z+7]=S,this.int16[z+8]=k,this.int16[z+9]=P,this.int16[z+10]=F,this.int16[z+11]=B,o}}We.prototype.bytesPerElement=24,Dt(We,"StructArrayLayout4i4ui4i24");class Le extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,d,p,_,v)}emplace(o,l,d,p,_,v,w){const D=10*o,S=5*o;return this.int16[D+0]=l,this.int16[D+1]=d,this.int16[D+2]=p,this.float32[S+2]=_,this.float32[S+3]=v,this.float32[S+4]=w,o}}Le.prototype.bytesPerElement=20,Dt(Le,"StructArrayLayout3i3f20");class Pt extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint32[1*o+0]=l,o}}Pt.prototype.bytesPerElement=4,Dt(Pt,"StructArrayLayout1ul4");class nn extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,v,w,D,S,k,P,F,B){const z=this.length;return this.resize(z+1),this.emplace(z,o,l,d,p,_,v,w,D,S,k,P,F,B)}emplace(o,l,d,p,_,v,w,D,S,k,P,F,B,z){const j=20*o,Y=10*o;return this.int16[j+0]=l,this.int16[j+1]=d,this.int16[j+2]=p,this.int16[j+3]=_,this.int16[j+4]=v,this.float32[Y+3]=w,this.float32[Y+4]=D,this.float32[Y+5]=S,this.float32[Y+6]=k,this.int16[j+14]=P,this.uint32[Y+8]=F,this.uint16[j+18]=B,this.uint16[j+19]=z,o}}nn.prototype.bytesPerElement=40,Dt(nn,"StructArrayLayout5i4f1i1ul2ui40");class Mt extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,v,w){const D=this.length;return this.resize(D+1),this.emplace(D,o,l,d,p,_,v,w)}emplace(o,l,d,p,_,v,w,D){const S=8*o;return this.int16[S+0]=l,this.int16[S+1]=d,this.int16[S+2]=p,this.int16[S+4]=_,this.int16[S+5]=v,this.int16[S+6]=w,this.int16[S+7]=D,o}}Mt.prototype.bytesPerElement=16,Dt(Mt,"StructArrayLayout3i2i2i16");class Ut extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,o,l,d,p,_)}emplace(o,l,d,p,_,v){const w=4*o,D=8*o;return this.float32[w+0]=l,this.float32[w+1]=d,this.float32[w+2]=p,this.int16[D+6]=_,this.int16[D+7]=v,o}}Ut.prototype.bytesPerElement=16,Dt(Ut,"StructArrayLayout2f1f2i16");class On extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const v=12*o,w=3*o;return this.uint8[v+0]=l,this.uint8[v+1]=d,this.float32[w+1]=p,this.float32[w+2]=_,o}}On.prototype.bytesPerElement=12,Dt(On,"StructArrayLayout2ub2f12");class Sn extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const _=3*o;return this.float32[_+0]=l,this.float32[_+1]=d,this.float32[_+2]=p,o}}Sn.prototype.bytesPerElement=12,Dt(Sn,"StructArrayLayout3f12");class At extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const _=3*o;return this.uint16[_+0]=l,this.uint16[_+1]=d,this.uint16[_+2]=p,o}}At.prototype.bytesPerElement=6,Dt(At,"StructArrayLayout3ui6");class oi extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,v,w,D,S,k,P,F,B,z,j,Y,te,ce,ne,ae,pe){const he=this.length;return this.resize(he+1),this.emplace(he,o,l,d,p,_,v,w,D,S,k,P,F,B,z,j,Y,te,ce,ne,ae,pe)}emplace(o,l,d,p,_,v,w,D,S,k,P,F,B,z,j,Y,te,ce,ne,ae,pe,he){const Te=30*o,Se=15*o,Ue=60*o;return this.int16[Te+0]=l,this.int16[Te+1]=d,this.int16[Te+2]=p,this.float32[Se+2]=_,this.float32[Se+3]=v,this.uint16[Te+8]=w,this.uint16[Te+9]=D,this.uint32[Se+5]=S,this.uint32[Se+6]=k,this.uint32[Se+7]=P,this.uint16[Te+16]=F,this.uint16[Te+17]=B,this.uint16[Te+18]=z,this.float32[Se+10]=j,this.float32[Se+11]=Y,this.uint8[Ue+48]=te,this.uint8[Ue+49]=ce,this.uint8[Ue+50]=ne,this.uint32[Se+13]=ae,this.int16[Te+28]=pe,this.uint8[Ue+58]=he,o}}oi.prototype.bytesPerElement=60,Dt(oi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class mi extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,v,w,D,S,k,P,F,B,z,j,Y,te,ce,ne,ae,pe,he,Te,Se,Ue,nt,Fe,Ge,je,Xe){const lt=this.length;return this.resize(lt+1),this.emplace(lt,o,l,d,p,_,v,w,D,S,k,P,F,B,z,j,Y,te,ce,ne,ae,pe,he,Te,Se,Ue,nt,Fe,Ge,je,Xe)}emplace(o,l,d,p,_,v,w,D,S,k,P,F,B,z,j,Y,te,ce,ne,ae,pe,he,Te,Se,Ue,nt,Fe,Ge,je,Xe,lt){const Be=38*o,ft=19*o;return this.int16[Be+0]=l,this.int16[Be+1]=d,this.int16[Be+2]=p,this.float32[ft+2]=_,this.float32[ft+3]=v,this.int16[Be+8]=w,this.int16[Be+9]=D,this.int16[Be+10]=S,this.int16[Be+11]=k,this.int16[Be+12]=P,this.int16[Be+13]=F,this.uint16[Be+14]=B,this.uint16[Be+15]=z,this.uint16[Be+16]=j,this.uint16[Be+17]=Y,this.uint16[Be+18]=te,this.uint16[Be+19]=ce,this.uint16[Be+20]=ne,this.uint16[Be+21]=ae,this.uint16[Be+22]=pe,this.uint16[Be+23]=he,this.uint16[Be+24]=Te,this.uint16[Be+25]=Se,this.uint16[Be+26]=Ue,this.uint16[Be+27]=nt,this.uint16[Be+28]=Fe,this.uint32[ft+15]=Ge,this.float32[ft+16]=je,this.float32[ft+17]=Xe,this.float32[ft+18]=lt,o}}mi.prototype.bytesPerElement=76,Dt(mi,"StructArrayLayout3i2f6i15ui1ul3f76");class gi extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.float32[1*o+0]=l,o}}gi.prototype.bytesPerElement=4,Dt(gi,"StructArrayLayout1f4");class _i extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,o,l,d,p,_)}emplace(o,l,d,p,_,v){const w=5*o;return this.float32[w+0]=l,this.float32[w+1]=d,this.float32[w+2]=p,this.float32[w+3]=_,this.float32[w+4]=v,o}}_i.prototype.bytesPerElement=20,Dt(_i,"StructArrayLayout5f20");class co extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const v=6*o;return this.uint32[3*o+0]=l,this.uint16[v+2]=d,this.uint16[v+3]=p,this.uint16[v+4]=_,o}}co.prototype.bytesPerElement=12,Dt(co,"StructArrayLayout1ul3ui12");class qe extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.uint16[p+0]=l,this.uint16[p+1]=d,o}}qe.prototype.bytesPerElement=4,Dt(qe,"StructArrayLayout2ui4");class Mn extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint16[1*o+0]=l,o}}Mn.prototype.bytesPerElement=2,Dt(Mn,"StructArrayLayout1ui2");class ti extends be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.float32[p+0]=l,this.float32[p+1]=d,o}}ti.prototype.bytesPerElement=8,Dt(ti,"StructArrayLayout2f8");class on extends me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}on.prototype.size=40;class bn extends nn{get(o){return new on(this,o)}}Dt(bn,"CollisionBoxArray");class Yn extends me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}Yn.prototype.size=60;class Gi extends oi{get(o){return new Yn(this,o)}}Dt(Gi,"PlacedSymbolArray");class Ji extends me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(o){this._structArray.uint32[this._pos4+15]=o}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ji.prototype.size=76;class Si extends mi{get(o){return new Ji(this,o)}}Dt(Si,"SymbolInstanceArray");class uo extends gi{getoffsetX(o){return this.float32[1*o+0]}}Dt(uo,"GlyphOffsetArray");class Sh extends Je{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}Dt(Sh,"SymbolLineVertexArray");class rd extends me{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}rd.prototype.size=12;class od extends co{get(o){return new rd(this,o)}}Dt(od,"FeatureIndexArray");class ir extends qe{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}Dt(ir,"FillExtrusionCentroidArray");const ho=ve([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),El=ve([{name:"a_dash",components:4,type:"Uint16"}]);var Ga={exports:{}},t0=function(a,o){var l,d,p,_,v,w,D,S;for(d=a.length-(l=3&a.length),p=o,v=3432918353,w=461845907,S=0;S<d;)D=255&a.charCodeAt(S)|(255&a.charCodeAt(++S))<<8|(255&a.charCodeAt(++S))<<16|(255&a.charCodeAt(++S))<<24,++S,p=27492+(65535&(_=5*(65535&(p=(p^=D=(65535&(D=(D=(65535&D)*v+(((D>>>16)*v&65535)<<16)&4294967295)<<15|D>>>17))*w+(((D>>>16)*w&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(D=0,l){case 3:D^=(255&a.charCodeAt(S+2))<<16;case 2:D^=(255&a.charCodeAt(S+1))<<8;case 1:p^=D=(65535&(D=(D=(65535&(D^=255&a.charCodeAt(S)))*v+(((D>>>16)*v&65535)<<16)&4294967295)<<15|D>>>17))*w+(((D>>>16)*w&65535)<<16)&4294967295}return p^=a.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0},nC=function(a,o){for(var l,d=a.length,p=o^d,_=0;d>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(_)|(255&a.charCodeAt(++_))<<8|(255&a.charCodeAt(++_))<<16|(255&a.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),d-=4,++_;switch(d){case 3:p^=(255&a.charCodeAt(_+2))<<16;case 2:p^=(255&a.charCodeAt(_+1))<<8;case 1:p=1540483477*(65535&(p^=255&a.charCodeAt(_)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};Ga.exports=t0,Ga.exports.murmur3=t0,Ga.exports.murmur2=nC;var tf=xo(Ga.exports);class Mh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,l,d,p){this.ids.push(ny(o)),this.positions.push(l,d,p)}getPositions(o){const l=ny(o);let d=0,p=this.ids.length-1;for(;d<p;){const v=d+p>>1;this.ids[v]>=l?p=v:d=v+1}const _=[];for(;this.ids[d]===l;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(o,l){const d=new Float64Array(o.ids),p=new Uint32Array(o.positions);return nf(d,p,0,d.length-1),l&&l.push(d.buffer,p.buffer),{ids:d,positions:p}}static deserialize(o){const l=new Mh;return l.ids=o.ids,l.positions=o.positions,l.indexed=!0,l}}function ny(a){const o=+a;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:tf(String(a))}function nf(a,o,l,d){for(;l<d;){const p=a[l+d>>1];let _=l-1,v=d+1;for(;;){do{_++}while(a[_]<p);do{v--}while(a[v]>p);if(_>=v)break;qm(a,_,v),qm(o,3*_,3*v),qm(o,3*_+1,3*v+1),qm(o,3*_+2,3*v+2)}v-l<d-v?(nf(a,o,l,v),l=v+1):(nf(a,o,v+1,d),d=v)}}function qm(a,o,l){const d=a[o];a[o]=a[l],a[l]=d}Dt(Mh,"FeaturePositionMap");class Dl{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,l),this.initialized=!0),!!this.location}}class Th extends Dl{constructor(o){super(o),this.current=0}set(o,l,d){this.fetchUniformLocation(o,l)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class iy extends Dl{constructor(o){super(o),this.current=[0,0,0,0]}set(o,l,d){this.fetchUniformLocation(o,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class ry extends Dl{constructor(o){super(o),this.current=Di.transparent}set(o,l,d){this.fetchUniformLocation(o,l)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const n0=new Float32Array(16),r0=new Float32Array(9),oy=new Float32Array(4);function sy(a){return[ue(255*a.r,255*a.g),ue(255*a.b,255*a.a)]}class rf{constructor(o,l,d){this.value=o,this.uniformNames=l.map(p=>`u_${p}`),this.type=d}setUniform(o,l,d,p,_){l.set(o,_,p.constantOr(this.value))}getBinding(o,l){return"color"===this.type?new ry(o):new Th(o)}}class Lr{constructor(o,l){this.uniformNames=l.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,l,d,p,_){const v="u_pattern"===_||"u_dash"===_?this.pattern:"u_pixel_ratio"===_?this.pixelRatio:null;v&&l.set(o,_,v)}getBinding(o,l){return"u_pattern"===l||"u_dash"===l?new iy(o):new Th(o)}}class fs{constructor(o,l,d,p){this.expression=o,this.type=d,this.maxValue=0,this.paintVertexAttributes=l.map(_=>({name:`a_${_}`,type:"Float32",components:"color"===d?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(o,l,d,p,_,v){const w=this.paintVertexArray.length,D=this.expression.evaluate(new R(0),l,{},_,p,v);this.paintVertexArray.resize(o),this._setPaintValue(w,o,D)}updatePaintArray(o,l,d,p,_){const v=this.expression.evaluate({zoom:0},d,p,void 0,_);this._setPaintValue(o,l,v)}_setPaintValue(o,l,d){if("color"===this.type){const p=sy(d);for(let _=o;_<l;_++)this.paintVertexArray.emplace(_,p[0],p[1])}else{for(let p=o;p<l;p++)this.paintVertexArray.emplace(p,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ui{constructor(o,l,d,p,_,v){this.expression=o,this.uniformNames=l.map(w=>`u_${w}_t`),this.type=d,this.useIntegerZoom=p,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=l.map(w=>({name:`a_${w}`,type:"Float32",components:"color"===d?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(o,l,d,p,_,v){const w=this.expression.evaluate(new R(this.zoom),l,{},_,p,v),D=this.expression.evaluate(new R(this.zoom+1),l,{},_,p,v),S=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(S,o,w,D)}updatePaintArray(o,l,d,p,_){const v=this.expression.evaluate({zoom:this.zoom},d,p,void 0,_),w=this.expression.evaluate({zoom:this.zoom+1},d,p,void 0,_);this._setPaintValue(o,l,v,w)}_setPaintValue(o,l,d,p){if("color"===this.type){const _=sy(d),v=sy(p);for(let w=o;w<l;w++)this.paintVertexArray.emplace(w,_[0],_[1],v[0],v[1])}else{for(let _=o;_<l;_++)this.paintVertexArray.emplace(_,d,p);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(p))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,l,d,p,_){const v=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,w=wt(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);l.set(o,_,w)}getBinding(o,l){return new Th(o)}}class ba{constructor(o,l,d,p,_){this.expression=o,this.layerId=_,this.paintVertexAttributes=("array"===d?El:ho).members;for(let v=0;v<l.length;++v);this.paintVertexArray=new p}populatePaintArray(o,l,d){const p=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(p,o,l.patterns&&l.patterns[this.layerId],d)}updatePaintArray(o,l,d,p,_,v){this._setPaintValues(o,l,d.patterns&&d.patterns[this.layerId],v)}_setPaintValues(o,l,d,p){if(!p||!d)return;const _=p[d];if(!_)return;const{tl:v,br:w,pixelRatio:D}=_;for(let S=o;S<l;S++)this.paintVertexArray.emplace(S,v[0],v[1],w[0],w[1],D)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class sd{constructor(o,l,d=(()=>!0)){this.binders={},this._buffers=[];const p=[];for(const _ in o.paint._values){if(!d(_))continue;const v=o.paint.get(_);if(!(v instanceof K&&ki(v.property.specification)))continue;const w=o0(_,o.type),D=v.value,S=v.property.specification.type,k=!!v.property.useIntegerZoom,P="line-dasharray"===_||_.endsWith("pattern"),F="line-dasharray"===_&&"constant"!==o.layout.get("line-cap").value.kind;if("constant"!==D.kind||F)if("source"===D.kind||F||P){const B=hc(_,S,"source");this.binders[_]=P?new ba(D,w,S,B,o.id):new fs(D,w,S,B),p.push(`/a_${_}`)}else{const B=hc(_,S,"composite");this.binders[_]=new ui(D,w,S,k,l,B),p.push(`/z_${_}`)}else this.binders[_]=P?new Lr(D.value,w):new rf(D.value,w,S),p.push(`/u_${_}`)}this.cacheKey=p.sort().join("")}getMaxValue(o){const l=this.binders[o];return l instanceof fs||l instanceof ui?l.maxValue:0}populatePaintArrays(o,l,d,p,_,v){for(const w in this.binders){const D=this.binders[w];(D instanceof fs||D instanceof ui||D instanceof ba)&&D.populatePaintArray(o,l,d,p,_,v)}}setConstantPatternPositions(o){for(const l in this.binders){const d=this.binders[l];d instanceof Lr&&d.setConstantPatternPositions(o)}}updatePaintArrays(o,l,d,p,_,v){let w=!1;for(const D in o){const S=l.getPositions(D);for(const k of S){const P=d.feature(k.index);for(const F in this.binders){const B=this.binders[F];if((B instanceof fs||B instanceof ui||B instanceof ba)&&!0===B.expression.isStateDependent){const z=p.paint.get(F);B.expression=z.value,B.updatePaintArray(k.start,k.end,P,o[D],_,v),w=!0}}}}return w}defines(){const o=[];for(const l in this.binders){const d=this.binders[l];(d instanceof rf||d instanceof Lr)&&o.push(...d.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return o}getBinderAttributes(){const o=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof fs||d instanceof ui||d instanceof ba)for(let p=0;p<d.paintVertexAttributes.length;p++)o.push(d.paintVertexAttributes[p].name)}return o}getBinderUniforms(){const o=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof rf||d instanceof Lr||d instanceof ui)for(const p of d.uniformNames)o.push(p)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const l=[];for(const d in this.binders){const p=this.binders[d];if(p instanceof rf||p instanceof Lr||p instanceof ui)for(const _ of p.uniformNames)l.push({name:_,property:d,binding:p.getBinding(o,_)})}return l}setUniforms(o,l,d,p,_){for(const{name:v,property:w,binding:D}of d)this.binders[w].setUniform(o,D,_,p.get(w),v)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const l=this.binders[o];(l instanceof fs||l instanceof ui||l instanceof ba)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(o){for(const l in this.binders){const d=this.binders[l];(d instanceof fs||d instanceof ui||d instanceof ba)&&d.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const l=this.binders[o];(l instanceof fs||l instanceof ui||l instanceof ba)&&l.destroy()}}}class uc{constructor(o,l,d=(()=>!0)){this.programConfigurations={};for(const p of o)this.programConfigurations[p.id]=new sd(p,l,d);this.needsUpload=!1,this._featureMap=new Mh,this._bufferOffset=0}populatePaintArrays(o,l,d,p,_,v,w){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(o,l,p,_,v,w);void 0!==l.id&&this._featureMap.add(l.id,d,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,l,d,p,_){for(const v of d)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(o,this._featureMap,l,v,p,_)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const iC={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function o0(a,o){return iC[a]||[a.replace(`${o}-`,"").replace(/-/g,"_")]}const s0={"line-pattern":{source:Me,composite:Me},"fill-pattern":{source:Me,composite:Me},"fill-extrusion-pattern":{source:Me,composite:Me},"line-dasharray":{source:$e,composite:$e}},Wm={color:{source:ti,composite:Qe},number:{source:gi,composite:ti}};function hc(a,o,l){const d=s0[a];return d&&d[l]||Wm[o][l]}Dt(rf,"ConstantBinder"),Dt(Lr,"PatternConstantBinder"),Dt(fs,"SourceExpressionBinder"),Dt(ba,"PatternCompositeBinder"),Dt(ui,"CompositeExpressionBinder"),Dt(sd,"ProgramConfiguration",{omit:["_buffers"]}),Dt(uc,"ProgramConfigurationSet");const a0="-transition";class ks extends Gd{constructor(o,l){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==o.type&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,"background"!==o.type&&"sky"!==o.type&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),l.layout&&(this._unevaluatedLayout=new Q(l.layout)),l.paint)){this._transitionablePaint=new V(l.paint);for(const d in o.paint)this.setPaintProperty(d,o.paint[d],{validate:!1});for(const d in o.layout)this.setLayoutProperty(d,o.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ee(l.paint)}}getLayoutProperty(o){return"visibility"===o?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,l,d={}){null!=l&&this._validate(Kb,`layers.${this.id}.layout.${o}`,o,l,d)||("visibility"!==o?this._unevaluatedLayout.setValue(o,l):this.visibility=l)}getPaintProperty(o){return Fc(o,a0)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,l,d={}){if(null!=l&&this._validate(Xb,`layers.${this.id}.paint.${o}`,o,l,d))return!1;if(Fc(o,a0))return this._transitionablePaint.setTransition(o.slice(0,-11),l||void 0),!1;{const p=this._transitionablePaint._values[o],_=p.value.isDataDriven(),v=p.value;this._transitionablePaint.setValue(o,l),this._handleSpecialPaintPropertyUpdate(o);const w=this._transitionablePaint._values[o].value,D=w.isDataDriven(),S=Fc(o,"pattern")||"line-dasharray"===o;return D||_||S||this._handleOverridablePaintPropertyUpdate(o,v,w)}}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getProgramConfiguration(o){return null}_handleOverridablePaintPropertyUpdate(o,l,d){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||"none"===this.visibility}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,l)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),hl(o,(l,d)=>!(void 0===l||"layout"===d&&!Object.keys(l).length||"paint"===d&&!Object.keys(l).length))}_validate(o,l,d,p,_={}){return(!_||!1!==_.validate)&&Kp(this,o.call(ey,{key:l,layerType:this.type,objectKey:d,value:p,styleSpec:ze,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const l=this.paint.get(o);if(l instanceof K&&ki(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=wl(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Zm=ve([{name:"a_pos",components:2,type:"Int16"}],4),Ym=ve([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class rr{constructor(o=[]){this.segments=o}prepareSegment(o,l,d,p){let _=this.segments[this.segments.length-1];return o>rr.MAX_VERTEX_ARRAY_LENGTH&&ji(`Max vertices per segment is ${rr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!_||_.vertexLength+o>rr.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p)&&(_={vertexOffset:l.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},void 0!==p&&(_.sortKey=p),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const o of this.segments)for(const l in o.vaos)o.vaos[l].destroy()}static simpleSegment(o,l,d,p){return new rr([{vertexOffset:o,primitiveOffset:l,vertexLength:d,primitiveLength:p,vaos:{},sortKey:0}])}}rr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Dt(rr,"SegmentVector");var Ot=8192;class pc{constructor(o,l){o&&(l?this.setSouthWest(o).setNorthEast(l):4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof ai?new ai(o.lng,o.lat):ai.convert(o),this}setSouthWest(o){return this._sw=o instanceof ai?new ai(o.lng,o.lat):ai.convert(o),this}extend(o){const l=this._sw,d=this._ne;let p,_;if(o instanceof ai)p=o,_=o;else{if(!(o instanceof pc))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(pc.convert(o)):this.extend(ai.convert(o)):"object"==typeof o&&null!==o&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(ai.convert(o)):this;if(p=o._sw,_=o._ne,!p||!_)return this}return l||d?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new ai(p.lng,p.lat),this._ne=new ai(_.lng,_.lat)),this}getCenter(){return new ai((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ai(this.getWest(),this.getNorth())}getSouthEast(){return new ai(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:l,lat:d}=ai.convert(o);let p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&p}static convert(o){return!o||o instanceof pc?o:new pc(o)}}var Xm=1e-6,qr=typeof Float32Array<"u"?Float32Array:Array;function Ah(){var a=new qr(9);return qr!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function l0(a,o,l){var d=o[0],p=o[1],_=o[2],v=o[3],w=o[4],D=o[5],S=o[6],k=o[7],P=o[8],F=l[0],B=l[1],z=l[2],j=l[3],Y=l[4],te=l[5],ce=l[6],ne=l[7],ae=l[8];return a[0]=F*d+B*v+z*S,a[1]=F*p+B*w+z*k,a[2]=F*_+B*D+z*P,a[3]=j*d+Y*v+te*S,a[4]=j*p+Y*w+te*k,a[5]=j*_+Y*D+te*P,a[6]=ce*d+ne*v+ae*S,a[7]=ce*p+ne*w+ae*k,a[8]=ce*_+ne*D+ae*P,a}function Sl(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function sf(a,o){var l=o[0],d=o[1],p=o[2],_=o[3],v=o[4],w=o[5],D=o[6],S=o[7],k=o[8],P=o[9],F=o[10],B=o[11],z=o[12],j=o[13],Y=o[14],te=o[15],ce=l*w-d*v,ne=l*D-p*v,ae=l*S-_*v,pe=d*D-p*w,he=d*S-_*w,Te=p*S-_*D,Se=k*j-P*z,Ue=k*Y-F*z,nt=k*te-B*z,Fe=P*Y-F*j,Ge=P*te-B*j,je=F*te-B*Y,Xe=ce*je-ne*Ge+ae*Fe+pe*nt-he*Ue+Te*Se;return Xe?(a[0]=(w*je-D*Ge+S*Fe)*(Xe=1/Xe),a[1]=(p*Ge-d*je-_*Fe)*Xe,a[2]=(j*Te-Y*he+te*pe)*Xe,a[3]=(F*he-P*Te-B*pe)*Xe,a[4]=(D*nt-v*je-S*Ue)*Xe,a[5]=(l*je-p*nt+_*Ue)*Xe,a[6]=(Y*ae-z*Te-te*ne)*Xe,a[7]=(k*Te-F*ae+B*ne)*Xe,a[8]=(v*Ge-w*nt+S*Se)*Xe,a[9]=(d*nt-l*Ge-_*Se)*Xe,a[10]=(z*he-j*ae+te*ce)*Xe,a[11]=(P*ae-k*he-B*ce)*Xe,a[12]=(w*Ue-v*Fe-D*Se)*Xe,a[13]=(l*Fe-d*Ue+p*Se)*Xe,a[14]=(j*ne-z*pe-Y*ce)*Xe,a[15]=(k*pe-P*ne+F*ce)*Xe,a):null}function Ih(a,o,l){var d=o[0],p=o[1],_=o[2],v=o[3],w=o[4],D=o[5],S=o[6],k=o[7],P=o[8],F=o[9],B=o[10],z=o[11],j=o[12],Y=o[13],te=o[14],ce=o[15],ne=l[0],ae=l[1],pe=l[2],he=l[3];return a[0]=ne*d+ae*w+pe*P+he*j,a[1]=ne*p+ae*D+pe*F+he*Y,a[2]=ne*_+ae*S+pe*B+he*te,a[3]=ne*v+ae*k+pe*z+he*ce,a[4]=(ne=l[4])*d+(ae=l[5])*w+(pe=l[6])*P+(he=l[7])*j,a[5]=ne*p+ae*D+pe*F+he*Y,a[6]=ne*_+ae*S+pe*B+he*te,a[7]=ne*v+ae*k+pe*z+he*ce,a[8]=(ne=l[8])*d+(ae=l[9])*w+(pe=l[10])*P+(he=l[11])*j,a[9]=ne*p+ae*D+pe*F+he*Y,a[10]=ne*_+ae*S+pe*B+he*te,a[11]=ne*v+ae*k+pe*z+he*ce,a[12]=(ne=l[12])*d+(ae=l[13])*w+(pe=l[14])*P+(he=l[15])*j,a[13]=ne*p+ae*D+pe*F+he*Y,a[14]=ne*_+ae*S+pe*B+he*te,a[15]=ne*v+ae*k+pe*z+he*ce,a}function af(a,o,l){var d,p,_,v,w,D,S,k,P,F,B,z,j=l[0],Y=l[1],te=l[2];return o===a?(a[12]=o[0]*j+o[4]*Y+o[8]*te+o[12],a[13]=o[1]*j+o[5]*Y+o[9]*te+o[13],a[14]=o[2]*j+o[6]*Y+o[10]*te+o[14],a[15]=o[3]*j+o[7]*Y+o[11]*te+o[15]):(p=o[1],_=o[2],v=o[3],w=o[4],D=o[5],S=o[6],k=o[7],P=o[8],F=o[9],B=o[10],z=o[11],a[0]=d=o[0],a[1]=p,a[2]=_,a[3]=v,a[4]=w,a[5]=D,a[6]=S,a[7]=k,a[8]=P,a[9]=F,a[10]=B,a[11]=z,a[12]=d*j+w*Y+P*te+o[12],a[13]=p*j+D*Y+F*te+o[13],a[14]=_*j+S*Y+B*te+o[14],a[15]=v*j+k*Y+z*te+o[15]),a}function su(a,o,l){var d=l[0],p=l[1],_=l[2];return a[0]=o[0]*d,a[1]=o[1]*d,a[2]=o[2]*d,a[3]=o[3]*d,a[4]=o[4]*p,a[5]=o[5]*p,a[6]=o[6]*p,a[7]=o[7]*p,a[8]=o[8]*_,a[9]=o[9]*_,a[10]=o[10]*_,a[11]=o[11]*_,a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a}function c0(a,o,l){var d=Math.sin(l),p=Math.cos(l),_=o[4],v=o[5],w=o[6],D=o[7],S=o[8],k=o[9],P=o[10],F=o[11];return o!==a&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[4]=_*p+S*d,a[5]=v*p+k*d,a[6]=w*p+P*d,a[7]=D*p+F*d,a[8]=S*p-_*d,a[9]=k*p-v*d,a[10]=P*p-w*d,a[11]=F*p-D*d,a}function ay(a,o,l){var d=Math.sin(l),p=Math.cos(l),_=o[0],v=o[1],w=o[2],D=o[3],S=o[8],k=o[9],P=o[10],F=o[11];return o!==a&&(a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=_*p-S*d,a[1]=v*p-k*d,a[2]=w*p-P*d,a[3]=D*p-F*d,a[8]=_*d+S*p,a[9]=v*d+k*p,a[10]=w*d+P*p,a[11]=D*d+F*p,a}function ly(a,o){return a[0]=o[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=o[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function lf(a,o,l){var d,p,_,v=l[0],w=l[1],D=l[2],S=Math.hypot(v,w,D);return S<Xm?null:(v*=S=1/S,w*=S,D*=S,d=Math.sin(o),p=Math.cos(o),a[0]=v*v*(_=1-p)+p,a[1]=w*v*_+D*d,a[2]=D*v*_-w*d,a[3]=0,a[4]=v*w*_-D*d,a[5]=w*w*_+p,a[6]=D*w*_+v*d,a[7]=0,a[8]=v*D*_+w*d,a[9]=w*D*_-v*d,a[10]=D*D*_+p,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,o=arguments.length;o--;)a+=arguments[o]*arguments[o];return Math.sqrt(a)});var rC=Ih;function kh(){var a=new qr(3);return qr!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Km(a){var o=new qr(3);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o}function ad(a){return Math.hypot(a[0],a[1],a[2])}function cf(a,o,l){var d=new qr(3);return d[0]=a,d[1]=o,d[2]=l,d}function Ml(a,o,l){return a[0]=o[0]+l[0],a[1]=o[1]+l[1],a[2]=o[2]+l[2],a}function Jm(a,o,l){return a[0]=o[0]-l[0],a[1]=o[1]-l[1],a[2]=o[2]-l[2],a}function d0(a,o,l){return a[0]=o[0]*l[0],a[1]=o[1]*l[1],a[2]=o[2]*l[2],a}function Rs(a,o,l){return a[0]=Math.min(o[0],l[0]),a[1]=Math.min(o[1],l[1]),a[2]=Math.min(o[2],l[2]),a}function df(a,o,l){return a[0]=Math.max(o[0],l[0]),a[1]=Math.max(o[1],l[1]),a[2]=Math.max(o[2],l[2]),a}function Zo(a,o,l){return a[0]=o[0]*l,a[1]=o[1]*l,a[2]=o[2]*l,a}function au(a,o,l,d){return a[0]=o[0]+l[0]*d,a[1]=o[1]+l[1]*d,a[2]=o[2]+l[2]*d,a}function Ao(a,o){var l=o[0],d=o[1],p=o[2],_=l*l+d*d+p*p;return _>0&&(_=1/Math.sqrt(_)),a[0]=o[0]*_,a[1]=o[1]*_,a[2]=o[2]*_,a}function Ps(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]}function uf(a,o,l){var d=o[0],p=o[1],_=o[2],v=l[0],w=l[1],D=l[2];return a[0]=p*D-_*w,a[1]=_*v-d*D,a[2]=d*w-p*v,a}function sr(a,o,l){var d=o[0],p=o[1],_=o[2],v=l[3]*d+l[7]*p+l[11]*_+l[15];return a[0]=(l[0]*d+l[4]*p+l[8]*_+l[12])/(v=v||1),a[1]=(l[1]*d+l[5]*p+l[9]*_+l[13])/v,a[2]=(l[2]*d+l[6]*p+l[10]*_+l[14])/v,a}function cy(a,o,l){var d=l[0],p=l[1],_=l[2],v=o[0],w=o[1],D=o[2],S=p*D-_*w,k=_*v-d*D,P=d*w-p*v,F=p*P-_*k,B=_*S-d*P,z=d*k-p*S,j=2*l[3];return k*=j,P*=j,B*=2,z*=2,a[0]=v+(S*=j)+(F*=2),a[1]=w+k+B,a[2]=D+P+z,a}var Rh,xa=Jm,u0=d0,oC=ad;function hf(a,o,l){return a[0]=o[0]*l,a[1]=o[1]*l,a[2]=o[2]*l,a[3]=o[3]*l,a}function ld(a,o){var l=o[0],d=o[1],p=o[2],_=o[3],v=l*l+d*d+p*p+_*_;return v>0&&(v=1/Math.sqrt(v)),a[0]=l*v,a[1]=d*v,a[2]=p*v,a[3]=_*v,a}function lu(a,o,l){var d=o[0],p=o[1],_=o[2],v=o[3];return a[0]=l[0]*d+l[4]*p+l[8]*_+l[12]*v,a[1]=l[1]*d+l[5]*p+l[9]*_+l[13]*v,a[2]=l[2]*d+l[6]*p+l[10]*_+l[14]*v,a[3]=l[3]*d+l[7]*p+l[11]*_+l[15]*v,a}function dy(){var a=new qr(4);return qr!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function uy(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function cu(a,o,l){l*=.5;var d=o[0],p=o[1],_=o[2],v=o[3],w=Math.sin(l),D=Math.cos(l);return a[0]=d*D+v*w,a[1]=p*D+_*w,a[2]=_*D-p*w,a[3]=v*D-d*w,a}function h0(a,o,l){l*=.5;var d=o[0],p=o[1],_=o[2],v=o[3],w=Math.sin(l),D=Math.cos(l);return a[0]=d*D-_*w,a[1]=p*D+v*w,a[2]=_*D+d*w,a[3]=v*D-p*w,a}kh(),Rh=new qr(4),qr!=Float32Array&&(Rh[0]=0,Rh[1]=0,Rh[2]=0,Rh[3]=0);var Un=ld;kh(),cf(1,0,0),cf(0,1,0),dy(),dy(),Ah();const hy=ve([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:p0}=hy,py=ve([{name:"a_pos_3",components:3,type:"Int16"}]);var Os=ve([{name:"a_pos",type:"Int16",components:2}]);class cd{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,d){const p=Ps(l,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1]+(o[2]-this.pos[2])*l[2])/p;return d[0]=this.pos[0]+this.dir[0]*_,d[1]=this.pos[1]+this.dir[1]*_,d[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(o,l,d){if(j=(B=this.pos)[0],Y=B[1],te=B[2],ce=(z=o)[0],ne=z[1],ae=z[2],Math.abs(j-ce)<=Xm*Math.max(1,Math.abs(j),Math.abs(ce))&&Math.abs(Y-ne)<=Xm*Math.max(1,Math.abs(Y),Math.abs(ne))&&Math.abs(te-ae)<=Xm*Math.max(1,Math.abs(te),Math.abs(ae))||0===l)return d[0]=d[1]=d[2]=0,!1;var B,z,j,Y,te,ce,ne,ae;const[p,_,v]=this.dir,w=this.pos[0]-o[0],D=this.pos[1]-o[1],S=this.pos[2]-o[2],k=p*p+_*_+v*v,P=2*(w*p+D*_+S*v),F=P*P-4*k*(w*w+D*D+S*S-l*l);if(F<0){const B=Math.max(-P/2,0),z=w+p*B,j=D+_*B,Y=S+v*B,te=Math.hypot(z,j,Y);return d[0]=z*l/te,d[1]=j*l/te,d[2]=Y*l/te,!1}{const B=(-P-Math.sqrt(F))/(2*k);if(B<0){const z=Math.hypot(w,D,S);return d[0]=w*l/z,d[1]=D*l/z,d[2]=S*l/z,!1}return d[0]=w+p*B,d[1]=D+_*B,d[2]=S+v*B,!0}}}class dd{constructor(o,l,d,p,_){this.TL=o,this.TR=l,this.BR=d,this.BL=p,this.horizon=_}static fromInvProjectionMatrix(o,l,d){const p=[-1,1,1],_=[1,1,1],v=[1,-1,1],w=[-1,-1,1],D=sr(p,p,o),S=sr(_,_,o),k=sr(v,v,o),P=sr(w,w,o);return new dd(D,S,k,P,l/d)}}class ud{constructor(o,l){this.points=o,this.planes=l}static fromInvProjectionMatrix(o,l,d,p){const _=Math.pow(2,d),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const S=lu([],D,o),k=1/S[3]/l*_;return(P=S)[0]=(F=S)[0]*(B=[k,k,p?1/S[3]:k,k])[0],P[1]=F[1]*B[1],P[2]=F[2]*B[2],P[3]=F[3]*B[3],P;var P,F,B}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const S=Ao([],uf([],xa([],v[D[0]],v[D[1]]),xa([],v[D[2]],v[D[1]]))),k=-Ps(S,v[D[1]]);return S.concat(k)});return new ud(v,w)}}class Io{static fromPoints(o){const l=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const p of o)Rs(l,l,p),df(d,d,p);return new Io(l,d)}static applyTransform(o,l){const d=o.getCorners();for(let p=0;p<d.length;++p)sr(d[p],d[p],l);return Io.fromPoints(d)}constructor(o,l){this.min=o,this.max=l,this.center=Zo([],Ml([],this.min,this.max),.5)}quadrant(o){const l=[o%2==0,o<2],d=Km(this.min),p=Km(this.max);for(let _=0;_<l.length;_++)d[_]=l[_]?this.min[_]:this.center[_],p[_]=l[_]?this.center[_]:this.max[_];return p[2]=this.max[2],new Io(d,p)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,l=this.max;return[[o[0],o[1],o[2]],[l[0],o[1],o[2]],[l[0],l[1],o[2]],[o[0],l[1],o[2]],[o[0],o[1],l[2]],[l[0],o[1],l[2]],[l[0],l[1],l[2]],[o[0],l[1],l[2]]]}intersects(o){const l=this.getCorners();let d=!0;for(let p=0;p<o.planes.length;p++){const _=o.planes[p];let v=0;for(let w=0;w<l.length;w++)v+=Ps(_,l[w])+_[3]>=0;if(0===v)return 0;v!==l.length&&(d=!1)}if(d)return 2;for(let p=0;p<3;p++){let _=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let w=0;w<o.points.length;w++){const D=o.points[w][p]-this.min[p];_=Math.min(_,D),v=Math.max(v,D)}if(v<0||_>this.max[p]-this.min[p])return 0}return 1}}const pf=5,du=6,fc=Ot/Math.PI/2,sC=16383,Qm=[64,32,16],qa=-fc,Wa=fc,pT=[new Io([qa,qa,qa],[Wa,Wa,Wa]),new Io([qa,qa,qa],[0,0,Wa]),new Io([0,qa,qa],[Wa,0,Wa]),new Io([qa,0,qa],[0,Wa,Wa]),new Io([0,0,qa],[Wa,Wa,Wa])];function fy(a){return a*fc/mf}function Oh(a,o,l,d=!0){const p=Zo([],a._camera.position,a.worldSize),_=[o,l,1,1];lu(_,_,a.pixelMatrixInverse),hf(_,_,1/_[3]);const v=Ao([],xa([],_,p)),w=a.globeMatrix,D=[w[12],w[13],w[14]],S=xa([],D,p),k=ad(S),P=Ao([],S),F=a.worldSize/(2*Math.PI),B=Ps(P,v),z=Math.asin(F/k);if(z<Math.acos(B)){if(!d)return null;const nt=[],Fe=[];Zo(nt,v,k/B),Ao(Fe,xa(Fe,nt,S)),Ao(v,Ml(v,S,Zo(v,Fe,Math.tan(z)*k)))}const j=[];new cd(p,v).closestPointOnSphere(D,F,j);const Y=Ao([],Fa(w,0)),te=Ao([],Fa(w,1)),ce=Ao([],Fa(w,2)),ne=Ps(Y,j),ae=Ps(te,j),pe=Ps(ce,j),he=Ei(Math.asin(-ae/F));let Te=Ei(Math.atan2(ne,pe));Te=a.center.lng+function(nt,Fe){const Ge=(Fe-nt+180)%360-180;return Ge<-180?Ge+360:Ge}(a.center.lng,Te);const Se=Al(Te),Ue=wt(Er(he),0,1);return new hu(Se,Ue)}class fT{constructor(o,l,d){this.a=xa([],o,d),this.b=xa([],l,d),this.center=d;const p=Ao([],this.a),_=Ao([],this.b);this.angle=Math.acos(Ps(p,_))}}function f0(a,o){if(0===a.angle)return null;let l;return l=0===a.a[o]?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[o]/a.a[o]/Math.sin(a.angle)-1/Math.tan(a.angle)),l<0||l>1?null:function(d,p,_,v){const w=Math.sin(_);return d*(Math.sin((1-v)*_)/w)+p*(Math.sin(v*_)/w)}(a.a[o],a.b[o],a.angle,wt(l,0,1))+a.center[o]}function Bi(a){if(a.z<=1)return pT[a.z+2*a.y+a.x];const o=eg(hd(a));return Io.fromPoints(o)}function uu(a,o,l){return Zo(a,a,1-l),au(a,a,o,l)}function Fh(a,o){const l=Za(o.zoom);if(0===l)return Bi(a);const d=hd(a),p=eg(d),_=Al(d.getWest())*o.worldSize,v=Al(d.getEast())*o.worldSize,w=Er(d.getNorth())*o.worldSize,D=Er(d.getSouth())*o.worldSize,S=[_,w,0],k=[v,w,0],P=[_,D,0],F=[v,D,0],B=sf([],o.globeMatrix);return sr(S,S,B),sr(k,k,B),sr(P,P,B),sr(F,F,B),p[0]=uu(p[0],P,l),p[1]=uu(p[1],F,l),p[2]=uu(p[2],k,l),p[3]=uu(p[3],S,l),Io.fromPoints(p)}function m0(a,o,l){for(const d of a)sr(d,d,o),Zo(d,d,l)}function hd({x:a,y:o,z:l}){const d=1/(1<<l),p=new ai(br(a*d),po((o+1)*d)),_=new ai(br((a+1)*d),po(o*d));return new pc(p,_)}function eg(a){const o=xn(a.getNorth()),l=xn(a.getSouth()),d=Math.cos(o),p=Math.cos(l),_=Math.sin(o),v=Math.sin(l),w=a.getWest(),D=a.getEast();return[mc(p,v,w),mc(p,v,D),mc(d,_,D),mc(d,_,w)]}function mc(a,o,l,d=fc){return l=xn(l),[a*Math.sin(l)*d,-o*d,a*Math.cos(l)*d]}function Tl(a,o,l){return mc(Math.cos(xn(a)),Math.sin(xn(a)),o,l)}function ff(a,o,l,d){const p=1<<l.z,_=(a/Ot+l.x)/p;return Tl(po((o/Ot+l.y)/p),br(_),d)}function my({min:a,max:o}){return sC/Math.max(o[0]-a[0],o[1]-a[1],o[2]-a[2])}const g0=new Float64Array(16);function tg(a){const o=my(a),l=ly(g0,[o,o,o]);return af(l,l,((d=[])[0]=-(p=a.min)[0],d[1]=-p[1],d[2]=-p[2],d));var d,p}function ms(a){const o=(d=a.min,(l=g0)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=d[0],l[13]=d[1],l[14]=d[2],l[15]=1,l);var l,d;const p=1/my(a);return su(o,o,[p,p,p])}function ng(a,o,l,d,p){const _=function(D){const S=Ot/(2*Math.PI);return D/(2*Math.PI)/S}(l),v=[a,o,-l/(2*Math.PI)],w=Sl(new Float64Array(16));return af(w,w,v),su(w,w,[_,_,_]),c0(w,w,xn(-p)),ay(w,w,xn(-d)),w}function Za(a){return Xi(pf,du,a)}function aC(a,o){const l=Tl(o.lat,o.lng);return v=(p=Jm([],function(z){const j=Tl(z._center.lat,z._center.lng);let Y=uf([],cf(0,1,0),j);const te=lf([],-z.angle,j);Y=sr(Y,Y,te),lf(te,-z._pitch,Y);const ce=Ao([],j);return Zo(ce,ce,fy(z.cameraToCenterDistance/z.pixelsPerMeter)),sr(ce,ce,te),Ml([],j,ce)}(a),l))[0],w=p[1],D=p[2],S=(_=l)[0],k=_[1],P=_[2],B=(F=Math.sqrt(v*v+w*w+D*D)*Math.sqrt(S*S+k*k+P*P))&&Ps(p,_)/F,Math.acos(Math.min(Math.max(B,-1),1));var p,_,v,w,D,S,k,P,F,B}function ig(a,o){return aC(a,o)>Math.PI/2*1.01}const _0=xn(85),lC=Math.cos(_0),cC=Math.sin(_0),mf=6371008.8,y0=2*Math.PI*mf;class pd{constructor(o,l){if(isNaN(o)||isNaN(l))throw new Error(`Invalid LngLat object: (${o}, ${l})`);if(this.lng=+o,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pd(Vt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const l=Math.PI/180,d=this.lat*l,p=o.lat*l,_=Math.sin(d)*Math.sin(p)+Math.cos(d)*Math.cos(p)*Math.cos((o.lng-this.lng)*l);return mf*Math.acos(Math.min(_,1))}toBounds(o=0){const l=360*o/40075017,d=l/Math.cos(Math.PI/180*this.lat);return new pc(new pd(this.lng-d,this.lat-l),new pd(this.lng+d,this.lat+l))}toEcef(o){const l=fy(o);return Tl(this.lat,this.lng,fc+l)}static convert(o){if(o instanceof pd)return o;if(Array.isArray(o)&&(2===o.length||3===o.length))return new pd(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&"object"==typeof o&&null!==o)return new pd(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var ai=pd;function Lh(a){return y0*Math.cos(a*Math.PI/180)}function Al(a){return(180+a)/360}function Er(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Ya(a,o){return a/Lh(o)}function br(a){return 360*a-180}function po(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function gy(a,o){return a*Lh(po(o))}const Nr=85.051129;function gf(a){return 1/Math.cos(a*Math.PI/180)}class hu{constructor(o,l,d=0){this.x=+o,this.y=+l,this.z=+d}static fromLngLat(o,l=0){const d=ai.convert(o);return new hu(Al(d.lng),Er(d.lat),Ya(l,d.lat))}toLngLat(){return new ai(br(this.x),po(this.y))}toAltitude(){return gy(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/y0*gf(po(this.y))}}function _y(a,o,l,d,p,_,v,w,D){const S=(o+d)/2,k=(l+p)/2,P=new pt(S,k);w(P),function(F,B,z,j,Y,te){const ce=z-Y,ne=j-te;return Math.abs((j-B)*ce-(z-F)*ne)/Math.hypot(ce,ne)}(P.x,P.y,_.x,_.y,v.x,v.y)>=D?(_y(a,o,l,S,k,_,P,w,D),_y(a,S,k,d,p,P,v,w,D)):a.push(v)}function v0(a,o,l){let d=a[0],p=d.x,_=d.y;o(d);const v=[d];for(let w=1;w<a.length;w++){const D=a[w],{x:S,y:k}=D;o(D),_y(v,p,_,S,k,d,D,o,l),p=S,_=k,d=D}return v}function fd(a,o,l,d){if(d(o,l)){const p=o.add(l)._mult(.5);fd(a,o,p,d),fd(a,p,l,d)}else a.push(l)}function _f(a,o){let l=a[0];const d=[l];for(let p=1;p<a.length;p++){const _=a[p];fd(d,l,_,o),l=_}return d}const yy=Math.pow(2,14)-1,dC=-yy-1;function b0(a,o){const l=Math.round(a.x*o),d=Math.round(a.y*o);return a.x=wt(l,dC,yy),a.y=wt(d,dC,yy),(l<a.x||l>a.x+1||d<a.y||d>a.y+1)&&ji("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function gc(a,o,l){const d=a.loadGeometry(),p=a.extent,_=Ot/p;if(o&&l&&l.projection.isReprojectedInTileSpace){const v=1<<o.z,{scale:w,x:D,y:S,projection:k}=l,P=F=>{const B=br((o.x+F.x/p)/v),z=po((o.y+F.y/p)/v),j=k.project(B,z);F.x=(j.x*w-D)*p,F.y=(j.y*w-S)*p};for(let F=0;F<d.length;F++)if(1!==a.type)d[F]=v0(d[F],P,1);else{const B=[];for(const z of d[F])z.x<0||z.x>=p||z.y<0||z.y>=p||(P(z),B.push(z));d[F]=B}}for(const v of d)for(const w of v)b0(w,_);return d}function Nh(a,o){return{type:a.type,id:a.id,properties:a.properties,geometry:o?gc(a):[]}}function rg(a,o,l,d,p){a.emplaceBack(2*o+(d+1)/2,2*l+(p+1)/2)}function og(a,o,l){a.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class vy{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Je,this.indexArray=new At,this.segments=new rr,this.programConfigurations=new uc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(o,l,d,p){const _=this.layers[0],v=[];let w=null;"circle"===_.type&&(w=_.layout.get("circle-sort-key"));for(const{feature:S,id:k,index:P,sourceLayerIndex:F}of o){const B=this.layers[0]._featureFilter.needGeometry,z=Nh(S,B);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),z,d))continue;const j=w?w.evaluate(z,{},d):void 0,Y={id:k,properties:S.properties,type:S.type,sourceLayerIndex:F,index:P,geometry:B?z.geometry:gc(S,d,p),patterns:{},sortKey:j};v.push(Y)}w&&v.sort((S,k)=>S.sortKey-k.sortKey);let D=null;"globe"===p.projection.name&&(this.globeExtVertexArray=new tt,D=p.projection);for(const S of v){const{geometry:k,index:P,sourceLayerIndex:F}=S,B=o[P].feature;this.addFeature(S,k,P,l.availableImages,d,D),l.featureIndex.insert(B,k,P,F,this.index)}}update(o,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Zm.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Ym.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,l,d,p,_,v){for(const w of l)for(const D of w){const S=D.x,k=D.y;if(S<0||S>=Ot||k<0||k>=Ot)continue;if(v){const B=v.projectTilePoint(S,k,_),z=v.upVector(_,S,k),j=this.globeExtVertexArray;og(j,B,z),og(j,B,z),og(j,B,z),og(j,B,z)}const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),F=P.vertexLength;rg(this.layoutVertexArray,S,k,-1,-1),rg(this.layoutVertexArray,S,k,1,-1),rg(this.layoutVertexArray,S,k,1,1),rg(this.layoutVertexArray,S,k,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+2,F+3),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,{},p,_)}}function yf(a,o){for(let l=0;l<a.length;l++)if(_c(o,a[l]))return!0;for(let l=0;l<o.length;l++)if(_c(a,o[l]))return!0;return!!E0(a,o)}function x0(a,o,l){return!!_c(a,o)||!!S0(o,a,l)}function w0(a,o){if(1===a.length)return T0(o,a[0]);for(let l=0;l<o.length;l++){const d=o[l];for(let p=0;p<d.length;p++)if(_c(a,d[p]))return!0}for(let l=0;l<a.length;l++)if(T0(o,a[l]))return!0;for(let l=0;l<o.length;l++)if(E0(a,o[l]))return!0;return!1}function C0(a,o,l){if(a.length>1){if(E0(a,o))return!0;for(let d=0;d<o.length;d++)if(S0(o[d],a,l))return!0}for(let d=0;d<a.length;d++)if(S0(a[d],o,l))return!0;return!1}function E0(a,o){if(0===a.length||0===o.length)return!1;for(let l=0;l<a.length-1;l++){const d=a[l],p=a[l+1];for(let _=0;_<o.length-1;_++)if(D0(d,p,o[_],o[_+1]))return!0}return!1}function D0(a,o,l,d){return xs(a,l,d)!==xs(o,l,d)&&xs(a,o,l)!==xs(a,o,d)}function S0(a,o,l){const d=l*l;if(1===o.length)return a.distSqr(o[0])<d;for(let p=1;p<o.length;p++)if(M0(a,o[p-1],o[p])<d)return!0;return!1}function M0(a,o,l){const d=o.distSqr(l);if(0===d)return a.distSqr(o);const p=((a.x-o.x)*(l.x-o.x)+(a.y-o.y)*(l.y-o.y))/d;return a.distSqr(p<0?o:p>1?l:l.sub(o)._mult(p)._add(o))}function T0(a,o){let l,d,p,_=!1;for(let v=0;v<a.length;v++){l=a[v];for(let w=0,D=l.length-1;w<l.length;D=w++)d=l[w],p=l[D],d.y>o.y!=p.y>o.y&&o.x<(p.x-d.x)*(o.y-d.y)/(p.y-d.y)+d.x&&(_=!_)}return _}function _c(a,o){let l=!1;for(let d=0,p=a.length-1;d<a.length;p=d++){const _=a[d],v=a[p];_.y>o.y!=v.y>o.y&&o.x<(v.x-_.x)*(o.y-_.y)/(v.y-_.y)+_.x&&(l=!l)}return l}function uC(a,o,l,d,p){for(const v of a)if(o<=v.x&&l<=v.y&&d>=v.x&&p>=v.y)return!0;const _=[new pt(o,l),new pt(o,p),new pt(d,p),new pt(d,l)];if(a.length>2)for(const v of _)if(_c(a,v))return!0;for(let v=0;v<a.length-1;v++)if(mT(a[v],a[v+1],_))return!0;return!1}function mT(a,o,l){const d=l[0],p=l[2];if(a.x<d.x&&o.x<d.x||a.x>p.x&&o.x>p.x||a.y<d.y&&o.y<d.y||a.y>p.y&&o.y>p.y)return!1;const _=xs(a,o,l[0]);return _!==xs(a,o,l[1])||_!==xs(a,o,l[2])||_!==xs(a,o,l[3])}function md(a,o,l){const d=o.paint.get(a).value;return"constant"===d.kind?d.value:l.programConfigurations.get(o.id).getMaxValue(a)}function by(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function hC(a,o,l,d,p){if(!o[0]&&!o[1])return a;const _=pt.convert(o)._mult(p);"viewport"===l&&_._rotate(-d);const v=[];for(let w=0;w<a.length;w++)v.push(a[w].sub(_));return v}function pC(a,o,l,d){const p=pt.convert(a)._mult(d);return"viewport"===o&&p._rotate(-l),p}Dt(vy,"CircleBucket",{omit:["layers"]});const gT=new re({"circle-sort-key":new Z(ze.layout_circle["circle-sort-key"])});var _T={paint:new re({"circle-radius":new Z(ze.paint_circle["circle-radius"]),"circle-color":new Z(ze.paint_circle["circle-color"]),"circle-blur":new Z(ze.paint_circle["circle-blur"]),"circle-opacity":new Z(ze.paint_circle["circle-opacity"]),"circle-translate":new U(ze.paint_circle["circle-translate"]),"circle-translate-anchor":new U(ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new U(ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new U(ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Z(ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Z(ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Z(ze.paint_circle["circle-stroke-opacity"])}),layout:gT};function A0(a,o,l,d,p,_,v,w,D){if(_&&a.queryGeometry.isAboveHorizon)return!1;_&&(D*=a.pixelToTileUnitsFactor);const S=a.tileID.canonical,k=l.projection.upVectorScale(S,l.center.lat,l.worldSize).metersToTile;for(const P of o)for(const F of P){const B=F.add(w),z=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(B.x,B.y,!0):0,j=l.projection.projectTilePoint(B.x,B.y,S);if(z>0){const ne=l.projection.upVector(S,B.x,B.y);j.x+=ne[0]*k*z,j.y+=ne[1]*k*z,j.z+=ne[2]*k*z}const Y=_?B:sg(j.x,j.y,j.z,d),te=_?a.tilespaceRays.map(ne=>k0(ne,z)):a.queryGeometry.screenGeometry,ce=lu([],[j.x,j.y,j.z,1],d);if(!v&&_?D*=ce[3]/l.cameraToCenterDistance:v&&!_&&(D*=l.cameraToCenterDistance/ce[3]),_){const ne=po((F.y/Ot+S.y)/(1<<S.z));D/=l.projection.pixelsPerMeter(ne,1)/Ya(1,ne)}if(x0(te,Y,D))return!0}return!1}function sg(a,o,l,d){const p=lu([],[a,o,l,1],d);return new pt(p[0]/p[3],p[1]/p[3])}const ag=cf(0,0,0),I0=cf(0,0,1);function k0(a,o){const l=kh();return ag[2]=o,a.intersectsPlane(ag,I0,l),new pt(l[0],l[1])}class xy extends vy{}function pu(a,{width:o,height:l},d,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==o*l*d)throw new RangeError("mismatched image size")}else p=new Uint8Array(o*l*d);return a.width=o,a.height=l,a.data=p,a}function wy(a,o,l){const{width:d,height:p}=o;d===a.width&&p===a.height||(Bh(a,o,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,p)},l),a.width=d,a.height=p,a.data=o.data)}function Bh(a,o,l,d,p,_){if(0===p.width||0===p.height)return o;if(p.width>a.width||p.height>a.height||l.x>a.width-p.width||l.y>a.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>o.width||p.height>o.height||d.x>o.width-p.width||d.y>o.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const v=a.data,w=o.data;for(let D=0;D<p.height;D++){const S=((l.y+D)*a.width+l.x)*_,k=((d.y+D)*o.width+d.x)*_;for(let P=0;P<p.width*_;P++)w[k+P]=v[S+P]}return o}Dt(xy,"HeatmapBucket",{omit:["layers"]});class Ca{constructor(o,l){pu(this,o,1,l)}resize(o){wy(this,new Ca(o),1)}clone(){return new Ca({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,d,p,_){Bh(o,l,d,p,_,1)}}class qi{constructor(o,l){pu(this,o,4,l)}resize(o){wy(this,new qi(o),4)}replace(o,l){l?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new qi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,d,p,_){Bh(o,l,d,p,_,4)}}Dt(Ca,"AlphaImage"),Dt(qi,"RGBAImage");var fC={paint:new re({"heatmap-radius":new Z(ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Z(ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new U(ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ie(ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new U(ze.paint_heatmap["heatmap-opacity"])})};function Cy(a){const o={},l=a.resolution||256,d=a.clips?a.clips.length:1,p=a.image||new qi({width:l,height:d}),_=(v,w,D)=>{o[a.evaluationKey]=D;const S=a.expression.evaluate(o);p.data[v+w+0]=Math.floor(255*S.r/S.a),p.data[v+w+1]=Math.floor(255*S.g/S.a),p.data[v+w+2]=Math.floor(255*S.b/S.a),p.data[v+w+3]=Math.floor(255*S.a)};if(a.clips)for(let v=0,w=0;v<d;++v,w+=4*l)for(let D=0,S=0;D<l;D++,S+=4){const k=D/(l-1),{start:P,end:F}=a.clips[v];_(w,S,P*(1-k)+F*k)}else for(let v=0,w=0;v<l;v++,w+=4)_(0,w,v/(l-1));return p}var mC={paint:new re({"hillshade-illumination-direction":new U(ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new U(ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new U(ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new U(ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new U(ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new U(ze.paint_hillshade["hillshade-accent-color"])})};const R0=ve([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ey}=R0;var Dy={exports:{}};function lg(a,o,l){l=l||2;var d,p,_,v,w,D,S,k=o&&o.length,P=k?o[0]*l:a.length,F=P0(a,0,P,l,!0),B=[];if(!F||F.next===F.prev)return B;if(k&&(F=function(j,Y,te,ce){var ne,ae,pe,he=[];for(ne=0,ae=Y.length;ne<ae;ne++)(pe=P0(j,Y[ne]*ce,ne<ae-1?Y[ne+1]*ce:j.length,ce,!1))===pe.next&&(pe.steiner=!0),he.push(F0(pe));for(he.sort(My),ne=0;ne<he.length;ne++)te=Yo(he[ne],te);return te}(a,o,F,l)),a.length>80*l){d=_=a[0],p=v=a[1];for(var z=l;z<P;z+=l)(w=a[z])<d&&(d=w),(D=a[z+1])<p&&(p=D),w>_&&(_=w),D>v&&(v=D);S=0!==(S=Math.max(_-d,v-p))?32767/S:0}return vf(F,B,l,d,p,S,0),B}function P0(a,o,l,d,p){var _,v;if(p===Ty(a,o,l,d)>0)for(_=o;_<l;_+=d)v=hg(_,a[_],a[_+1],v);else for(_=l-d;_>=o;_-=d)v=hg(_,a[_],a[_+1],v);return v&&xf(v,v.next)&&(Ef(v),v=v.next),v}function gd(a,o){if(!a)return a;o||(o=a);var l,d=a;do{if(l=!1,d.steiner||!xf(d,d.next)&&0!==gr(d.prev,d,d.next))d=d.next;else{if(Ef(d),(d=o=d.prev)===d.next)break;l=!0}}while(l||d!==o);return o}function vf(a,o,l,d,p,_,v){if(a){!v&&_&&function(k,P,F,B){var z=k;do{0===z.z&&(z.z=cg(z.x,z.y,P,F,B)),z.prevZ=z.prev,z.nextZ=z.next,z=z.next}while(z!==k);z.prevZ.nextZ=null,z.prevZ=null,function(j){var Y,te,ce,ne,ae,pe,he,Te,Se=1;do{for(te=j,j=null,ae=null,pe=0;te;){for(pe++,ce=te,he=0,Y=0;Y<Se&&(he++,ce=ce.nextZ);Y++);for(Te=Se;he>0||Te>0&&ce;)0!==he&&(0===Te||!ce||te.z<=ce.z)?(ne=te,te=te.nextZ,he--):(ne=ce,ce=ce.nextZ,Te--),ae?ae.nextZ=ne:j=ne,ne.prevZ=ae,ae=ne;te=ce}ae.nextZ=null,Se*=2}while(pe>1)}(z)}(a,d,p,_);for(var w,D,S=a;a.prev!==a.next;)if(w=a.prev,D=a.next,_?Fs(a,d,p,_):gC(a))o.push(w.i/l|0),o.push(a.i/l|0),o.push(D.i/l|0),Ef(a),a=D.next,S=D.next;else if((a=D)===S){v?1===v?vf(a=Sy(gd(a),o,l),o,l,d,p,_,2):2===v&&O0(a,o,l,d,p,_):vf(gd(a),o,l,d,p,_,1);break}}}function gC(a){var o=a.prev,l=a,d=a.next;if(gr(o,l,d)>=0)return!1;for(var p=o.x,_=l.x,v=d.x,w=o.y,D=l.y,S=d.y,k=p<_?p<v?p:v:_<v?_:v,P=w<D?w<S?w:S:D<S?D:S,F=p>_?p>v?p:v:_>v?_:v,B=w>D?w>S?w:S:D>S?D:S,z=d.next;z!==o;){if(z.x>=k&&z.x<=F&&z.y>=P&&z.y<=B&&zh(p,w,_,D,v,S,z.x,z.y)&&gr(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function Fs(a,o,l,d){var p=a.prev,_=a,v=a.next;if(gr(p,_,v)>=0)return!1;for(var w=p.x,D=_.x,S=v.x,k=p.y,P=_.y,F=v.y,B=w<D?w<S?w:S:D<S?D:S,z=k<P?k<F?k:F:P<F?P:F,j=w>D?w>S?w:S:D>S?D:S,Y=k>P?k>F?k:F:P>F?P:F,te=cg(B,z,o,l,d),ce=cg(j,Y,o,l,d),ne=a.prevZ,ae=a.nextZ;ne&&ne.z>=te&&ae&&ae.z<=ce;){if(ne.x>=B&&ne.x<=j&&ne.y>=z&&ne.y<=Y&&ne!==p&&ne!==v&&zh(w,k,D,P,S,F,ne.x,ne.y)&&gr(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,ae.x>=B&&ae.x<=j&&ae.y>=z&&ae.y<=Y&&ae!==p&&ae!==v&&zh(w,k,D,P,S,F,ae.x,ae.y)&&gr(ae.prev,ae,ae.next)>=0))return!1;ae=ae.nextZ}for(;ne&&ne.z>=te;){if(ne.x>=B&&ne.x<=j&&ne.y>=z&&ne.y<=Y&&ne!==p&&ne!==v&&zh(w,k,D,P,S,F,ne.x,ne.y)&&gr(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;ae&&ae.z<=ce;){if(ae.x>=B&&ae.x<=j&&ae.y>=z&&ae.y<=Y&&ae!==p&&ae!==v&&zh(w,k,D,P,S,F,ae.x,ae.y)&&gr(ae.prev,ae,ae.next)>=0)return!1;ae=ae.nextZ}return!0}function Sy(a,o,l){var d=a;do{var p=d.prev,_=d.next.next;!xf(p,_)&&N0(p,d,d.next,_)&&Cf(p,_)&&Cf(_,p)&&(o.push(p.i/l|0),o.push(d.i/l|0),o.push(_.i/l|0),Ef(d),Ef(d.next),d=a=_),d=d.next}while(d!==a);return gd(d)}function O0(a,o,l,d,p,_){var v=a;do{for(var w=v.next.next;w!==v.prev;){if(v.i!==w.i&&L0(v,w)){var D=ug(v,w);return v=gd(v,v.next),D=gd(D,D.next),vf(v,o,l,d,p,_,0),void vf(D,o,l,d,p,_,0)}w=w.next}v=v.next}while(v!==a)}function My(a,o){return a.x-o.x}function Yo(a,o){var l=function(p,_){var v,w=_,D=p.x,S=p.y,k=-1/0;do{if(S<=w.y&&S>=w.next.y&&w.next.y!==w.y){var P=w.x+(S-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(P<=D&&P>k&&(k=P,v=w.x<w.next.x?w:w.next,P===D))return v}w=w.next}while(w!==_);if(!v)return null;var F,B=v,z=v.x,j=v.y,Y=1/0;w=v;do{D>=w.x&&w.x>=z&&D!==w.x&&zh(S<j?D:k,S,z,j,S<j?k:D,S,w.x,w.y)&&(F=Math.abs(S-w.y)/(D-w.x),Cf(w,p)&&(F<Y||F===Y&&(w.x>v.x||w.x===v.x&&bf(v,w)))&&(v=w,Y=F)),w=w.next}while(w!==B);return v}(a,o);if(!l)return o;var d=ug(l,a);return gd(d,d.next),gd(l,l.next)}function bf(a,o){return gr(a.prev,a,o.prev)<0&&gr(o.next,a,a.next)<0}function cg(a,o,l,d,p){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*p|0)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-d)*p|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function F0(a){var o=a,l=a;do{(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next}while(o!==a);return l}function zh(a,o,l,d,p,_,v,w){return(p-v)*(o-w)>=(a-v)*(_-w)&&(a-v)*(d-w)>=(l-v)*(o-w)&&(l-v)*(_-w)>=(p-v)*(d-w)}function L0(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function(l,d){var p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==d.i&&p.next.i!==d.i&&N0(p,p.next,l,d))return!0;p=p.next}while(p!==l);return!1}(a,o)&&(Cf(a,o)&&Cf(o,a)&&function(l,d){var p=l,_=!1,v=(l.x+d.x)/2,w=(l.y+d.y)/2;do{p.y>w!=p.next.y>w&&p.next.y!==p.y&&v<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next}while(p!==l);return _}(a,o)&&(gr(a.prev,a,o.prev)||gr(a,o.prev,o))||xf(a,o)&&gr(a.prev,a,a.next)>0&&gr(o.prev,o,o.next)>0)}function gr(a,o,l){return(o.y-a.y)*(l.x-o.x)-(o.x-a.x)*(l.y-o.y)}function xf(a,o){return a.x===o.x&&a.y===o.y}function N0(a,o,l,d){var p=dg(gr(a,o,l)),_=dg(gr(a,o,d)),v=dg(gr(l,d,a)),w=dg(gr(l,d,o));return p!==_&&v!==w||!(0!==p||!wf(a,l,o))||!(0!==_||!wf(a,d,o))||!(0!==v||!wf(l,a,d))||!(0!==w||!wf(l,o,d))}function wf(a,o,l){return o.x<=Math.max(a.x,l.x)&&o.x>=Math.min(a.x,l.x)&&o.y<=Math.max(a.y,l.y)&&o.y>=Math.min(a.y,l.y)}function dg(a){return a>0?1:a<0?-1:0}function Cf(a,o){return gr(a.prev,a,a.next)<0?gr(a,o,a.next)>=0&&gr(a,a.prev,o)>=0:gr(a,o,a.prev)<0||gr(a,a.next,o)<0}function ug(a,o){var l=new fu(a.i,a.x,a.y),d=new fu(o.i,o.x,o.y),p=a.next,_=o.prev;return a.next=o,o.prev=a,l.next=p,p.prev=l,d.next=l,l.prev=d,_.next=d,d.prev=_,d}function hg(a,o,l,d){var p=new fu(a,o,l);return d?(p.next=d.next,p.prev=d,d.next.prev=p,d.next=p):(p.prev=p,p.next=p),p}function Ef(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function fu(a,o,l){this.i=a,this.x=o,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ty(a,o,l,d){for(var p=0,_=o,v=l-d;_<l;_+=d)p+=(a[v]-a[_])*(a[_+1]+a[v+1]),v=_;return p}Dy.exports=lg,Dy.exports.default=lg,lg.deviation=function(a,o,l,d){var p=o&&o.length,_=Math.abs(Ty(a,0,p?o[0]*l:a.length,l));if(p)for(var v=0,w=o.length;v<w;v++)_-=Math.abs(Ty(a,o[v]*l,v<w-1?o[v+1]*l:a.length,l));var D=0;for(v=0;v<d.length;v+=3){var S=d[v]*l,k=d[v+1]*l,P=d[v+2]*l;D+=Math.abs((a[S]-a[P])*(a[k+1]-a[S+1])-(a[S]-a[k])*(a[P+1]-a[S+1]))}return 0===_&&0===D?0:Math.abs((D-_)/_)},lg.flatten=function(a){for(var o=a[0][0].length,l={vertices:[],holes:[],dimensions:o},d=0,p=0;p<a.length;p++){for(var _=0;_<a[p].length;_++)for(var v=0;v<o;v++)l.vertices.push(a[p][_][v]);p>0&&l.holes.push(d+=a[p-1].length)}return l};var Ay=xo(Dy.exports);function Iy(a,o,l,d,p){pg(a,o,l||0,d||a.length-1,p||Uh)}function pg(a,o,l,d,p){for(;d>l;){if(d-l>600){var _=d-l+1,v=o-l+1,w=Math.log(_),D=.5*Math.exp(2*w/3),S=.5*Math.sqrt(w*D*(_-D)/_)*(v-_/2<0?-1:1);pg(a,o,Math.max(l,Math.floor(o-v*D/_+S)),Math.min(d,Math.floor(o+(_-v)*D/_+S)),p)}var k=a[o],P=l,F=d;for(Vh(a,l,o),p(a[d],k)>0&&Vh(a,l,d);P<F;){for(Vh(a,P,F),P++,F--;p(a[P],k)<0;)P++;for(;p(a[F],k)>0;)F--}0===p(a[l],k)?Vh(a,l,F):Vh(a,++F,d),F<=o&&(l=F+1),o<=F&&(d=F-1)}}function Vh(a,o,l){var d=a[o];a[o]=a[l],a[l]=d}function Uh(a,o){return a<o?-1:a>o?1:0}function jh(a,o){const l=a.length;if(l<=1)return[a];const d=[];let p,_;for(let v=0;v<l;v++){const w=Qu(a[v]);0!==w&&(a[v].area=Math.abs(w),void 0===_&&(_=w<0),_===w<0?(p&&d.push(p),p=[a[v]]):p.push(a[v]))}if(p&&d.push(p),o>1)for(let v=0;v<d.length;v++)d[v].length<=o||(Iy(d[v],o,1,d[v].length-1,B0),d[v]=d[v].slice(0,o));return d}function B0(a,o){return o.area-a.area}function Df(a,o,l){const d=l.patternDependencies;let p=!1;for(const _ of o){const v=_.paint.get(`${a}-pattern`);v.isConstant()||(p=!0);const w=v.constantOr(null);w&&(p=!0,d[w]=!0)}return p}function Hh(a,o,l,d,p){const _=p.patternDependencies;for(const v of o){const w=v.paint.get(`${a}-pattern`).value;if("constant"!==w.kind){let D=w.evaluate({zoom:d},l,{},p.availableImages);D=D&&D.name?D.name:D,_[D]=!0,l.patterns[v.id]=D}}return l}class fg{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Je,this.indexArray=new At,this.indexArray2=new qe,this.programConfigurations=new uc(o.layers,o.zoom),this.segments=new rr,this.segments2=new rr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=o.projection}populate(o,l,d,p){this.hasPattern=Df("fill",this.layers,l);const _=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:w,id:D,index:S,sourceLayerIndex:k}of o){const P=this.layers[0]._featureFilter.needGeometry,F=Nh(w,P);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),F,d))continue;const B=_?_.evaluate(F,{},d,l.availableImages):void 0,z={id:D,properties:w.properties,type:w.type,sourceLayerIndex:k,index:S,geometry:P?F.geometry:gc(w,d,p),patterns:{},sortKey:B};v.push(z)}_&&v.sort((w,D)=>w.sortKey-D.sortKey);for(const w of v){const{geometry:D,index:S,sourceLayerIndex:k}=w;if(this.hasPattern){const P=Hh("fill",this.layers,w,this.zoom,l);this.patternFeatures.push(P)}else this.addFeature(w,D,S,d,{},l.availableImages);l.featureIndex.insert(o[S].feature,D,S,k,this.index)}}update(o,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,d,p)}addFeatures(o,l,d,p,_){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,l,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Ey),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,l,d,p,_,v=[]){for(const w of jh(l,500)){let D=0;for(const z of w)D+=z.length;const S=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),k=S.vertexLength,P=[],F=[];for(const z of w){if(0===z.length)continue;z!==w[0]&&F.push(P.length/2);const j=this.segments2.prepareSegment(z.length,this.layoutVertexArray,this.indexArray2),Y=j.vertexLength;this.layoutVertexArray.emplaceBack(z[0].x,z[0].y),this.indexArray2.emplaceBack(Y+z.length-1,Y),P.push(z[0].x),P.push(z[0].y);for(let te=1;te<z.length;te++)this.layoutVertexArray.emplaceBack(z[te].x,z[te].y),this.indexArray2.emplaceBack(Y+te-1,Y+te),P.push(z[te].x),P.push(z[te].y);j.vertexLength+=z.length,j.primitiveLength+=z.length}const B=Ay(P,F);for(let z=0;z<B.length;z+=3)this.indexArray.emplaceBack(k+B[z],k+B[z+1],k+B[z+2]);S.vertexLength+=D,S.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,_,v,p)}}Dt(fg,"FillBucket",{omit:["layers","patternFeatures"]});const _C=new re({"fill-sort-key":new Z(ze.layout_fill["fill-sort-key"])});var yC={paint:new re({"fill-antialias":new U(ze.paint_fill["fill-antialias"]),"fill-opacity":new Z(ze.paint_fill["fill-opacity"]),"fill-color":new Z(ze.paint_fill["fill-color"]),"fill-outline-color":new Z(ze.paint_fill["fill-outline-color"]),"fill-translate":new U(ze.paint_fill["fill-translate"]),"fill-translate-anchor":new U(ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new Z(ze.paint_fill["fill-pattern"])}),layout:_C};const vC=ve([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),bC=ve([{name:"a_centroid_pos",components:2,type:"Uint16"}]),xC=ve([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:z0}=vC;var $h={},V0=vs,mg=Gh;function Gh(a,o,l,d,p){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=p,a.readFields(wC,this,o)}function wC(a,o,l){1==a?o.id=l.readVarint():2==a?function(d,p){for(var _=d.readVarint()+d.pos;d.pos<_;){var v=p._keys[d.readVarint()],w=p._values[d.readVarint()];p.properties[v]=w}}(l,o):3==a?o.type=l.readVarint():4==a&&(o._geometry=l.pos)}function ky(a){for(var o,l,d=0,p=0,_=a.length,v=_-1;p<_;v=p++)d+=((l=a[v]).x-(o=a[p]).x)*(o.y+l.y);return d}Gh.types=["Unknown","Point","LineString","Polygon"],Gh.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var o,l=a.readVarint()+a.pos,d=1,p=0,_=0,v=0,w=[];a.pos<l;){if(p<=0){var D=a.readVarint();d=7&D,p=D>>3}if(p--,1===d||2===d)_+=a.readSVarint(),v+=a.readSVarint(),1===d&&(o&&w.push(o),o=[]),o.push(new V0(_,v));else{if(7!==d)throw new Error("unknown command "+d);o&&o.push(o[0].clone())}}return o&&w.push(o),w},Gh.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var o=a.readVarint()+a.pos,l=1,d=0,p=0,_=0,v=1/0,w=-1/0,D=1/0,S=-1/0;a.pos<o;){if(d<=0){var k=a.readVarint();l=7&k,d=k>>3}if(d--,1===l||2===l)(p+=a.readSVarint())<v&&(v=p),p>w&&(w=p),(_+=a.readSVarint())<D&&(D=_),_>S&&(S=_);else if(7!==l)throw new Error("unknown command "+l)}return[v,D,w,S]},Gh.prototype.toGeoJSON=function(a,o,l){var d,p,_=this.extent*Math.pow(2,l),v=this.extent*a,w=this.extent*o,D=this.loadGeometry(),S=Gh.types[this.type];function k(B){for(var z=0;z<B.length;z++){var j=B[z];B[z]=[360*(j.x+v)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+w)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(d=0;d<D.length;d++)P[d]=D[d][0];k(D=P);break;case 2:for(d=0;d<D.length;d++)k(D[d]);break;case 3:for(D=function(B){var z=B.length;if(z<=1)return[B];for(var j,Y,te=[],ce=0;ce<z;ce++){var ne=ky(B[ce]);0!==ne&&(void 0===Y&&(Y=ne<0),Y===ne<0?(j&&te.push(j),j=[B[ce]]):j.push(B[ce]))}return j&&te.push(j),te}(D),d=0;d<D.length;d++)for(p=0;p<D[d].length;p++)k(D[d][p])}1===D.length?D=D[0]:S="Multi"+S;var F={type:"Feature",geometry:{type:S,coordinates:D},properties:this.properties};return"id"in this&&(F.id=this.id),F};var U0=mg,_d=Ry;function Ry(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(j0,this,o),this.length=this._features.length}function j0(a,o,l){15===a?o.version=l.readVarint():1===a?o.name=l.readString():5===a?o.extent=l.readVarint():2===a?o._features.push(l.pos):3===a?o._keys.push(l.readString()):4===a&&o._values.push(function(d){for(var p=null,_=d.readVarint()+d.pos;d.pos<_;){var v=d.readVarint()>>3;p=1===v?d.readString():2===v?d.readFloat():3===v?d.readDouble():4===v?d.readVarint64():5===v?d.readVarint():6===v?d.readSVarint():7===v?d.readBoolean():null}return p}(l))}Ry.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new U0(this._pbf,o,this.extent,this._keys,this._values)};var CC=_d;function yT(a,o,l){if(3===a){var d=new CC(l,l.readVarint()+l.pos);d.length&&(o[d.name]=d)}}var qh=$h.VectorTile=function(a,o){this.layers=a.readFields(yT,{},o)},gg=$h.VectorTileFeature=mg;function Sf(a,o,l,d){const p=[],_=0===d?(v,w,D,S,k,P)=>{v.push(new pt(P,D+(P-w)/(S-w)*(k-D)))}:(v,w,D,S,k,P)=>{v.push(new pt(w+(P-D)/(k-D)*(S-w),P))};for(const v of a){const w=[];for(const D of v){if(D.length<=2)continue;const S=[];for(let F=0;F<D.length-1;F++){const B=D[F].x,z=D[F].y,j=D[F+1].x,Y=D[F+1].y,te=0===d?B:z,ce=0===d?j:Y;te<o?ce>o&&_(S,B,z,j,Y,o):te>l?ce<l&&_(S,B,z,j,Y,l):S.push(D[F]),ce<o&&te>=o&&_(S,B,z,j,Y,o),ce>l&&te<=l&&_(S,B,z,j,Y,l)}let k=D[D.length-1];const P=0===d?k.x:k.y;P>=o&&P<=l&&S.push(k),S.length&&(k=S[S.length-1],S[0].x===k.x&&S[0].y===k.y||S.push(S[0]),w.push(S))}w.length&&p.push(w)}return p}$h.VectorTileLayer=_d;const H0=gg.types,$0=Math.pow(2,13);function mu(a,o,l,d,p,_,v,w){a.emplaceBack((o<<1)+v,(l<<1)+_,(Math.floor(d*$0)<<1)+p,Math.round(w))}function Wh(a,o,l){a.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class Mf{constructor(){this.acc=new pt(0,0),this.polyCount=[]}startRing(o){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new pt(o.x,o.y),this.max=new pt(o.x,o.y))}append(o,l){this.currentPolyCount.edges++,this.acc._add(o);const d=this.min,p=this.max;o.x<d.x?d.x=o.x:o.x>p.x&&(p.x=o.x),o.y<d.y?d.y=o.y:o.y>p.y&&(p.y=o.y),((0===o.x||o.x===Ot)&&o.x===l.x)!=((0===o.y||o.y===Ot)&&o.y===l.y)&&this.processBorderOverlap(o,l),l.x<0!=o.x<0&&this.addBorderIntersection(0,Hn(l.y,o.y,(0-l.x)/(o.x-l.x))),l.x>Ot!=o.x>Ot&&this.addBorderIntersection(1,Hn(l.y,o.y,(Ot-l.x)/(o.x-l.x))),l.y<0!=o.y<0&&this.addBorderIntersection(2,Hn(l.x,o.x,(0-l.y)/(o.y-l.y))),l.y>Ot!=o.y>Ot&&this.addBorderIntersection(3,Hn(l.x,o.x,(Ot-l.y)/(o.y-l.y)))}addBorderIntersection(o,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[o];l<d[0]&&(d[0]=l),l>d[1]&&(d[1]=l)}processBorderOverlap(o,l){if(o.x===l.x){if(o.y===l.y)return;const d=0===o.x?0:1;this.addBorderIntersection(d,l.y),this.addBorderIntersection(d,o.y)}else{const d=0===o.y?2:3;this.addBorderIntersection(d,l.x),this.addBorderIntersection(d,o.x)}}centroid(){const o=this.polyCount.reduce((l,d)=>l+d.edges,0);return 0!==o?this.acc.div(o)._round():new pt(0,0)}span(){return new pt(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((o,l)=>o+ +(l[0]!==Number.MAX_VALUE),0)}}class yc{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.layoutVertexArray=new Ve,this.centroidVertexArray=new ir,this.indexArray=new At,this.programConfigurations=new uc(o.layers,o.zoom),this.segments=new rr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=o.enableTerrain}populate(o,l,d,p){this.features=[],this.hasPattern=Df("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const v=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*v/(v*v+1)/Ot/(1<<_.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:v,index:w,sourceLayerIndex:D}of o){const S=this.layers[0]._featureFilter.needGeometry,k=Nh(_,S);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),k,d))continue;const P={id:v,sourceLayerIndex:D,index:w,geometry:S?k.geometry:gc(_,d,p),properties:_.properties,type:_.type,patterns:{}},F=this.layoutVertexArray.length;this.hasPattern?this.features.push(Hh("fill-extrusion",this.layers,P,this.zoom,l)):this.addFeature(P,P.geometry,w,d,{},l.availableImages,p),l.featureIndex.insert(_,P.geometry,w,D,this.index,F)}this.sortBorders()}addFeatures(o,l,d,p,_){for(const v of this.features){const{geometry:w}=v;this.addFeature(v,w,v.index,l,d,p,_)}this.sortBorders()}update(o,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,z0),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,xC.members,!0))),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,bC.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,l,d,p,_,v,w){const D=[new pt(0,0),new pt(Ot,Ot)],S=w.projection,k="globe"===S.name,P=this.enableTerrain&&!k?new Mf:null,F="Polygon"===H0[o.type];k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new tt);const B=jh(l,500);for(let te=B.length-1;te>=0;te--){const ce=B[te];(0===ce.length||(z=ce[0]).every(ne=>ne.x<=0)||z.every(ne=>ne.x>=Ot)||z.every(ne=>ne.y<=0)||z.every(ne=>ne.y>=Ot))&&B.splice(te,1)}var z;let j;if(k)j=Ly(B,D,p);else{j=[];for(const te of B)j.push({polygon:te,bounds:D})}const Y=F?this.edgeRadius:0;for(const{polygon:te,bounds:ce}of j){let ne=0,ae=0;for(const he of te)F&&!he[0].equals(he[he.length-1])&&he.push(he[0]),ae+=F?he.length-1:he.length;const pe=this.segments.prepareSegment((F?5:4)*ae,this.layoutVertexArray,this.indexArray);if(F){const he=[],Te=[];ne=pe.vertexLength;for(const Ue of te){let nt,Fe;Ue.length&&Ue!==te[0]&&Te.push(he.length/2),nt=Ue[1].sub(Ue[0])._perp()._unit();for(let Ge=1;Ge<Ue.length;Ge++){const je=Ue[Ge],Xe=Ue[Ge===Ue.length-1?1:Ge+1];let{x:lt,y:Be}=je;if(Y){Fe=Xe.sub(je)._perp()._unit();const ft=nt.add(Fe)._unit(),St=Y*Math.min(4,1/(nt.x*ft.x+nt.y*ft.y));lt+=St*ft.x,Be+=St*ft.y,nt=Fe}mu(this.layoutVertexArray,lt,Be,0,0,1,1,0),pe.vertexLength++,he.push(je.x,je.y),k&&Wh(this.layoutVertexExtArray,S.projectTilePoint(lt,Be,p),S.upVector(p,lt,Be))}}const Se=Ay(he,Te);for(let Ue=0;Ue<Se.length;Ue+=3)this.indexArray.emplaceBack(ne+Se[Ue],ne+Se[Ue+2],ne+Se[Ue+1]),pe.primitiveLength++}for(const he of te){P&&he.length&&P.startRing(he[0]);let Te,Se,Ue,nt=he.length>4&&_g(he[he.length-2],he[0],he[1]),Fe=Y?Oy(he[he.length-2],he[0],he[1],Y):0;Se=he[1].sub(he[0])._perp()._unit();let Ge=!0;for(let je=1,Xe=0;je<he.length;je++){let lt=he[je-1],Be=he[je];const ft=he[je===he.length-1?1:je+1];if(P&&F&&P.currentPolyCount.top++,Fy(Be,lt,ce)){Y&&(Se=ft.sub(Be)._perp()._unit(),Ge=!Ge);continue}P&&P.append(Be,lt);const St=Be.sub(lt)._perp(),_t=St.x/(Math.abs(St.x)+Math.abs(St.y)),en=St.y>0?1:0,st=lt.dist(Be);if(Xe+st>32768&&(Xe=0),Y){Ue=ft.sub(Be)._perp()._unit();let an=Tf(lt,Be,ft,Py(Se,Ue),Y);isNaN(an)&&(an=0);const Ht=Be.sub(lt)._unit();lt=lt.add(Ht.mult(Fe))._round(),Be=Be.add(Ht.mult(-an))._round(),Fe=an,Se=Ue}const Ft=pe.vertexLength,sn=he.length>4&&_g(lt,Be,ft);let Gn=Zh(Xe,nt,Ge);if(mu(this.layoutVertexArray,lt.x,lt.y,_t,en,0,0,Gn),mu(this.layoutVertexArray,lt.x,lt.y,_t,en,0,1,Gn),Xe+=st,Gn=Zh(Xe,sn,!Ge),nt=sn,mu(this.layoutVertexArray,Be.x,Be.y,_t,en,0,0,Gn),mu(this.layoutVertexArray,Be.x,Be.y,_t,en,0,1,Gn),pe.vertexLength+=4,this.indexArray.emplaceBack(Ft+0,Ft+1,Ft+2),this.indexArray.emplaceBack(Ft+1,Ft+3,Ft+2),pe.primitiveLength+=2,Y){const an=ne+(1===je?he.length-2:je-2),Ht=1===je?ne:an+1;if(this.indexArray.emplaceBack(Ft+1,an,Ft+3),this.indexArray.emplaceBack(an,Ht,Ft+3),pe.primitiveLength+=2,void 0===Te&&(Te=Ft),!Fy(ft,he[je],ce)){const vi=je===he.length-1?Te:pe.vertexLength;this.indexArray.emplaceBack(Ft+2,Ft+3,vi),this.indexArray.emplaceBack(Ft+3,vi+1,vi),this.indexArray.emplaceBack(Ft+3,Ht,vi+1),pe.primitiveLength+=3}Ge=!Ge}if(k){const an=this.layoutVertexExtArray,Ht=S.projectTilePoint(lt.x,lt.y,p),vi=S.projectTilePoint(Be.x,Be.y,p),Yt=S.upVector(p,lt.x,lt.y),fn=S.upVector(p,Be.x,Be.y);Wh(an,Ht,Yt),Wh(an,Ht,Yt),Wh(an,vi,fn),Wh(an,vi,fn)}}F&&(ne+=he.length-1)}}if(P&&P.polyCount.length>0){if(P.borders){P.vertexArrayOffset=this.centroidVertexArray.length;const te=P.borders,ce=this.featuresOnBorder.push(P)-1;for(let ne=0;ne<4;ne++)te[ne][0]!==Number.MAX_VALUE&&this.borders[ne].push(ce)}this.encodeCentroid(P.borders?void 0:P.centroid(),P)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,_,v,p)}sortBorders(){for(let o=0;o<4;o++)this.borders[o].sort((l,d)=>this.featuresOnBorder[l].borders[o][0]-this.featuresOnBorder[d].borders[o][0])}encodeCentroid(o,l,d=!0){let p,_;if(o)if(0!==o.y){const w=l.span()._mult(this.tileToMeter);p=(Math.max(o.x,1)<<3)+Math.min(7,Math.round(w.x/10)),_=(Math.max(o.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else p=Math.ceil(7*(o.x+450)),_=0;else p=0,_=+d;let v=d?this.centroidVertexArray.length:l.vertexArrayOffset;for(const w of l.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let D=0;D<w.top;D++)this.centroidVertexArray.emplace(v++,p,_);for(let D=0;D<2*w.edges;D++)this.centroidVertexArray.emplace(v++,0,_),this.centroidVertexArray.emplace(v++,p,_)}}}function Py(a,o){const l=a.add(o)._unit();return a.x*l.x+a.y*l.y}function Oy(a,o,l,d){const p=o.sub(a)._perp()._unit(),_=l.sub(o)._perp()._unit();return Tf(a,o,l,Py(p,_),d)}function Tf(a,o,l,d,p){const _=Math.sqrt(1-d*d);return Math.min(a.dist(o)/3,o.dist(l)/3,p*_/d)}function Fy(a,o,l){return a.x<l[0].x&&o.x<l[0].x||a.x>l[1].x&&o.x>l[1].x||a.y<l[0].y&&o.y<l[0].y||a.y>l[1].y&&o.y>l[1].y}function _g(a,o,l){if(a.x<0||a.x>=Ot||o.x<0||o.x>=Ot||l.x<0||l.x>=Ot)return!1;const d=l.sub(o),p=d.perp(),_=a.sub(o);return(d.x*_.x+d.y*_.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(_.x*_.x+_.y*_.y))>-.866&&p.x*_.x+p.y*_.y<0}function Zh(a,o,l){const d=o?2|a:-3&a;return l?1|d:-2&d}function G0(){const a=Math.PI/32,o=Math.tan(a),l=mf;return l*Math.sqrt(1+2*o*o)-l}function Ly(a,o,l){const d=1<<l.z,p=br(l.x/d),_=br((l.x+1)/d),v=po(l.y/d),w=po((l.y+1)/d);return function(D,S,k,P,F=0,B){const z=[];if(!D.length||!k||!P)return z;const j=(he,Te)=>{for(const Se of he)z.push({polygon:Se,bounds:Te})},Y=Math.ceil(Math.log2(k)),te=Math.ceil(Math.log2(P)),ce=Y-te,ne=[];for(let he=0;he<Math.abs(ce);he++)ne.push(ce>0?0:1);for(let he=0;he<Math.min(Y,te);he++)ne.push(0),ne.push(1);let ae=D;if(ae=Sf(ae,S[0].y-F,S[1].y+F,1),ae=Sf(ae,S[0].x-F,S[1].x+F,0),!ae.length)return z;const pe=[];for(ne.length?pe.push({polygons:ae,bounds:S,depth:0}):j(ae,S);pe.length;){const he=pe.pop(),Te=he.depth,Se=ne[Te],Ue=he.bounds[0],nt=he.bounds[1],Fe=0===Se?Ue.x:Ue.y,Ge=0===Se?nt.x:nt.y,je=B?B(Se,Fe,Ge):.5*(Fe+Ge),Xe=Sf(he.polygons,Fe-F,je+F,Se),lt=Sf(he.polygons,je-F,Ge+F,Se);if(Xe.length){const Be=[Ue,new pt(0===Se?je:nt.x,1===Se?je:nt.y)];ne.length>Te+1?pe.push({polygons:Xe,bounds:Be,depth:Te+1}):j(Xe,Be)}if(lt.length){const Be=[new pt(0===Se?je:Ue.x,1===Se?je:Ue.y),nt];ne.length>Te+1?pe.push({polygons:lt,bounds:Be,depth:Te+1}):j(lt,Be)}}return z}(a,o,Math.ceil((_-p)/11.25),Math.ceil((v-w)/11.25),1,(D,S,k)=>{if(0===D)return.5*(S+k);{const P=po((l.y+S/Ot)/d);return(Er(.5*(po((l.y+k/Ot)/d)+P))*d-l.y)*Ot}})}Dt(yc,"FillExtrusionBucket",{omit:["layers","features"]}),Dt(Mf,"PartMetadata");const EC=new re({"fill-extrusion-edge-radius":new U(ze["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var DC={paint:new re({"fill-extrusion-opacity":new U(ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Z(ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new U(ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new U(ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Z(ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Z(ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Z(ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new U(ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new U(ze["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new U(ze["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new U(ze["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:EC};function q0(a,o,l){var d=2*Math.PI*6378137/256/Math.pow(2,l);return[a*d-2*Math.PI*6378137/2,o*d-2*Math.PI*6378137/2]}class Af{constructor(o,l,d){this.z=o,this.x=l,this.y=d,this.key=gu(0,o,o,l,d)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,l){const d=(v=this.y,w=this.z,D=q0(256*(_=this.x),256*(v=Math.pow(2,w)-v-1),w),S=q0(256*(_+1),256*(v+1),w),D[0]+","+D[1]+","+S[0]+","+S[1]),p=function(_,v,w){let D,S="";for(let k=_;k>0;k--)D=1<<k-1,S+=(v&D?1:0)+(w&D?2:0);return S}(this.z,this.x,this.y);var _,v,w,D,S;return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ny{constructor(o,l){this.wrap=o,this.canonical=l,this.key=gu(o,l.z,l.z,l.x,l.y)}}class Wr{constructor(o,l,d,p,_){this.overscaledZ=o,this.wrap=l,this.canonical=new Af(d,+p,+_),this.key=0===l&&o===d?this.canonical.key:gu(l,o,d,p,_)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const l=this.canonical.z-o;return o>this.canonical.z?new Wr(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Wr(o,this.wrap,o,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(o,l=!0){if(this.overscaledZ===o&&l)return this.key;if(o>this.canonical.z)return gu(this.wrap*+l,o,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-o;return gu(this.wrap*+l,o,o,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const l=this.canonical.z-o.canonical.z;return 0===o.overscaledZ||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>l&&o.canonical.y===this.canonical.y>>l}children(o){if(this.overscaledZ>=o)return[new Wr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,d=2*this.canonical.x,p=2*this.canonical.y;return[new Wr(l,this.wrap,l,d,p),new Wr(l,this.wrap,l,d+1,p),new Wr(l,this.wrap,l,d,p+1),new Wr(l,this.wrap,l,d+1,p+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new Wr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new Wr(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ny(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function gu(a,o,l,d,p){const _=1<<Math.min(l,22);let v=_*(p%_)+d%_;return a&&l<22&&(v+=_*_*((a<0?-2*a-1:2*a)%(1<<2*(22-l)))),16*(32*v+l)+(o-l)}Dt(Af,"CanonicalTileID"),Dt(Wr,"OverscaledTileID",{omit:["projMatrix"]});class Xa extends pt{constructor(o,l,d){super(o,l),this.z=d}}function If(a,o){return a.x*o.x+a.y*o.y}function W0(a,o){if(1===a.length){let l=0;const d=o[l++];let p;for(;!p||d.equals(p);)if(p=o[l++],!p)return 1/0;for(;l<o.length;l++){const _=o[l],v=a[0],w=p.sub(d),D=_.sub(d),S=v.sub(d),k=If(w,w),P=If(w,D),F=If(D,D),B=If(S,w),z=If(S,D),j=k*F-P*P,Y=(F*B-P*z)/j,te=(k*z-P*B)/j,ce=d.z*(1-Y-te)+p.z*Y+_.z*te;if(isFinite(ce))return ce}return 1/0}{let l=1/0;for(const d of o)l=Math.min(l,d.z);return l}}function SC(a,o,l,d,p,_,v,w){const D=v*p.getElevationAt(a,o,!0,!0),S=0!==_[0],k=S?0===_[1]?v*(_[0]/7-450):v*function(P,F,B){const z=Math.floor(F[0]/8),j=Math.floor(F[1]/8),Y=10*(F[0]-8*z),te=10*(F[1]-8*j),ce=P.getElevationAt(z,j,!0,!0),ne=P.getMeterToDEM(B),ae=Math.floor(.5*(Y*ne-1)),pe=Math.floor(.5*(te*ne-1)),he=P.tileCoordToPixel(z,j),Te=2*ae+1,Se=2*pe+1,Ue=(St=Te,_t=Se,[(lt=P).getElevationAtPixel(Be=he.x-ae,ft=he.y-pe,!0),lt.getElevationAtPixel(Be+_t,ft,!0),lt.getElevationAtPixel(Be,ft+_t,!0),lt.getElevationAtPixel(Be+St,ft+_t,!0)]),nt=Math.abs(Ue[0]-Ue[1]),Fe=Math.abs(Ue[2]-Ue[3]),Ge=Math.abs(Ue[0]-Ue[2])+Math.abs(Ue[1]-Ue[3]),je=Math.min(.25,.5*ne*(nt+Fe)/Te),Xe=Math.min(.25,.5*ne*Ge/Se);var lt,Be,ft,St,_t;return ce+Math.max(je*Y,Xe*te)}(p,_,w):D;return{base:D+(0===l)?-1:l,top:S?Math.max(k+d,D+l+2):D+d}}const MC=ve([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:By}=MC,TC=ve([{name:"a_packed",components:4,type:"Float32"}]),{members:kf}=TC,yg=gg.types,zy=Math.cos(Math.PI/180*37.5);class Rf{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Re,this.layoutVertexArray2=new Qe,this.indexArray=new At,this.programConfigurations=new uc(o.layers,o.zoom),this.segments=new rr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(o,l,d,p){this.hasPattern=Df("line",this.layers,l);const _=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:k,id:P,index:F,sourceLayerIndex:B}of o){const z=this.layers[0]._featureFilter.needGeometry,j=Nh(k,z);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),j,d))continue;const Y=_?_.evaluate(j,{},d):void 0,te={id:P,properties:k.properties,type:k.type,sourceLayerIndex:B,index:F,geometry:z?j.geometry:gc(k,d,p),patterns:{},sortKey:Y};v.push(te)}_&&v.sort((k,P)=>k.sortKey-P.sortKey);const{lineAtlas:w,featureIndex:D}=l,S=this.addConstantDashes(w);for(const k of v){const{geometry:P,index:F,sourceLayerIndex:B}=k;if(S&&this.addFeatureDashes(k,w),this.hasPattern){const z=Hh("line",this.layers,k,this.zoom,l);this.patternFeatures.push(z)}else this.addFeature(k,P,F,d,w.positions,l.availableImages);D.insert(o[F].feature,P,F,B,this.index)}}addConstantDashes(o){let l=!1;for(const d of this.layers){const p=d.paint.get("line-dasharray").value,_=d.layout.get("line-cap").value;if("constant"!==p.kind||"constant"!==_.kind)l=!0;else{const v=_.value,w=p.value;if(!w)continue;o.addDash(w,v)}}return l}addFeatureDashes(o,l){const d=this.zoom;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,v=p.layout.get("line-cap").value;if("constant"===_.kind&&"constant"===v.kind)continue;let w,D;if("constant"===_.kind){if(w=_.value,!w)continue}else w=_.evaluate({zoom:d},o);D="constant"===v.kind?v.value:v.evaluate({zoom:d},o),l.addDash(w,D),o.patterns[p.id]=l.getKey(w,D)}}update(o,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,d,p)}addFeatures(o,l,d,p,_){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,l,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,kf)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,By),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,l,d,p,_,v){const w=this.layers[0].layout,D=w.get("line-join").evaluate(o,{}),S=w.get("line-cap").evaluate(o,{}),k=w.get("line-miter-limit"),P=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const F of l)this.addLine(F,o,D,S,k,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,_,v,p)}addLine(o,l,d,p,_,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let te=0;te<o.length-1;te++)this.totalDistance+=o[te].dist(o[te+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w="Polygon"===yg[l.type];let D=o.length;for(;D>=2&&o[D-1].equals(o[D-2]);)D--;let S=0;for(;S<D-1&&o[S].equals(o[S+1]);)S++;if(D<(w?3:2))return;"bevel"===d&&(_=1.05);const k=this.overscaling<=16?15*Ot/(512*this.overscaling):0,P=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let F,B,z,j,Y;this.e1=this.e2=-1,w&&(F=o[D-2],Y=o[S].sub(F)._unit()._perp());for(let te=S;te<D;te++){if(z=te===D-1?w?o[S+1]:void 0:o[te+1],z&&o[te].equals(z))continue;Y&&(j=Y),F&&(B=F),F=o[te],Y=z?z.sub(F)._unit()._perp():j,j=j||Y;let ce=j.add(Y);0===ce.x&&0===ce.y||ce._unit();const ne=j.x*Y.x+j.y*Y.y,ae=ce.x*Y.x+ce.y*Y.y,pe=0!==ae?1/ae:1/0,he=2*Math.sqrt(2-2*ae),Te=ae<zy&&B&&z,Se=j.x*Y.y-j.y*Y.x>0;if(Te&&te>S){const Fe=F.dist(B);if(Fe>2*k){const Ge=F.sub(F.sub(B)._mult(k/Fe)._round());this.updateDistance(B,Ge),this.addCurrentVertex(Ge,j,0,0,P),B=Ge}}const Ue=B&&z;let nt=Ue?d:w?"butt":p;if(Ue&&"round"===nt&&(pe<v?nt="miter":pe<=2&&(nt="fakeround")),"miter"===nt&&pe>_&&(nt="bevel"),"bevel"===nt&&(pe>2&&(nt="flipbevel"),pe<_&&(nt="miter")),B&&this.updateDistance(B,F),"miter"===nt)ce._mult(pe),this.addCurrentVertex(F,ce,0,0,P);else if("flipbevel"===nt){if(pe>100)ce=Y.mult(-1);else{const Fe=pe*j.add(Y).mag()/j.sub(Y).mag();ce._perp()._mult(Fe*(Se?-1:1))}this.addCurrentVertex(F,ce,0,0,P),this.addCurrentVertex(F,ce.mult(-1),0,0,P)}else if("bevel"===nt||"fakeround"===nt){const Fe=-Math.sqrt(pe*pe-1),Ge=Se?Fe:0,je=Se?0:Fe;if(B&&this.addCurrentVertex(F,j,Ge,je,P),"fakeround"===nt){const Xe=Math.round(180*he/Math.PI/20);for(let lt=1;lt<Xe;lt++){let Be=lt/Xe;if(.5!==Be){const St=Be-.5;Be+=Be*St*(Be-1)*((1.0904+ne*(ne*(3.55645-1.43519*ne)-3.2452))*St*St+(.848013+ne*(.215638*ne-1.06021)))}const ft=Y.sub(j)._mult(Be)._add(j)._unit()._mult(Se?-1:1);this.addHalfVertex(F,ft.x,ft.y,!1,Se,0,P)}}z&&this.addCurrentVertex(F,Y,-Ge,-je,P)}else if("butt"===nt)this.addCurrentVertex(F,ce,0,0,P);else if("square"===nt){const Fe=B?1:-1;B||this.addCurrentVertex(F,ce,Fe,Fe,P),this.addCurrentVertex(F,ce,0,0,P),B&&this.addCurrentVertex(F,ce,Fe,Fe,P)}else"round"===nt&&(B&&(this.addCurrentVertex(F,j,0,0,P),this.addCurrentVertex(F,j,1,1,P,!0)),z&&(this.addCurrentVertex(F,Y,-1,-1,P,!0),this.addCurrentVertex(F,Y,0,0,P)));if(Te&&te<D-1){const Fe=F.dist(z);if(Fe>2*k){const Ge=F.add(z.sub(F)._mult(k/Fe)._round());this.updateDistance(F,Ge),this.addCurrentVertex(Ge,Y,0,0,P),F=Ge}}}}addCurrentVertex(o,l,d,p,_,v=!1){const w=l.y*p-l.x,D=-l.y-l.x*p;this.addHalfVertex(o,l.x+l.y*d,l.y-l.x*d,v,!1,d,_),this.addHalfVertex(o,w,D,v,!0,-p,_)}addHalfVertex({x:o,y:l},d,p,_,v,w,D){this.layoutVertexArray.emplaceBack((o<<1)+(_?1:0),(l<<1)+(v?1:0),Math.round(63*d)+128,Math.round(63*p)+128,1+(0===w?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const S=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,S),D.primitiveLength++),v?this.e2=S:this.e1=S}updateScaledDistance(){if(this.lineClips){const o=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=o*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(o,l){this.distance+=o.dist(l),this.updateScaledDistance()}}Dt(Rf,"LineBucket",{omit:["layers","patternFeatures"]});const Z0=new re({"line-cap":new Z(ze.layout_line["line-cap"]),"line-join":new Z(ze.layout_line["line-join"]),"line-miter-limit":new U(ze.layout_line["line-miter-limit"]),"line-round-limit":new U(ze.layout_line["line-round-limit"]),"line-sort-key":new Z(ze.layout_line["line-sort-key"])});var Vy={paint:new re({"line-opacity":new Z(ze.paint_line["line-opacity"]),"line-color":new Z(ze.paint_line["line-color"]),"line-translate":new U(ze.paint_line["line-translate"]),"line-translate-anchor":new U(ze.paint_line["line-translate-anchor"]),"line-width":new Z(ze.paint_line["line-width"]),"line-gap-width":new Z(ze.paint_line["line-gap-width"]),"line-offset":new Z(ze.paint_line["line-offset"]),"line-blur":new Z(ze.paint_line["line-blur"]),"line-dasharray":new Z(ze.paint_line["line-dasharray"]),"line-pattern":new Z(ze.paint_line["line-pattern"]),"line-gradient":new ie(ze.paint_line["line-gradient"]),"line-trim-offset":new U(ze.paint_line["line-trim-offset"])}),layout:Z0};const yd=new class extends Z{possiblyEvaluate(a,o){return o=new R(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(a,o)}evaluate(a,o,l,d){return o=Oi({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(a,o,l,d)}}(Vy.paint.properties["line-width"].specification);function Y0(a,o){return o>0?o+2*a:a}yd.useIntegerZoom=!0;const AC=ve([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),IC=ve([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),kC=ve([{name:"a_projected_pos",components:4,type:"Float32"}],4);ve([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const RC=ve([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ta=ve([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ve([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ka=ve([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),PC=ve([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ve([{name:"triangle",components:3,type:"Uint16"}]),ve([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ve([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ve([{type:"Float32",name:"offsetX"}]),ve([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Zr=24;const Ja=128;function Uy(a,o){const{expression:l}=o;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new R(a+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:d,interpolationType:p}=l;let _=0;for(;_<d.length&&d[_]<=a;)_++;_=Math.max(0,_-1);let v=_;for(;v<d.length&&d[v]<a+1;)v++;v=Math.min(d.length-1,v);const w=d[_],D=d[v];return"composite"===l.kind?{kind:"composite",minZoom:w,maxZoom:D,interpolationType:p}:{kind:"camera",minZoom:w,maxZoom:D,minSize:l.evaluate(new R(w)),maxSize:l.evaluate(new R(D)),interpolationType:p}}}function vg(a,{uSize:o,uSizeT:l},{lowerSize:d,upperSize:p}){return"source"===a.kind?d/Ja:"composite"===a.kind?Hn(d/Ja,p/Ja,l):o}function Yh(a,o){let l=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){const{interpolationType:p,minZoom:_,maxZoom:v}=a,w=p?wt(Ks.interpolationFactor(p,o,_,v),0,1):0;"camera"===a.kind?d=Hn(a.minSize,a.maxSize,w):l=w}return{uSizeT:l,uSize:d}}var X0=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ja,evaluateSizeForFeature:vg,evaluateSizeForZoom:Yh,getSizeData:Uy});function OC(a,o,l){return a.sections.forEach(d=>{d.text=function(p,_,v){const w=_.layout.get("text-transform").evaluate(v,{});return"uppercase"===w?p=p.toLocaleUpperCase():"lowercase"===w&&(p=p.toLocaleLowerCase()),I.applyArabicShaping&&(p=I.applyArabicShaping(p)),p}(d.text,o,l)}),a}const Pf={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function FC(a){return"\ufe36"===a||"\ufe48"===a||"\ufe38"===a||"\ufe44"===a||"\ufe42"===a||"\ufe3e"===a||"\ufe3c"===a||"\ufe3a"===a||"\ufe18"===a||"\ufe40"===a||"\ufe10"===a||"\ufe13"===a||"\ufe14"===a||"\uff40"===a||"\uffe3"===a||"\ufe11"===a||"\ufe12"===a}function LC(a){return"\ufe35"===a||"\ufe47"===a||"\ufe37"===a||"\ufe43"===a||"\ufe41"===a||"\ufe3d"===a||"\ufe3b"===a||"\ufe39"===a||"\ufe17"===a||"\ufe3f"===a}var Of=yi,Il=function(a,o,l,d,p){var _,v,w=8*p-d-1,D=(1<<w)-1,S=D>>1,k=-7,P=l?p-1:0,F=l?-1:1,B=a[o+P];for(P+=F,_=B&(1<<-k)-1,B>>=-k,k+=w;k>0;_=256*_+a[o+P],P+=F,k-=8);for(v=_&(1<<-k)-1,_>>=-k,k+=d;k>0;v=256*v+a[o+P],P+=F,k-=8);if(0===_)_=1-S;else{if(_===D)return v?NaN:1/0*(B?-1:1);v+=Math.pow(2,d),_-=S}return(B?-1:1)*v*Math.pow(2,_-d)},Xh=function(a,o,l,d,p,_){var v,w,D,S=8*_-p-1,k=(1<<S)-1,P=k>>1,F=23===p?Math.pow(2,-24)-Math.pow(2,-77):0,B=d?0:_-1,z=d?1:-1,j=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,v=k):(v=Math.floor(Math.log(o)/Math.LN2),o*(D=Math.pow(2,-v))<1&&(v--,D*=2),(o+=v+P>=1?F/D:F*Math.pow(2,1-P))*D>=2&&(v++,D/=2),v+P>=k?(w=0,v=k):v+P>=1?(w=(o*D-1)*Math.pow(2,p),v+=P):(w=o*Math.pow(2,P-1)*Math.pow(2,p),v=0));p>=8;a[l+B]=255&w,B+=z,w/=256,p-=8);for(v=v<<p|w,S+=p;S>0;a[l+B]=255&v,B+=z,v/=256,S-=8);a[l+B-z]|=128*j};function yi(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}yi.Varint=0,yi.Fixed64=1,yi.Bytes=2,yi.Fixed32=5;var bg=4294967296,jy=1/bg,NC=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function vd(a){return a.type===yi.Bytes?a.readVarint()+a.pos:a.pos+1}function xg(a,o,l){var d=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));l.realloc(d);for(var p=l.pos-1;p>=a;p--)l.buf[p+d]=l.buf[p]}function Hy(a,o){for(var l=0;l<a.length;l++)o.writeVarint(a[l])}function vT(a,o){for(var l=0;l<a.length;l++)o.writeSVarint(a[l])}function bT(a,o){for(var l=0;l<a.length;l++)o.writeFloat(a[l])}function K0(a,o){for(var l=0;l<a.length;l++)o.writeDouble(a[l])}function BC(a,o){for(var l=0;l<a.length;l++)o.writeBoolean(a[l])}function zC(a,o){for(var l=0;l<a.length;l++)o.writeFixed32(a[l])}function VC(a,o){for(var l=0;l<a.length;l++)o.writeSFixed32(a[l])}function UC(a,o){for(var l=0;l<a.length;l++)o.writeFixed64(a[l])}function J0(a,o){for(var l=0;l<a.length;l++)o.writeSFixed64(a[l])}function _u(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+16777216*a[o+3]}function yu(a,o,l){a[l]=o,a[l+1]=o>>>8,a[l+2]=o>>>16,a[l+3]=o>>>24}function wg(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+(a[o+3]<<24)}yi.prototype={destroy:function(){this.buf=null},readFields:function(a,o,l){for(l=l||this.length;this.pos<l;){var d=this.readVarint(),p=d>>3,_=this.pos;this.type=7&d,a(p,o,this),this.pos===_&&this.skip(d)}return o},readMessage:function(a,o){return this.readFields(a,o,this.readVarint()+this.pos)},readFixed32:function(){var a=_u(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=wg(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=_u(this.buf,this.pos)+_u(this.buf,this.pos+4)*bg;return this.pos+=8,a},readSFixed64:function(){var a=_u(this.buf,this.pos)+wg(this.buf,this.pos+4)*bg;return this.pos+=8,a},readFloat:function(){var a=Il(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Il(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var o,l,d=this.buf;return o=127&(l=d[this.pos++]),l<128?o:(o|=(127&(l=d[this.pos++]))<<7,l<128?o:(o|=(127&(l=d[this.pos++]))<<14,l<128?o:(o|=(127&(l=d[this.pos++]))<<21,l<128?o:function(p,_,v){var w,D,S=v.buf;if(w=(112&(D=S[v.pos++]))>>4,D<128||(w|=(127&(D=S[v.pos++]))<<3,D<128)||(w|=(127&(D=S[v.pos++]))<<10,D<128)||(w|=(127&(D=S[v.pos++]))<<17,D<128)||(w|=(127&(D=S[v.pos++]))<<24,D<128)||(w|=(1&(D=S[v.pos++]))<<31,D<128))return function Ff(a,o,l){return l?4294967296*o+(a>>>0):4294967296*(o>>>0)+(a>>>0)}(p,w,_);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(l=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,o=this.pos;return this.pos=a,a-o>=12&&NC?NC.decode(this.buf.subarray(o,a)):function(l,d,p){for(var _="",v=d;v<p;){var w,D,S,k=l[v],P=null,F=k>239?4:k>223?3:k>191?2:1;if(v+F>p)break;1===F?k<128&&(P=k):2===F?128==(192&(w=l[v+1]))&&(P=(31&k)<<6|63&w)<=127&&(P=null):3===F?(D=l[v+2],128==(192&(w=l[v+1]))&&128==(192&D)&&((P=(15&k)<<12|(63&w)<<6|63&D)<=2047||P>=55296&&P<=57343)&&(P=null)):4===F&&(D=l[v+2],S=l[v+3],128==(192&(w=l[v+1]))&&128==(192&D)&&128==(192&S)&&((P=(15&k)<<18|(63&w)<<12|(63&D)<<6|63&S)<=65535||P>=1114112)&&(P=null)),null===P?(P=65533,F=1):P>65535&&(P-=65536,_+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),_+=String.fromCharCode(P),v+=F}return _}(this.buf,o,a)},readBytes:function(){var a=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,a);return this.pos=a,o},readPackedVarint:function(a,o){if(this.type!==yi.Bytes)return a.push(this.readVarint(o));var l=vd(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){if(this.type!==yi.Bytes)return a.push(this.readSVarint());var o=vd(this);for(a=a||[];this.pos<o;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==yi.Bytes)return a.push(this.readBoolean());var o=vd(this);for(a=a||[];this.pos<o;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==yi.Bytes)return a.push(this.readFloat());var o=vd(this);for(a=a||[];this.pos<o;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==yi.Bytes)return a.push(this.readDouble());var o=vd(this);for(a=a||[];this.pos<o;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==yi.Bytes)return a.push(this.readFixed32());var o=vd(this);for(a=a||[];this.pos<o;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==yi.Bytes)return a.push(this.readSFixed32());var o=vd(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==yi.Bytes)return a.push(this.readFixed64());var o=vd(this);for(a=a||[];this.pos<o;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==yi.Bytes)return a.push(this.readSFixed64());var o=vd(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed64());return a},skip:function(a){var o=7&a;if(o===yi.Varint)for(;this.buf[this.pos++]>127;);else if(o===yi.Bytes)this.pos=this.readVarint()+this.pos;else if(o===yi.Fixed32)this.pos+=4;else{if(o!==yi.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(a,o){this.writeVarint(a<<3|o)},realloc:function(a){for(var o=this.length||16;o<this.pos+a;)o*=2;if(o!==this.length){var l=new Uint8Array(o);l.set(this.buf),this.buf=l,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),yu(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),yu(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),yu(this.buf,-1&a,this.pos),yu(this.buf,Math.floor(a*jy),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),yu(this.buf,-1&a,this.pos),yu(this.buf,Math.floor(a*jy),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(o,l){var d,p,_,w;if(o>=0?(d=o%4294967296|0,p=o/4294967296|0):(p=~(-o/4294967296),4294967295^(d=~(-o%4294967296))?d=d+1|0:(d=0,p=p+1|0)),o>=0x10000000000000000||o<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),_=d,(w=l).buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,w.buf[w.pos]=127&(_>>>=7),function(_,v){var w=(7&_)<<4;v.buf[v.pos++]|=w|((_>>>=3)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_)))))}(p,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(d,p,_){for(var v,w,D=0;D<p.length;D++){if((v=p.charCodeAt(D))>55295&&v<57344){if(!w){v>56319||D+1===p.length?(d[_++]=239,d[_++]=191,d[_++]=189):w=v;continue}if(v<56320){d[_++]=239,d[_++]=191,d[_++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(d[_++]=239,d[_++]=191,d[_++]=189,w=null);v<128?d[_++]=v:(v<2048?d[_++]=v>>6|192:(v<65536?d[_++]=v>>12|224:(d[_++]=v>>18|240,d[_++]=v>>12&63|128),d[_++]=v>>6&63|128),d[_++]=63&v|128)}return _}(this.buf,a,this.pos);var l=this.pos-o;l>=128&&xg(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),Xh(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Xh(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var o=a.length;this.writeVarint(o),this.realloc(o);for(var l=0;l<o;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,o){this.pos++;var l=this.pos;a(o,this);var d=this.pos-l;d>=128&&xg(l,d,this),this.pos=l-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,o,l){this.writeTag(a,yi.Bytes),this.writeRawMessage(o,l)},writePackedVarint:function(a,o){o.length&&this.writeMessage(a,Hy,o)},writePackedSVarint:function(a,o){o.length&&this.writeMessage(a,vT,o)},writePackedBoolean:function(a,o){o.length&&this.writeMessage(a,BC,o)},writePackedFloat:function(a,o){o.length&&this.writeMessage(a,bT,o)},writePackedDouble:function(a,o){o.length&&this.writeMessage(a,K0,o)},writePackedFixed32:function(a,o){o.length&&this.writeMessage(a,zC,o)},writePackedSFixed32:function(a,o){o.length&&this.writeMessage(a,VC,o)},writePackedFixed64:function(a,o){o.length&&this.writeMessage(a,UC,o)},writePackedSFixed64:function(a,o){o.length&&this.writeMessage(a,J0,o)},writeBytesField:function(a,o){this.writeTag(a,yi.Bytes),this.writeBytes(o)},writeFixed32Field:function(a,o){this.writeTag(a,yi.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(a,o){this.writeTag(a,yi.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(a,o){this.writeTag(a,yi.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(a,o){this.writeTag(a,yi.Fixed64),this.writeSFixed64(o)},writeVarintField:function(a,o){this.writeTag(a,yi.Varint),this.writeVarint(o)},writeSVarintField:function(a,o){this.writeTag(a,yi.Varint),this.writeSVarint(o)},writeStringField:function(a,o){this.writeTag(a,yi.Bytes),this.writeString(o)},writeFloatField:function(a,o){this.writeTag(a,yi.Fixed32),this.writeFloat(o)},writeDoubleField:function(a,o){this.writeTag(a,yi.Fixed64),this.writeDouble(o)},writeBooleanField:function(a,o){this.writeVarintField(a,!!o)}};var Cg=xo(Of);const hi=3;function jC(a,o,l){o.glyphs=[],1===a&&l.readMessage(HC,o)}function HC(a,o,l){if(3===a){const{id:d,bitmap:p,width:_,height:v,left:w,top:D,advance:S}=l.readMessage($y,{});o.glyphs.push({id:d,bitmap:new Ca({width:_+2*hi,height:v+2*hi},p),metrics:{width:_,height:v,left:w,top:D,advance:S}})}else 4===a?o.ascender=l.readSVarint():5===a&&(o.descender=l.readSVarint())}function $y(a,o,l){1===a?o.id=l.readVarint():2===a?o.bitmap=l.readBytes():3===a?o.width=l.readVarint():4===a?o.height=l.readVarint():5===a?o.left=l.readSVarint():6===a?o.top=l.readSVarint():7===a&&(o.advance=l.readVarint())}const Gy=hi;function qy(a){let o=0,l=0;for(const v of a)o+=v.w*v.h,l=Math.max(l,v.w);a.sort((v,w)=>w.h-v.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),l),h:1/0}];let p=0,_=0;for(const v of a)for(let w=d.length-1;w>=0;w--){const D=d[w];if(!(v.w>D.w||v.h>D.h)){if(v.x=D.x,v.y=D.y,_=Math.max(_,v.y+v.h),p=Math.max(p,v.x+v.w),v.w===D.w&&v.h===D.h){const S=d.pop();w<d.length&&(d[w]=S)}else v.h===D.h?(D.x+=v.w,D.w-=v.w):v.w===D.w?(D.y+=v.h,D.h-=v.h):(d.push({x:D.x+v.w,y:D.y,w:D.w-v.w,h:v.h}),D.y+=v.h,D.h-=v.h);break}}return{w:p,h:_,fill:o/(p*_)||0}}const gs=1;class Wy{constructor(o,{pixelRatio:l,version:d,stretchX:p,stretchY:_,content:v}){this.paddedRect=o,this.pixelRatio=l,this.stretchX=p,this.stretchY=_,this.content=v,this.version=d}get tl(){return[this.paddedRect.x+gs,this.paddedRect.y+gs]}get br(){return[this.paddedRect.x+this.paddedRect.w-gs,this.paddedRect.y+this.paddedRect.h-gs]}get displaySize(){return[(this.paddedRect.w-2*gs)/this.pixelRatio,(this.paddedRect.h-2*gs)/this.pixelRatio]}}class Q0{constructor(o,l){const d={},p={};this.haveRenderCallbacks=[];const _=[];this.addImages(o,d,_),this.addImages(l,p,_);const{w:v,h:w}=qy(_),D=new qi({width:v||1,height:w||1});for(const S in o){const k=o[S],P=d[S].paddedRect;qi.copy(k.data,D,{x:0,y:0},{x:P.x+gs,y:P.y+gs},k.data)}for(const S in l){const k=l[S],P=p[S].paddedRect,F=P.x+gs,B=P.y+gs,z=k.data.width,j=k.data.height;qi.copy(k.data,D,{x:0,y:0},{x:F,y:B},k.data),qi.copy(k.data,D,{x:0,y:j-1},{x:F,y:B-1},{width:z,height:1}),qi.copy(k.data,D,{x:0,y:0},{x:F,y:B+j},{width:z,height:1}),qi.copy(k.data,D,{x:z-1,y:0},{x:F-1,y:B},{width:1,height:j}),qi.copy(k.data,D,{x:0,y:0},{x:F+z,y:B},{width:1,height:j})}this.image=D,this.iconPositions=d,this.patternPositions=p}addImages(o,l,d){for(const p in o){const _=o[p],v={x:0,y:0,w:_.data.width+2*gs,h:_.data.height+2*gs};d.push(v),l[p]=new Wy(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(o,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>o.hasImage(d)),o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in o.updatedImages)this.patchUpdatedImage(this.iconPositions[d],o.getImage(d),l),this.patchUpdatedImage(this.patternPositions[d],o.getImage(d),l)}patchUpdatedImage(o,l,d){if(!o||!l||o.version===l.version)return;o.version=l.version;const[p,_]=o.tl;d.update(l.data,void 0,{x:p,y:_})}}Dt(Wy,"ImagePosition"),Dt(Q0,"ImageAtlas");const Ls={horizontal:1,vertical:2,horizontalOnly:3},$C=-17;class Eg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,l){const d=new Eg;return d.scale=o||1,d.fontStack=l,d}static forImage(o){const l=new Eg;return l.imageName=o,l}}class kl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,l){const d=new kl;for(let p=0;p<o.sections.length;p++){const _=o.sections[p];_.image?d.addImageSection(_):d.addTextSection(_,l)}return d}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(o){this.text=function(l,d){let p="";for(let _=0;_<l.length;_++){const v=l.charCodeAt(_+1)||null,w=l.charCodeAt(_-1)||null;p+=!d&&(v&&ru(v)&&!Pf[l[_+1]]||w&&ru(w)&&!Pf[l[_-1]])||!Pf[l[_]]?l[_]:Pf[l[_]]}return p}(this.text,o)}trim(){let o=0;for(let d=0;d<this.text.length&&bd[this.text.charCodeAt(d)];d++)o++;let l=this.text.length;for(let d=this.text.length-1;d>=0&&d>=o&&bd[this.text.charCodeAt(d)];d--)l--;this.text=this.text.substring(o,l),this.sectionIndex=this.sectionIndex.slice(o,l)}substring(o,l){const d=new kl;return d.text=this.text.substring(o,l),d.sectionIndex=this.sectionIndex.slice(o,l),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,l)=>Math.max(o,this.sections[l].scale),0)}addTextSection(o,l){this.text+=o.text,this.sections.push(Eg.forText(o.scale,o.fontStack||l));const d=this.sections.length-1;for(let p=0;p<o.text.length;++p)this.sectionIndex.push(d)}addImageSection(o){const l=o.image?o.image.name:"";if(0===l.length)return void ji("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(Eg.forImage(l)),this.sectionIndex.push(this.sections.length-1)):ji("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ke(a,o,l,d,p,_,v,w,D,S,k,P,F,B,z){const j=kl.fromFeature(a,p);P===Ls.vertical&&j.verticalizePunctuation(F);let Y=[];const te=function(he,Te,Se,Ue,nt,Fe){if(!he)return[];const Ge=[],je=function(ft,St,_t,en,st,Ft){let sn=0;for(let Gn=0;Gn<ft.length();Gn++){const an=ft.getSection(Gn);sn+=Zy(ft.getCharCode(Gn),an,en,st,St,Ft)}return sn/Math.max(1,Math.ceil(sn/_t))}(he,Te,Se,Ue,nt,Fe),Xe=he.text.indexOf("\u200b")>=0;let lt=0;for(let ft=0;ft<he.length();ft++){const St=he.getSection(ft),_t=he.getCharCode(ft);if(bd[_t]||(lt+=Zy(_t,St,Ue,nt,Te,Fe)),ft<he.length()-1){const en=!((Be=_t)<11904||!(dt["Bopomofo Extended"](Be)||dt.Bopomofo(Be)||dt["CJK Compatibility Forms"](Be)||dt["CJK Compatibility Ideographs"](Be)||dt["CJK Compatibility"](Be)||dt["CJK Radicals Supplement"](Be)||dt["CJK Strokes"](Be)||dt["CJK Symbols and Punctuation"](Be)||dt["CJK Unified Ideographs Extension A"](Be)||dt["CJK Unified Ideographs"](Be)||dt["Enclosed CJK Letters and Months"](Be)||dt["Halfwidth and Fullwidth Forms"](Be)||dt.Hiragana(Be)||dt["Ideographic Description Characters"](Be)||dt["Kangxi Radicals"](Be)||dt["Katakana Phonetic Extensions"](Be)||dt.Katakana(Be)||dt["Vertical Forms"](Be)||dt["Yi Radicals"](Be)||dt["Yi Syllables"](Be)));(ex[_t]||en||St.imageName)&&Ge.push(tx(ft+1,lt,je,Ge,Xy(_t,he.getCharCode(ft+1),en&&Xe),!1))}}var Be;return Ky(tx(he.length(),lt,je,Ge,0,!0))}(j,S,_,o,d,B),{processBidirectionalText:ce,processStyledBidirectionalText:ne}=I;if(ce&&1===j.sections.length){const he=ce(j.toString(),te);for(const Te of he){const Se=new kl;Se.text=Te,Se.sections=j.sections;for(let Ue=0;Ue<Te.length;Ue++)Se.sectionIndex.push(0);Y.push(Se)}}else if(ne){const he=ne(j.text,j.sectionIndex,te);for(const Te of he){const Se=new kl;Se.text=Te[0],Se.sectionIndex=Te[1],Se.sections=j.sections,Y.push(Se)}}else Y=function(he,Te){const Se=[],Ue=he.text;let nt=0;for(const Fe of Te)Se.push(he.substring(nt,Fe)),nt=Fe;return nt<Ue.length&&Se.push(he.substring(nt,Ue.length)),Se}(j,te);const ae=[],pe={positionedLines:ae,text:j.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(he,Te,Se,Ue,nt,Fe,Ge,je,Xe,lt,Be,ft){let St=0,_t=0,en=0;const st="right"===je?1:"left"===je?0:.5;let Ft=!1;for(const Yt of nt){const fn=Yt.getSections();for(const bi of fn){if(bi.imageName)continue;const pi=Te[bi.fontStack];if(pi&&(Ft=void 0!==pi.ascender&&void 0!==pi.descender,!Ft))break}if(!Ft)break}let sn=0;for(const Yt of nt){Yt.trim();const fn=Yt.getMaxScale(),bi=(fn-1)*Zr,pi={positionedGlyphs:[],lineOffset:0};he.positionedLines[sn]=pi;const Mi=pi.positionedGlyphs;let xi=0;if(!Yt.length()){_t+=Fe,++sn;continue}let Wi=0,ar=0;for(let wi=0;wi<Yt.length();wi++){const or=Yt.getSection(wi),Zi=Yt.getSectionIndex(wi),Fi=Yt.getCharCode(wi);let ni=or.scale,_r=null,li=null,Xo=null,yr=Zr,Yr=0;const xr=!(Xe===Ls.horizontal||!Be&&!iu(Fi)||Be&&(bd[Fi]||(Gn=Fi,dt.Arabic(Gn)||dt["Arabic Supplement"](Gn)||dt["Arabic Extended-A"](Gn)||dt["Arabic Presentation Forms-A"](Gn)||dt["Arabic Presentation Forms-B"](Gn))));if(or.imageName){const Ko=Ue[or.imageName];if(!Ko)continue;Xo=or.imageName,he.iconsInText=he.iconsInText||!0,li=Ko.paddedRect;const cr=Ko.displaySize;ni=ni*Zr/ft,_r={width:cr[0],height:cr[1],left:gs,top:-Gy,advance:xr?cr[1]:cr[0],localGlyph:!1},Yr=Ft?-_r.height*ni:$C+fn*Zr-cr[1]*ni,yr=_r.advance;const il=(xr?cr[0]:cr[1])*ni-Zr*fn;il>0&&il>xi&&(xi=il)}else{const Ko=Se[or.fontStack];if(!Ko)continue;Ko[Fi]&&(li=Ko[Fi]);const cr=Te[or.fontStack];if(!cr)continue;const il=cr.glyphs[Fi];if(!il)continue;if(_r=il.metrics,yr=8203!==Fi?Zr:0,Ft){const ku=void 0!==cr.ascender?Math.abs(cr.ascender):0,lp=void 0!==cr.descender?Math.abs(cr.descender):0,Zf=(ku+lp)*ni;Wi<Zf&&(Wi=Zf,ar=(ku-lp)/2*ni),Yr=-ku*ni}else Yr=$C+(fn-ni)*Zr}xr?(he.verticalizable=!0,Mi.push({glyph:Fi,imageName:Xo,x:St,y:_t+Yr,vertical:xr,scale:ni,localGlyph:_r.localGlyph,fontStack:or.fontStack,sectionIndex:Zi,metrics:_r,rect:li}),St+=yr*ni+lt):(Mi.push({glyph:Fi,imageName:Xo,x:St,y:_t+Yr,vertical:xr,scale:ni,localGlyph:_r.localGlyph,fontStack:or.fontStack,sectionIndex:Zi,metrics:_r,rect:li}),St+=_r.advance*ni+lt)}0!==Mi.length&&(en=Math.max(St-lt,en),Ft?Sg(Mi,st,xi,ar,Fe*fn/2):Sg(Mi,st,xi,0,Fe/2)),St=0;const lr=Fe*fn+xi;pi.lineOffset=Math.max(xi,bi),_t+=lr,++sn}var Gn;const an=_t,{horizontalAlign:Ht,verticalAlign:vi}=Dg(Ge);(function(Yt,fn,bi,pi,Mi,xi){const Wi=(fn-bi)*Mi,ar=-xi*pi;for(const lr of Yt)for(const wi of lr.positionedGlyphs)wi.x+=Wi,wi.y+=ar})(he.positionedLines,st,Ht,vi,en,an),he.top+=-vi*an,he.bottom=he.top+an,he.left+=-Ht*en,he.right=he.left+en,he.hasBaseline=Ft}(pe,o,l,d,Y,v,w,D,P,S,F,z),!function(he){for(const Te of he)if(0!==Te.positionedGlyphs.length)return!1;return!0}(ae)&&pe}const bd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ex={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Zy(a,o,l,d,p,_){if(o.imageName){const v=d[o.imageName];return v?v.displaySize[0]*o.scale*Zr/_+p:0}{const v=l[o.fontStack],w=v&&v.glyphs[a];return w?w.metrics.advance*o.scale+p:0}}function Yy(a,o,l,d){const p=Math.pow(a-o,2);return d?a<o?p/2:2*p:p+Math.abs(l)*l}function Xy(a,o,l){let d=0;return 10===a&&(d-=1e4),l&&(d+=150),40!==a&&65288!==a||(d+=50),41!==o&&65289!==o||(d+=50),d}function tx(a,o,l,d,p,_){let v=null,w=Yy(o,l,p,_);for(const D of d){const S=Yy(o-D.x,l,p,_)+D.badness;S<=w&&(v=D,w=S)}return{index:a,x:o,priorBreak:v,badness:w}}function Ky(a){return a?Ky(a.priorBreak).concat(a.index):[]}function Dg(a){let o=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:o,verticalAlign:l}}function Sg(a,o,l,d,p){if(!(o||l||d||p))return;const _=a.length-1,v=a[_],w=(v.x+v.metrics.advance*v.scale)*o;for(let D=0;D<=_;D++)a[D].x-=w,a[D].y+=l+d+p}function xT(a,o,l){const{horizontalAlign:d,verticalAlign:p}=Dg(l),_=o[0]-a.displaySize[0]*d,v=o[1]-a.displaySize[1]*p;return{image:a,top:v,bottom:v+a.displaySize[1],left:_,right:_+a.displaySize[0]}}function Mg(a,o,l,d,p,_){const v=a.image;let w;if(v.content){const Y=v.content,te=v.pixelRatio||1;w=[Y[0]/te,Y[1]/te,v.displaySize[0]-Y[2]/te,v.displaySize[1]-Y[3]/te]}const D=o.left*_,S=o.right*_;let k,P,F,B;"width"===l||"both"===l?(B=p[0]+D-d[3],P=p[0]+S+d[1]):(B=p[0]+(D+S-v.displaySize[0])/2,P=B+v.displaySize[0]);const z=o.top*_,j=o.bottom*_;return"height"===l||"both"===l?(k=p[1]+z-d[0],F=p[1]+j+d[2]):(k=p[1]+(z+j-v.displaySize[1])/2,F=k+v.displaySize[1]),{image:v,top:k,right:P,bottom:F,left:B,collisionPadding:w}}class vc extends pt{constructor(o,l,d,p,_){super(o,l),this.angle=p,this.z=d,void 0!==_&&(this.segment=_)}clone(){return new vc(this.x,this.y,this.z,this.angle,this.segment)}}function Tg(a,o,l,d,p){if(void 0===o.segment)return!0;let _=o,v=o.segment+1,w=0;for(;w>-l/2;){if(v--,v<0)return!1;w-=a[v].dist(_),_=a[v]}w+=a[v].dist(a[v+1]),v++;const D=[];let S=0;for(;w<l/2;){const k=a[v],P=a[v+1];if(!P)return!1;let F=a[v-1].angleTo(k)-k.angleTo(P);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:w,angleDelta:F}),S+=F;w-D[0].distance>d;)S-=D.shift().angleDelta;if(S>p)return!1;v++,w+=k.dist(P)}return!0}function Jy(a){let o=0;for(let l=0;l<a.length-1;l++)o+=a[l].dist(a[l+1]);return o}function Qy(a,o,l){return a?.6*o*l:0}function xd(a,o){return Math.max(a?a.right-a.left:0,o?o.right-o.left:0)}function GC(a,o,l,d,p,_){const v=Qy(l,p,_),w=xd(l,d)*_;let D=0;const S=Jy(a)/2;for(let k=0;k<a.length-1;k++){const P=a[k],F=a[k+1],B=P.dist(F);if(D+B>S){const z=(S-D)/B,j=Hn(P.x,F.x,z),Y=Hn(P.y,F.y,z),te=new vc(j,Y,0,F.angleTo(P),k);return!v||Tg(a,te,w,v,o)?te:void 0}D+=B}}function ev(a,o,l,d,p,_,v,w,D){const S=Qy(d,_,v),k=xd(d,p),P=k*v,F=0===a[0].x||a[0].x===D||0===a[0].y||a[0].y===D;return o-P<o/4&&(o=P+o/4),Lf(a,F?o/2*w%o:(k/2+2*_)*v*w%o,o,S,l,P,F,!1,D)}function Lf(a,o,l,d,p,_,v,w,D){const S=_/2,k=Jy(a);let P=0,F=o-l,B=[];for(let z=0;z<a.length-1;z++){const j=a[z],Y=a[z+1],te=j.dist(Y),ce=Y.angleTo(j);for(;F+l<P+te;){F+=l;const ne=(F-P)/te,ae=Hn(j.x,Y.x,ne),pe=Hn(j.y,Y.y,ne);if(ae>=0&&ae<D&&pe>=0&&pe<D&&F-S>=0&&F+S<=k){const he=new vc(ae,pe,0,ce,z);he._round(),d&&!Tg(a,he,_,d,p)||B.push(he)}}P+=te}return w||B.length||v||(B=Lf(a,P/2,l,d,p,_,v,!0,D)),B}function nx(a,o,l,d,p){const _=[];for(let v=0;v<a.length;v++){const w=a[v];let D;for(let S=0;S<w.length-1;S++){let k=w[S],P=w[S+1];k.x<o&&P.x<o||(k.x<o?k=new pt(o,k.y+(o-k.x)/(P.x-k.x)*(P.y-k.y))._round():P.x<o&&(P=new pt(o,k.y+(o-k.x)/(P.x-k.x)*(P.y-k.y))._round()),k.y<l&&P.y<l||(k.y<l?k=new pt(k.x+(l-k.y)/(P.y-k.y)*(P.x-k.x),l)._round():P.y<l&&(P=new pt(k.x+(l-k.y)/(P.y-k.y)*(P.x-k.x),l)._round()),k.x>=d&&P.x>=d||(k.x>=d?k=new pt(d,k.y+(d-k.x)/(P.x-k.x)*(P.y-k.y))._round():P.x>=d&&(P=new pt(d,k.y+(d-k.x)/(P.x-k.x)*(P.y-k.y))._round()),k.y>=p&&P.y>=p||(k.y>=p?k=new pt(k.x+(p-k.y)/(P.y-k.y)*(P.x-k.x),p)._round():P.y>=p&&(P=new pt(k.x+(p-k.y)/(P.y-k.y)*(P.x-k.x),p)._round()),D&&k.equals(D[D.length-1])||(D=[k],_.push(D)),D.push(P)))))}}return _}Dt(vc,"Anchor");const vu=1e20;function Nf(a,o,l,d,p,_,v,w,D){for(let S=o;S<o+d;S++)Qa(a,l*_+S,_,p,v,w,D);for(let S=l;S<l+p;S++)Qa(a,S*_+o,1,d,v,w,D)}function Qa(a,o,l,d,p,_,v){_[0]=0,v[0]=-vu,v[1]=vu,p[0]=a[o];for(let w=1,D=0,S=0;w<d;w++){p[w]=a[o+w*l];const k=w*w;do{const P=_[D];S=(p[w]-p[P]+k-P*P)/(w-P)/2}while(S<=v[D]&&--D>-1);D++,_[D]=w,v[D]=S,v[D+1]=vu}for(let w=0,D=0;w<d;w++){for(;v[D+1]<w;)D++;const S=_[D],k=w-S;a[o+w*l]=p[S]+k*k}}const na=2,Bf={none:0,ideographs:1,all:2};class Kh{constructor(o,l,d){this.requestManager=o,this.localGlyphMode=l,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o){this.url=o}getGlyphs(o,l){const d=[];for(const p in o)for(const _ of o[p])d.push({stack:p,id:_});gn(d,({stack:p,id:_},v)=>{let w=this.entries[p];w||(w=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let D=w.glyphs[_];if(void 0!==D)return void v(null,{stack:p,id:_,glyph:D});if(D=this._tinySDF(w,p,_),D)return w.glyphs[_]=D,void v(null,{stack:p,id:_,glyph:D});const S=Math.floor(_/256);if(256*S>65535)return void v(new Error("glyphs > 65535 not supported"));if(w.ranges[S])return void v(null,{stack:p,id:_,glyph:D});let k=w.requests[S];k||(k=w.requests[S]=[],Kh.loadGlyphRange(p,S,this.url,this.requestManager,(P,F)=>{if(F){w.ascender=F.ascender,w.descender=F.descender;for(const B in F.glyphs)this._doesCharSupportLocalGlyph(+B)||(w.glyphs[+B]=F.glyphs[+B]);w.ranges[S]=!0}for(const B of k)B(P,F);delete w.requests[S]})),k.push((P,F)=>{P?v(P):F&&v(null,{stack:p,id:_,glyph:F.glyphs[_]||null})})},(p,_)=>{if(p)l(p);else if(_){const v={};for(const{stack:w,id:D,glyph:S}of _)void 0===v[w]&&(v[w]={}),void 0===v[w].glyphs&&(v[w].glyphs={}),v[w].glyphs[D]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics},v[w].ascender=this.entries[w].ascender,v[w].descender=this.entries[w].descender;l(null,v)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==Bf.none&&(this.localGlyphMode===Bf.all?!!this.localFontFamily:!!this.localFontFamily&&(dt["CJK Unified Ideographs"](o)||dt["Hangul Syllables"](o)||dt.Hiragana(o)||dt.Katakana(o)||dt["CJK Symbols and Punctuation"](o)))}_tinySDF(o,l,d){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(d))return;let _=o.tinySDF;if(!_){let j="400";/bold/i.test(l)?j="900":/medium/i.test(l)?j="500":/light/i.test(l)&&(j="200"),_=o.tinySDF=new Kh.TinySDF({fontFamily:p,fontWeight:j,fontSize:24*na,buffer:3*na,radius:8*na}),_.fontWeight=j}if(this.localGlyphs[_.fontWeight][d])return this.localGlyphs[_.fontWeight][d];const v=String.fromCharCode(d),{data:w,width:D,height:S,glyphWidth:k,glyphHeight:P,glyphLeft:F,glyphTop:B,glyphAdvance:z}=_.draw(v);return this.localGlyphs[_.fontWeight][d]={id:d,bitmap:new Ca({width:D,height:S},w),metrics:{width:k/na,height:P/na,left:F/na,top:B/na-27,advance:z/na,localGlyph:!0}}}}Kh.loadGlyphRange=function(a,o,l,d,p){const _=256*o,v=_+255,w=d.transformRequest(d.normalizeGlyphsURL(l).replace("{fontstack}",a).replace("{range}",`${_}-${v}`),fl.Glyphs);zc(w,(D,S)=>{if(D)p(D);else if(S){const k={},P=new Cg(S).readFields(jC,{});for(const F of P.glyphs)k[F.id]=F;p(null,{glyphs:k,ascender:P.ascender,descender:P.descender})}})},Kh.TinySDF=class{constructor({fontSize:a=24,buffer:o=3,radius:l=8,cutoff:d=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:v="normal"}={}){this.buffer=o,this.cutoff=d,this.radius=l;const w=this.size=a+4*o,D=this._createCanvas(w),S=this.ctx=D.getContext("2d",{willReadFrequently:!0});S.font=`${v} ${_} ${a}px ${p}`,S.textBaseline="alphabetic",S.textAlign="left",S.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(a){const o=document.createElement("canvas");return o.width=o.height=a,o}draw(a){const{width:o,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(a),v=Math.ceil(l),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-p))),D=Math.min(this.size-this.buffer,v+Math.ceil(d)),S=w+2*this.buffer,k=D+2*this.buffer,P=Math.max(S*k,0),F=new Uint8ClampedArray(P),B={data:F,width:S,height:k,glyphWidth:w,glyphHeight:D,glyphTop:v,glyphLeft:0,glyphAdvance:o};if(0===w||0===D)return B;const{ctx:z,buffer:j,gridInner:Y,gridOuter:te}=this;z.clearRect(j,j,w,D),z.fillText(a,j,j+v);const ce=z.getImageData(j,j,w,D);te.fill(vu,0,P),Y.fill(0,0,P);for(let ne=0;ne<D;ne++)for(let ae=0;ae<w;ae++){const pe=ce.data[4*(ne*w+ae)+3]/255;if(0===pe)continue;const he=(ne+j)*S+ae+j;if(1===pe)te[he]=0,Y[he]=vu;else{const Te=.5-pe;te[he]=Te>0?Te*Te:0,Y[he]=Te<0?Te*Te:0}}Nf(te,0,0,S,k,S,this.f,this.v,this.z),Nf(Y,j,j,w,D,S,this.f,this.v,this.z);for(let ne=0;ne<P;ne++){const ae=Math.sqrt(te[ne])-Math.sqrt(Y[ne]);F[ne]=Math.round(255-255*(ae/this.radius+this.cutoff))}return B}};const Jh=gs;function tv(a,o,l,d){const p=[],_=a.image,v=_.pixelRatio,w=_.paddedRect.w-2*Jh,D=_.paddedRect.h-2*Jh,S=a.right-a.left,k=a.bottom-a.top,P=_.stretchX||[[0,w]],F=_.stretchY||[[0,D]],B=(Fe,Ge)=>Fe+Ge[1]-Ge[0],z=P.reduce(B,0),j=F.reduce(B,0),Y=w-z,te=D-j;let ce=0,ne=z,ae=0,pe=j,he=0,Te=Y,Se=0,Ue=te;if(_.content&&d){const Fe=_.content;ce=bc(P,0,Fe[0]),ae=bc(F,0,Fe[1]),ne=bc(P,Fe[0],Fe[2]),pe=bc(F,Fe[1],Fe[3]),he=Fe[0]-ce,Se=Fe[1]-ae,Te=Fe[2]-Fe[0]-ne,Ue=Fe[3]-Fe[1]-pe}const nt=(Fe,Ge,je,Xe)=>{const lt=Ag(Fe.stretch-ce,ne,S,a.left),Be=Ig(Fe.fixed-he,Te,Fe.stretch,z),ft=Ag(Ge.stretch-ae,pe,k,a.top),St=Ig(Ge.fixed-Se,Ue,Ge.stretch,j),_t=Ag(je.stretch-ce,ne,S,a.left),en=Ig(je.fixed-he,Te,je.stretch,z),st=Ag(Xe.stretch-ae,pe,k,a.top),Ft=Ig(Xe.fixed-Se,Ue,Xe.stretch,j),sn=new pt(lt,ft),Gn=new pt(_t,ft),an=new pt(_t,st),Ht=new pt(lt,st),vi=new pt(Be/v,St/v),Yt=new pt(en/v,Ft/v),fn=o*Math.PI/180;if(fn){const Mi=Math.sin(fn),xi=Math.cos(fn),Wi=[xi,-Mi,Mi,xi];sn._matMult(Wi),Gn._matMult(Wi),Ht._matMult(Wi),an._matMult(Wi)}const bi=Fe.stretch+Fe.fixed,pi=Ge.stretch+Ge.fixed;return{tl:sn,tr:Gn,bl:Ht,br:an,tex:{x:_.paddedRect.x+Jh+bi,y:_.paddedRect.y+Jh+pi,w:je.stretch+je.fixed-bi,h:Xe.stretch+Xe.fixed-pi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vi,pixelOffsetBR:Yt,minFontScaleX:Te/v/S,minFontScaleY:Ue/v/k,isSDF:l}};if(d&&(_.stretchX||_.stretchY)){const Fe=ix(P,Y,z),Ge=ix(F,te,j);for(let je=0;je<Fe.length-1;je++){const Xe=Fe[je],lt=Fe[je+1];for(let Be=0;Be<Ge.length-1;Be++)p.push(nt(Xe,Ge[Be],lt,Ge[Be+1]))}}else p.push(nt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:D+1}));return p}function bc(a,o,l){let d=0;for(const p of a)d+=Math.max(o,Math.min(l,p[1]))-Math.max(o,Math.min(l,p[0]));return d}function ix(a,o,l){const d=[{fixed:-Jh,stretch:0}];for(const[p,_]of a){const v=d[d.length-1];d.push({fixed:p-v.stretch,stretch:v.stretch}),d.push({fixed:p-v.stretch,stretch:v.stretch+(_-p)})}return d.push({fixed:o+Jh,stretch:l}),d}function Ag(a,o,l,d){return a/o*l+d}function Ig(a,o,l,d){return a-o*l/d}function nv(a,o,l,d){const p=o+a.positionedLines[d].lineOffset;return 0===d?l+p/2:l+(p+(o+a.positionedLines[d-1].lineOffset))/2}class kg{constructor(o=[],l=qC){if(this.data=o,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const o=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:l,compare:d}=this,p=l[o];for(;o>0;){const _=o-1>>1,v=l[_];if(d(p,v)>=0)break;l[o]=v,o=_}l[o]=p}_down(o){const{data:l,compare:d}=this,p=this.length>>1,_=l[o];for(;o<p;){let v=1+(o<<1),w=l[v];const D=v+1;if(D<this.length&&d(l[D],w)<0&&(v=D,w=l[D]),d(w,_)>=0)break;l[o]=w,o=v}l[o]=_}}function qC(a,o){return a<o?-1:a>o?1:0}function rx(a,o=1,l=!1){let d=1/0,p=1/0,_=-1/0,v=-1/0;const w=a[0];for(let B=0;B<w.length;B++){const z=w[B];(!B||z.x<d)&&(d=z.x),(!B||z.y<p)&&(p=z.y),(!B||z.x>_)&&(_=z.x),(!B||z.y>v)&&(v=z.y)}const D=Math.min(_-d,v-p);let S=D/2;const k=new kg([],wd);if(0===D)return new pt(d,p);for(let B=d;B<_;B+=D)for(let z=p;z<v;z+=D)k.push(new zf(B+S,z+S,S,a));let P=function(B){let z=0,j=0,Y=0;const te=B[0];for(let ce=0,ne=te.length,ae=ne-1;ce<ne;ae=ce++){const pe=te[ce],he=te[ae],Te=pe.x*he.y-he.x*pe.y;j+=(pe.x+he.x)*Te,Y+=(pe.y+he.y)*Te,z+=3*Te}return new zf(j/z,Y/z,0,B)}(a),F=k.length;for(;k.length;){const B=k.pop();(B.d>P.d||!P.d)&&(P=B,l&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,F)),B.max-P.d<=o||(S=B.h/2,k.push(new zf(B.p.x-S,B.p.y-S,S,a)),k.push(new zf(B.p.x+S,B.p.y-S,S,a)),k.push(new zf(B.p.x-S,B.p.y+S,S,a)),k.push(new zf(B.p.x+S,B.p.y+S,S,a)),F+=4)}return l&&(console.log(`num probes: ${F}`),console.log(`best distance: ${P.d}`)),P.p}function wd(a,o){return o.max-a.max}class zf{constructor(o,l,d,p){this.p=new pt(o,l),this.h=d,this.d=function(_,v){let w=!1,D=1/0;for(let S=0;S<v.length;S++){const k=v[S];for(let P=0,F=k.length,B=F-1;P<F;B=P++){const z=k[P],j=k[B];z.y>_.y!=j.y>_.y&&_.x<(j.x-z.x)*(_.y-z.y)/(j.y-z.y)+z.x&&(w=!w),D=Math.min(D,M0(_,z,j))}}return(w?1:-1)*Math.sqrt(D)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const ko=7,Vf=Number.POSITIVE_INFINITY,WC=Math.sqrt(2);function ZC(a,[o,l]){let d=0,p=0;if(l===Vf){o<0&&(o=0);const _=o/WC;switch(a){case"top-right":case"top-left":p=_-ko;break;case"bottom-right":case"bottom-left":p=-_+ko;break;case"bottom":p=-o+ko;break;case"top":p=o-ko}switch(a){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=o;break;case"right":d=-o}}else{switch(o=Math.abs(o),l=Math.abs(l),a){case"top-right":case"top-left":case"top":p=l-ko;break;case"bottom-right":case"bottom-left":case"bottom":p=-l+ko}switch(a){case"top-right":case"bottom-right":case"right":d=-o;break;case"top-left":case"bottom-left":case"left":d=o}}return[d,p]}function wT(a,o,l,d,p,_,v,w,D,S){a.createArrays(),a.tilePixelRatio=Ot/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const k=a.layers[0].layout,P=a.layers[0]._unevaluatedLayout._values,F={};if("composite"===a.textSizeData.kind){const{minZoom:j,maxZoom:Y}=a.textSizeData;F.compositeTextSizes=[P["text-size"].possiblyEvaluate(new R(j),w),P["text-size"].possiblyEvaluate(new R(Y),w)]}if("composite"===a.iconSizeData.kind){const{minZoom:j,maxZoom:Y}=a.iconSizeData;F.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new R(j),w),P["icon-size"].possiblyEvaluate(new R(Y),w)]}F.layoutTextSize=P["text-size"].possiblyEvaluate(new R(D+1),w),F.layoutIconSize=P["icon-size"].possiblyEvaluate(new R(D+1),w),F.textMaxSize=P["text-size"].possiblyEvaluate(new R(18),w);const B="map"===k.get("text-rotation-alignment")&&"point"!==k.get("symbol-placement"),z=k.get("text-size");for(const j of a.features){const Y=k.get("text-font").evaluate(j,{},w).join(","),te=z.evaluate(j,{},w),ce=F.layoutTextSize.evaluate(j,{},w),ne=(F.layoutIconSize.evaluate(j,{},w),{horizontal:{},vertical:void 0}),ae=j.text;let pe,he=[0,0];if(ae){const Ue=ae.toString(),nt=k.get("text-letter-spacing").evaluate(j,{},w)*Zr,Fe=k.get("text-line-height").evaluate(j,{},w)*Zr,Ge=Qb(Ue)?nt:0,je=k.get("text-anchor").evaluate(j,{},w),Xe=k.get("text-variable-anchor");if(!Xe){const _t=k.get("text-radial-offset").evaluate(j,{},w);he=_t?ZC(je,[_t*Zr,Vf]):k.get("text-offset").evaluate(j,{},w).map(en=>en*Zr)}let lt=B?"center":k.get("text-justify").evaluate(j,{},w);const Be="point"===k.get("symbol-placement"),ft=Be?k.get("text-max-width").evaluate(j,{},w)*Zr:1/0,St=_t=>{a.allowVerticalPlacement&&Eh(Ue)&&(ne.vertical=Ke(ae,o,l,p,Y,ft,Fe,je,_t,Ge,he,Ls.vertical,!0,ce,te))};if(!B&&Xe){const _t="auto"===lt?Xe.map(st=>Qh(st)):[lt];let en=!1;for(let st=0;st<_t.length;st++){const Ft=_t[st];if(!ne.horizontal[Ft])if(en)ne.horizontal[Ft]=ne.horizontal[0];else{const sn=Ke(ae,o,l,p,Y,ft,Fe,"center",Ft,Ge,he,Ls.horizontal,!1,ce,te);sn&&(ne.horizontal[Ft]=sn,en=1===sn.positionedLines.length)}}St("left")}else{if("auto"===lt&&(lt=Qh(je)),Be||k.get("text-writing-mode").indexOf("horizontal")>=0||!Eh(Ue)){const _t=Ke(ae,o,l,p,Y,ft,Fe,je,lt,Ge,he,Ls.horizontal,!1,ce,te);_t&&(ne.horizontal[lt]=_t)}St(Be?"left":lt)}}let Te=!1;if(j.icon&&j.icon.name){const Ue=d[j.icon.name];Ue&&(pe=xT(p[j.icon.name],k.get("icon-offset").evaluate(j,{},w),k.get("icon-anchor").evaluate(j,{},w)),Te=Ue.sdf,void 0===a.sdfIcons?a.sdfIcons=Ue.sdf:a.sdfIcons!==Ue.sdf&&ji("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ue.pixelRatio!==a.pixelRatio||0!==k.get("icon-rotate").constantOr(1))&&(a.iconsNeedLinear=!0))}const Se=Rg(ne.horizontal)||ne.vertical;a.iconsInText||(a.iconsInText=!!Se&&Se.iconsInText),(Se||pe)&&YC(a,j,ne,pe,d,F,ce,0,he,Te,v,w,S)}_&&a.generateCollisionDebugBuffers(D,a.collisionBoxArray)}function Qh(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function YC(a,o,l,d,p,_,v,w,D,S,k,P,F){let B=_.textMaxSize.evaluate(o,{},P);void 0===B&&(B=v);const z=a.layers[0].layout,j=z.get("icon-offset").evaluate(o,{},P),Y=Rg(l.horizontal)||l.vertical,te="globe"===F.name,ce=Zr,ne=v/ce,ae=a.tilePixelRatio*B/ce,pe=(je=a.overscaling,a.zoom>18&&je>2&&(je>>=1),Math.max(Ot/(512*je),1)*z.get("symbol-spacing")),he=z.get("text-padding")*a.tilePixelRatio,Te=z.get("icon-padding")*a.tilePixelRatio,Se=xn(z.get("text-max-angle")),Ue="map"===z.get("text-rotation-alignment")&&"point"!==z.get("symbol-placement"),nt="map"===z.get("icon-rotation-alignment")&&"point"!==z.get("symbol-placement"),Fe=z.get("symbol-placement"),Ge=pe/2;var je;const Xe=z.get("icon-text-fit");let lt;d&&"none"!==Xe&&(a.allowVerticalPlacement&&l.vertical&&(lt=Mg(d,l.vertical,Xe,z.get("icon-text-fit-padding"),j,ne)),Y&&(d=Mg(d,Y,Xe,z.get("icon-text-fit-padding"),j,ne)));const Be=(ft,St,_t)=>{if(St.x<0||St.x>=Ot||St.y<0||St.y>=Ot)return;let en=null;if(te){const{x:st,y:Ft,z:sn}=F.projectTilePoint(St.x,St.y,_t);en={anchor:new vc(st,Ft,sn,0,void 0),up:F.upVector(_t,St.x,St.y)}}!function(st,Ft,sn,Gn,an,Ht,vi,Yt,fn,bi,pi,Mi,xi,Wi,ar,lr,wi,or,Zi,Fi,ni,_r,li,Xo,yr){const Yr=st.addToLineVertexArray(Ft,Gn);let xr,Ko,cr,il,ku,lp,Zf,xx=0,cp=0,wx=0,iE=0,Cv=-1,Ev=-1;const Bl={};let Cx=tf("");const Ru=sn?sn.anchor:Ft;let Dv=0,Sv=0;if(void 0===fn._unevaluatedLayout.getValue("text-radial-offset")?[Dv,Sv]=fn.layout.get("text-offset").evaluate(ni,{},yr).map(Jo=>Jo*Zr):(Dv=fn.layout.get("text-radial-offset").evaluate(ni,{},yr)*Zr,Sv=Vf),st.allowVerticalPlacement&&an.vertical){const Jo=an.vertical;if(ar)lp=xu(Jo),Yt&&(Zf=xu(Yt));else{const Ns=fn.layout.get("text-rotate").evaluate(ni,{},yr)+90;cr=tp(bi,Ru,Ft,pi,Mi,xi,Jo,Wi,Ns,lr),Yt&&(il=tp(bi,Ru,Ft,pi,Mi,xi,Yt,or,Ns))}}if(Ht){const Jo=fn.layout.get("icon-rotate").evaluate(ni,{},yr),Ns="none"!==fn.layout.get("icon-text-fit"),Yf=tv(Ht,Jo,li,Ns),Mv=Yt?tv(Yt,Jo,li,Ns):void 0;Ko=tp(bi,Ru,Ft,pi,Mi,xi,Ht,or,Jo),xx=4*Yf.length;const Ex=st.iconSizeData;let Pu=null;"source"===Ex.kind?(Pu=[Ja*fn.layout.get("icon-size").evaluate(ni,{},yr)],Pu[0]>Rl&&ji(`${st.layerIds[0]}: Value for "icon-size" is >= ${bu}. Reduce your "icon-size".`)):"composite"===Ex.kind&&(Pu=[Ja*_r.compositeIconSizes[0].evaluate(ni,{},yr),Ja*_r.compositeIconSizes[1].evaluate(ni,{},yr)],(Pu[0]>Rl||Pu[1]>Rl)&&ji(`${st.layerIds[0]}: Value for "icon-size" is >= ${bu}. Reduce your "icon-size".`)),st.addSymbols(st.icon,Yf,Pu,Fi,Zi,ni,!1,sn,Ft,Yr.lineStartIndex,Yr.lineLength,-1,Xo,yr),Cv=st.icon.placedSymbolArray.length-1,Mv&&(cp=4*Mv.length,st.addSymbols(st.icon,Mv,Pu,Fi,Zi,ni,Ls.vertical,sn,Ft,Yr.lineStartIndex,Yr.lineLength,-1,Xo,yr),Ev=st.icon.placedSymbolArray.length-1)}for(const Jo in an.horizontal){const Ns=an.horizontal[Jo];xr||(Cx=tf(Ns.text),ar?ku=xu(Ns):xr=tp(bi,Ru,Ft,pi,Mi,xi,Ns,Wi,fn.layout.get("text-rotate").evaluate(ni,{},yr),lr));const Yf=1===Ns.positionedLines.length;if(wx+=ep(st,sn,Ft,Ns,vi,fn,ar,ni,lr,Yr,an.vertical?Ls.horizontal:Ls.horizontalOnly,Yf?Object.keys(an.horizontal):[Jo],Bl,Cv,_r,Xo,yr),Yf)break}an.vertical&&(iE+=ep(st,sn,Ft,an.vertical,vi,fn,ar,ni,lr,Yr,Ls.vertical,["vertical"],Bl,Ev,_r,Xo,yr));let xc=-1;const Et=(Jo,Ns)=>Jo?Math.max(Jo,Ns):Ns;xc=Et(ku,xc),xc=Et(lp,xc),xc=Et(Zf,xc);const rE=xc>-1?1:0;st.glyphOffsetArray.length>=jt.MAX_GLYPHS&&ji("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ni.sortKey&&st.addToSortKeyRanges(st.symbolInstances.length,ni.sortKey),st.symbolInstances.emplaceBack(Ru.x,Ru.y,Ru.z,Ft.x,Ft.y,Bl.right>=0?Bl.right:-1,Bl.center>=0?Bl.center:-1,Bl.left>=0?Bl.left:-1,Bl.vertical>=0?Bl.vertical:-1,Cv,Ev,Cx,void 0!==xr?xr:st.collisionBoxArray.length,void 0!==xr?xr+1:st.collisionBoxArray.length,void 0!==cr?cr:st.collisionBoxArray.length,void 0!==cr?cr+1:st.collisionBoxArray.length,void 0!==Ko?Ko:st.collisionBoxArray.length,void 0!==Ko?Ko+1:st.collisionBoxArray.length,il||st.collisionBoxArray.length,il?il+1:st.collisionBoxArray.length,pi,wx,iE,xx,cp,rE,0,Dv,Sv,xc)}(a,St,en,ft,l,d,p,lt,a.layers[0],a.collisionBoxArray,o.index,o.sourceLayerIndex,a.index,he,Ue,D,0,Te,nt,j,o,_,S,k,P)};if("line"===Fe)for(const ft of nx(o.geometry,0,0,Ot,Ot)){const St=ev(ft,pe,Se,l.vertical||Y,d,ce,ae,a.overscaling,Ot);for(const _t of St)Y&&Pg(a,Y.text,Ge,_t)||Be(ft,_t,P)}else if("line-center"===Fe){for(const ft of o.geometry)if(ft.length>1){const St=GC(ft,Se,l.vertical||Y,d,ce,ae);St&&Be(ft,St,P)}}else if("Polygon"===o.type)for(const ft of jh(o.geometry,0)){const St=rx(ft,16);Be(ft[0],new vc(St.x,St.y,0,0,void 0),P)}else if("LineString"===o.type)for(const ft of o.geometry)Be(ft,new vc(ft[0].x,ft[0].y,0,0,void 0),P);else if("Point"===o.type)for(const ft of o.geometry)for(const St of ft)Be([St],new vc(St.x,St.y,0,0,void 0),P)}const bu=255,Rl=bu*Ja;function ep(a,o,l,d,p,_,v,w,D,S,k,P,F,B,z,j,Y){const te=function(ae,pe,he,Te,Se,Ue,nt,Fe){const Ge=[];if(0===pe.positionedLines.length)return Ge;const je=Te.layout.get("text-rotate").evaluate(Ue,{})*Math.PI/180,Xe=function(_t){const en=_t[0],st=_t[1],Ft=en*st;return Ft>0?[en,-st]:Ft<0?[-en,st]:0===en?[st,en]:[st,-en]}(he);let lt=Math.abs(pe.top-pe.bottom);for(const _t of pe.positionedLines)lt-=_t.lineOffset;const Be=pe.positionedLines.length,ft=lt/Be;let St=pe.top-he[1];for(let _t=0;_t<Be;++_t){const en=pe.positionedLines[_t];St=nv(pe,ft,St,_t);for(const st of en.positionedGlyphs){if(!st.rect)continue;const Ft=st.rect||{};let sn=Gy+1,Gn=!0,an=1,Ht=0;if(st.imageName){const li=nt[st.imageName];if(!li)continue;if(li.sdf){ji("SDF images are not supported in formatted text and will be ignored.");continue}Gn=!1,an=li.pixelRatio,sn=gs/an}const vi=(Se||Fe)&&st.vertical,Yt=st.metrics.advance*st.scale/2,fn=st.metrics,bi=st.rect;if(null===bi)continue;Fe&&pe.verticalizable&&(Ht=st.imageName?Yt-st.metrics.width*st.scale/2:0);const pi=Se?[st.x+Yt,st.y]:[0,0];let Mi=[0,0],xi=[0,0],Wi=!1;Se||(vi?(xi=[st.x+Yt+Xe[0],st.y+Xe[1]-Ht],Wi=!0):Mi=[st.x+Yt+he[0],st.y+he[1]-Ht]);const ar=bi.w*st.scale/(an*(st.localGlyph?na:1)),lr=bi.h*st.scale/(an*(st.localGlyph?na:1));let wi,or,Zi,Fi;if(vi){const li=st.y-St,Xo=new pt(-Yt,Yt-li),yr=-Math.PI/2,Yr=new pt(...xi);wi=new pt(-Yt+Mi[0],Mi[1]),wi._rotateAround(yr,Xo)._add(Yr),wi.x+=-li+Yt,wi.y-=(fn.left-sn)*st.scale;const xr=st.imageName?fn.advance*st.scale:Zr*st.scale,Ko=String.fromCharCode(st.glyph);FC(Ko)?wi.x+=(1-sn)*st.scale:LC(Ko)?wi.x+=xr-fn.height*st.scale+(-sn-1)*st.scale:wi.x+=st.imageName||fn.width+2*sn===bi.w&&fn.height+2*sn===bi.h?(xr-lr)/2:(xr-(fn.height+2*sn)*st.scale)/2,or=new pt(wi.x,wi.y-ar),Zi=new pt(wi.x+lr,wi.y),Fi=new pt(wi.x+lr,wi.y-ar)}else{const li=(fn.left-sn)*st.scale-Yt+Mi[0],Xo=(-fn.top-sn)*st.scale+Mi[1],yr=li+ar,Yr=Xo+lr;wi=new pt(li,Xo),or=new pt(yr,Xo),Zi=new pt(li,Yr),Fi=new pt(yr,Yr)}if(je){let li;li=Se?new pt(0,0):Wi?new pt(Xe[0],Xe[1]):new pt(he[0],he[1]),wi._rotateAround(je,li),or._rotateAround(je,li),Zi._rotateAround(je,li),Fi._rotateAround(je,li)}const ni=new pt(0,0),_r=new pt(0,0);Ge.push({tl:wi,tr:or,bl:Zi,br:Fi,tex:Ft,writingMode:pe.writingMode,glyphOffset:pi,sectionIndex:st.sectionIndex,isSDF:Gn,pixelOffsetTL:ni,pixelOffsetBR:_r,minFontScaleX:0,minFontScaleY:0})}}return Ge}(0,d,D,_,v,w,p,a.allowVerticalPlacement),ce=a.textSizeData;let ne=null;"source"===ce.kind?(ne=[Ja*_.layout.get("text-size").evaluate(w,{},Y)],ne[0]>Rl&&ji(`${a.layerIds[0]}: Value for "text-size" is >= ${bu}. Reduce your "text-size".`)):"composite"===ce.kind&&(ne=[Ja*z.compositeTextSizes[0].evaluate(w,{},Y),Ja*z.compositeTextSizes[1].evaluate(w,{},Y)],(ne[0]>Rl||ne[1]>Rl)&&ji(`${a.layerIds[0]}: Value for "text-size" is >= ${bu}. Reduce your "text-size".`)),a.addSymbols(a.text,te,ne,D,v,w,k,o,l,S.lineStartIndex,S.lineLength,B,j,Y);for(const ae of P)F[ae]=a.text.placedSymbolArray.length-1;return 4*te.length}function Rg(a){for(const o in a)return a[o];return null}function tp(a,o,l,d,p,_,v,w,D,S){let k=v.top,P=v.bottom,F=v.left,B=v.right;const z=v.collisionPadding;if(z&&(F-=z[0],k-=z[1],B+=z[2],P+=z[3]),D){const j=new pt(F,k),Y=new pt(B,k),te=new pt(F,P),ce=new pt(B,P),ne=xn(D);let ae=new pt(0,0);S&&(ae=new pt(S[0],S[1])),j._rotateAround(ne,ae),Y._rotateAround(ne,ae),te._rotateAround(ne,ae),ce._rotateAround(ne,ae),F=Math.min(j.x,Y.x,te.x,ce.x),B=Math.max(j.x,Y.x,te.x,ce.x),k=Math.min(j.y,Y.y,te.y,ce.y),P=Math.max(j.y,Y.y,te.y,ce.y)}return a.emplaceBack(o.x,o.y,o.z,l.x,l.y,F,k,B,P,w,d,p,_),a.length-1}function xu(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const o=a.bottom-a.top;return o>0?Math.max(10,o):null}function Pg(a,o,l,d){const p=a.compareText;if(o in p){const _=p[o];for(let v=_.length-1;v>=0;v--)if(d.dist(_[v])<l)return!0}else p[o]=[];return p[o].push(d),!1}function np(a,o){const l=a.fovAboveCenter,d=a.elevation?a.elevation.getMinElevationBelowMSL()*o:0,p=(a._camera.position[2]*a.worldSize-d)/Math.cos(a._pitch),_=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-a._pitch-l,.01)),v=Math.sin(a._pitch)*_+p;return Math.min(1.01*v,p*(1/a._horizonShift))}function Cd(a,o){if(!o.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:o};const l=Math.pow(2,-a.z),d=a.x*l,p=(a.x+1)*l,_=a.y*l,v=(a.y+1)*l,w=br(d),D=br(p),S=po(_),k=po(v),P=o.project(w,S),F=o.project(D,S),B=o.project(D,k),z=o.project(w,k);let j=Math.min(P.x,F.x,B.x,z.x),Y=Math.min(P.y,F.y,B.y,z.y),te=Math.max(P.x,F.x,B.x,z.x),ce=Math.max(P.y,F.y,B.y,z.y);const ne=l/16;function ae(he,Te,Se,Ue,nt,Fe){const Ge=(Se+nt)/2,je=(Ue+Fe)/2,Xe=o.project(br(Ge),po(je)),lt=Math.max(0,j-Xe.x,Y-Xe.y,Xe.x-te,Xe.y-ce);j=Math.min(j,Xe.x),te=Math.max(te,Xe.x),Y=Math.min(Y,Xe.y),ce=Math.max(ce,Xe.y),lt>ne&&(ae(he,Xe,Se,Ue,Ge,je),ae(Xe,Te,Ge,je,nt,Fe))}ae(P,F,d,_,p,_),ae(F,B,p,_,p,v),ae(B,z,p,v,d,v),ae(z,P,d,v,d,_),j-=ne,Y-=ne,te+=ne,ce+=ne;const pe=1/Math.max(te-j,ce-Y);return{scale:pe,x:j*pe,y:Y*pe,x2:te*pe,y2:ce*pe,projection:o}}const iv=Sl(new Float32Array(16));class el{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,l){return{x:0,y:0,z:0}}unproject(o,l){return new ai(0,0)}projectTilePoint(o,l,d){return{x:o,y:l,z:0}}locationPoint(o,l,d=!0){return o._coordinatePoint(o.locationCoordinate(l),d)}pixelsPerMeter(o,l){return Ya(1,o)*l}pixelSpaceConversion(o,l,d){return 1}farthestPixelDistance(o){return np(o,o.pixelsPerMeter)}pointCoordinate(o,l,d,p){const _=o.horizonLineFromTop(!1),v=new pt(l,Math.max(_,d));return o.rayIntersectionCoordinate(o.pointRayIntersection(v,p))}pointCoordinate3D(o,l,d){const p=new pt(l,d);if(o.elevation)return o.elevation.pointCoordinate(p);{const _=this.pointCoordinate(o,p.x,p.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(o,l){if(o.elevation)return!this.pointCoordinate3D(o,l.x,l.y);const d=o.horizonLineFromTop();return l.y<d}createInversionMatrix(o,l){return iv}createTileMatrix(o,l,d){let p,_,v;const w=d.canonical,D=Sl(new Float64Array(16));if(this.isReprojectedInTileSpace){const S=Cd(w,this);p=1,_=S.x+d.wrap*S.scale,v=S.y,su(D,D,[p/S.scale,p/S.scale,o.pixelsPerMeter/l])}else p=l/o.zoomScale(w.z),_=(w.x+Math.pow(2,w.z)*d.wrap)*p,v=w.y*p;return af(D,D,[_,v,0]),su(D,D,[p/Ot,p/Ot,1]),D}upVector(o,l,d){return[0,0,1]}upVectorScale(o,l,d){return{metersToTile:1}}}class CT extends el{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[l,d]=this.parallels=o.parallels||[29.5,45.5],p=Math.sin(xn(l));this.n=(p+Math.sin(xn(d)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(o,l){const{n:d,c:p,r0:_}=this,v=xn(o-this.center[0]),w=xn(l),D=Math.sqrt(p-2*d*Math.sin(w))/d;return{x:D*Math.sin(v*d),y:D*Math.cos(v*d)-_,z:0}}unproject(o,l){const{n:d,c:p,r0:_}=this,v=_+l;let w=Math.atan2(o,Math.abs(v))*Math.sign(v);v*d<0&&(w-=Math.PI*Math.sign(o)*Math.sign(v));const D=xn(this.center[0])*d;w=Vt(w,-Math.PI-D,Math.PI-D);const S=wt(Ei(w/d)+this.center[0],-180,180),k=Math.asin(wt((p-(o*o+v*v)*d*d)/(2*d),-1,1)),P=wt(Ei(k),-Nr,Nr);return new ai(S,P)}}const wu=1.340264,Cu=-.081106,ip=893e-6,Uf=.003796,Og=Math.sqrt(3)/2;class ox extends el{project(o,l){l=l/180*Math.PI,o=o/180*Math.PI;const d=Math.asin(Og*Math.sin(l)),p=d*d,_=p*p*p;return{x:.5*(o*Math.cos(d)/(Og*(wu+3*Cu*p+_*(7*ip+9*Uf*p)))/Math.PI+.5),y:1-.5*(d*(wu+Cu*p+_*(ip+Uf*p))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=d*d,_=p*p*p;for(let k,P,F,B=0;B<12&&(P=d*(wu+Cu*p+_*(ip+Uf*p))-l,F=wu+3*Cu*p+_*(7*ip+9*Uf*p),k=P/F,d=wt(d-k,-Math.PI/3,Math.PI/3),p=d*d,_=p*p*p,!(Math.abs(k)<1e-12));++B);const v=Og*o*(wu+3*Cu*p+_*(7*ip+9*Uf*p))/Math.cos(d),w=Math.asin(Math.sin(d)/Og),D=wt(180*v/Math.PI,-180,180),S=wt(180*w/Math.PI,-Nr,Nr);return new ai(D,S)}}class sx extends el{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){return{x:.5+o/360,y:.5-l/360,z:0}}unproject(o,l){const d=360*(o-.5),p=wt(360*(.5-l),-Nr,Nr);return new ai(d,p)}}const rp=Math.PI/2;function Fg(a){return Math.tan((rp+a)/2)}class ET extends el{constructor(o){super(o),this.center=o.center||[0,30];const[l,d]=this.parallels=o.parallels||[30,30];let p=xn(l),_=xn(d);this.southernCenter=p+_<0,this.southernCenter&&(p=-p,_=-_);const v=Math.cos(p),w=Fg(p);this.n=p===_?Math.sin(p):Math.log(v/Math.cos(_))/Math.log(Fg(_)/w),this.f=v*Math.pow(Fg(p),this.n)/this.n}project(o,l){l=xn(l),this.southernCenter&&(l=-l),o=xn(o-this.center[0]);const d=1e-6,{n:p,f:_}=this;_>0?l<-rp+d&&(l=-rp+d):l>rp-d&&(l=rp-d);const v=_/Math.pow(Fg(l),p);let w=v*Math.sin(p*o),D=_-v*Math.cos(p*o);return w=.5*(w/Math.PI+.5),D=.5*(D/Math.PI+.5),{x:w,y:this.southernCenter?D:1-D,z:0}}unproject(o,l){o=(2*o-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:d,f:p}=this,_=p-l,v=Math.sign(_),w=Math.sign(d)*Math.sqrt(o*o+_*_);let D=Math.atan2(o,Math.abs(_))*v;_*d<0&&(D-=Math.PI*Math.sign(o)*v);const S=wt(Ei(D/d)+this.center[0],-180,180),k=wt(Ei(2*Math.atan(Math.pow(p/w,1/d))-rp),-Nr,Nr);return new ai(S,this.southernCenter?-k:k)}}class ax extends el{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,l){return{x:Al(o),y:Er(l),z:0}}unproject(o,l){const d=br(o),p=po(l);return new ai(d,p)}}const Lg=xn(Nr);class rv extends el{project(o,l){const d=(l=xn(l))*l,p=d*d;return{x:.5*((o=xn(o))*(.8707-.131979*d+p*(p*(.003971*d-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+d*(.015085+p*(.028874*d-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=25,_=0,v=d*d;do{v=d*d;const S=v*v;_=(d*(1.007226+v*(.015085+S*(.028874*v-.044475-.005916*S)))-l)/(1.007226+v*(.045255+S*(.259866*v-.311325-.005916*11*S))),d=wt(d-_,-Lg,Lg)}while(Math.abs(_)>1e-6&&--p>0);v=d*d;const w=wt(Ei(o/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),D=Ei(d);return new ai(w,D)}}const lx=xn(Nr);class cx extends el{project(o,l){l=xn(l),o=xn(o);const d=Math.cos(l),p=2/Math.PI,_=Math.acos(d*Math.cos(o/2)),v=Math.sin(_)/_,w=.5*(o*p+2*d*Math.sin(o/2)/v)||0,D=.5*(l+Math.sin(l)/v)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(D/Math.PI+1),z:0}}unproject(o,l){let d=o=(2*o-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,_=25;const v=1e-6;let w=0,D=0;do{const S=Math.cos(p),k=Math.sin(p),P=2*k*S,F=k*k,B=S*S,z=Math.cos(d/2),j=Math.sin(d/2),Y=2*z*j,te=j*j,ce=1-B*z*z,ne=ce?1/ce:0,ae=ce?Math.acos(S*z)*Math.sqrt(1/ce):0,pe=.5*(2*ae*S*j+2*d/Math.PI)-o,he=.5*(ae*k+p)-l,Te=.5*ne*(B*te+ae*S*z*F)+1/Math.PI,Se=ne*(Y*P/4-ae*k*j),Ue=.125*ne*(P*j-ae*k*B*Y),nt=.5*ne*(F*z+ae*te*S)+.5,Fe=Se*Ue-nt*Te;w=(he*Se-pe*nt)/Fe,D=(pe*Ue-he*Te)/Fe,d=wt(d-w,-Math.PI,Math.PI),p=wt(p-D,-lx,lx)}while((Math.abs(w)>v||Math.abs(D)>v)&&--_>0);return new ai(Ei(d),Ei(p))}}class Ng extends el{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(xn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){const{scale:d,cosPhi:p}=this;return{x:xn(o)*p*d+.5,y:-Math.sin(xn(l))/p*d+.5,z:0}}unproject(o,l){const{scale:d,cosPhi:p}=this,_=-(l-.5)/d,v=wt(Ei((o-.5)/d)/p,-180,180),w=Math.asin(wt(_*p,-1,1)),D=wt(Ei(w),-Nr,Nr);return new ai(v,D)}}class Bg extends ax{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,l,d){const p=ff(o,l,d);return sr(p,p,tg(Bi(d))),{x:p[0],y:p[1],z:p[2]}}locationPoint(o,l){const d=Tl(l.lat,l.lng),p=Ao([],d),_=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(l),o._centerAltitude):o._centerAltitude;au(d,d,p,Ya(1,0)*Ot*_);const v=Sl(new Float64Array(16));return Ih(v,o.pixelMatrix,o.globeMatrix),sr(d,d,v),new pt(d[0],d[1])}pixelsPerMeter(o,l){return Ya(1,0)*l}pixelSpaceConversion(o,l,d){const p=Ya(1,o)*l,_=Hn(Ya(1,45)*l,p,d);return this.pixelsPerMeter(o,l)/_}createTileMatrix(o,l,d){const p=ms(Bi(d.canonical));return Ih(new Float64Array(16),o.globeMatrix,p)}createInversionMatrix(o,l){const{center:d}=o,p=tg(Bi(l));return ay(p,p,xn(d.lng)),c0(p,p,xn(d.lat)),su(p,p,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(o,l,d,p){return Oh(o,l,d,!0)||new hu(0,0)}pointCoordinate3D(o,l,d){const p=this.pointCoordinate(o,l,d,0);return[p.x,p.y,p.z]}isPointAboveHorizon(o,l){return!Oh(o,l.x,l.y,!1)}farthestPixelDistance(o){const l=function(p,_){const v=p.cameraToCenterDistance,w=p._centerAltitude*_,D=p._camera,S=p._camera.forward(),k=Ml([],Zo([],S,-v),[0,0,w]),P=p.worldSize/(2*Math.PI),F=[0,0,-P],B=p.width/p.height,z=Math.tan(p.fovAboveCenter),j=Zo([],D.up(),z),Y=Zo([],D.right(),z*B),te=Ao([],Ml([],Ml([],S,j),Y)),ce=[];let ne;if(new cd(k,te).closestPointOnSphere(F,P,ce)){const ae=Ml([],ce,F),pe=xa([],ae,k);ne=Math.cos(p.fovAboveCenter)*ad(pe)}else{const ae=xa([],k,F),pe=xa([],F,k);Ao(pe,pe);const he=ad(ae)-P;ne=Math.sqrt(he*(he+2*P));const Te=Math.acos(ne/(P+he))-Math.acos(Ps(S,pe));ne*=Math.cos(Te)}return 1.01*ne}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),d=Za(o.zoom);if(d>0){const p=np(o,Ya(1,o.center.lat)*o.worldSize),_=o.worldSize/(2*Math.PI),v=Math.max(o.width,o.height)/o.worldSize*Math.PI;return Hn(l,p+_*(1-Math.cos(v)),Math.pow(d,10))}return l}upVector(o,l,d){return ff(l,d,o,1)}upVectorScale(o){return{metersToTile:fy(my(Bi(o)))}}}function dx(a){const o=a.parallels,l=!!o&&Math.abs(o[0]+o[1])<.01;switch(a.name){case"mercator":return new ax(a);case"equirectangular":return new sx(a);case"naturalEarth":return new rv(a);case"equalEarth":return new ox(a);case"winkelTripel":return new cx(a);case"albers":return l?new Ng(a):new CT(a);case"lambertConformalConic":return l?new Ng(a):new ET(a);case"globe":return new Bg(a)}throw new Error(`Invalid projection name: ${a.name}`)}const ux=gg.types,XC=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function jf(a,o,l,d,p,_,v,w,D,S,k,P,F){const B=w?Math.min(Rl,Math.round(w[0])):0,z=w?Math.min(Rl,Math.round(w[1])):0;a.emplaceBack(o,l,Math.round(32*d),Math.round(32*p),_,v,(B<<1)+(D?1:0),z,16*S,16*k,256*P,256*F)}function ov(a,o,l,d,p,_,v){a.emplaceBack(o,l,d,p,_,v)}function zg(a,o,l,d,p){a.emplaceBack(o,l,d,p),a.emplaceBack(o,l,d,p),a.emplaceBack(o,l,d,p),a.emplaceBack(o,l,d,p)}function op(a){for(const o of a.sections)if(Gm(o.text))return!0;return!1}class sv{constructor(o){this.layoutVertexArray=new We,this.indexArray=new At,this.programConfigurations=o,this.segments=new rr,this.dynamicLayoutVertexArray=new Qe,this.opacityVertexArray=new Pt,this.placedSymbolArray=new Gi,this.globeExtVertexArray=new Le}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(o,l,d,p){this.isEmpty()||(d&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,AC.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,kC.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,XC,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,IC.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||p)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Dt(sv,"SymbolBuffers");class Ed{constructor(o,l,d){this.layoutVertexArray=new o,this.layoutAttributes=l,this.indexArray=new d,this.segments=new rr,this.collisionVertexArray=new On,this.collisionVertexArrayExt=new Sn}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,RC.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,ta.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Dt(Ed,"CollisionBuffers");class jt{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(v=>v.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Sl([]),this.placementViewportMatrix=Sl([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Uy(this.zoom,l["text-size"]),this.iconSizeData=Uy(this.zoom,l["icon-size"]);const d=this.layers[0].layout,p=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&void 0!==p.constantOr(1),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(v=>Ls[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=o.sourceID,this.projection=o.projection}createArrays(){this.text=new sv(new uc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new sv(new uc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new uo,this.lineVertexArray=new Sh,this.symbolInstances=new Si}calculateGlyphDependencies(o,l,d,p,_){for(let v=0;v<o.length;v++)if(l[o.charCodeAt(v)]=!0,p&&_){const w=Pf[o.charAt(v)];w&&(l[w.charCodeAt(0)]=!0)}}populate(o,l,d,p){const _=this.layers[0],v=_.layout,w="globe"===this.projection.name,D=v.get("text-font"),S=v.get("text-field"),k=v.get("icon-image"),P=("constant"!==S.value.kind||S.value.value instanceof ds&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&("constant"!==D.value.kind||D.value.value.length>0),F="constant"!==k.value.kind||!!k.value.value||Object.keys(k.parameters).length>0,B=v.get("symbol-sort-key");if(this.features=[],!P&&!F)return;const z=l.iconDependencies,j=l.glyphDependencies,Y=l.availableImages,te=new R(this.zoom);for(const{feature:ce,id:ne,index:ae,sourceLayerIndex:pe}of o){const he=_._featureFilter.needGeometry,Te=Nh(ce,he);if(!_._featureFilter.filter(te,Te,d))continue;if(he||(Te.geometry=gc(ce,d,p)),w&&1!==ce.type&&d.z<=5){const Fe=Te.geometry,Ge=.98078528056,je=(Xe,lt)=>Ps(ff(Xe.x,Xe.y,d,1),ff(lt.x,lt.y,d,1))<Ge;for(let Xe=0;Xe<Fe.length;Xe++)Fe[Xe]=_f(Fe[Xe],je)}let Se,Ue;if(P){const Fe=_.getValueAndResolveTokens("text-field",Te,d,Y),Ge=ds.factory(Fe);op(Ge)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===C()||this.hasRTLText&&I.isParsed())&&(Se=OC(Ge,_,Te))}if(F){const Fe=_.getValueAndResolveTokens("icon-image",Te,d,Y);Ue=Fe instanceof Ws?Fe:Ws.fromString(Fe)}if(!Se&&!Ue)continue;const nt=this.sortFeaturesByKey?B.evaluate(Te,{},d):void 0;if(this.features.push({id:ne,text:Se,icon:Ue,index:ae,sourceLayerIndex:pe,geometry:Te.geometry,properties:ce.properties,type:ux[ce.type],sortKey:nt}),Ue&&(z[Ue.name]=!0),Se){const Fe=D.evaluate(Te,{},d).join(","),Ge="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ls.vertical)>=0;for(const je of Se.sections)if(je.image)z[je.image.name]=!0;else{const Xe=Eh(Se.toString()),lt=je.fontStack||Fe,Be=j[lt]=j[lt]||{};this.calculateGlyphDependencies(je.text,Be,Ge,this.allowVerticalPlacement,Xe)}}}"line"===v.get("symbol-placement")&&(this.features=function(ce){const ne={},ae={},pe=[];let he=0;function Te(Fe){pe.push(ce[Fe]),he++}function Se(Fe,Ge,je){const Xe=ae[Fe];return delete ae[Fe],ae[Ge]=Xe,pe[Xe].geometry[0].pop(),pe[Xe].geometry[0]=pe[Xe].geometry[0].concat(je[0]),Xe}function Ue(Fe,Ge,je){const Xe=ne[Ge];return delete ne[Ge],ne[Fe]=Xe,pe[Xe].geometry[0].shift(),pe[Xe].geometry[0]=je[0].concat(pe[Xe].geometry[0]),Xe}function nt(Fe,Ge,je){const Xe=je?Ge[0][Ge[0].length-1]:Ge[0][0];return`${Fe}:${Xe.x}:${Xe.y}`}for(let Fe=0;Fe<ce.length;Fe++){const Ge=ce[Fe],je=Ge.geometry,Xe=Ge.text?Ge.text.toString():null;if(!Xe){Te(Fe);continue}const lt=nt(Xe,je),Be=nt(Xe,je,!0);if(lt in ae&&Be in ne&&ae[lt]!==ne[Be]){const ft=Ue(lt,Be,je),St=Se(lt,Be,pe[ft].geometry);delete ne[lt],delete ae[Be],ae[nt(Xe,pe[St].geometry,!0)]=St,pe[ft].geometry=null}else lt in ae?Se(lt,Be,je):Be in ne?Ue(lt,Be,je):(Te(Fe),ne[lt]=he-1,ae[Be]=he-1)}return pe.filter(Fe=>Fe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,ne)=>ce.sortKey-ne.sortKey)}update(o,l,d,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,l,this.layers,d,p),this.icon.programConfigurations.updatePaintArrays(o,l,this.layers,d,p))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=dx(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,l){const d=this.lineVertexArray.length;if(void 0!==o.segment)for(const{x:p,y:_}of l)this.lineVertexArray.emplaceBack(p,_);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(o,l,d,p,_,v,w,D,S,k,P,F,B,z){const j=o.indexArray,Y=o.layoutVertexArray,te=o.globeExtVertexArray,ce=o.segments.prepareSegment(4*l.length,Y,j,this.canOverlap?v.sortKey:void 0),ne=this.glyphOffsetArray.length,ae=ce.vertexLength,pe=this.allowVerticalPlacement&&w===Ls.vertical?Math.PI/2:0,he=v.text&&v.text.sections;for(let Se=0;Se<l.length;Se++){const{tl:Ue,tr:nt,bl:Fe,br:Ge,tex:je,pixelOffsetTL:Xe,pixelOffsetBR:lt,minFontScaleX:Be,minFontScaleY:ft,glyphOffset:St,isSDF:_t,sectionIndex:en}=l[Se],st=ce.vertexLength,Ft=St[1];if(jf(Y,S.x,S.y,Ue.x,Ft+Ue.y,je.x,je.y,d,_t,Xe.x,Xe.y,Be,ft),jf(Y,S.x,S.y,nt.x,Ft+nt.y,je.x+je.w,je.y,d,_t,lt.x,Xe.y,Be,ft),jf(Y,S.x,S.y,Fe.x,Ft+Fe.y,je.x,je.y+je.h,d,_t,Xe.x,lt.y,Be,ft),jf(Y,S.x,S.y,Ge.x,Ft+Ge.y,je.x+je.w,je.y+je.h,d,_t,lt.x,lt.y,Be,ft),D){const{x:sn,y:Gn,z:an}=D.anchor,[Ht,vi,Yt]=D.up;ov(te,sn,Gn,an,Ht,vi,Yt),ov(te,sn,Gn,an,Ht,vi,Yt),ov(te,sn,Gn,an,Ht,vi,Yt),ov(te,sn,Gn,an,Ht,vi,Yt),zg(o.dynamicLayoutVertexArray,sn,Gn,an,pe)}else zg(o.dynamicLayoutVertexArray,S.x,S.y,S.z,pe);j.emplaceBack(st,st+1,st+2),j.emplaceBack(st+1,st+2,st+3),ce.vertexLength+=4,ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(St[0]),Se!==l.length-1&&en===l[Se+1].sectionIndex||o.programConfigurations.populatePaintArrays(Y.length,v,v.index,{},B,z,he&&he[en])}const Te=D?D.anchor:S;o.placedSymbolArray.emplaceBack(Te.x,Te.y,Te.z,S.x,S.y,ne,this.glyphOffsetArray.length-ne,ae,k,P,S.segment,d?d[0]:0,d?d[1]:0,p[0],p[1],w,0,!1,0,F,0)}_commitLayoutVertex(o,l,d,p,_,v,w){o.emplaceBack(l,d,p,_,v,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(o,l,d,p,_,v,w){const D=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),S=D.vertexLength,k=w.tileAnchorX,P=w.tileAnchorY;for(let B=0;B<4;B++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(l,-o.padding,-o.padding),d.collisionVertexArrayExt.emplaceBack(l,o.padding,-o.padding),d.collisionVertexArrayExt.emplaceBack(l,o.padding,o.padding),d.collisionVertexArrayExt.emplaceBack(l,-o.padding,o.padding),this._commitLayoutVertex(d.layoutVertexArray,p,_,v,k,P,new pt(o.x1,o.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,_,v,k,P,new pt(o.x2,o.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,_,v,k,P,new pt(o.x2,o.y2)),this._commitLayoutVertex(d.layoutVertexArray,p,_,v,k,P,new pt(o.x1,o.y2)),D.vertexLength+=4;const F=d.indexArray;F.emplaceBack(S,S+1),F.emplaceBack(S+1,S+2),F.emplaceBack(S+2,S+3),F.emplaceBack(S+3,S),D.primitiveLength+=4}_addTextDebugCollisionBoxes(o,l,d,p,_,v){for(let w=p;w<_;w++){const D=d.get(w),S=this.getSymbolInstanceTextSize(o,v,l,w);this._addCollisionDebugVertices(D,S,this.textCollisionBox,D.projectedAnchorX,D.projectedAnchorY,D.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(o,l,d,p,_,v){for(let w=p;w<_;w++){const D=d.get(w),S=this.getSymbolInstanceIconSize(o,l,v.placedIconSymbolIndex);this._addCollisionDebugVertices(D,S,this.iconCollisionBox,D.projectedAnchorX,D.projectedAnchorY,D.projectedAnchorZ,v)}}generateCollisionDebugBuffers(o,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ed(Mt,Ka.members,qe),this.iconCollisionBox=new Ed(Mt,Ka.members,qe);const d=Yh(this.iconSizeData,o),p=Yh(this.textSizeData,o);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(p,o,l,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(p,o,l,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(d,o,l,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(d,o,l,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(o,l,d,p){const _=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),v=vg(this.textSizeData,o,_)/Zr;return this.tilePixelRatio*v}getSymbolInstanceIconSize(o,l,d){const p=this.icon.placedSymbolArray.get(d),_=vg(this.iconSizeData,o,p);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(o,l,d){o.emplaceBack(l,-d,-d),o.emplaceBack(l,d,-d),o.emplaceBack(l,d,d),o.emplaceBack(l,-d,d)}_updateTextDebugCollisionBoxes(o,l,d,p,_,v){for(let w=p;w<_;w++){const D=d.get(w),S=this.getSymbolInstanceTextSize(o,v,l,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,S,D.padding)}}_updateIconDebugCollisionBoxes(o,l,d,p,_,v){for(let w=p;w<_;w++){const D=d.get(w),S=this.getSymbolInstanceIconSize(o,l,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,S,D.padding)}}updateCollisionDebugBuffers(o,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=Yh(this.iconSizeData,o),p=Yh(this.textSizeData,o);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(p,o,l,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(p,o,l,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(d,o,l,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,o,l,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,l,d,p,_,v,w,D,S){const k={};if(l<d){const{x1:P,y1:F,x2:B,y2:z,padding:j,projectedAnchorX:Y,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:ae,featureIndex:pe}=o.get(l);k.textBox={x1:P,y1:F,x2:B,y2:z,padding:j,projectedAnchorX:Y,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:ae},k.textFeatureIndex=pe}if(p<_){const{x1:P,y1:F,x2:B,y2:z,padding:j,projectedAnchorX:Y,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:ae,featureIndex:pe}=o.get(p);k.verticalTextBox={x1:P,y1:F,x2:B,y2:z,padding:j,projectedAnchorX:Y,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:ae},k.verticalTextFeatureIndex=pe}if(v<w){const{x1:P,y1:F,x2:B,y2:z,padding:j,projectedAnchorX:Y,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:ae,featureIndex:pe}=o.get(v);k.iconBox={x1:P,y1:F,x2:B,y2:z,padding:j,projectedAnchorX:Y,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:ae},k.iconFeatureIndex=pe}if(D<S){const{x1:P,y1:F,x2:B,y2:z,padding:j,projectedAnchorX:Y,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:ae,featureIndex:pe}=o.get(D);k.verticalIconBox={x1:P,y1:F,x2:B,y2:z,padding:j,projectedAnchorX:Y,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:ae},k.verticalIconFeatureIndex=pe}return k}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,l){const d=o.placedSymbolArray.get(l),p=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<p;_+=4)o.indexArray.emplaceBack(_,_+1,_+2),o.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(o),d=Math.cos(o),p=[],_=[],v=[];for(let w=0;w<this.symbolInstances.length;++w){v.push(w);const D=this.symbolInstances.get(w);p.push(0|Math.round(l*D.tileAnchorX+d*D.tileAnchorY)),_.push(D.featureIndex)}return v.sort((w,D)=>p[w]-p[D]||_[D]-_[w]),v}addToSortKeyRanges(o,l){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===l?d.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const d=this.symbolInstances.get(l);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:S}=d;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),_>=0&&_!==p&&this.addIndicesForPlacedSymbol(this.text,_),v>=0&&v!==_&&v!==p&&this.addIndicesForPlacedSymbol(this.text,v),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Dt(jt,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),jt.MAX_GLYPHS=65535,jt.addDynamicAttributes=zg;const KC=new re({"symbol-placement":new U(ze.layout_symbol["symbol-placement"]),"symbol-spacing":new U(ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new U(ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Z(ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new U(ze.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new U(ze.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new U(ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new U(ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new U(ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new Z(ze.layout_symbol["icon-size"]),"icon-text-fit":new U(ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new U(ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new Z(ze.layout_symbol["icon-image"]),"icon-rotate":new Z(ze.layout_symbol["icon-rotate"]),"icon-padding":new U(ze.layout_symbol["icon-padding"]),"icon-keep-upright":new U(ze.layout_symbol["icon-keep-upright"]),"icon-offset":new Z(ze.layout_symbol["icon-offset"]),"icon-anchor":new Z(ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new U(ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new U(ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new U(ze.layout_symbol["text-rotation-alignment"]),"text-field":new Z(ze.layout_symbol["text-field"]),"text-font":new Z(ze.layout_symbol["text-font"]),"text-size":new Z(ze.layout_symbol["text-size"]),"text-max-width":new Z(ze.layout_symbol["text-max-width"]),"text-line-height":new Z(ze.layout_symbol["text-line-height"]),"text-letter-spacing":new Z(ze.layout_symbol["text-letter-spacing"]),"text-justify":new Z(ze.layout_symbol["text-justify"]),"text-radial-offset":new Z(ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new U(ze.layout_symbol["text-variable-anchor"]),"text-anchor":new Z(ze.layout_symbol["text-anchor"]),"text-max-angle":new U(ze.layout_symbol["text-max-angle"]),"text-writing-mode":new U(ze.layout_symbol["text-writing-mode"]),"text-rotate":new Z(ze.layout_symbol["text-rotate"]),"text-padding":new U(ze.layout_symbol["text-padding"]),"text-keep-upright":new U(ze.layout_symbol["text-keep-upright"]),"text-transform":new Z(ze.layout_symbol["text-transform"]),"text-offset":new Z(ze.layout_symbol["text-offset"]),"text-allow-overlap":new U(ze.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new U(ze.layout_symbol["text-ignore-placement"]),"text-optional":new U(ze.layout_symbol["text-optional"])});var Eu={paint:new re({"icon-opacity":new Z(ze.paint_symbol["icon-opacity"]),"icon-color":new Z(ze.paint_symbol["icon-color"]),"icon-halo-color":new Z(ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new Z(ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Z(ze.paint_symbol["icon-halo-blur"]),"icon-translate":new U(ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new U(ze.paint_symbol["icon-translate-anchor"]),"text-opacity":new Z(ze.paint_symbol["text-opacity"]),"text-color":new Z(ze.paint_symbol["text-color"],{runtimeType:as,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Z(ze.paint_symbol["text-halo-color"]),"text-halo-width":new Z(ze.paint_symbol["text-halo-width"]),"text-halo-blur":new Z(ze.paint_symbol["text-halo-blur"]),"text-translate":new U(ze.paint_symbol["text-translate"]),"text-translate-anchor":new U(ze.paint_symbol["text-translate-anchor"])}),layout:KC};class Pl{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Jn,this.defaultValue=o}evaluate(o){if(o.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(o.formattedSection))return l.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Dt(Pl,"FormatSectionOverride",{omit:["defaultValue"]});class Vg extends ks{constructor(o){super(o,Eu)}recalculate(o,l){super.recalculate(o,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const p=[];for(const _ of d)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(o,l,d,p){const _=this.layout.get(o).evaluate(l,{},d,p),v=this._unevaluatedLayout._values[o];return v.isDataDriven()||ya(v.value)||!_?_:(w=l.properties,_.replace(/{([^{}]+)}/g,(S,k)=>k in w?String(w[k]):""));var w}createBucket(o){return new jt(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of Eu.paint.overridableProperties){if(!Vg.hasPaintOverride(this.layout,o))continue;const l=this.paint.get(o),d=new Pl(l),p=new nr(d,l.property.specification);let _=null;_="constant"===l.value.kind||"source"===l.value.kind?new As("source",p):new Ha("composite",p,l.value.zoomStops,l.value._interpolationType),this.paint._values[o]=new K(l.property,_,l.parameters)}}_handleOverridablePaintPropertyUpdate(o,l,d){return!(!this.layout||l.isDataDriven()||d.isDataDriven())&&Vg.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,l){const d=o.get("text-field"),p=Eu.paint.properties[l];let _=!1;const v=w=>{for(const D of w)if(p.overrides&&p.overrides.hasOverride(D))return void(_=!0)};if("constant"===d.value.kind&&d.value.value instanceof ds)v(d.value.value.sections);else if("source"===d.value.kind){const w=S=>{_||(S instanceof Zn&&Qi(S.value)===tc?v(S.value.sections):S instanceof nc?v(S.sections):S.eachChild(w))},D=d.value;D._styleExpression&&w(D._styleExpression.expression)}return _}getProgramConfiguration(o){return new sd(this,o)}}var JC={paint:new re({"background-color":new U(ze.paint_background["background-color"]),"background-pattern":new U(ze.paint_background["background-pattern"]),"background-opacity":new U(ze.paint_background["background-opacity"])})},Du={paint:new re({"raster-opacity":new U(ze.paint_raster["raster-opacity"]),"raster-hue-rotate":new U(ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new U(ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new U(ze.paint_raster["raster-brightness-max"]),"raster-saturation":new U(ze.paint_raster["raster-saturation"]),"raster-contrast":new U(ze.paint_raster["raster-contrast"]),"raster-resampling":new U(ze.paint_raster["raster-resampling"]),"raster-fade-duration":new U(ze.paint_raster["raster-fade-duration"])})};class QC extends ks{constructor(o){super(o,{}),this.implementation=o}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}var av={paint:new re({"sky-type":new U(ze.paint_sky["sky-type"]),"sky-atmosphere-sun":new U(ze.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new U(ze.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new U(ze.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new U(ze.paint_sky["sky-gradient-radius"]),"sky-gradient":new ie(ze.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new U(ze.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new U(ze.paint_sky["sky-atmosphere-color"]),"sky-opacity":new U(ze.paint_sky["sky-opacity"])})};function Su(a,o,l){const d=[0,0,1],p=uy([]);return h0(p,p,l?-xn(a)+Math.PI:xn(a)),cu(p,p,-xn(o)),cy(d,d,p),Ao(d,d)}const hx={circle:class extends ks{constructor(a){super(a,_T)}createBucket(a){return new vy(a)}queryRadius(a){const o=a;return md("circle-radius",this,o)+md("circle-stroke-width",this,o)+by(this.paint.get("circle-translate"))}queryIntersectsFeature(a,o,l,d,p,_,v,w){const D=pC(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),S=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l);return A0(a,d,_,v,w,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),D,S)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new sd(this,a)}},heatmap:class extends ks{createBucket(a){return new xy(a)}constructor(a){super(a,fC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Cy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return md("heatmap-radius",this,a)}queryIntersectsFeature(a,o,l,d,p,_,v,w){const D=this.paint.get("heatmap-radius").evaluate(o,l);return A0(a,d,_,v,w,!0,!0,new pt(0,0),D)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new sd(this,a)}},hillshade:class extends ks{constructor(a){super(a,mC)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ks{constructor(a){super(a,yC)}getProgramIds(){const a=this.paint.get("fill-pattern"),o=a&&a.constantOr(1),l=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(a){return new sd(this,a)}recalculate(a,o){super.recalculate(a,o);const l=this.paint._values["fill-outline-color"];"constant"===l.value.kind&&void 0===l.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new fg(a)}queryRadius(){return by(this.paint.get("fill-translate"))}queryIntersectsFeature(a,o,l,d,p,_){return!a.queryGeometry.isAboveHorizon&&w0(hC(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends ks{constructor(a){super(a,DC)}createBucket(a){return new yc(a)}queryRadius(){return by(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new sd(this,a)}queryIntersectsFeature(a,o,l,d,p,_,v,w,D){const S=pC(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(o,l),P=this.paint.get("fill-extrusion-base").evaluate(o,l),F=[0,0],B=w&&_.elevation,z=_.elevation?_.elevation.exaggeration():1,j=a.tile.getBucket(this);if(B&&j instanceof yc){const ae=j.centroidVertexArray,pe=D+1;pe<ae.length&&(F[0]=ae.geta_centroid_pos0(pe),F[1]=ae.geta_centroid_pos1(pe))}if(0===F[0]&&1===F[1])return!1;"globe"===_.projection.name&&(d=Ly([d],[new pt(0,0),new pt(Ot,Ot)],a.tileID.canonical).map(ae=>ae.polygon).flat());const Y=B?w:null,[te,ce]=(pe=d,he=P,Te=k,Se=S,Ue=v,nt=Y,Fe=F,Ge=z,je=_.center.lat,"globe"===(ae=_).projection.name?function(lt,Be,ft,St,_t,en,st,Ft,sn,Gn,an){const Ht=[],vi=[],Yt=lt.projection.upVectorScale(an,lt.center.lat,lt.worldSize).metersToTile,fn=[0,0,0,1],bi=[0,0,0,1],pi=(xi,Wi,ar,lr)=>{xi[0]=Wi,xi[1]=ar,xi[2]=lr,xi[3]=1},Mi=G0();ft>0&&(ft+=Mi),St+=Mi;for(const xi of Be){const Wi=[],ar=[];for(const lr of xi){const wi=lr.x+_t.x,or=lr.y+_t.y,Zi=lt.projection.projectTilePoint(wi,or,an),Fi=lt.projection.upVector(an,lr.x,lr.y);let ni=ft,_r=St;if(st){const li=SC(wi,or,ft,St,st,Ft,sn,Gn);ni+=li.base,_r+=li.top}0!==ft?pi(fn,Zi.x+Fi[0]*Yt*ni,Zi.y+Fi[1]*Yt*ni,Zi.z+Fi[2]*Yt*ni):pi(fn,Zi.x,Zi.y,Zi.z),pi(bi,Zi.x+Fi[0]*Yt*_r,Zi.y+Fi[1]*Yt*_r,Zi.z+Fi[2]*Yt*_r),sr(fn,fn,en),sr(bi,bi,en),Wi.push(new Xa(fn[0],fn[1],fn[2])),ar.push(new Xa(bi[0],bi[1],bi[2]))}Ht.push(Wi),vi.push(ar)}return[Ht,vi]}(ae,pe,he,Te,Se,Ue,nt,Fe,Ge,je,a.tileID.canonical):nt?function(lt,Be,ft,St,_t,en,st,Ft,sn){const Gn=[],an=[],Ht=[0,0,0,1];for(const vi of lt){const Yt=[],fn=[];for(const bi of vi){const pi=bi.x+St.x,Mi=bi.y+St.y,xi=SC(pi,Mi,Be,ft,en,st,Ft,sn);Ht[0]=pi,Ht[1]=Mi,Ht[2]=xi.base,Ht[3]=1,lu(Ht,Ht,_t),Ht[3]=Math.max(Ht[3],1e-5);const Wi=new Xa(Ht[0]/Ht[3],Ht[1]/Ht[3],Ht[2]/Ht[3]);Ht[0]=pi,Ht[1]=Mi,Ht[2]=xi.top,Ht[3]=1,lu(Ht,Ht,_t),Ht[3]=Math.max(Ht[3],1e-5);const ar=new Xa(Ht[0]/Ht[3],Ht[1]/Ht[3],Ht[2]/Ht[3]);Yt.push(Wi),fn.push(ar)}Gn.push(Yt),an.push(fn)}return[Gn,an]}(pe,he,Te,Se,Ue,nt,Fe,Ge,je):function(lt,Be,ft,St,_t){const en=[],st=[],Ft=_t[8]*Be,sn=_t[9]*Be,Gn=_t[10]*Be,an=_t[11]*Be,Ht=_t[8]*ft,vi=_t[9]*ft,Yt=_t[10]*ft,fn=_t[11]*ft;for(const bi of lt){const pi=[],Mi=[];for(const xi of bi){const Wi=xi.x+St.x,ar=xi.y+St.y,lr=_t[0]*Wi+_t[4]*ar+_t[12],wi=_t[1]*Wi+_t[5]*ar+_t[13],or=_t[2]*Wi+_t[6]*ar+_t[14],Zi=_t[3]*Wi+_t[7]*ar+_t[15],Fi=lr+Ft,ni=wi+sn,_r=or+Gn,li=Math.max(Zi+an,1e-5),Xo=lr+Ht,yr=wi+vi,Yr=or+Yt,xr=Math.max(Zi+fn,1e-5);pi.push(new Xa(Fi/li,ni/li,_r/li)),Mi.push(new Xa(Xo/xr,yr/xr,Yr/xr))}en.push(pi),st.push(Mi)}return[en,st]}(pe,he,Te,Se,Ue)),ne=a.queryGeometry;var ae,pe,he,Te,Se,Ue,nt,Fe,Ge,je;return function(ae,pe,he){let Te=1/0;w0(he,pe)&&(Te=W0(he,pe[0]));for(let Se=0;Se<pe.length;Se++){const Ue=pe[Se],nt=ae[Se];for(let Fe=0;Fe<Ue.length-1;Fe++){const Ge=Ue[Fe],je=[Ge,Ue[Fe+1],nt[Fe+1],nt[Fe],Ge];yf(he,je)&&(Te=Math.min(Te,W0(he,je)))}}return Te!==1/0&&Te}(te,ce,ne.isPointQuery()?ne.screenBounds:ne.screenGeometry)}},line:class extends ks{constructor(a){super(a,Vy),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if("line-gradient"===a){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof Fp,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,o){super.recalculate(a,o),this.paint._values["line-floorwidth"]=yd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Rf(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new sd(this,a)}queryRadius(a){const o=a,l=Y0(md("line-width",this,o),md("line-gap-width",this,o)),d=md("line-offset",this,o);return l/2+Math.abs(d)+by(this.paint.get("line-translate"))}queryIntersectsFeature(a,o,l,d,p,_){if(a.queryGeometry.isAboveHorizon)return!1;const v=hC(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),w=a.pixelToTileUnitsFactor/2*Y0(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),D=this.paint.get("line-offset").evaluate(o,l);return D&&(d=function(S,k){const P=[],F=new pt(0,0);for(let B=0;B<S.length;B++){const z=S[B],j=[];for(let Y=0;Y<z.length;Y++){const te=z[Y],ce=z[Y+1],ne=0===Y?F:te.sub(z[Y-1])._unit()._perp(),ae=Y===z.length-1?F:ce.sub(te)._unit()._perp(),pe=ne._add(ae)._unit();pe._mult(1/(pe.x*ae.x+pe.y*ae.y)),j.push(pe._mult(k)._add(te))}P.push(j)}return P}(d,D*a.pixelToTileUnitsFactor)),function(S,k,P){for(let F=0;F<k.length;F++){const B=k[F];if(S.length>=3)for(let z=0;z<B.length;z++)if(_c(S,B[z]))return!0;if(C0(S,B,P))return!0}return!1}(v,d,w)}isTileClipped(){return!0}},symbol:Vg,background:class extends ks{constructor(a){super(a,JC)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ks{constructor(a){super(a,Du)}getProgramIds(){return["raster"]}},sky:class extends ks{constructor(a){super(a,av),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"sky-gradient"===a?this._updateColorRamp():"sky-atmosphere-sun"!==a&&"sky-atmosphere-halo-color"!==a&&"sky-atmosphere-color"!==a&&"sky-atmosphere-sun-intensity"!==a||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Cy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(a,o){if("atmosphere"===this.paint.get("sky-type")){const d=this.paint.get("sky-atmosphere-sun"),p=!d,_=a.style.light,v=_.properties.get("position");return p&&"viewport"===_.properties.get("anchor")&&ji("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?Su(v.azimuthal,90-v.polar,o):Su(d[0],90-d[1],o)}const l=this.paint.get("sky-gradient-center");return Su(l[0],90-l[1],o)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return"atmosphere"===a?["skyboxCapture","skybox"]:"gradient"===a?["skyboxGradient"]:null}}};class Ug{constructor(o,l,d,p){this.context=o,this.format=d,this.texture=o.gl.createTexture(),this.update(l,p)}update(o,l,d){const{width:p,height:_}=o,{context:v}=this,{gl:w}=v,{HTMLImageElement:D,HTMLCanvasElement:S,HTMLVideoElement:k,ImageData:P,ImageBitmap:F}=Ie;if(w.bindTexture(w.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!l||!1!==l.premultiply)),d||this.size&&this.size[0]===p&&this.size[1]===_){const{x:B,y:z}=d||{x:0,y:0};o instanceof D||o instanceof S||o instanceof k||o instanceof P||F&&o instanceof F?w.texSubImage2D(w.TEXTURE_2D,0,B,z,w.RGBA,w.UNSIGNED_BYTE,o):w.texSubImage2D(w.TEXTURE_2D,0,B,z,p,_,w.RGBA,w.UNSIGNED_BYTE,o.data)}else this.size=[p,_],o instanceof D||o instanceof S||o instanceof k||o instanceof P||F&&o instanceof F?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,o):w.texImage2D(w.TEXTURE_2D,0,this.format,p,_,0,this.format,w.UNSIGNED_BYTE,o.data);this.useMipmap=!!(l&&l.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(o,l){const{context:d}=this,{gl:p}=d;p.bindTexture(p.TEXTURE_2D,this.texture),o!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?o===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:o),this.filter=o),l!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class lv{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Ol{constructor(){this.tasks={},this.taskQueue=[],fi(["process"],this),this.invoker=new lv(this.process),this.nextId=0}add(o,l){const d=this.nextId++,p=function({type:_,isSymbolTile:v,zoom:w}){return w=w||0,"message"===_?0:"maybePrepare"!==_||v?"parseTile"!==_||v?"parseTile"===_&&v?300-w:"maybePrepare"===_&&v?400-w:500:200-w:100-w}(l);if(0===p){pl();try{o()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:o,metadata:l,priority:p,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){pl();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const o=this.pick();if(null===o)return;const l=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let o=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){const _=this.tasks[this.taskQueue[p]];_.priority<l&&(l=_.priority,o=p)}if(null===o)return null;const d=this.taskQueue[o];return this.taskQueue.splice(o,1),d}remove(){this.invoker.remove()}}class Hf{constructor(o){this._stringToNumber={},this._numberToString=[];for(let l=0;l<o.length;l++){const d=o[l];this._stringToNumber[d]=l,this._numberToString[l]=d}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const px=["tile","layer","source","sourceLayer","state"];class cv{constructor(o,l,d,p,_){this.type="Feature",this._vectorTileFeature=o,this._z=l,this._x=d,this._y=p,this.properties=o.properties,this.id=_}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(o.id=this.id);for(const l of px)void 0!==this[l]&&(o[l]=this[l]);return o}}const Dd=new Uint16Array(8184);for(let a=0;a<2046;a++){let o=a+2,l=0,d=0,p=0,_=0,v=0,w=0;for(1&o?p=_=v=32:l=d=w=32;(o>>=1)>1;){const S=l+p>>1,k=d+_>>1;1&o?(p=l,_=d,l=v,d=w):(l=p,d=_,p=v,_=w),v=S,w=k}const D=4*a;Dd[D+0]=l,Dd[D+1]=d,Dd[D+2]=p,Dd[D+3]=_}const Ll=new Uint16Array(2178),Sd=new Uint8Array(1089),jg=new Uint16Array(1089);function dv(a){return 0===a?-.03125:32===a?.03125:0}var Mu=ve([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Nl={type:2,extent:Ot,loadGeometry:()=>[[new pt(0,0),new pt(Ot+1,0),new pt(Ot+1,Ot+1),new pt(0,Ot+1),new pt(0,0)]]};class Hg{constructor(o,l,d,p,_){this.tileID=o,this.uid=Xt(),this.uses=0,this.tileSize=l,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(o){const l=o+this.timeAdded;l<Na.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Cd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,l,d){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(p,_){const v={};if(!_)return v;for(const w of p){const D=w.layerIds.map(S=>_.getLayer(S)).filter(Boolean);if(0!==D.length){w.layers=D,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(S=>D.filter(k=>k.id===S)[0]));for(const S of D)v[S.id]=w}}return v}(o.buckets,l.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof jt){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof jt&&_.hasRTLText){this.hasRTLText=!0,I.isLoading()||I.isLoaded()||"deferred"!==C()||M();break}}this.queryPadding=0;for(const p in this.buckets){const _=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(p).queryRadius(_))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas)}else this.collisionBoxArray=new bn}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.id]}upload(o){for(const d in this.buckets){const p=this.buckets[d];p.uploadPending()&&p.upload(o)}const l=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ug(o,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ug(o,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ug(o,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,l,d,p,_,v,w,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:w,transform:v,params:_,tileTransform:this.tileTransform},o,l,d):{}}querySourceFeatures(o,l){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const p=d.loadVTLayers(),_=l?l.sourceLayer:"",v=p._geojsonTileLayer||p[_];if(!v)return;const w=wl(l&&l.filter),{z:D,x:S,y:k}=this.tileID.canonical,P={z:D,x:S,y:k};for(let F=0;F<v.length;F++){const B=v.feature(F);if(w.needGeometry){const Y=Nh(B,!0);if(!w.filter(new R(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!w.filter(new R(this.tileID.overscaledZ),B))continue;const z=d.getId(B,_),j=new cv(B,D,S,k,z);j.tile=P,o.push(j)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const l=this.expirationTime;if(o.cacheControl){const d=ws(o.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const d=Date.now();let p=!1;if(this.expirationTime>d)p=!1;else if(l)if(this.expirationTime<l)p=!0;else{const _=this.expirationTime-l;_?this.expirationTime=d+Math.max(_,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length||!l)return;const d=this.latestFeatureIndex.loadVTLayers(),p=l.style.listImages();for(const _ in this.buckets){if(!l.style.hasLayer(_))continue;const v=this.buckets[_],w=v.layers[0].sourceLayer||"_geojsonTileLayer",D=d[w],S=o[w];if(!D||!S||0===Object.keys(S).length)continue;if(v.update(S,D,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof Rf||v instanceof fg){const P=l.style._getSourceCache(v.layers[0].source);l._terrain&&l._terrain.enabled&&P&&v.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(P.id,this.tileID)}const k=l&&l.style&&l.style.getLayer(_);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(v)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Na.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=Na.now()+o}setTexture(o,l){const d=l.context,p=d.gl;this.texture=this.texture||l.getTileTexture(o.width),this.texture?this.texture.update(o,{useMipmap:!0}):(this.texture=new Ug(d,o,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE))}setDependencies(o,l){const d={};for(const p of l)d[p]=!0;this.dependencies[o]=d}hasDependency(o,l){for(const d of o){const p=this.dependencies[d];if(p)for(const _ of l)if(p[_])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,l){if(!l||"mercator"===l.name||this._tileDebugBuffer)return;const d=gc(Nl,this.tileID.canonical,this.tileTransform)[0],p=new Je,_=new Mn;for(let v=0;v<d.length;v++){const{x:w,y:D}=d[v];p.emplaceBack(w,D),_.emplaceBack(v)}_.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(_),this._tileDebugBuffer=o.createVertexBuffer(p,Os.members),this._tileDebugSegments=rr.simpleSegment(0,0,p.length,_.length)}_makeTileBoundsBuffers(o,l){if(this._tileBoundsBuffer||!l||"mercator"===l.name)return;const d=gc(Nl,this.tileID.canonical,this.tileTransform)[0];let p,_;if(this.isRaster){const v=function(w,D){const S=Cd(w,D),k=Math.pow(2,w.z);for(let Y=0;Y<33;Y++)for(let te=0;te<33;te++){const ce=br((w.x+(te+dv(te))/32)/k),ne=po((w.y+(Y+dv(Y))/32)/k),ae=D.project(ce,ne),pe=33*Y+te;Ll[2*pe+0]=Math.round((ae.x*S.scale-S.x)*Ot),Ll[2*pe+1]=Math.round((ae.y*S.scale-S.y)*Ot)}Sd.fill(0),jg.fill(0);for(let Y=2045;Y>=0;Y--){const te=4*Y,ce=Dd[te+0],ne=Dd[te+1],ae=Dd[te+2],pe=Dd[te+3],he=ce+ae>>1,Te=ne+pe>>1,Se=he+Te-ne,Ue=Te+ce-he,nt=33*ne+ce,Fe=33*pe+ae,Ge=33*Te+he,je=Math.hypot((Ll[2*nt+0]+Ll[2*Fe+0])/2-Ll[2*Ge+0],(Ll[2*nt+1]+Ll[2*Fe+1])/2-Ll[2*Ge+1])>=16;Sd[Ge]=Sd[Ge]||(je?1:0),Y<1022&&(Sd[Ge]=Sd[Ge]||Sd[33*(ne+Ue>>1)+(ce+Se>>1)]||Sd[33*(pe+Ue>>1)+(ae+Se>>1)])}const P=new Ve,F=new At;let B=0;function z(Y,te){const ce=33*te+Y;return 0===jg[ce]&&(P.emplaceBack(Ll[2*ce+0],Ll[2*ce+1],Y*Ot/32,te*Ot/32),jg[ce]=++B),jg[ce]-1}function j(Y,te,ce,ne,ae,pe){const he=Y+ce>>1,Te=te+ne>>1;if(Math.abs(Y-ae)+Math.abs(te-pe)>1&&Sd[33*Te+he])j(ae,pe,Y,te,he,Te),j(ce,ne,ae,pe,he,Te);else{const Se=z(Y,te),Ue=z(ce,ne),nt=z(ae,pe);F.emplaceBack(Se,Ue,nt)}}return j(0,0,32,32,32,0),j(32,32,0,0,0,32),{vertices:P,indices:F}}(this.tileID.canonical,l);p=v.vertices,_=v.indices}else{p=new Ve,_=new At;for(const{x:w,y:D}of d)p.emplaceBack(w,D,0,0);const v=Ay(p.int16,void 0,4);for(let w=0;w<v.length;w+=3)_.emplaceBack(v[w],v[w+1],v[w+2])}this._tileBoundsBuffer=o.createVertexBuffer(p,Mu.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(_),this._tileBoundsSegments=rr.simpleSegment(0,0,p.length,_.length)}_makeGlobeTileDebugBuffers(o,l){const d=l.projection;if(!d||"globe"!==d.name||l.freezeTileCoverage)return;const p=this.tileID.canonical,_=tg(Fh(p,l)),v=Za(l.zoom);let w;v>0&&(w=sf(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,p,l,_,w,v),this._makeGlobeTileDebugTextBuffer(o,p,l,_,w,v)}_globePoint(o,l,d,p,_,v,w){let D=ff(o,l,d);if(v){const S=1<<d.z,k=Al(p.center.lng),P=Er(p.center.lat),F=(d.x+.5)/S-k;let B=0;F>.5?B=-1:F<-.5&&(B=1);let z=(o/Ot+d.x)/S+B,j=(l/Ot+d.y)/S;z=(z-k)*p._pixelsPerMercatorPixel+k,j=(j-P)*p._pixelsPerMercatorPixel+P;const Y=[z*p.worldSize,j*p.worldSize,0];sr(Y,Y,v),D=uu(D,Y,w)}return sr(D,D,_)}_makeGlobeTileDebugBorderBuffer(o,l,d,p,_,v){const w=new Je,D=new Mn,S=new De,k=(F,B,z,j,Y)=>{const te=(z-F)/(Y-1),ce=(j-B)/(Y-1),ne=w.length;for(let ae=0;ae<Y;ae++){const pe=F+ae*te,he=B+ae*ce;w.emplaceBack(pe,he);const Te=this._globePoint(pe,he,l,d,p,_,v);S.emplaceBack(Te[0],Te[1],Te[2]),D.emplaceBack(ne+ae)}},P=Ot;k(0,0,P,0,16),k(P,0,P,P,16),k(P,P,0,P,16),k(0,P,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(D),this._tileDebugBuffer=o.createVertexBuffer(w,Os.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(S,py.members),this._tileDebugSegments=rr.simpleSegment(0,0,w.length,D.length)}_makeGlobeTileDebugTextBuffer(o,l,d,p,_,v){const w=Ot/4,D=new Je,S=new At,k=new De,P=25;S.reserve(32),D.reserve(P),k.reserve(P);const F=(B,z)=>P*B+z;for(let B=0;B<P;B++){const z=B*w;for(let j=0;j<P;j++){const Y=j*w;D.emplaceBack(Y,z);const te=this._globePoint(Y,z,l,d,p,_,v);k.emplaceBack(te[0],te[1],te[2])}}for(let B=0;B<4;B++)for(let z=0;z<4;z++){const j=F(B,z),Y=F(B,z+1),te=F(B+1,z),ce=F(B+1,z+1);S.emplaceBack(j,Y,te),S.emplaceBack(te,Y,ce)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(S),this._tileDebugTextBuffer=o.createVertexBuffer(D,Os.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(k,py.members),this._tileDebugTextSegments=rr.simpleSegment(0,0,P,32)}}class DT{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,l,d){const p=String(l);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][p]=this.stateChanges[o][p]||{},Oi(this.stateChanges[o][p],d),null===this.deletedStates[o]){this.deletedStates[o]={};for(const _ in this.state[o])_!==p&&(this.deletedStates[o][_]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][p]){this.deletedStates[o][p]={};for(const _ in this.state[o][p])d[_]||(this.deletedStates[o][p][_]=null)}else for(const _ in d)this.deletedStates[o]&&this.deletedStates[o][p]&&null===this.deletedStates[o][p][_]&&delete this.deletedStates[o][p][_]}removeFeatureState(o,l,d){if(null===this.deletedStates[o])return;const p=String(l);if(this.deletedStates[o]=this.deletedStates[o]||{},d&&void 0!==l)null!==this.deletedStates[o][p]&&(this.deletedStates[o][p]=this.deletedStates[o][p]||{},this.deletedStates[o][p][d]=null);else if(void 0!==l)if(this.stateChanges[o]&&this.stateChanges[o][p])for(d in this.deletedStates[o][p]={},this.stateChanges[o][p])this.deletedStates[o][p][d]=null;else this.deletedStates[o][p]=null;else this.deletedStates[o]=null}getState(o,l){const d=String(l),p=Oi({},(this.state[o]||{})[d],(this.stateChanges[o]||{})[d]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const _=this.deletedStates[o][l];if(null===_)return{};for(const v in _)delete p[v]}return p}initializeTileState(o,l){o.setFeatureState(this.state,l)}coalesceChanges(o,l){const d={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const _={};for(const v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),Oi(this.state[p][v],this.stateChanges[p][v]),_[v]=this.state[p][v];d[p]=_}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const _={};if(null===this.deletedStates[p])for(const v in this.state[p])_[v]={},this.state[p][v]={};else for(const v in this.deletedStates[p]){if(null===this.deletedStates[p][v])this.state[p][v]={};else if(this.state[p][v])for(const w of Object.keys(this.deletedStates[p][v]))delete this.state[p][v][w];_[v]=this.state[p][v]}d[p]=d[p]||{},Oi(d[p],_)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(d).length)for(const p in o)o[p].setFeatureState(d,l)}}class fx{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,l){const d=this.toIdx(o,l);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(o,l){return this.leaves[this.toIdx(o,l)]}toIdx(o,l){return l*this.size+o}}function eE(a,o,l,d){let p=0,_=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(d[v])<1e-15){if(l[v]<a[v]||l[v]>o[v])return null}else{const w=1/d[v];let D=(a[v]-l[v])*w,S=(o[v]-l[v])*w;if(D>S){const k=D;D=S,S=k}if(D>p&&(p=D),S<_&&(_=S),p>_)return null}return p}function tE(a,o,l,d,p,_,v,w,D,S,k){const P=d-a,F=p-o,B=_-l,z=v-a,j=w-o,Y=D-l,te=k[1]*Y-k[2]*j,ce=k[2]*z-k[0]*Y,ne=k[0]*j-k[1]*z,ae=P*te+F*ce+B*ne;if(Math.abs(ae)<1e-15)return null;const pe=1/ae,he=S[0]-a,Te=S[1]-o,Se=S[2]-l,Ue=(he*te+Te*ce+Se*ne)*pe;if(Ue<0||Ue>1)return null;const nt=Te*B-Se*F,Fe=Se*P-he*B,Ge=he*F-Te*P,je=(k[0]*nt+k[1]*Fe+k[2]*Ge)*pe;return je<0||Ue+je>1?null:(z*nt+j*Fe+Y*Ge)*pe}function uv(a,o,l){return(a-o)/(l-o)}function hv(a,o,l,d,p,_,v,w,D){const S=1<<l,k=_-d,P=v-p,F=(a+1)/S*k+d,B=(o+0)/S*P+p,z=(o+1)/S*P+p;w[0]=(a+0)/S*k+d,w[1]=B,D[0]=F,D[1]=z}class nE{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(_){const v=Math.ceil(Math.log2(_.dim/8)),w=[];let D=Math.ceil(Math.pow(2,v));const S=1/D,k=(B,z,j,Y,te)=>{const ce=Y?1:0,ne=(B+1)*j-ce,ae=z*j,pe=(z+1)*j-ce;te[0]=B*j,te[1]=ae,te[2]=ne,te[3]=pe};let P=new fx(D);const F=[];for(let B=0;B<D*D;B++){k(B%D,Math.floor(B/D),S,!1,F);const z=tl(F[0],F[1],_),j=tl(F[2],F[1],_),Y=tl(F[2],F[3],_),te=tl(F[0],F[3],_);P.minimums.push(Math.min(z,j,Y,te)),P.maximums.push(Math.max(z,j,Y,te)),P.leaves.push(1)}for(w.push(P),D/=2;D>=1;D/=2){const B=w[w.length-1];P=new fx(D);for(let z=0;z<D*D;z++){k(z%D,Math.floor(z/D),2,!0,F);const j=B.getElevation(F[0],F[1]),Y=B.getElevation(F[2],F[1]),te=B.getElevation(F[2],F[3]),ce=B.getElevation(F[0],F[3]),ne=B.isLeaf(F[0],F[1]),ae=B.isLeaf(F[2],F[1]),pe=B.isLeaf(F[2],F[3]),he=B.isLeaf(F[0],F[3]),Te=Math.min(j.min,Y.min,te.min,ce.min),Se=Math.max(j.max,Y.max,te.max,ce.max),Ue=ne&&ae&&pe&&he;P.maximums.push(Se),P.minimums.push(Te),P.leaves.push(Se-Te<=5&&Ue?1:0)}w.push(P)}return w}(this.dem),d=l.length-1,p=l[d];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,d,0)}raycastRoot(o,l,d,p,_,v,w=1){return eE([o,l,-100],[d,p,this.maximums[0]*w],_,v)}raycast(o,l,d,p,_,v,w=1){if(!this.nodeCount)return null;const D=this.raycastRoot(o,l,d,p,_,v,w);if(null==D)return null;const S=[],k=[],P=[],F=[],B=[{idx:0,t:D,nodex:0,nodey:0,depth:0}];for(;B.length>0;){const{idx:z,t:j,nodex:Y,nodey:te,depth:ce}=B.pop();if(this.leaves[z]){hv(Y,te,ce,o,l,d,p,P,F);const ae=1<<ce,pe=(Y+0)/ae,he=(Y+1)/ae,Te=(te+0)/ae,Se=(te+1)/ae,Ue=tl(pe,Te,this.dem)*w,nt=tl(he,Te,this.dem)*w,Fe=tl(he,Se,this.dem)*w,Ge=tl(pe,Se,this.dem)*w,je=tE(P[0],P[1],Ue,F[0],P[1],nt,F[0],F[1],Fe,_,v),Xe=tE(F[0],F[1],Fe,P[0],F[1],Ge,P[0],P[1],Ue,_,v),lt=Math.min(null!==je?je:Number.MAX_VALUE,null!==Xe?Xe:Number.MAX_VALUE);if(lt!==Number.MAX_VALUE)return lt;{const Be=au([],_,v,j);if(pv(Ue,nt,Ge,Fe,uv(Be[0],P[0],F[0]),uv(Be[1],P[1],F[1]))>=Be[2])return j}continue}let ne=0;for(let ae=0;ae<this._siblingOffset.length;ae++){hv((Y<<1)+this._siblingOffset[ae][0],(te<<1)+this._siblingOffset[ae][1],ce+1,o,l,d,p,P,F),P[2]=-100,F[2]=this.maximums[this.childOffsets[z]+ae]*w;const pe=eE(P,F,_,v);if(null!=pe){const he=pe;S[ae]=he;let Te=!1;for(let Se=0;Se<ne&&!Te;Se++)he>=S[k[Se]]&&(k.splice(Se,0,ae),Te=!0);Te||(k[ne]=ae),ne++}}for(let ae=0;ae<ne;ae++){const pe=k[ae];B.push({idx:this.childOffsets[z]+pe,t:S[pe],nodex:(Y<<1)+this._siblingOffset[pe][0],nodey:(te<<1)+this._siblingOffset[pe][1],depth:ce+1})}}return null}_addNode(o,l,d){return this.minimums.push(o),this.maximums.push(l),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(o,l,d,p,_){if(1===o[p].isLeaf(l,d))return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const v=p-1,w=o[v];let D=0,S=0;for(let k=0;k<this._siblingOffset.length;k++){const P=2*l+this._siblingOffset[k][0],F=2*d+this._siblingOffset[k][1],B=w.getElevation(P,F),z=w.isLeaf(P,F),j=this._addNode(B.min,B.max,z);z&&(D|=1<<k),S||(S=j)}for(let k=0;k<this._siblingOffset.length;k++)D&1<<k||this._construct(o,2*l+this._siblingOffset[k][0],2*d+this._siblingOffset[k][1],v,S+k)}}function pv(a,o,l,d,p,_){return Hn(Hn(a,l,_),Hn(o,d,_),p)}function tl(a,o,l){const d=l.dim,p=wt(a*d-.5,0,d-1),_=wt(o*d-.5,0,d-1),v=Math.floor(p),w=Math.floor(_),D=Math.min(v+1,d-1),S=Math.min(w+1,d-1);return pv(l.get(v,w),l.get(D,w),l.get(v,S),l.get(D,S),p-v,_-w)}const fv={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function mx(a,o,l){return(256*a*256+256*o+l)/10-1e4}function gx(a,o,l){return 256*a+o+l/256-32768}class Tn{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,l,d,p=!1,_=!1){if(this.uid=o,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(d&&"mapbox"!==d&&"terrarium"!==d)return ji(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const v=this.dim=l.height-2,w=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.encoding=d||"mapbox",this.borderReady=p,!p){for(let D=0;D<v;D++)w[this._idx(-1,D)]=w[this._idx(0,D)],w[this._idx(v,D)]=w[this._idx(v-1,D)],w[this._idx(D,-1)]=w[this._idx(D,0)],w[this._idx(D,v)]=w[this._idx(D,v-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(v,-1)]=w[this._idx(v-1,0)],w[this._idx(-1,v)]=w[this._idx(0,v-1)],w[this._idx(v,v)]=w[this._idx(v-1,v-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new nE(this)}get(o,l,d=!1){d&&(o=wt(o,-1,this.dim),l=wt(l,-1,this.dim));const p=4*this._idx(o,l);return("terrarium"===this.encoding?gx:mx)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(o){return fv[o]}get unpackVector(){return fv[this.encoding]}_idx(o,l){if(o<-1||o>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(o+1)}static pack(o,l){const d=[0,0,0,0],p=Tn.getUnpackVector(l);let _=Math.floor((o+p[3])/p[2]);return d[2]=_%256,_=Math.floor(_/256),d[1]=_%256,_=Math.floor(_/256),d[0]=_,d}getPixels(){return new qi({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,l,d){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,_=l*this.dim+this.dim,v=d*this.dim,w=d*this.dim+this.dim;switch(l){case-1:p=_-1;break;case 1:_=p+1}switch(d){case-1:v=w-1;break;case 1:w=v+1}const D=-l*this.dim,S=-d*this.dim;for(let k=v;k<w;k++)for(let P=p;P<_;P++){const F=4*this._idx(P,k),B=4*this._idx(P+D,k+S);this.pixels[F+0]=o.pixels[B+0],this.pixels[F+1]=o.pixels[B+1],this.pixels[F+2]=o.pixels[B+2],this.pixels[F+3]=o.pixels[B+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Dt(Tn,"DEMData"),Dt(nE,"DemMinMaxQuadTree",{omit:["dem"]});class Ze{constructor(o,l){this.max=o,this.onRemove=l,this.reset()}reset(){for(const o in this.data)for(const l of this.data[o])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(o,l,d){const p=o.wrapped().key;void 0===this.data[p]&&(this.data[p]=[]);const _={value:l,timeout:void 0};if(void 0!==d&&(_.timeout=setTimeout(()=>{this.remove(o,_)},d)),this.data[p].push(_),this.order.push(p),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const l=this.data[o].shift();return l.timeout&&clearTimeout(l.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),l.value}getByKey(o){const l=this.data[o];return l?l[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,l){if(!this.has(o))return this;const d=o.wrapped().key,p=void 0===l?0:this.data[d].indexOf(l),_=this.data[d][p];return this.data[d].splice(p,1),_.timeout&&clearTimeout(_.timeout),0===this.data[d].length&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(o){const l=[];for(const d in this.data)for(const p of this.data[d])o(p.value)||l.push(p);for(const d of l)this.remove(d.value.tileID,d)}}class Tu{constructor(o,l,d){this.func=o,this.mask=l,this.range=d}}Tu.ReadOnly=!1,Tu.ReadWrite=!0,Tu.disabled=new Tu(519,Tu.ReadOnly,[0,1]);class mv{constructor(o,l,d,p,_,v){this.test=o,this.ref=l,this.mask=d,this.fail=p,this.depthFail=_,this.pass=v}}mv.disabled=new mv({func:519,mask:0},0,0,7680,7680,7680);class nl{constructor(o,l,d){this.blendFunction=o,this.blendColor=l,this.mask=d}}nl.Replace=[1,0],nl.disabled=new nl(nl.Replace,Di.transparent,[!1,!1,!1,!1]),nl.unblended=new nl(nl.Replace,Di.transparent,[!0,!0,!0,!0]),nl.alphaBlended=new nl([1,771],Di.transparent,[!0,!0,!0,!0]);class Da{constructor(o,l,d){this.enable=o,this.mode=l,this.frontFace=d}}Da.disabled=new Da(!1,1029,2305),Da.backCCW=new Da(!0,1029,2305),Da.backCW=new Da(!0,1029,2304),Da.frontCW=new Da(!0,1028,2304),Da.frontCCW=new Da(!0,1028,2305);class Au extends Gd{constructor(o,l,d){super(),this.id=o,this._onlySymbols=d,l.on("data",p=>{"source"===p.dataType&&"metadata"===p.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===p.dataType&&"content"===p.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new Ze(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new DT,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(o){this.map=o,this._minTileCacheSize=void 0===this._minTileCacheSize&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const l=this._tiles[o];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,l){return o.isSymbolTile=this._onlySymbols,this._source.loadTile(o,l)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o,()=>{})}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const d=this._tiles[l];d.upload(o),d.prepare(this.map.style.imageManager)}}getIds(){return os(this._tiles).map(o=>o.tileID).sort(yv).map(o=>o.key)}getRenderableIds(o){const l=[];for(const d in this._tiles)this._isIdRenderable(+d,o)&&l.push(this._tiles[d]);return o?l.sort((d,p)=>{const _=d.tileID,v=p.tileID,w=new pt(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),D=new pt(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-v.overscaledZ||D.y-w.y||D.x-w.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(yv).map(d=>d.key)}hasRenderableParent(o){const l=this.findLoadedParent(o,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(o,l){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(l||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(+o,"reloading")}}_reloadTile(o,l){const d=this._tiles[o];d&&("loading"!==d.state&&(d.state=l),this._loadTile(d,this._tileLoaded.bind(this,d,o,l)))}_tileLoaded(o,l,d,p){if(p)if(o.state="errored",404!==p.status)this._source.fire(new Ba(p,{tile:o}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else o.timeAdded=Na.now(),"expired"===d&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(l,o),"raster-dem"===this._source.type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new ec("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const l=this.getRenderableIds();for(let p=0;p<l.length;p++){const _=l[p];if(o.neighboringTiles&&o.neighboringTiles[_]){const v=this.getTileByID(_);d(o,v),d(v,o)}}function d(p,_){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let v=_.tileID.canonical.x-p.tileID.canonical.x;const w=_.tileID.canonical.y-p.tileID.canonical.y,D=Math.pow(2,p.tileID.canonical.z),S=_.tileID.key;0===v&&0===w||Math.abs(w)>1||(Math.abs(v)>1&&(1===Math.abs(v+D)?v+=D:1===Math.abs(v-D)&&(v-=D)),_.dem&&p.dem&&(p.dem.backfillBorder(_.dem,v,w),p.neighboringTiles&&p.neighboringTiles[S]&&(p.neighboringTiles[S].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,l,d,p){for(const _ in this._tiles){let v=this._tiles[_];if(p[_]||!v.hasData()||v.tileID.overscaledZ<=l||v.tileID.overscaledZ>d)continue;let w=v.tileID;for(;v&&v.tileID.overscaledZ>l+1;){const S=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[S.key],v&&v.hasData()&&(w=S)}let D=w;for(;D.overscaledZ>l;)if(D=D.scaledTo(D.overscaledZ-1),o[D.key]){p[w.key]=w;break}}}findLoadedParent(o,l){if(o.key in this._loadedParentTiles){const d=this._loadedParentTiles[o.key];return d&&d.tileID.overscaledZ>=l?d:null}for(let d=o.overscaledZ-1;d>=l;d--){const p=o.scaledTo(d),_=this._getLoadedTile(p);if(_)return _}}_getLoadedTile(o){const l=this._tiles[o.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,l){l=l||this._source.tileSize;const d=Math.ceil(o.width/l)+1,p=Math.ceil(o.height/l)+1,_=Math.floor(d*p*5),v="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,_):_,w="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(w)}handleWrapJump(o){const l=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,l){const d={};for(const p in this._tiles){const _=this._tiles[p];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+l),d[_.tileID.key]=_}this._tiles=d;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(o,l,d){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let p;this.updateCacheSize(o,l),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new Wr(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(p=o.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(w=>this._source.hasTile(w)))):p=[];const _=this._updateRetainedTiles(p);if(yx(this._source.type)&&0!==p.length){const w={},D={},S=Object.keys(_);for(const P of S){const F=_[P],B=this._tiles[P];if(!B||B.fadeEndTime&&B.fadeEndTime<=Na.now())continue;const z=this.findLoadedParent(F,Math.max(F.overscaledZ-Au.maxOverzooming,this._source.minzoom));z&&(this._addTile(z.tileID),w[z.tileID.key]=z.tileID),D[P]=F}const k=p[p.length-1].overscaledZ;for(const P in this._tiles){const F=this._tiles[P];if(_[P]||!F.hasData())continue;let B=F.tileID;for(;B.overscaledZ>k;){B=B.scaledTo(B.overscaledZ-1);const z=this._tiles[B.key];if(z&&z.hasData()&&D[B.key]){_[P]=F.tileID;break}}}for(const P in w)_[P]||(this._coveredTiles[P]=!0,_[P]=w[P])}for(const w in _)this._tiles[w].clearFadeHold();const v=function(w,D){const S=[];for(const k in w)k in D||S.push(k);return S}(this._tiles,_);for(const w of v){const D=this._tiles[w];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const l={};if(0===o.length)return l;const d={},p=o.reduce((S,k)=>Math.min(S,k.overscaledZ),1/0),_=o[0].overscaledZ,v=Math.max(_-Au.maxOverzooming,this._source.minzoom),w=Math.max(_+Au.maxUnderzooming,this._source.minzoom),D={};for(const S of o){const k=this._addTile(S);l[S.key]=S,k.hasData()||p<this._source.maxzoom&&(D[S.key]=S)}this._retainLoadedChildren(D,p,w,l);for(const S of o){let k=this._tiles[S.key];if(k.hasData())continue;if(S.canonical.z>=this._source.maxzoom){const F=S.children(this._source.maxzoom)[0],B=this.getTile(F);if(B&&B.hasData()){l[F.key]=F;continue}}else{const F=S.children(this._source.maxzoom);if(l[F[0].key]&&l[F[1].key]&&l[F[2].key]&&l[F[3].key])continue}let P=k.wasRequested();for(let F=S.overscaledZ-1;F>=v;--F){const B=S.scaledTo(F);if(d[B.key]||(d[B.key]=!0,k=this.getTile(B),!k&&P&&(k=this._addTile(B)),k&&(l[B.key]=B,P=k.wasRequested(),k.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const l=[];let d,p=this._tiles[o].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){d=this._loadedParentTiles[p.key];break}l.push(p.key);const _=p.scaledTo(p.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;p=_}for(const _ of l)this._loadedParentTiles[_]=d}}_addTile(o){let l=this._tiles[o.key];if(l)return l;l=this._cache.getAndRemove(o),l&&(this._setTileReloadTimer(o.key,l),l.tileID=o,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,l)));const d=!!l;if(!d){const p=this.map?this.map.painter:null;l=new Hg(o,this._source.tileSize*o.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,o.key,l.state))}return l?(l.uses++,this._tiles[o.key]=l,d||this._source.fire(new ec("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(o,l){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const d=l.getExpiryTimeout();d&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},d))}_removeTile(o){const l=this._tiles[o];l&&(l.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,l,d){const p=[],_=this.transform;if(!_)return p;const v="globe"===_.projection.name,w=Al(_.center.lng);for(const D in this._tiles){const S=this._tiles[D];if(d&&S.clearQueryDebugViz(),S.holdingForFade())continue;let k;if(v){const P=S.tileID.canonical;if(0===P.z){const F=[Math.abs(wt(w,...$f(P,-1))-w),Math.abs(wt(w,...$f(P,1))-w)];k=[0,2*F.indexOf(Math.min(...F))-1]}else{const F=[Math.abs(wt(w,...$f(P,-1))-w),Math.abs(wt(w,...$f(P,0))-w),Math.abs(wt(w,...$f(P,1))-w)];k=[F.indexOf(Math.min(...F))-1]}}else k=[0];for(const P of k){const F=o.containsTile(S,_,l,P);F&&p.push(F)}}return p}getVisibleCoordinates(o){const l=this.getRenderableIds(o).map(d=>this._tiles[d].tileID);for(const d of l)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(yx(this._source.type))for(const o in this._tiles){const l=this._tiles[o];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=Na.now())return!0}return!1}setFeatureState(o,l,d){this._state.updateState(o=o||"_geojsonTileLayer",l,d)}removeFeatureState(o,l,d){this._state.removeFeatureState(o=o||"_geojsonTileLayer",l,d)}getFeatureState(o,l){return this._state.getState(o=o||"_geojsonTileLayer",l)}setDependencies(o,l,d){const p=this._tiles[o];p&&p.setDependencies(l,d)}reloadTilesForDependencies(o,l){for(const d in this._tiles)this._tiles[d].hasDependency(o,l)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(o,l))}_preloadTiles(o,l){if(!this._sourceLoaded){const w=()=>{this._sourceLoaded&&(this._source.off("data",w),this._preloadTiles(o,l))};return void this._source.on("data",w)}const d=new Map,p=Array.isArray(o)?o:[o],_=this.map.painter.terrain,v=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const w of p){const D=w.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const S of D)d.set(S.key,S);this.usedForTerrain&&w.updateElevation(!1)}gn(Array.from(d.values()),(w,D)=>{const S=new Hg(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(S,k=>{"raster-dem"===this._source.type&&S.dem&&this._backfillDEM(S),D(k,S)})},l)}}function yv(a,o){const l=Math.abs(2*a.wrap)-+(a.wrap<0),d=Math.abs(2*o.wrap)-+(o.wrap<0);return a.overscaledZ-o.overscaledZ||d-l||o.canonical.y-a.canonical.y||o.canonical.x-a.canonical.x}function yx(a){return"raster"===a||"image"===a||"video"===a||"custom"===a}function $f(a,o){const l=1<<a.z;return[a.x/l+o,(a.x+1)/l+o]}Au.maxOverzooming=10,Au.maxUnderzooming=3;class vv{constructor(o,l,d){this._demTile=o,this._dem=this._demTile.dem,this._scale=l,this._offset=d}static create(o,l,d){const p=d||o.findDEMTileFor(l);if(!p||!p.dem)return;const _=p.dem,v=p.tileID,w=1<<l.canonical.z-v.canonical.z;return new vv(p,p.tileSize/Ot/w,[(l.canonical.x/w-v.canonical.x)*_.dim,(l.canonical.y/w-v.canonical.y)*_.dim])}tileCoordToPixel(o,l){const d=l*this._scale+this._offset[1],p=Math.floor(o*this._scale+this._offset[0]),_=Math.floor(d);return new pt(p,_)}getElevationAt(o,l,d,p){const _=o*this._scale+this._offset[0],v=l*this._scale+this._offset[1],w=Math.floor(_),D=Math.floor(v),S=this._dem;return p=!!p,d?Hn(Hn(S.get(w,D,p),S.get(w,D+1,p),v-D),Hn(S.get(w+1,D,p),S.get(w+1,D+1,p),v-D),_-w):S.get(w,D,p)}getElevationAtPixel(o,l,d){return this._dem.get(o,l,!!d)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*Ya(1,o)*this._dem.stride}}class bv{constructor(o,l){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new dc(Ot,16,0),this.featureIndexArray=new od,this.promoteId=l}insert(o,l,d,p,_,v=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,p,_,v);const D=this.grid;for(let S=0;S<l.length;S++){const k=l[S],P=[1/0,1/0,-1/0,-1/0];for(let F=0;F<k.length;F++){const B=k[F];P[0]=Math.min(P[0],B.x),P[1]=Math.min(P[1],B.y),P[2]=Math.max(P[2],B.x),P[3]=Math.max(P[3],B.y)}P[0]<Ot&&P[1]<Ot&&P[2]>=0&&P[3]>=0&&D.insert(w,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new qh(new Cg(this.rawTileData)).layers,this.sourceLayerCoder=new Hf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,l,d,p){this.loadVTLayers();const _=o.params||{},v=wl(_.filter),w=o.tileResult,D=o.transform,S=w.bufferedTilespaceBounds,k=this.grid.query(S.min.x,S.min.y,S.max.x,S.max.y,(z,j,Y,te)=>uC(w.bufferedTilespaceGeometry,z,j,Y,te));k.sort(Ro);let P=null;D.elevation&&k.length>0&&(P=vv.create(D.elevation,this.tileID));const F={};let B;for(let z=0;z<k.length;z++){const j=k[z];if(j===B)continue;B=j;const Y=this.featureIndexArray.get(j);let te=null;this.loadMatchingFeature(F,Y,v,_.layers,_.availableImages,l,d,p,(ce,ne,ae,pe=0)=>(te||(te=gc(ce,this.tileID.canonical,o.tileTransform)),ne.queryIntersectsFeature(w,ce,ae,te,this.z,o.transform,o.pixelPosMatrix,P,pe)))}return F}loadMatchingFeature(o,l,d,p,_,v,w,D,S){const{featureIndex:k,bucketIndex:P,sourceLayerIndex:F,layoutVertexArrayOffset:B}=l,z=this.bucketLayerIDs[P];if(p&&!function(ce,ne){for(let ae=0;ae<ce.length;ae++)if(ne.indexOf(ce[ae])>=0)return!0;return!1}(p,z))return;const j=this.sourceLayerCoder.decode(F),Y=this.vtLayers[j].feature(k);if(d.needGeometry){const ce=Nh(Y,!0);if(!d.filter(new R(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!d.filter(new R(this.tileID.overscaledZ),Y))return;const te=this.getId(Y,j);for(let ce=0;ce<z.length;ce++){const ne=z[ce];if(p&&p.indexOf(ne)<0)continue;const ae=v[ne];if(!ae)continue;let pe={};void 0!==te&&D&&(pe=D.getState(ae.sourceLayer||"_geojsonTileLayer",te));const he=Oi({},w[ne]);he.paint=xv(he.paint,ae.paint,Y,pe,_),he.layout=xv(he.layout,ae.layout,Y,pe,_);const Te=!S||S(Y,ae,pe,B);if(!Te)continue;const Se=new cv(Y,this.z,this.x,this.y,te);Se.layer=he;let Ue=o[ne];void 0===Ue&&(Ue=o[ne]=[]),Ue.push({featureIndex:k,feature:Se,intersectionZ:Te})}}lookupSymbolFeatures(o,l,d,p,_,v,w,D){const S={};this.loadVTLayers();const k=wl(_);for(const P of o)this.loadMatchingFeature(S,{bucketIndex:d,sourceLayerIndex:p,featureIndex:P,layoutVertexArrayOffset:0},k,v,w,D,l);return S}loadFeature(o){const{featureIndex:l,sourceLayerIndex:d}=o;this.loadVTLayers();const p=this.sourceLayerCoder.decode(d),_=this.vtFeatures[p];if(_[l])return _[l];const v=this.vtLayers[p].feature(l);return _[l]=v,v}hasLayer(o){for(const l of this.bucketLayerIDs)for(const d of l)if(o===d)return!0;return!1}getId(o,l){let d=o.id;if(this.promoteId){const p="string"==typeof this.promoteId?this.promoteId:this.promoteId[l];null!=p&&(d=o.properties[p]),"boolean"==typeof d&&(d=Number(d))}return d}}function xv(a,o,l,d,p){return xt(a,(_,v)=>{const w=o instanceof ee?o.get(v):null;return w&&w.evaluate?w.evaluate(l,d,p):w})}function Ro(a,o){return o-a}Dt(bv,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class J{constructor(o,l){this.width=o,this.height=l,this.nextRow=0,this.image=new Ca({width:o,height:l}),this.positions={},this.uploaded=!1}getDash(o,l){const d=this.getKey(o,l);return this.positions[d]}trim(){const o=this.width,l=this.height=la(this.nextRow);this.image.resize({width:o,height:l})}getKey(o,l){return o.join(",")+l}getDashRanges(o,l,d){const p=[];let _=o.length%2==1?-o[o.length-1]*d:0,v=o[0]*d,w=!0;p.push({left:_,right:v,isDash:w,zeroLength:0===o[0]});let D=o[0];for(let S=1;S<o.length;S++){w=!w;const k=o[S];_=D*d,D+=k,v=D*d,p.push({left:_,right:v,isDash:w,zeroLength:0===k})}return p}addRoundDash(o,l,d){const p=l/2;for(let _=-d;_<=d;_++){const v=this.width*(this.nextRow+d+_);let w=0,D=o[w];for(let S=0;S<this.width;S++){S/D.right>1&&(D=o[++w]);const k=Math.abs(S-D.left),P=Math.abs(S-D.right),F=Math.min(k,P);let B;const z=_/d*(p+1);if(D.isDash){const j=p-Math.abs(z);B=Math.sqrt(F*F+j*j)}else B=p-Math.sqrt(F*F+z*z);this.image.data[v+S]=Math.max(0,Math.min(255,B+128))}}}addRegularDash(o,l){for(let D=o.length-1;D>=0;--D){const S=o[D],k=o[D+1];S.zeroLength?o.splice(D,1):k&&k.isDash===S.isDash&&(k.left=S.left,o.splice(D,1))}const d=o[0],p=o[o.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const _=this.width*this.nextRow;let v=0,w=o[v];for(let D=0;D<this.width;D++){D/w.right>1&&(w=o[++v]);const S=Math.abs(D-w.left),k=Math.abs(D-w.right),P=Math.min(S,k);this.image.data[_+D]=Math.max(0,Math.min(255,(w.isDash?P:-P)+l+128))}}addDash(o,l){const d=this.getKey(o,l);if(this.positions[d])return this.positions[d];const p="round"===l,_=p?7:0,v=2*_+1;if(this.nextRow+v>this.height)return ji("LineAtlas out of space"),null;0===o.length&&o.push(1);let w=0;for(let k=0;k<o.length;k++)o[k]<0&&(ji("Negative value is found in line dasharray, replacing values with 0"),o[k]=0),w+=o[k];if(0!==w){const k=this.width/w,P=this.getDashRanges(o,this.width,k);p?this.addRoundDash(P,k,_):this.addRegularDash(P,"square"===l?.5*k:0)}const D=this.nextRow+_;this.nextRow+=v;const S={tl:[D,_],br:[w,0]};return this.positions[d]=S,S}}Dt(J,"LineAtlas");const Iu=1*na;class vx{constructor(o){const l={},d=[];for(const w in o){const D=o[w],S=l[w]={};for(const k in D.glyphs){const P=D.glyphs[+k];if(!P||0===P.bitmap.width||0===P.bitmap.height)continue;const F=P.metrics.localGlyph?Iu:1,B={x:0,y:0,w:P.bitmap.width+2*F,h:P.bitmap.height+2*F};d.push(B),S[k]=B}}const{w:p,h:_}=qy(d),v=new Ca({width:p||1,height:_||1});for(const w in o){const D=o[w];for(const S in D.glyphs){const k=D.glyphs[+S];if(!k||0===k.bitmap.width||0===k.bitmap.height)continue;const P=l[w][S],F=k.metrics.localGlyph?Iu:1;Ca.copy(k.bitmap,v,{x:0,y:0},{x:P.x+F,y:P.y+F},k.bitmap)}}this.image=v,this.positions=l}}Dt(vx,"GlyphAtlas");class $g{constructor(o){this.tileID=new Wr(o.tileID.overscaledZ,o.tileID.wrap,o.tileID.canonical.z,o.tileID.canonical.x,o.tileID.canonical.y),this.tileZoom=o.tileZoom,this.uid=o.uid,this.zoom=o.zoom,this.canonical=o.tileID.canonical,this.pixelRatio=o.pixelRatio,this.tileSize=o.tileSize,this.source=o.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=o.showCollisionBoxes,this.collectResourceTiming=!!o.collectResourceTiming,this.returnDependencies=!!o.returnDependencies,this.promoteId=o.promoteId,this.enableTerrain=!!o.enableTerrain,this.isSymbolTile=o.isSymbolTile,this.tileTransform=Cd(o.tileID.canonical,o.projection),this.projection=o.projection}parse(o,l,d,p,_){this.status="parsing",this.data=o,this.collisionBoxArray=new bn;const v=new Hf(Object.keys(o.layers).sort()),w=new bv(this.tileID,this.promoteId);w.bucketLayerIDs=[];const D={},S=new J(256,256),k={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:S,availableImages:d},P=l.familiesBySource[this.source];for(const pe in P){const he=o.layers[pe];if(!he)continue;let Te=!1,Se=!1;for(const Fe of P[pe])"symbol"===Fe[0].type?Te=!0:Se=!0;if(!0===this.isSymbolTile&&!Te||!1===this.isSymbolTile&&!Se)continue;1===he.version&&ji(`Vector tile source "${this.source}" layer "${pe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ue=v.encode(pe),nt=[];for(let Fe=0;Fe<he.length;Fe++){const Ge=he.feature(Fe),je=w.getId(Ge,pe);nt.push({feature:Ge,id:je,index:Fe,sourceLayerIndex:Ue})}for(const Fe of P[pe]){const Ge=Fe[0];void 0!==this.isSymbolTile&&"symbol"===Ge.type!==this.isSymbolTile||Ge.minzoom&&this.zoom<Math.floor(Ge.minzoom)||Ge.maxzoom&&this.zoom>=Ge.maxzoom||"none"!==Ge.visibility&&(Md(Fe,this.zoom,d),(D[Ge.id]=Ge.createBucket({index:w.bucketLayerIDs.length,layers:Fe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ue,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate(nt,k,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(Fe.map(je=>je.id)))}}let F,B,z,j;S.trim();const Y={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},te=()=>{if(F)return _(F);if(B&&z&&j){const pe=new vx(B),he=new Q0(z,j);for(const Te in D){const Se=D[Te];Se instanceof jt?(Md(Se.layers,this.zoom,d),wT(Se,B,pe.positions,z,he.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):Se.hasPattern&&(Se instanceof Rf||Se instanceof fg||Se instanceof yc)&&(Md(Se.layers,this.zoom,d),Se.addFeatures(k,this.tileID.canonical,he.patternPositions,d,this.tileTransform))}this.status="done",_(null,{buckets:os(D).filter(Te=>!Te.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:pe.image,lineAtlas:S,imageAtlas:he,glyphMap:this.returnDependencies?B:null,iconMap:this.returnDependencies?z:null,glyphPositions:this.returnDependencies?pe.positions:null})}},ce=xt(k.glyphDependencies,pe=>Object.keys(pe).map(Number));Object.keys(ce).length?p.send("getGlyphs",{uid:this.uid,stacks:ce},(pe,he)=>{F||(F=pe,B=he,te())},void 0,!1,Y):B={};const ne=Object.keys(k.iconDependencies);ne.length?p.send("getImages",{icons:ne,source:this.source,tileID:this.tileID,type:"icons"},(pe,he)=>{F||(F=pe,z=he,te())},void 0,!1,Y):z={};const ae=Object.keys(k.patternDependencies);ae.length?p.send("getImages",{icons:ae,source:this.source,tileID:this.tileID,type:"patterns"},(pe,he)=>{F||(F=pe,j=he,te())},void 0,!1,Y):j={},te()}}function Md(a,o,l){const d=new R(o);for(const p of a)p.recalculate(d,l)}class Gg{constructor(o){this.entries={},this.scheduler=o}request(o,l,d,p){const _=this.entries[o]=this.entries[o]||{callbacks:[]};if(_.result){const[v,w]=_.result;return this.scheduler?this.scheduler.add(()=>{p(v,w)},l):p(v,w),()=>{}}return _.callbacks.push(p),_.cancel||(_.cancel=d((v,w)=>{_.result=[v,w];for(const D of _.callbacks)this.scheduler?this.scheduler.add(()=>{D(v,w)},l):D(v,w);setTimeout(()=>delete this.entries[o],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(v=>v!==p),_.callbacks.length||(_.cancel(),delete this.entries[o]))}}}function sp(a,o,l){const d=JSON.stringify(a.request);return a.data&&(this.deduped.entries[d]={result:[null,a.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},p=>{const _=zc(a.request,(v,w,D,S)=>{v?p(v):w&&p(null,{vectorTile:l?void 0:new qh(new Cg(w)),rawData:w,cacheControl:D,expires:S})});return()=>{_.cancel(),p()}},o)}const wv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Gf{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,d]=new Uint8Array(o,0,2);if(219!==l)throw new Error("Data does not appear to be in a KDBush format.");const p=d>>4;if(1!==p)throw new Error(`Got v${p} data when expected v1.`);const _=wv[15&d];if(!_)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(o,2,1),[w]=new Uint32Array(o,4,1);return new Gf(w,v,_,o)}constructor(o,l=64,d=Float64Array,p){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=d,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const _=wv.indexOf(this.ArrayType),v=2*o*this.ArrayType.BYTES_PER_ELEMENT,w=o*this.IndexArrayType.BYTES_PER_ELEMENT,D=(8-w%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${d}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+w+D,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+v+w+D),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+w+D,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=o)}add(o,l){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=o,this.coords[this._pos++]=l,d}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return qf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,l,d,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:v,nodeSize:w}=this,D=[0,_.length-1,0],S=[];for(;D.length;){const k=D.pop()||0,P=D.pop()||0,F=D.pop()||0;if(P-F<=w){for(let Y=F;Y<=P;Y++){const te=v[2*Y],ce=v[2*Y+1];te>=o&&te<=d&&ce>=l&&ce<=p&&S.push(_[Y])}continue}const B=F+P>>1,z=v[2*B],j=v[2*B+1];z>=o&&z<=d&&j>=l&&j<=p&&S.push(_[B]),(0===k?o<=z:l<=j)&&(D.push(F),D.push(B-1),D.push(1-k)),(0===k?d>=z:p>=j)&&(D.push(B+1),D.push(P),D.push(1-k))}return S}within(o,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:_,nodeSize:v}=this,w=[0,p.length-1,0],D=[],S=d*d;for(;w.length;){const k=w.pop()||0,P=w.pop()||0,F=w.pop()||0;if(P-F<=v){for(let Y=F;Y<=P;Y++)bx(_[2*Y],_[2*Y+1],o,l)<=S&&D.push(p[Y]);continue}const B=F+P>>1,z=_[2*B],j=_[2*B+1];bx(z,j,o,l)<=S&&D.push(p[B]),(0===k?o-d<=z:l-d<=j)&&(w.push(F),w.push(B-1),w.push(1-k)),(0===k?o+d>=z:l+d>=j)&&(w.push(B+1),w.push(P),w.push(1-k))}return D}}function qf(a,o,l,d,p,_){if(p-d<=l)return;const v=d+p>>1;qg(a,o,v,d,p,_),qf(a,o,l,d,v-1,1-_),qf(a,o,l,v+1,p,1-_)}function qg(a,o,l,d,p,_){for(;p>d;){if(p-d>600){const S=p-d+1,k=l-d+1,P=Math.log(S),F=.5*Math.exp(2*P/3),B=.5*Math.sqrt(P*F*(S-F)/S)*(k-S/2<0?-1:1);qg(a,o,l,Math.max(d,Math.floor(l-k*F/S+B)),Math.min(p,Math.floor(l+(S-k)*F/S+B)),_)}const v=o[2*l+_];let w=d,D=p;for(ap(a,o,d,l),o[2*p+_]>v&&ap(a,o,d,p);w<D;){for(ap(a,o,w,D),w++,D--;o[2*w+_]<v;)w++;for(;o[2*D+_]>v;)D--}o[2*d+_]===v?ap(a,o,d,D):(D++,ap(a,o,D,p)),D<=l&&(d=D+1),l<=D&&(p=D-1)}}function ap(a,o,l,d){Wf(a,l,d),Wf(o,2*l,2*d),Wf(o,2*l+1,2*d+1)}function Wf(a,o,l){const d=a[o];a[o]=a[l],a[l]=d}function bx(a,o,l,d){const p=a-l,_=o-d;return p*p+_*_}f.ARRAY_TYPE=qr,f.AUTH_ERR_MSG=fe,f.Aabb=Io,f.Actor=class{constructor(a,o,l){this.target=a,this.parent=o,this.mapId=l,this.callbacks={},this.cancelCallbacks={},fi(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=pl()?a:Ie,this.scheduler=new Ol}send(a,o,l,d,p=!1,_){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=_,this.callbacks[v]=l);const w=Vd(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:a,hasCallback:!!l,targetMapId:d,mustQueue:p,sourceMapId:this.mapId,data:To(o,w)},w),{cancel:()=>{l&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(a){const o=a.data,l=o.id;if(l&&(!o.targetMapId||this.mapId===o.targetMapId))if("<cancel>"===o.type){const d=this.cancelCallbacks[l];delete this.cancelCallbacks[l],d&&d.cancel()}else if(o.mustQueue||pl()){const d=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,o),d&&d.metadata||{type:"message"})}else this.processTask(l,o)}processTask(a,o){if("<response>"===o.type){const l=this.callbacks[a];delete this.callbacks[a],l&&(o.error?l(va(o.error)):l(null,va(o.data)))}else{const l=Vd(this.globalScope)?void 0:[],d=o.hasCallback?(_,v)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:_?To(_):null,data:To(v,l)},l)}:_=>{},p=va(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,p,d);else if(this.parent.getWorkerSource){const _=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,_[0],p.source)[_[1]](p,d)}else d(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},f.CanonicalTileID=Af,f.Color=Di,f.ColorMode=nl,f.CullFaceMode=Da,f.DEMData=Tn,f.DataConstantProperty=U,f.DedupedRequest=Gg,f.DepthMode=Tu,f.EXTENT=Ot,f.Elevation=class{isDataAvailableAtPoint(a){const o=this._source();if(this.isUsingMockSource()||!o||a.y<0||a.y>1)return!1;const l=o.getSource().maxzoom,d=1<<l,p=Math.floor(a.x),_=Math.floor((a.x-p)*d),v=Math.floor(a.y*d),w=this.findDEMTileFor(new Wr(l,p,l,_,v));return!(!w||!w.dem)}getAtPointOrZero(a,o=0){return this.getAtPoint(a,o)||0}getAtPoint(a,o,l=!0){if(this.isUsingMockSource())return null;null==o&&(o=null);const d=this._source();if(!d||a.y<0||a.y>1)return o;const p=d.getSource().maxzoom,_=1<<p,v=Math.floor(a.x),w=a.x-v,D=new Wr(p,v,p,Math.floor(w*_),Math.floor(a.y*_)),S=this.findDEMTileFor(D);if(!S||!S.dem)return o;const k=S.dem,P=1<<S.tileID.canonical.z,F=(w*P-S.tileID.canonical.x)*k.dim,B=(a.y*P-S.tileID.canonical.y)*k.dim,z=Math.floor(F),j=Math.floor(B);return(l?this.exaggeration():1)*Hn(Hn(k.get(z,j),k.get(z,j+1),B-j),Hn(k.get(z+1,j),k.get(z+1,j+1),B-j),F-z)}getAtTileOffset(a,o,l){const d=1<<a.canonical.z;return this.getAtPointOrZero(new hu(a.wrap+(a.canonical.x+o/Ot)/d,(a.canonical.y+l/Ot)/d))}getAtTileOffsetFunc(a,o,l,d){return p=>{const _=this.getAtTileOffset(a,p.x,p.y),v=d.upVector(a.canonical,p.x,p.y);return Zo(v,v,_*d.upVectorScale(a.canonical,o,l).metersToTile),v}}getForTilePoints(a,o,l,d){if(this.isUsingMockSource())return!1;const p=vv.create(this,a,d);return!!p&&(o.forEach(_=>{_[2]=this.exaggeration()*p.getElevationAt(_[0],_[1],l)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(a);if(!o||!o.dem)return null;const l=o.dem.tree,d=o.tileID,p=1<<a.canonical.z-d.canonical.z;let _=a.canonical.x/p-d.canonical.x,v=a.canonical.y/p-d.canonical.y,w=0;for(let D=0;D<a.canonical.z-d.canonical.z&&!l.leaves[w];D++){_*=2,v*=2;const S=2*Math.floor(v)+Math.floor(_);w=l.childOffsets[w]+S,_%=1,v%=1}return{min:this.exaggeration()*l.minimums[w],max:this.exaggeration()*l.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,o,l){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},f.ErrorEvent=Ba,f.EvaluationParameters=R,f.Event=ec,f.Evented=Gd,f.FillExtrusionBucket=yc,f.Frustum=ud,f.FrustumCorners=dd,f.GLOBE_RADIUS=fc,f.GLOBE_SCALE_MATCH_LATITUDE=45,f.GLOBE_ZOOM_THRESHOLD_MAX=du,f.GLOBE_ZOOM_THRESHOLD_MIN=pf,f.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,o){const l=new Je,d=new At,p=[],_=a+1+2,v=o[0]+1,w=o[0]+1+(1+o.length),D=(S,k,P)=>{let F=S===_-1?S-2:0===S?S:S-1;return F+=P?24575:0,[F,k]};for(let S=0;S<_;++S)l.emplaceBack(...D(S,0,!0));for(let S=0;S<v;++S)for(let k=0;k<_;++k)l.emplaceBack(...D(k,S,(0===k||k===_-1)&&!0));for(let S=0;S<o.length;++S){const k=o[S];for(let P=0;P<_;++P)l.emplaceBack(...D(P,k,!0))}for(let S=0;S<o.length;++S){const k=d.length,P=o[S]+1+2,F=new At;for(let j=0;j<P-1;j++){const Y=j===P-2,te=Y?_*(w-o.length+S-j):_;for(let ce=0;ce<_-1;ce++){const ne=j*_+ce;0===j||Y||0===ce||ce===_-2?(F.emplaceBack(ne+1,ne,ne+te),F.emplaceBack(ne+te,ne+te+1,ne+1)):(d.emplaceBack(ne+1,ne,ne+te),d.emplaceBack(ne+te,ne+te+1,ne+1))}}const B=rr.simpleSegment(0,k,l.length,d.length-k);for(let j=0;j<F.uint16.length;j+=3)d.emplaceBack(F.uint16[j],F.uint16[j+1],F.uint16[j+2]);const z=rr.simpleSegment(0,k,l.length,d.length-k);p.push({withoutSkirts:B,withSkirts:z})}return{vertices:l,indices:d,segments:p}}_createGrid(a){const o=this._fillGridMeshWithLods(64,Qm);this._gridSegments=o.segments,this._gridBuffer=a.createVertexBuffer(o.vertices,Os.members),this._gridIndexBuffer=a.createIndexBuffer(o.indices,!0)}_createPoles(a){const o=new At;for(let p=0;p<=64;p++)o.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=a.createIndexBuffer(o,!0);const l=new _i,d=new _i;this._poleSegments=[];for(let p=0,_=0;p<pf;p++){const v=360/(1<<p);l.emplaceBack(0,-fc,0,.5,0),d.emplaceBack(0,-fc,0,.5,1);for(let w=0;w<=64;w++){const D=w/64,S=Hn(0,v,D),[k,P,F]=mc(lC,cC,S,fc);l.emplaceBack(k,P,F,D,0),d.emplaceBack(k,P,F,D,1)}this._poleSegments.push(rr.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(l,p0,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(d,p0,!1)}getGridBuffers(a,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,o){if(!this._wireframeSegments){const l=new qe,d=64,p=d+1+2,_=1;this._wireframeSegments=[];for(let v=0,w=0;v<Qm.length;v++){const D=Qm[v];for(let k=_;k<D+_;k++)for(let P=_;P<d+_;P++){const F=k*p+P;l.emplaceBack(F,F+1),l.emplaceBack(F,F+p),l.emplaceBack(F,F+p+1)}const S=D*d*3;this._wireframeSegments.push(rr.simpleSegment(0,w,(D+1)*p,S)),w+=S}this._wireframeIndexBuffer=a.createIndexBuffer(l)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[o]]}},f.GlyphManager=Kh,f.ImagePosition=Wy,f.KDBush=Gf,f.LivePerformanceUtils=Vc,f.LngLat=ai,f.LngLatBounds=pc,f.LocalGlyphMode=Bf,f.MAX_MERCATOR_LATITUDE=Nr,f.MercatorCoordinate=hu,f.ONE_EM=Zr,f.OverscaledTileID=Wr,f.PerformanceMarkers=Ki,f.Point=pt,f.Properties=re,f.RGBAImage=qi,f.Ray=cd,f.RequestManager=class{constructor(a,o,l){this._transformRequestFn=a,this._customAccessToken=o,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const a=function(){let o="";for(let l=0;l<10;l++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ra,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,o){return this._transformRequestFn&&this._transformRequestFn(a,o)||{url:a}}normalizeStyleURL(a,o){if(!_e(a))return a;const l=ut(a);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||o)}normalizeGlyphsURL(a,o){if(!_e(a))return a;const l=ut(a);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||o)}normalizeSourceURL(a,o,l,d){if(!_e(a))return a;const p=ut(a);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),l&&p.params.push(`language=${l}`),d&&p.params.push(`worldview=${d}`),this._makeAPIURL(p,this._customAccessToken||o)}normalizeSpriteURL(a,o,l,d){const p=ut(a);return _e(a)?(p.path=`/styles/v1${p.path}/sprite${o}${l}`,this._makeAPIURL(p,this._customAccessToken||d)):(p.path+=`${o}${l}`,it(p))}normalizeTileURL(a,o,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!_e(a))return a;const d=ut(a);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${o||l&&"raster"!==d.authority&&512===l?"@2x":""}${ln.supported?".webp":"$1"}`),"raster"===d.authority?d.path=`/${hn.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${hn.TILE_URL_VERSION}${d.path}`);const p=this._customAccessToken||function(_){for(const v of _){const w=v.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(d.params)||hn.ACCESS_TOKEN;return hn.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,p)}canonicalizeTileURL(a,o){const l=ut(a);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return a;let d="mapbox://";l.path.match(/^\/raster\/v1\//)?d+=`raster/${l.path.replace(`/${hn.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${l.path.replace(`/${hn.TILE_URL_VERSION}/`,"")}`;let p=l.params;return o&&(p=p.filter(_=>!_.match(/^access_token=/))),p.length&&(d+=`?${p.join("&")}`),d}canonicalizeTileset(a,o){const l=!!o&&_e(o),d=[];for(const p of a.tiles||[])Ee(p)?d.push(this.canonicalizeTileURL(p,l)):d.push(p);return d}_makeAPIURL(a,o){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=ut(hn.API_URL);if(a.protocol=d.protocol,a.authority=d.authority,"http"===a.protocol){const p=a.params.indexOf("secure");p>=0&&a.params.splice(p,1)}if("/"!==d.path&&(a.path=`${d.path}${a.path}`),!hn.REQUIRE_ACCESS_TOKEN)return it(a);if(o=o||hn.ACCESS_TOKEN,!this._silenceAuthErrors){if(!o)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if("s"===o[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return a.params=a.params.filter(p=>-1===p.indexOf("access_token")),a.params.push(`access_token=${o||""}`),it(a)}},f.ResourceType=fl,f.SegmentVector=rr,f.SourceCache=Au,f.StencilMode=mv,f.StructArrayLayout1ui2=Mn,f.StructArrayLayout2f1f2i16=Ut,f.StructArrayLayout2i4=Je,f.StructArrayLayout2ui4=qe,f.StructArrayLayout3f12=Sn,f.StructArrayLayout3ui6=At,f.StructArrayLayout4i8=Ve,f.StructArrayLayout5f20=_i,f.Texture=Ug,f.Tile=Hg,f.Transitionable=V,f.Uniform1f=Th,f.Uniform1i=class extends Dl{constructor(a){super(a),this.current=0}set(a,o,l){this.fetchUniformLocation(a,o)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},f.Uniform2f=class extends Dl{constructor(a){super(a),this.current=[0,0]}set(a,o,l){this.fetchUniformLocation(a,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}},f.Uniform3f=class extends Dl{constructor(a){super(a),this.current=[0,0,0]}set(a,o,l){this.fetchUniformLocation(a,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}},f.Uniform4f=iy,f.UniformColor=ry,f.UniformMatrix2f=class extends Dl{constructor(a){super(a),this.current=oy}set(a,o,l){if(this.fetchUniformLocation(a,o))for(let d=0;d<4;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}},f.UniformMatrix3f=class extends Dl{constructor(a){super(a),this.current=r0}set(a,o,l){if(this.fetchUniformLocation(a,o))for(let d=0;d<9;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}},f.UniformMatrix4f=class extends Dl{constructor(a){super(a),this.current=n0}set(a,o,l){if(this.fetchUniformLocation(a,o)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let d=1;d<16;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}},f.UnwrappedTileID=Ny,f.ValidationError=bt,f.VectorTileFeature=gg,f.VectorTileWorkerSource=class extends Gd{constructor(a,o,l,d,p){super(),this.actor=a,this.layerIndex=o,this.availableImages=l,this.loadVectorData=p||sp,this.loading={},this.loaded={},this.deduped=new Gg(a.scheduler),this.isSpriteLoaded=d,this.scheduler=a.scheduler}loadTile(a,o){const l=a.uid,d=a&&a.request,p=d&&d.collectResourceTiming,_=this.loading[l]=new $g(a);_.abort=this.loadVectorData(a,(v,w)=>{const D=!this.loading[l];if(delete this.loading[l],D||v||!w)return _.status="done",D||(this.loaded[l]=_),o(v);const S=w.rawData,k={};w.expires&&(k.expires=w.expires),w.cacheControl&&(k.cacheControl=w.cacheControl),_.vectorTile=w.vectorTile||new qh(new Cg(S));const P=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(F,B)=>{if(F||!B)return o(F);const z={};if(p){const j=kp(d);j.length>0&&(z.resourceTiming=JSON.parse(JSON.stringify(j)))}o(null,Oi({rawTileData:S.slice(0)},B,k,z))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[l]=_})}reloadTile(a,o){const l=this.loaded,d=a.uid,p=this;if(l&&l[d]){const _=l[d];_.showCollisionBoxes=a.showCollisionBoxes,_.enableTerrain=!!a.enableTerrain,_.projection=a.projection,_.tileTransform=Cd(a.tileID.canonical,a.projection);const v=(w,D)=>{const S=_.reloadCallback;S&&(delete _.reloadCallback,_.parse(_.vectorTile,p.layerIndex,this.availableImages,p.actor,S)),o(w,D)};"parsing"===_.status?_.reloadCallback=v:"done"===_.status&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(a,o){const l=a.uid,d=this.loading[l];d&&(d.abort&&d.abort(),delete this.loading[l]),o()}removeTile(a,o){const l=this.loaded,d=a.uid;l&&l[d]&&delete l[d],o()}},f.WritingMode=Ls,f.ZoomDependentExpression=Ha,f.add=Ml,f.addDynamicAttributes=zg,f.adjoint=function(a,o){var l=o[0],d=o[1],p=o[2],_=o[3],v=o[4],w=o[5],D=o[6],S=o[7],k=o[8];return a[0]=v*k-w*S,a[1]=p*S-d*k,a[2]=d*w-p*v,a[3]=w*D-_*k,a[4]=l*k-p*D,a[5]=p*_-l*w,a[6]=_*S-v*D,a[7]=d*D-l*S,a[8]=l*v-d*_,a},f.asyncAll=gn,f.bezier=He,f.bindAll=fi,f.boundsAttributes=Mu,f.bufferConvexPolygon=function(a,o){const l=[];for(let d=0;d<a.length;d++){const p=Vt(d-1,-1,a.length-1),_=Vt(d+1,-1,a.length-1),v=a[d],w=a[_],D=a[p].sub(v).unit(),S=w.sub(v).unit(),k=S.angleWithSep(D.x,D.y),P=D.add(S).unit().mult(-1*o/Math.sin(k/2));l.push(v.add(P))}return l},f.cacheEntryPossiblyAdded=function(a){Cs++,Cs>th&&(a.getActor().send("enforceCacheSizeLimit",Nc),Cs=0)},f.calculateGlobeLabelMatrix=function(a,o){const{x:l,y:d}=a.point,p=ng(l,d,a.worldSize/a._pixelsPerMercatorPixel,0,0);return Ih(p,p,ms(Bi(o)))},f.calculateGlobeMatrix=function(a){const{x:o,y:l}=a.point,{lng:d,lat:p}=a._center;return ng(o,l,a.worldSize,d,p)},f.calculateGlobeMercatorMatrix=function(a){const o=a.pixelsPerMeter,l=o/Ya(1,a.center.lat),d=Sl(new Float64Array(16));return af(d,d,[a.point.x,a.point.y,0]),su(d,d,[l,l,o]),Float32Array.from(d)},f.circumferenceAtLatitude=Lh,f.clamp=wt,f.clearTileCache=function(a){if(!jd())return;const o=Ie.caches.delete(Lc);a&&o.catch(a).then(()=>a())},f.clipLine=nx,f.clone=function(a){var o=new qr(16);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],o[9]=a[9],o[10]=a[10],o[11]=a[11],o[12]=a[12],o[13]=a[13],o[14]=a[14],o[15]=a[15],o},f.clone$1=ss,f.collisionCircleLayout=PC,f.config=hn,f.conjugate=function(a,o){return a[0]=-o[0],a[1]=-o[1],a[2]=-o[2],a[3]=o[3],a},f.create=function(){var a=new qr(16);return qr!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},f.create$1=Ah,f.createExpression=Js,f.createLayout=ve,f.createStyleLayer=function(a){return"custom"===a.type?new QC(a):new hx[a.type](a)},f.cross=uf,f.degToRad=xn,f.distance=function(a,o){return Math.hypot(o[0]-a[0],o[1]-a[1],o[2]-a[2])},f.div=function(a,o,l){return a[0]=o[0]/l[0],a[1]=o[1]/l[1],a[2]=o[2]/l[2],a},f.dot=Ps,f.earthRadius=mf,f.ease=mt,f.easeCubicInOut=ul,f.ecefToLatLng=function([a,o,l]){const d=Math.hypot(a,o,l),p=Math.atan2(a,l),_=.5*Math.PI-Math.acos(-o/d);return new ai(Ei(p),Ei(_))},f.emitValidationErrors=Kp,f.endsWith=Fc,f.enforceCacheSizeLimit=function(a){Jl(),zo&&zo.then(o=>{o.keys().then(l=>{for(let d=0;d<l.length-a;d++)o.delete(l[d])})})},f.evaluateSizeForFeature=vg,f.evaluateSizeForZoom=Yh,f.evaluateVariableOffset=ZC,f.evented=x,f.exactEquals=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]&&a[3]===o[3]},f.exactEquals$1=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]},f.exported=Na,f.exported$1=ln,f.extend=Oi,f.extend$1=da,f.fillExtrusionHeightLift=G0,f.filterObject=hl,f.fromMat4=function(a,o){return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[4],a[4]=o[5],a[5]=o[6],a[6]=o[8],a[7]=o[9],a[8]=o[10],a},f.fromQuat=function(a,o){var l=o[0],d=o[1],p=o[2],_=o[3],v=l+l,w=d+d,D=p+p,S=l*v,k=d*v,P=d*w,F=p*v,B=p*w,z=p*D,j=_*v,Y=_*w,te=_*D;return a[0]=1-P-z,a[1]=k+te,a[2]=F-Y,a[3]=0,a[4]=k-te,a[5]=1-S-z,a[6]=B+j,a[7]=0,a[8]=F+Y,a[9]=B-j,a[10]=1-S-P,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},f.fromRotation=function(a,o){var l=Math.sin(o),d=Math.cos(o);return a[0]=d,a[1]=l,a[2]=0,a[3]=-l,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},f.fromScaling=ly,f.furthestTileCorner=function(a){const o=Math.round((a+45+360)%360/90)%4;return Xl[o]},f.getAABBPointSquareDist=function(a,o,l){let d=0;for(let p=0;p<2;++p){const _=l?l[p]:0;a[p]>_&&(d+=(a[p]-_)*(a[p]-_)),o[p]<_&&(d+=(_-o[p])*(_-o[p]))}return d},f.getAnchorAlignment=Dg,f.getAnchorJustification=Qh,f.getBounds=function(a){let o=1/0,l=1/0,d=-1/0,p=-1/0;for(const _ of a)o=Math.min(o,_.x),l=Math.min(l,_.y),d=Math.max(d,_.x),p=Math.max(p,_.y);return{min:new pt(o,l),max:new pt(d,p)}},f.getColumn=Fa,f.getDefaultExportFromCjs=xo,f.getGridMatrix=function(a,o,l,d){const p=o.getNorth(),_=o.getSouth(),v=o.getWest(),w=o.getEast(),D=1<<a.z,S=w-v,k=p-_,P=S/64,F=-k/Qm[l],B=[0,P,0,F,0,0,p,v,0];if(a.z>0){const z=180/d;l0(B,B,[z/S+1,0,0,0,z/k+1,0,-.5*z/P,.5*z/F,1])}return B[2]=D,B[5]=a.x,B[8]=a.y,B},f.getImage=se,f.getJSON=function(a,o){return Ql(Oi(a,{type:"json"}),o)},f.getLatitudinalLod=function(a){const o=Nr-5;a=wt(a,-o,o)/o*90;const l=Math.pow(Math.abs(Math.sin(xn(a))),3);return Math.round(l*(Qm.length-1))},f.getMapSessionAPI=Ni,f.getPerformanceMeasurement=kp,f.getProjection=dx,f.getRTLTextPluginStatus=C,f.getReferrer=gl,f.getTilePoint=function(a,{x:o,y:l},d=0){return new pt(((o-d)*a.scale-a.x)*Ot,(l*a.scale-a.y)*Ot)},f.getTileVec3=function(a,o,l=0){return cf(((o.x-l)*a.scale-a.x)*Ot,(o.y*a.scale-a.y)*Ot,gy(o.z,o.y))},f.getVideo=function(a,o){const l=Ie.document.createElement("video");l.muted=!0,l.onloadstart=function(){o(null,l)};for(let d=0;d<a.length;d++){const p=Ie.document.createElement("source");nh(a[d])||(l.crossOrigin="Anonymous"),p.src=a[d],l.appendChild(p)}return{cancel:()=>{}}},f.globeCenterToScreenPoint=function(a){const o=[0,0,0],l=Sl(new Float64Array(16));return Ih(l,a.pixelMatrix,a.globeMatrix),sr(o,o,l),new pt(o[0],o[1])},f.globeDenormalizeECEF=ms,f.globeECEFOrigin=function(a,o){const l=[0,0,0];return sr(l,l,tg(Bi(o.canonical))),sr(l,l,a),l},f.globeMetersToEcef=fy,f.globeNormalizeECEF=tg,f.globePixelsToTileUnits=function(a,o){return Ot/(512*Math.pow(2,a))*my(Bi(o))},f.globePoleMatrixForTile=function(a,o,l){const d=Sl(new Float64Array(16)),p=(o/(1<<a)-.5)*Math.PI*2;return ay(d,l.globeMatrix,p),Float32Array.from(d)},f.globeTileBounds=Bi,f.globeTiltAtLngLat=aC,f.globeToMercatorTransition=Za,f.globeUseCustomAntiAliasing=function(a,o,l){const d=Za(l.zoom),p=a.style.map._antialias,_=!!o.extStandardDerivatives,v=o.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return 0===d&&!p&&!v&&_},f.identity=Sl,f.identity$1=uy,f.invert=sf,f.isFullscreen=function(){return!!Ie.document.fullscreenElement||!!Ie.document.webkitFullscreenElement},f.isLngLatBehindGlobe=ig,f.isMapAuthenticated=function(a){return wo.has(a)},f.isMapboxURL=_e,f.isSafariWithAntialiasingBug=function(a){const o=a.navigator?a.navigator.userAgent:null;return!!Vd(a)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},f.latFromMercatorY=po,f.latLngToECEF=Tl,f.len=oC,f.length=ad,f.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},f.lngFromMercatorX=br,f.loadVectorTile=sp,f.makeRequest=Ql,f.mapValue=function(a,o,l,d,p){return wt((a-o)/(l-o)*(p-d)+d,d,p)},f.mercatorScale=gf,f.mercatorXfromLng=Al,f.mercatorYfromLat=Er,f.mercatorZfromAltitude=Ya,f.mul=rC,f.mul$1=u0,f.multiply=Ih,f.multiply$1=l0,f.multiply$2=d0,f.nextPowerOfTwo=la,f.normalize=Ao,f.normalize$1=Un,f.normalize$2=ld,f.number=Hn,f.ortho=function(a,o,l,d,p,_,v){var w=1/(o-l),D=1/(d-p),S=1/(_-v);return a[0]=-2*w,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*D,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*S,a[11]=0,a[12]=(o+l)*w,a[13]=(p+d)*D,a[14]=(v+_)*S,a[15]=1,a},f.pbf=Of,f.perspective=function(a,o,l,d,p){var _,v=1/Math.tan(o/2);return a[0]=v/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=v,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=p&&p!==1/0?(a[10]=(p+d)*(_=1/(d-p)),a[14]=2*p*d*_):(a[10]=-1,a[14]=-2*d),a},f.pick=function(a,o){const l={};for(let d=0;d<o.length;d++){const p=o[d];p in a&&(l[p]=a[p])}return l},f.plugin=I,f.pointGeometry=vs,f.polesInViewport=function(a){const o=Sl(new Float64Array(16));Ih(o,a.pixelMatrix,a.globeMatrix);const l=[0,qa,0],d=[0,Wa,0];return sr(l,l,o),sr(d,d,o),[l[0]>0&&l[0]<=a.width&&l[1]>0&&l[1]<=a.height&&!ig(a,new ai(a.center.lat,90)),d[0]>0&&d[0]<=a.width&&d[1]>0&&d[1]<=a.height&&!ig(a,new ai(a.center.lat,-90))]},f.polygonContainsPoint=_c,f.polygonIntersectsBox=uC,f.polygonIntersectsPolygon=yf,f.polygonizeBounds=function(a,o,l=0,d=!0){const p=new pt(l,l),_=a.sub(p),v=o.add(p),w=[_,new pt(v.x,_.y),v,new pt(_.x,v.y)];return d&&w.push(_.clone()),w},f.posAttributes=Os,f.postMapLoadEvent=pr,f.postPerformanceEvent=vr,f.postTurnstileEvent=zn,f.potpack=qy,f.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},f.radToDeg=Ei,f.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],f.registerForPluginStateChange=function(a){return a({pluginStatus:g,pluginURL:c}),x.on("pluginStateChange",a),a},f.removeAuthState=function(a){wo.delete(a)},f.renderColorRamp=Cy,f.resample=v0,f.rotateX=c0,f.rotateX$1=cu,f.rotateY=ay,f.rotateY$1=h0,f.rotateZ=function(a,o,l){var d=Math.sin(l),p=Math.cos(l),_=o[0],v=o[1],w=o[2],D=o[3],S=o[4],k=o[5],P=o[6],F=o[7];return o!==a&&(a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=_*p+S*d,a[1]=v*p+k*d,a[2]=w*p+P*d,a[3]=D*p+F*d,a[4]=S*p-_*d,a[5]=k*p-v*d,a[6]=P*p-w*d,a[7]=F*p-D*d,a},f.rotateZ$1=function(a,o,l){l*=.5;var d=o[0],p=o[1],_=o[2],v=o[3],w=Math.sin(l),D=Math.cos(l);return a[0]=d*D+p*w,a[1]=p*D-d*w,a[2]=_*D+v*w,a[3]=v*D-_*w,a},f.scale=su,f.scale$1=hf,f.scale$2=Zo,f.scaleAndAdd=au,f.set=function(a,o,l,d){return a[0]=o,a[1]=l,a[2]=d,a},f.setCacheLimits=function(a,o){Nc=a,th=o},f.setColumn=function(a,o,l){a[4*o+0]=l[0],a[4*o+1]=l[1],a[4*o+2]=l[2],a[4*o+3]=l[3]},f.setRTLTextPlugin=function(a,o,l=!1){if(g===ou||g===Qp||g===nd)throw new Error("setRTLTextPlugin cannot be called multiple times.");c=Na.resolveURL(a),g=ou,id=o,y(),l||M()},f.smoothstep=Xi,f.spec=ze,f.squaredLength=function(a){var o=a[0],l=a[1],d=a[2];return o*o+l*l+d*d},f.storeAuthState=function(a,o){o?wo.add(a):wo.delete(a)},f.sub=xa,f.subtract=Jm,f.symbolSize=X0,f.tileAABB=function(a,o,l,d,p,_,v,w,D){if("globe"===D.name)return function wa(a,o,l){const d=o/a.worldSize,p=a.globeMatrix;if(l.z<=1){const Se=Bi(l).getCorners();return m0(Se,p,d),Io.fromPoints(Se)}const _=hd(l),v=eg(_);m0(v,p,d);const w=Number.MAX_VALUE,D=[-w,-w,-w],S=[w,w,w];if(_.contains(a.center)){for(const nt of v)Rs(S,S,nt),df(D,D,nt);D[2]=0;const Se=a.point,Ue=[Se.x*d,Se.y*d,0];return Rs(S,S,Ue),df(D,D,Ue),new Io(S,D)}const k=[p[12]*d,p[13]*d,p[14]*d],P=_.getCenter(),F=wt(a.center.lat,-Nr,Nr),B=wt(P.lat,-Nr,Nr),z=Al(a.center.lng),j=Er(F);let Y=z-Al(P.lng);const te=j-Er(B);Y>.5?Y-=1:Y<-.5&&(Y+=1);let ce=0;Math.abs(Y)>Math.abs(te)?ce=Y>=0?1:3:(ce=te>=0?0:2,au(k,k,[p[4]*d,p[5]*d,p[6]*d],-Math.sin(xn(te>=0?_.getSouth():_.getNorth()))*fc));const ne=v[ce],ae=v[(ce+1)%4],pe=new fT(ne,ae,k),he=[f0(pe,0)||ne[0],f0(pe,1)||ne[1],f0(pe,2)||ne[2]],Te=Za(a.zoom);if(Te>0){const Se=function({x:nt,y:Fe,z:Ge},je,Xe,lt,Be){const ft=1/(1<<Ge);let St=nt*ft,_t=St+ft,en=Fe*ft,st=en+ft,Ft=0;const sn=(St+_t)/2-lt;return sn>.5?Ft=-1:sn<-.5&&(Ft=1),St=((St+Ft)*je-(lt*=je))*Xe+lt,_t=((_t+Ft)*je-lt)*Xe+lt,en=(en*je-(Be*=je))*Xe+Be,st=(st*je-Be)*Xe+Be,[[St,st,0],[_t,st,0],[_t,en,0],[St,en,0]]}(l,o,a._pixelsPerMercatorPixel,z,j);for(let nt=0;nt<v.length;nt++)uu(v[nt],Se[nt],Te);const Ue=Ml([],Se[ce],Se[(ce+1)%4]);Zo(Ue,Ue,.5),uu(he,Ue,Te)}for(const Se of v)Rs(S,S,Se),df(D,D,Se);return S[2]=Math.min(ne[2],ae[2]),Rs(S,S,he),df(D,D,he),new Io(S,D)}(a,o,new Af(l,d,p));const S=Cd({z:l,x:d,y:p},D);return new Io([(_+S.x/S.scale)*o,o*(S.y/S.scale),v],[(_+S.x2/S.scale)*o,o*(S.y2/S.scale),w])},f.tileCornersToBounds=hd,f.tileTransform=Cd,f.transformMat3=function(a,o,l){var d=o[0],p=o[1],_=o[2];return a[0]=d*l[0]+p*l[3]+_*l[6],a[1]=d*l[1]+p*l[4]+_*l[7],a[2]=d*l[2]+p*l[5]+_*l[8],a},f.transformMat4=sr,f.transformMat4$1=lu,f.transformQuat=cy,f.transitionTileAABBinECEF=Fh,f.translate=af,f.transpose=function(a,o){if(a===o){var l=o[1],d=o[2],p=o[5];a[1]=o[3],a[2]=o[6],a[3]=l,a[5]=o[7],a[6]=d,a[7]=p}else a[0]=o[0],a[1]=o[3],a[2]=o[6],a[3]=o[1],a[4]=o[4],a[5]=o[7],a[6]=o[2],a[7]=o[5],a[8]=o[8];return a},f.triggerPluginCompletionEvent=h,f.uniqueId=Xt,f.updateGlobeVertexNormal=function(a,o,l,d,p){const _=5*o+2;a.float32[_+0]=l,a.float32[_+1]=d,a.float32[_+2]=p},f.validateCustomStyleLayer=function(a){const o=[],l=a.id;return void 0===l&&o.push({message:`layers.${l}: missing required property "id"`}),void 0===a.render&&o.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&o.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),o},f.validateFilter=a=>Fr(tu(a)),f.validateFog=a=>Fr(J_(a)),f.validateLayer=a=>Fr(Z_(a)),f.validateLight=a=>Fr(K_(a)),f.validateSource=a=>Fr(X_(a)),f.validateStyle=ey,f.validateTerrain=a=>Fr(Um(a)),f.values=os,f.vectorTile=$h,f.version=Pi,f.warnOnce=ji,f.window=Ie,f.wrap=Vt}),io(0,function(f){function Ie(le){if("number"==typeof le||"boolean"==typeof le||"string"==typeof le||null==le)return JSON.stringify(le);if(Array.isArray(le)){let G="[";for(const se of le)G+=`${Ie(se)},`;return`${G}]`}let $="{";for(const G of Object.keys(le).sort())$+=`${G}:${Ie(le[G])},`;return`${$}}`}function Pi(le){let $="";for(const G of f.refProperties)$+=`/${Ie(le[G])}`;return $}class Ar{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,G){for(const fe of $)this._layerConfigs[fe.id]=fe,(this._layers[fe.id]=f.createStyleLayer(fe)).compileFilter(),this.keyCache[fe.id]&&delete this.keyCache[fe.id];for(const fe of G)delete this.keyCache[fe],delete this._layerConfigs[fe],delete this._layers[fe];this.familiesBySource={};const se=function(fe,_e){const Ee={};for(let ye=0;ye<fe.length;ye++){const Oe=_e&&_e[fe[ye].id]||Pi(fe[ye]);_e&&(_e[fe[ye].id]=Oe);let ct=Ee[Oe];ct||(ct=Ee[Oe]=[]),ct.push(fe[ye])}const Ce=[];for(const ye in Ee)Ce.push(Ee[ye]);return Ce}(f.values(this._layerConfigs),this.keyCache);for(const fe of se){const _e=fe.map(ut=>this._layers[ut.id]),Ee=_e[0];if("none"===Ee.visibility)continue;const Ce=Ee.source||"";let ye=this.familiesBySource[Ce];ye||(ye=this.familiesBySource[Ce]={});const Oe=Ee.sourceLayer||"_geojsonTileLayer";let ct=ye[Oe];ct||(ct=ye[Oe]=[]),ct.push(_e)}}}class hn{loadTile($,G){const{uid:se,encoding:fe,rawImageData:_e,padding:Ee,buildQuadTree:Ce}=$,ye=f.window.ImageBitmap&&_e instanceof f.window.ImageBitmap?this.getImageData(_e,Ee):_e;G(null,new f.DEMData(se,ye,fe,Ee<1,Ce))}getImageData($,G){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas($.width,$.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=$.width,this.offscreenCanvas.height=$.height,this.offscreenCanvasContext.drawImage($,0,0,$.width,$.height);const se=this.offscreenCanvasContext.getImageData(-G,-G,$.width+2*G,$.height+2*G);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),se}}function ln(le,$){if(0!==le.length){Vi(le[0],$);for(var G=1;G<le.length;G++)Vi(le[G],!$)}}function Vi(le,$){for(var G=0,se=0,fe=0,_e=le.length,Ee=_e-1;fe<_e;Ee=fe++){var Ce=(le[fe][0]-le[Ee][0])*(le[Ee][1]+le[fe][1]),ye=G+Ce;se+=Math.abs(G)>=Math.abs(Ce)?G-ye+Ce:Ce-ye+G,G=ye}G+se>=0!=!!$&&le.reverse()}var Ir=f.getDefaultExportFromCjs(function le($,G){var se,fe=$&&$.type;if("FeatureCollection"===fe)for(se=0;se<$.features.length;se++)le($.features[se],G);else if("GeometryCollection"===fe)for(se=0;se<$.geometries.length;se++)le($.geometries[se],G);else if("Feature"===fe)le($.geometry,G);else if("Polygon"===fe)ln($.coordinates,G);else if("MultiPolygon"===fe)for(se=0;se<$.coordinates.length;se++)ln($.coordinates[se],G);return $});const ro=f.VectorTileFeature.prototype.toGeoJSON;var Ci={exports:{}},ka=f.pointGeometry,Ra=f.vectorTile.VectorTileFeature,xo=Bo;function Bo(le,$){this.options=$||{},this.features=le,this.length=le.length}function oo(le,$){this.id="number"==typeof le.id?le.id:void 0,this.type=le.type,this.rawGeometry=1===le.type?[le.geometry]:le.geometry,this.properties=le.tags,this.extent=$||4096}Bo.prototype.feature=function(le){return new oo(this.features[le],this.options.extent)},oo.prototype.loadGeometry=function(){var le=this.rawGeometry;this.geometry=[];for(var $=0;$<le.length;$++){for(var G=le[$],se=[],fe=0;fe<G.length;fe++)se.push(new ka(G[fe][0],G[fe][1]));this.geometry.push(se)}return this.geometry},oo.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var le=this.geometry,$=1/0,G=-1/0,se=1/0,fe=-1/0,_e=0;_e<le.length;_e++)for(var Ee=le[_e],Ce=0;Ce<Ee.length;Ce++){var ye=Ee[Ce];$=Math.min($,ye.x),G=Math.max(G,ye.x),se=Math.min(se,ye.y),fe=Math.max(fe,ye.y)}return[$,se,G,fe]},oo.prototype.toGeoJSON=Ra.prototype.toGeoJSON;var aa=f.pbf,vs=xo;function rs(le){var $=new aa;return function(G,se){for(var fe in G.layers)se.writeMessage(3,pt,G.layers[fe])}(le,$),$.finish()}function pt(le,$){var G;$.writeVarintField(15,le.version||1),$.writeStringField(1,le.name||""),$.writeVarintField(5,le.extent||4096);var se={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<le.length;G++)se.feature=le.feature(G),$.writeMessage(2,qs,se);var fe=se.keys;for(G=0;G<fe.length;G++)$.writeStringField(3,fe[G]);var _e=se.values;for(G=0;G<_e.length;G++)$.writeMessage(4,ul,_e[G])}function qs(le,$){var G=le.feature;void 0!==G.id&&$.writeVarintField(1,G.id),$.writeMessage(2,Pa,le),$.writeVarintField(3,G.type),$.writeMessage(4,Xl,G)}function Pa(le,$){var G=le.feature,se=le.keys,fe=le.values,_e=le.keycache,Ee=le.valuecache;for(var Ce in G.properties){var ye=G.properties[Ce],Oe=_e[Ce];if(null!==ye){void 0===Oe&&(se.push(Ce),_e[Ce]=Oe=se.length-1),$.writeVarint(Oe);var ct=typeof ye;"string"!==ct&&"boolean"!==ct&&"number"!==ct&&(ye=JSON.stringify(ye));var ut=ct+":"+ye,it=Ee[ut];void 0===it&&(fe.push(ye),Ee[ut]=it=fe.length-1),$.writeVarint(it)}}}function xn(le,$){return($<<3)+(7&le)}function Ei(le){return le<<1^le>>31}function Xl(le,$){for(var G=le.loadGeometry(),se=le.type,fe=0,_e=0,Ee=G.length,Ce=0;Ce<Ee;Ce++){var ye=G[Ce],Oe=1;1===se&&(Oe=ye.length),$.writeVarint(xn(1,Oe));for(var ct=3===se?ye.length-1:ye.length,ut=0;ut<ct;ut++){1===ut&&1!==se&&$.writeVarint(xn(2,ct-1));var it=ye[ut].x-fe,cn=ye[ut].y-_e;$.writeVarint(Ei(it)),$.writeVarint(Ei(cn)),fe+=it,_e+=cn}3===se&&$.writeVarint(xn(7,1))}}function ul(le,$){var G=typeof le;"string"===G?$.writeStringField(1,le):"boolean"===G?$.writeBooleanField(7,le):"number"===G&&(le%1!=0?$.writeDoubleField(3,le):le<0?$.writeSVarintField(6,le):$.writeVarintField(5,le))}Ci.exports=rs,Ci.exports.fromVectorTileJs=rs,Ci.exports.fromGeojsonVt=function(le,$){$=$||{};var G={};for(var se in le)G[se]=new vs(le[se].features,$),G[se].name=se,G[se].version=$.version,G[se].extent=$.extent;return rs({layers:G})},Ci.exports.GeoJSONWrapper=vs;var He=f.getDefaultExportFromCjs(Ci.exports);const mt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:le=>le},wt=Math.fround||(Xi=new Float32Array(1),le=>(Xi[0]=+le,Xi[0]));var Xi;const Vt=3,gn=5,os=6;class Oi{constructor($){this.options=Object.assign(Object.create(mt),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:G,minZoom:se,maxZoom:fe}=this.options;G&&console.time("total time");const _e=`prepare ${$.length} points`;G&&console.time(_e),this.points=$;const Ee=[];for(let ye=0;ye<$.length;ye++){const Oe=$[ye];if(!Oe.geometry)continue;const[ct,ut]=Oe.geometry.coordinates,it=wt(Oa(ct)),cn=wt(la(ut));Ee.push(it,cn,1/0,ye,-1,1),this.options.reduce&&Ee.push(0)}let Ce=this.trees[fe+1]=this._createTree(Ee);G&&console.timeEnd(_e);for(let ye=fe;ye>=se;ye--){const Oe=+Date.now();Ce=this.trees[ye]=this._createTree(this._cluster(Ce,ye)),G&&console.log("z%d: %d clusters in %dms",ye,Ce.numItems,+Date.now()-Oe)}return G&&console.timeEnd("total time"),this}getClusters($,G){let se=(($[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,$[1]));let _e=180===$[2]?180:(($[2]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)se=-180,_e=180;else if(se>_e){const ut=this.getClusters([se,fe,180,Ee],G),it=this.getClusters([-180,fe,_e,Ee],G);return ut.concat(it)}const Ce=this.trees[this._limitZoom(G)],ye=Ce.range(Oa(se),la(Ee),Oa(_e),la(fe)),Oe=Ce.data,ct=[];for(const ut of ye){const it=this.stride*ut;ct.push(Oe[it+gn]>1?bs(Oe,it,this.clusterProps):this.points[Oe[it+Vt]])}return ct}getChildren($){const G=this._getOriginId($),se=this._getOriginZoom($),fe="No cluster with the specified id.",_e=this.trees[se];if(!_e)throw new Error(fe);const Ee=_e.data;if(G*this.stride>=Ee.length)throw new Error(fe);const Ce=this.options.radius/(this.options.extent*Math.pow(2,se-1)),ye=_e.within(Ee[G*this.stride],Ee[G*this.stride+1],Ce),Oe=[];for(const ct of ye){const ut=ct*this.stride;Ee[ut+4]===$&&Oe.push(Ee[ut+gn]>1?bs(Ee,ut,this.clusterProps):this.points[Ee[ut+Vt]])}if(0===Oe.length)throw new Error(fe);return Oe}getLeaves($,G,se){const fe=[];return this._appendLeaves(fe,$,G=G||10,se=se||0,0),fe}getTile($,G,se){const fe=this.trees[this._limitZoom($)],_e=Math.pow(2,$),{extent:Ee,radius:Ce}=this.options,ye=Ce/Ee,Oe=(se-ye)/_e,ct=(se+1+ye)/_e,ut={features:[]};return this._addTileFeatures(fe.range((G-ye)/_e,Oe,(G+1+ye)/_e,ct),fe.data,G,se,_e,ut),0===G&&this._addTileFeatures(fe.range(1-ye/_e,Oe,1,ct),fe.data,_e,se,_e,ut),G===_e-1&&this._addTileFeatures(fe.range(0,Oe,ye/_e,ct),fe.data,-1,se,_e,ut),ut.features.length?ut:null}getClusterExpansionZoom($){let G=this._getOriginZoom($)-1;for(;G<=this.options.maxZoom;){const se=this.getChildren($);if(G++,1!==se.length)break;$=se[0].properties.cluster_id}return G}_appendLeaves($,G,se,fe,_e){const Ee=this.getChildren(G);for(const Ce of Ee){const ye=Ce.properties;if(ye&&ye.cluster?_e+ye.point_count<=fe?_e+=ye.point_count:_e=this._appendLeaves($,ye.cluster_id,se,fe,_e):_e<fe?_e++:$.push(Ce),$.length===se)break}return _e}_createTree($){const G=new f.KDBush($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let se=0;se<$.length;se+=this.stride)G.add($[se],$[se+1]);return G.finish(),G.data=$,G}_addTileFeatures($,G,se,fe,_e,Ee){for(const Ce of $){const ye=Ce*this.stride,Oe=G[ye+gn]>1;let ct,ut,it;if(Oe)ct=Xt(G,ye,this.clusterProps),ut=G[ye],it=G[ye+1];else{const Lt=this.points[G[ye+Vt]];ct=Lt.properties;const[kn,zn]=Lt.geometry.coordinates;ut=Oa(kn),it=la(zn)}const cn={type:1,geometry:[[Math.round(this.options.extent*(ut*_e-se)),Math.round(this.options.extent*(it*_e-fe))]],tags:ct};let wn;wn=Oe||this.options.generateId?G[ye+Vt]:this.points[G[ye+Vt]].id,void 0!==wn&&(cn.id=wn),Ee.features.push(cn)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,G){const{radius:se,extent:fe,reduce:_e,minPoints:Ee}=this.options,Ce=se/(fe*Math.pow(2,G)),ye=$.data,Oe=[],ct=this.stride;for(let ut=0;ut<ye.length;ut+=ct){if(ye[ut+2]<=G)continue;ye[ut+2]=G;const it=ye[ut],cn=ye[ut+1],wn=$.within(ye[ut],ye[ut+1],Ce),Lt=ye[ut+gn];let kn=Lt;for(const zn of wn){const Hi=zn*ct;ye[Hi+2]>G&&(kn+=ye[Hi+gn])}if(kn>Lt&&kn>=Ee){let zn,Hi=it*Lt,pr=cn*Lt,Hr=-1;const vr=((ut/ct|0)<<5)+(G+1)+this.points.length;for(const ca of wn){const Ni=ca*ct;if(ye[Ni+2]<=G)continue;ye[Ni+2]=G;const wo=ye[Ni+gn];Hi+=ye[Ni]*wo,pr+=ye[Ni+1]*wo,ye[Ni+4]=vr,_e&&(zn||(zn=this._map(ye,ut,!0),Hr=this.clusterProps.length,this.clusterProps.push(zn)),_e(zn,this._map(ye,Ni)))}ye[ut+4]=vr,Oe.push(Hi/kn,pr/kn,1/0,vr,-1,kn),_e&&Oe.push(Hr)}else{for(let zn=0;zn<ct;zn++)Oe.push(ye[ut+zn]);if(kn>1)for(const zn of wn){const Hi=zn*ct;if(!(ye[Hi+2]<=G)){ye[Hi+2]=G;for(let pr=0;pr<ct;pr++)Oe.push(ye[Hi+pr])}}}}return Oe}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,G,se){if($[G+gn]>1){const Ee=this.clusterProps[$[G+os]];return se?Object.assign({},Ee):Ee}const fe=this.points[$[G+Vt]].properties,_e=this.options.map(fe);return se&&_e===fe?Object.assign({},_e):_e}}function bs(le,$,G){return{type:"Feature",id:le[$+Vt],properties:Xt(le,$,G),geometry:{type:"Point",coordinates:[(se=le[$],360*(se-.5)),Ui(le[$+1])]}};var se}function Xt(le,$,G){const se=le[$+gn],fe=se>=1e4?`${Math.round(se/1e3)}k`:se>=1e3?Math.round(se/100)/10+"k":se,_e=le[$+os],Ee=-1===_e?{}:Object.assign({},G[_e]);return Object.assign(Ee,{cluster:!0,cluster_id:le[$+Vt],point_count:se,point_count_abbreviated:fe})}function Oa(le){return le/360+.5}function la(le){const $=Math.sin(le*Math.PI/180),G=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return G<0?0:G>1?1:G}function Ui(le){const $=(180-360*le)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function fi(le,$,G,se){for(var fe,_e=se,Ee=G-$>>1,Ce=G-$,ye=le[$],Oe=le[$+1],ct=le[G],ut=le[G+1],it=$+3;it<G;it+=3){var cn=Fc(le[it],le[it+1],ye,Oe,ct,ut);if(cn>_e)fe=it,_e=cn;else if(cn===_e){var wn=Math.abs(it-Ee);wn<Ce&&(fe=it,Ce=wn)}}_e>se&&(fe-$>3&&fi(le,$,fe,se),le[fe+2]=_e,G-fe>3&&fi(le,fe,G,se))}function Fc(le,$,G,se,fe,_e){var Ee=fe-G,Ce=_e-se;if(0!==Ee||0!==Ce){var ye=((le-G)*Ee+($-se)*Ce)/(Ee*Ee+Ce*Ce);ye>1?(G=fe,se=_e):ye>0&&(G+=Ee*ye,se+=Ce*ye)}return(Ee=le-G)*Ee+(Ce=$-se)*Ce}function xt(le,$,G,se){var fe={id:void 0===le?null:le,type:$,geometry:G,tags:se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(_e){var Ee=_e.geometry,Ce=_e.type;if("Point"===Ce||"MultiPoint"===Ce||"LineString"===Ce)hl(_e,Ee);else if("Polygon"===Ce||"MultiLineString"===Ce)for(var ye=0;ye<Ee.length;ye++)hl(_e,Ee[ye]);else if("MultiPolygon"===Ce)for(ye=0;ye<Ee.length;ye++)for(var Oe=0;Oe<Ee[ye].length;Oe++)hl(_e,Ee[ye][Oe])}(fe),fe}function hl(le,$){for(var G=0;G<$.length;G+=3)le.minX=Math.min(le.minX,$[G]),le.minY=Math.min(le.minY,$[G+1]),le.maxX=Math.max(le.maxX,$[G]),le.maxY=Math.max(le.maxY,$[G+1])}function ss(le,$,G,se){if($.geometry){var fe=$.geometry.coordinates,_e=$.geometry.type,Ee=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2),Ce=[],ye=$.id;if(G.promoteId?ye=$.properties[G.promoteId]:G.generateId&&(ye=se||0),"Point"===_e)Kl(fe,Ce);else if("MultiPoint"===_e)for(var Oe=0;Oe<fe.length;Oe++)Kl(fe[Oe],Ce);else if("LineString"===_e)ji(fe,Ce,Ee,!1);else if("MultiLineString"===_e){if(G.lineMetrics){for(Oe=0;Oe<fe.length;Oe++)ji(fe[Oe],Ce=[],Ee,!1),le.push(xt(ye,"LineString",Ce,$.properties));return}xs(fe,Ce,Ee,!1)}else if("Polygon"===_e)xs(fe,Ce,Ee,!0);else{if("MultiPolygon"!==_e){if("GeometryCollection"===_e){for(Oe=0;Oe<$.geometry.geometries.length;Oe++)ss(le,{id:ye,geometry:$.geometry.geometries[Oe],properties:$.properties},G,se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Oe=0;Oe<fe.length;Oe++){var ct=[];xs(fe[Oe],ct,Ee,!0),Ce.push(ct)}}le.push(xt(ye,_e,Ce,$.properties))}}function Kl(le,$){$.push(Qu(le[0])),$.push(pl(le[1])),$.push(0)}function ji(le,$,G,se){for(var fe,_e,Ee=0,Ce=0;Ce<le.length;Ce++){var ye=Qu(le[Ce][0]),Oe=pl(le[Ce][1]);$.push(ye),$.push(Oe),$.push(0),Ce>0&&(Ee+=se?(fe*Oe-ye*_e)/2:Math.sqrt(Math.pow(ye-fe,2)+Math.pow(Oe-_e,2))),fe=ye,_e=Oe}var ct=$.length-3;$[2]=1,fi($,0,ct,G),$[ct+2]=1,$.size=Math.abs(Ee),$.start=0,$.end=$.size}function xs(le,$,G,se){for(var fe=0;fe<le.length;fe++){var _e=[];ji(le[fe],_e,G,se),$.push(_e)}}function Qu(le){return le/360+.5}function pl(le){var $=Math.sin(le*Math.PI/180),G=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return G<0?0:G>1?1:G}function ws(le,$,G,se,fe,_e,Ee,Ce){if(se/=$,_e>=(G/=$)&&Ee<se)return le;if(Ee<G||_e>=se)return null;for(var ye=[],Oe=0;Oe<le.length;Oe++){var ct=le[Oe],ut=ct.geometry,it=ct.type,cn=0===fe?ct.minX:ct.minY,wn=0===fe?ct.maxX:ct.maxY;if(cn>=G&&wn<se)ye.push(ct);else if(!(wn<G||cn>=se)){var Lt=[];if("Point"===it||"MultiPoint"===it)eh(ut,Lt,G,se,fe);else if("LineString"===it)Vd(ut,Lt,G,se,fe,!1,Ce.lineMetrics);else if("MultiLineString"===it)Fa(ut,Lt,G,se,fe,!1);else if("Polygon"===it)Fa(ut,Lt,G,se,fe,!0);else if("MultiPolygon"===it)for(var kn=0;kn<ut.length;kn++){var zn=[];Fa(ut[kn],zn,G,se,fe,!0),zn.length&&Lt.push(zn)}if(Lt.length){if(Ce.lineMetrics&&"LineString"===it){for(kn=0;kn<Lt.length;kn++)ye.push(xt(ct.id,it,Lt[kn],ct.tags));continue}"LineString"!==it&&"MultiLineString"!==it||(1===Lt.length?(it="LineString",Lt=Lt[0]):it="MultiLineString"),"Point"!==it&&"MultiPoint"!==it||(it=3===Lt.length?"Point":"MultiPoint"),ye.push(xt(ct.id,it,Lt,ct.tags))}}}return ye.length?ye:null}function eh(le,$,G,se,fe){for(var _e=0;_e<le.length;_e+=3){var Ee=le[_e+fe];Ee>=G&&Ee<=se&&($.push(le[_e]),$.push(le[_e+1]),$.push(le[_e+2]))}}function Vd(le,$,G,se,fe,_e,Ee){for(var Ce,ye,Oe=Ud(le),ct=0===fe?Nc:th,ut=le.start,it=0;it<le.length-3;it+=3){var cn=le[it],wn=le[it+1],Lt=le[it+2],kn=le[it+3],zn=le[it+4],Hi=0===fe?cn:wn,pr=0===fe?kn:zn,Hr=!1;Ee&&(Ce=Math.sqrt(Math.pow(cn-kn,2)+Math.pow(wn-zn,2))),Hi<G?pr>G&&(ye=ct(Oe,cn,wn,kn,zn,G),Ee&&(Oe.start=ut+Ce*ye)):Hi>se?pr<se&&(ye=ct(Oe,cn,wn,kn,zn,se),Ee&&(Oe.start=ut+Ce*ye)):Lc(Oe,cn,wn,Lt),pr<G&&Hi>=G&&(ye=ct(Oe,cn,wn,kn,zn,G),Hr=!0),pr>se&&Hi<=se&&(ye=ct(Oe,cn,wn,kn,zn,se),Hr=!0),!_e&&Hr&&(Ee&&(Oe.end=ut+Ce*ye),$.push(Oe),Oe=Ud(le)),Ee&&(ut+=Ce)}var vr=le.length-3;cn=le[vr],wn=le[vr+1],Lt=le[vr+2],(Hi=0===fe?cn:wn)>=G&&Hi<=se&&Lc(Oe,cn,wn,Lt),vr=Oe.length-3,_e&&vr>=3&&(Oe[vr]!==Oe[0]||Oe[vr+1]!==Oe[1])&&Lc(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&$.push(Oe)}function Ud(le){var $=[];return $.size=le.size,$.start=le.start,$.end=le.end,$}function Fa(le,$,G,se,fe,_e){for(var Ee=0;Ee<le.length;Ee++)Vd(le[Ee],$,G,se,fe,_e,!1)}function Lc(le,$,G,se){le.push($),le.push(G),le.push(se)}function Nc(le,$,G,se,fe,_e){var Ee=(_e-$)/(se-$);return le.push(_e),le.push(G+(fe-G)*Ee),le.push(1),Ee}function th(le,$,G,se,fe,_e){var Ee=(_e-G)/(fe-G);return le.push($+(se-$)*Ee),le.push(_e),le.push(1),Ee}function zo(le,$){for(var G=[],se=0;se<le.length;se++){var fe,_e=le[se],Ee=_e.type;if("Point"===Ee||"MultiPoint"===Ee||"LineString"===Ee)fe=La(_e.geometry,$);else if("MultiLineString"===Ee||"Polygon"===Ee){fe=[];for(var Ce=0;Ce<_e.geometry.length;Ce++)fe.push(La(_e.geometry[Ce],$))}else if("MultiPolygon"===Ee)for(fe=[],Ce=0;Ce<_e.geometry.length;Ce++){for(var ye=[],Oe=0;Oe<_e.geometry[Ce].length;Oe++)ye.push(La(_e.geometry[Ce][Oe],$));fe.push(ye)}G.push(xt(_e.id,Ee,fe,_e.tags))}return G}function La(le,$){var G=[];G.size=le.size,void 0!==le.start&&(G.start=le.start,G.end=le.end);for(var se=0;se<le.length;se+=3)G.push(le[se]+$,le[se+1],le[se+2]);return G}function jd(le,$){if(le.transformed)return le;var G,se,fe,_e=1<<le.z,Ee=le.x,Ce=le.y;for(G=0;G<le.features.length;G++){var ye=le.features[G],Oe=ye.geometry,ct=ye.type;if(ye.geometry=[],1===ct)for(se=0;se<Oe.length;se+=2)ye.geometry.push(Jl(Oe[se],Oe[se+1],$,_e,Ee,Ce));else for(se=0;se<Oe.length;se++){var ut=[];for(fe=0;fe<Oe[se].length;fe+=2)ut.push(Jl(Oe[se][fe],Oe[se][fe+1],$,_e,Ee,Ce));ye.geometry.push(ut)}}return le.transformed=!0,le}function Jl(le,$,G,se,fe,_e){return[Math.round(G*(le*se-fe)),Math.round(G*($*se-_e))]}function Bc(le,$,G,se,fe){for(var _e=$===fe.maxZoom?0:fe.tolerance/((1<<$)*fe.extent),Ee={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:G,y:se,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ce=0;Ce<le.length;Ce++){Ee.numFeatures++,Cs(Ee,le[Ce],_e,fe);var ye=le[Ce].minX,Oe=le[Ce].minY,ct=le[Ce].maxX,ut=le[Ce].maxY;ye<Ee.minX&&(Ee.minX=ye),Oe<Ee.minY&&(Ee.minY=Oe),ct>Ee.maxX&&(Ee.maxX=ct),ut>Ee.maxY&&(Ee.maxY=ut)}return Ee}function Cs(le,$,G,se){var fe=$.geometry,_e=$.type,Ee=[];if("Point"===_e||"MultiPoint"===_e)for(var Ce=0;Ce<fe.length;Ce+=3)Ee.push(fe[Ce]),Ee.push(fe[Ce+1]),le.numPoints++,le.numSimplified++;else if("LineString"===_e)fl(Ee,fe,le,G,!1,!1);else if("MultiLineString"===_e||"Polygon"===_e)for(Ce=0;Ce<fe.length;Ce++)fl(Ee,fe[Ce],le,G,"Polygon"===_e,0===Ce);else if("MultiPolygon"===_e)for(var ye=0;ye<fe.length;ye++){var Oe=fe[ye];for(Ce=0;Ce<Oe.length;Ce++)fl(Ee,Oe[Ce],le,G,!0,0===Ce)}if(Ee.length){var ct=$.tags||null;if("LineString"===_e&&se.lineMetrics){for(var ut in ct={},$.tags)ct[ut]=$.tags[ut];ct.mapbox_clip_start=fe.start/fe.size,ct.mapbox_clip_end=fe.end/fe.size}var it={geometry:Ee,type:"Polygon"===_e||"MultiPolygon"===_e?3:"LineString"===_e||"MultiLineString"===_e?2:1,tags:ct};null!==$.id&&(it.id=$.id),le.features.push(it)}}function fl(le,$,G,se,fe,_e){var Ee=se*se;if(se>0&&$.size<(fe?Ee:se))G.numPoints+=$.length/3;else{for(var Ce=[],ye=0;ye<$.length;ye+=3)(0===se||$[ye+2]>Ee)&&(G.numSimplified++,Ce.push($[ye]),Ce.push($[ye+1])),G.numPoints++;fe&&function(Oe,ct){for(var ut=0,it=0,cn=Oe.length,wn=cn-2;it<cn;wn=it,it+=2)ut+=(Oe[it]-Oe[wn])*(Oe[it+1]+Oe[wn+1]);if(ut>0===ct)for(it=0,cn=Oe.length;it<cn/2;it+=2){var Lt=Oe[it],kn=Oe[it+1];Oe[it]=Oe[cn-2-it],Oe[it+1]=Oe[cn-1-it],Oe[cn-2-it]=Lt,Oe[cn-1-it]=kn}}(Ce,_e),le.push(Ce)}}function ml(le,$){var G=($=this.options=function(fe,_e){for(var Ee in _e)fe[Ee]=_e[Ee];return fe}(Object.create(this.options),$)).debug;if(G&&console.time("preprocess data"),$.maxZoom<0||$.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($.promoteId&&$.generateId)throw new Error("promoteId and generateId cannot be used together.");var fe,_e,Ee,Ce,ye,Oe,se=function(fe,_e){var Ee=[];if("FeatureCollection"===fe.type)for(var Ce=0;Ce<fe.features.length;Ce++)ss(Ee,fe.features[Ce],_e,Ce);else ss(Ee,"Feature"===fe.type?fe:{geometry:fe},_e);return Ee}(le,$);this.tiles={},this.tileCoords=[],G&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$.indexMaxZoom,$.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ce=fe=se,ye=ws(fe,1,-1-(Ee=(_e=$).buffer/_e.extent),Ee,0,-1,2,_e),Oe=ws(fe,1,1-Ee,2+Ee,0,-1,2,_e),(ye||Oe)&&(Ce=ws(fe,1,-Ee,1+Ee,0,-1,2,_e)||[],ye&&(Ce=zo(ye,1).concat(Ce)),Oe&&(Ce=Ce.concat(zo(Oe,-1)))),(se=Ce).length&&this.splitTile(se,0,0,0),G&&(se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gl(le,$,G){return 32*((1<<le)*G+$)+le}function Ql(le,$){const G=le.tileID.canonical;if(!this._geoJSONIndex)return $(null,null);const se=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!se)return $(null,null);const fe=new class{constructor(Ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.EXTENT,this.length=Ee.length,this._features=Ee}feature(Ee){return new class{constructor(Ce){this._feature=Ce,this.extent=f.EXTENT,this.type=Ce.type,this.properties=Ce.tags,"id"in Ce&&!isNaN(Ce.id)&&(this.id=parseInt(Ce.id,10))}loadGeometry(){if(1===this._feature.type){const Ce=[];for(const ye of this._feature.geometry)Ce.push([new f.Point(ye[0],ye[1])]);return Ce}{const Ce=[];for(const ye of this._feature.geometry){const Oe=[];for(const ct of ye)Oe.push(new f.Point(ct[0],ct[1]));Ce.push(Oe)}return Ce}}toGeoJSON(Ce,ye,Oe){return ro.call(this,Ce,ye,Oe)}}(this._features[Ee])}}(se.features);let _e=He(fe);0===_e.byteOffset&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),$(null,{vectorTile:fe,rawData:_e.buffer})}ml.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ml.prototype.splitTile=function(le,$,G,se,fe,_e,Ee){for(var Ce=[le,$,G,se],ye=this.options,Oe=ye.debug;Ce.length;){se=Ce.pop(),G=Ce.pop(),$=Ce.pop(),le=Ce.pop();var ct=1<<$,ut=gl($,G,se),it=this.tiles[ut];if(!it&&(Oe>1&&console.time("creation"),it=this.tiles[ut]=Bc(le,$,G,se,ye),this.tileCoords.push({z:$,x:G,y:se}),Oe)){Oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$,G,se,it.numFeatures,it.numPoints,it.numSimplified),console.timeEnd("creation"));var cn="z"+$;this.stats[cn]=(this.stats[cn]||0)+1,this.total++}if(it.source=le,fe){if($===ye.maxZoom||$===fe)continue;var wn=1<<fe-$;if(G!==Math.floor(_e/wn)||se!==Math.floor(Ee/wn))continue}else if($===ye.indexMaxZoom||it.numPoints<=ye.indexMaxPoints)continue;if(it.source=null,0!==le.length){Oe>1&&console.time("clipping");var Lt,kn,zn,Hi,pr,Hr,vr=.5*ye.buffer/ye.extent,ca=.5-vr,Ni=.5+vr,wo=1+vr;Lt=kn=zn=Hi=null,pr=ws(le,ct,G-vr,G+Ni,0,it.minX,it.maxX,ye),Hr=ws(le,ct,G+ca,G+wo,0,it.minX,it.maxX,ye),le=null,pr&&(Lt=ws(pr,ct,se-vr,se+Ni,1,it.minY,it.maxY,ye),kn=ws(pr,ct,se+ca,se+wo,1,it.minY,it.maxY,ye),pr=null),Hr&&(zn=ws(Hr,ct,se-vr,se+Ni,1,it.minY,it.maxY,ye),Hi=ws(Hr,ct,se+ca,se+wo,1,it.minY,it.maxY,ye),Hr=null),Oe>1&&console.timeEnd("clipping"),Ce.push(Lt||[],$+1,2*G,2*se),Ce.push(kn||[],$+1,2*G,2*se+1),Ce.push(zn||[],$+1,2*G+1,2*se),Ce.push(Hi||[],$+1,2*G+1,2*se+1)}}},ml.prototype.getTile=function(le,$,G){var se=this.options,fe=se.extent,_e=se.debug;if(le<0||le>24)return null;var Ee=1<<le,Ce=gl(le,$=($%Ee+Ee)%Ee,G);if(this.tiles[Ce])return jd(this.tiles[Ce],fe);_e>1&&console.log("drilling down to z%d-%d-%d",le,$,G);for(var ye,Oe=le,ct=$,ut=G;!ye&&Oe>0;)Oe--,ct=Math.floor(ct/2),ut=Math.floor(ut/2),ye=this.tiles[gl(Oe,ct,ut)];return ye&&ye.source?(_e>1&&console.log("found parent tile z%d-%d-%d",Oe,ct,ut),_e>1&&console.time("drilling down"),this.splitTile(ye.source,Oe,ct,ut,le,$,G),_e>1&&console.timeEnd("drilling down"),this.tiles[Ce]?jd(this.tiles[Ce],fe):null):null};class zc extends f.VectorTileWorkerSource{constructor($,G,se,fe,_e){super($,G,se,fe,Ql),_e&&(this.loadGeoJSON=_e)}loadData($,G){const se=$&&$.request,fe=se&&se.collectResourceTiming;this.loadGeoJSON($,(_e,Ee)=>{if(_e||!Ee)return G(_e);if("object"!=typeof Ee)return G(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));{Ir(Ee,!0);try{if($.filter){const ye=f.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ye.result)throw new Error(ye.value.map(ct=>`${ct.key}: ${ct.message}`).join(", "));Ee={type:"FeatureCollection",features:Ee.features.filter(ct=>ye.value.evaluate({zoom:0},ct))}}this._geoJSONIndex=$.cluster?new Oi(function({superclusterOptions:ye,clusterProperties:Oe}){if(!Oe||!ye)return ye;const ct={},ut={},it={accumulated:null,zoom:0},cn={properties:null},wn=Object.keys(Oe);for(const Lt of wn){const[kn,zn]=Oe[Lt],Hi=f.createExpression(zn),pr=f.createExpression("string"==typeof kn?[kn,["accumulated"],["get",Lt]]:kn);ct[Lt]=Hi.value,ut[Lt]=pr.value}return ye.map=Lt=>{cn.properties=Lt;const kn={};for(const zn of wn)kn[zn]=ct[zn].evaluate(it,cn);return kn},ye.reduce=(Lt,kn)=>{cn.properties=kn;for(const zn of wn)it.accumulated=Lt[zn],Lt[zn]=ut[zn].evaluate(it,cn)},ye}($)).load(Ee.features):new ml(ye=Ee,$.geojsonVtOptions)}catch(ye){return G(ye)}this.loaded={};const Ce={};if(fe){const ye=f.getPerformanceMeasurement(se);ye&&(Ce.resourceTiming={},Ce.resourceTiming[$.source]=JSON.parse(JSON.stringify(ye)))}G(null,Ce)}var ye})}reloadTile($,G){const se=this.loaded;return se&&se[$.uid]?super.reloadTile($,G):this.loadTile($,G)}loadGeoJSON($,G){if($.request)f.getJSON($.request,G);else{if("string"!=typeof $.data)return G(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));try{return G(null,JSON.parse($.data))}catch{return G(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom($,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom($.clusterId))}catch(se){G(se)}}getClusterChildren($,G){try{G(null,this._geoJSONIndex.getChildren($.clusterId))}catch(se){G(se)}}getClusterLeaves($,G){try{G(null,this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset))}catch(se){G(se)}}}class nh{constructor($){this.self=$,this.actor=new f.Actor($,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=f.getProjection({name:"mercator"}),this.workerSourceTypes={vector:f.VectorTileWorkerSource,geojson:zc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(G,se)=>{if(this.workerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.workerSourceTypes[G]=se},this.self.registerRTLTextPlugin=G=>{if(f.plugin.isParsed())throw new Error("RTL text plugin already registered.");f.plugin.applyArabicShaping=G.applyArabicShaping,f.plugin.processBidirectionalText=G.processBidirectionalText,f.plugin.processStyledBidirectionalText=G.processStyledBidirectionalText}}clearCaches($,G,se){delete this.layerIndexes[$],delete this.availableImages[$],delete this.workerSources[$],delete this.demWorkerSources[$],se()}checkIfReady($,G,se){se()}setReferrer($,G){this.referrer=G}spriteLoaded($,G){this.isSpriteLoaded[$]=G;for(const se in this.workerSources[$]){const fe=this.workerSources[$][se];for(const _e in fe)fe[_e]instanceof f.VectorTileWorkerSource&&(fe[_e].isSpriteLoaded=G,fe[_e].fire(new f.Event("isSpriteLoaded")))}}setImages($,G,se){this.availableImages[$]=G;for(const fe in this.workerSources[$]){const _e=this.workerSources[$][fe];for(const Ee in _e)_e[Ee].availableImages=G}se()}enableTerrain($,G,se){this.terrain=G,se()}setProjection($,G){this.projections[$]=f.getProjection(G)}setLayers($,G,se){this.getLayerIndex($).replace(G),se()}updateLayers($,G,se){this.getLayerIndex($).update(G.layers,G.removedIds),se()}loadTile($,G,se){const fe=this.enableTerrain?f.extend({enableTerrain:this.terrain},G):G;fe.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,G.type,G.source).loadTile(fe,se)}loadDEMTile($,G,se){const fe=this.enableTerrain?f.extend({buildQuadTree:this.terrain},G):G;this.getDEMWorkerSource($,G.source).loadTile(fe,se)}reloadTile($,G,se){const fe=this.enableTerrain?f.extend({enableTerrain:this.terrain},G):G;fe.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,G.type,G.source).reloadTile(fe,se)}abortTile($,G,se){this.getWorkerSource($,G.type,G.source).abortTile(G,se)}removeTile($,G,se){this.getWorkerSource($,G.type,G.source).removeTile(G,se)}removeSource($,G,se){if(!this.workerSources[$]||!this.workerSources[$][G.type]||!this.workerSources[$][G.type][G.source])return;const fe=this.workerSources[$][G.type][G.source];delete this.workerSources[$][G.type][G.source],void 0!==fe.removeSource?fe.removeSource(G,se):se()}loadWorkerSource($,G,se){try{this.self.importScripts(G.url),se()}catch(fe){se(fe.toString())}}syncRTLPluginState($,G,se){try{f.plugin.setState(G);const fe=f.plugin.getPluginURL();if(f.plugin.isLoaded()&&!f.plugin.isParsed()&&null!=fe){this.self.importScripts(fe);const _e=f.plugin.isParsed();se(_e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${fe}`),_e)}}catch(fe){se(fe.toString())}}getAvailableImages($){let G=this.availableImages[$];return G||(G=[]),G}getLayerIndex($){let G=this.layerIndexes[$];return G||(G=this.layerIndexes[$]=new Ar),G}getWorkerSource($,G,se){return this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][G]||(this.workerSources[$][G]={}),this.workerSources[$][G][se]||(this.workerSources[$][G][se]=new this.workerSourceTypes[G]({send:(_e,Ee,Ce,ye,Oe,ct)=>{this.actor.send(_e,Ee,Ce,$,Oe,ct)},scheduler:this.actor.scheduler},this.getLayerIndex($),this.getAvailableImages($),this.isSpriteLoaded[$])),this.workerSources[$][G][se]}getDEMWorkerSource($,G){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][G]||(this.demWorkerSources[$][G]=new hn),this.demWorkerSources[$][G]}enforceCacheSizeLimit($,G){f.enforceCacheSizeLimit(G)}getWorkerPerformanceMetrics($,G,se){se(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new nh(self)),nh}),io(0,function(f){function Ie(g,c){if(Array.isArray(g)){if(!Array.isArray(c)||g.length!==c.length)return!1;for(let h=0;h<g.length;h++)if(!Ie(g[h],c[h]))return!1;return!0}if("object"==typeof g&&null!==g&&null!==c){if("object"!=typeof c||Object.keys(g).length!==Object.keys(c).length)return!1;for(const h in g)if(!Ie(g[h],c[h]))return!1;return!0}return g===c}var Pi=Ar;function Ar(g){return c=g,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,x,C=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(C);try{x=new Worker(M),y=!0}catch{y=!1}return x&&x.terminate(),URL.revokeObjectURL(M),y}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var y=document.createElement("canvas");y.width=y.height=1;var x=y.getContext("2d");if(!x)return!1;var C=x.getImageData(0,0,1,1);return C&&C.width===y.width}()||(void 0===hn[h=c&&c.failIfMajorPerformanceCaveat]&&(hn[h]=function(y){var x,M,I,R,C=(M=y,I=document.createElement("canvas"),(R=Object.create(Ar.webGLContextAttributes)).failIfMajorPerformanceCaveat=M,I.getContext("webgl",R)||I.getContext("experimental-webgl",R));if(!C)return!1;try{x=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!x||C.isContextLost())&&(C.shaderSource(x,"void main() {}"),C.compileShader(x),!0===C.getShaderParameter(x,C.COMPILE_STATUS))}(h)),!hn[h]||document.documentMode));var c,h}var hn={};function ln(g,c,h){const y=f.window.document.createElement(g);return void 0!==c&&(y.className=c),h&&h.appendChild(y),y}function Vi(g,c,h){const y=f.window.document.createElementNS("http://www.w3.org/2000/svg",g);for(const x of Object.keys(c))y.setAttributeNS(null,x,c[x]);return h&&h.appendChild(y),y}Ar.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Ir=f.window.document&&f.window.document.documentElement.style,ro=Ir&&void 0!==Ir.userSelect?"userSelect":"WebkitUserSelect";let Ci;function ka(){Ir&&ro&&(Ci=Ir[ro],Ir[ro]="none")}function Ra(){Ir&&ro&&(Ir[ro]=Ci)}function xo(g){g.preventDefault(),g.stopPropagation(),f.window.removeEventListener("click",xo,!0)}function Bo(){f.window.addEventListener("click",xo,!0),f.window.setTimeout(()=>{f.window.removeEventListener("click",xo,!0)},0)}function oo(g,c){const h=g.getBoundingClientRect();return rs(g,h,c)}function aa(g,c){const h=g.getBoundingClientRect(),y=[];for(let x=0;x<c.length;x++)y.push(rs(g,h,c[x]));return y}function vs(g){return void 0!==f.window.InstallTrigger&&2===g.button&&g.ctrlKey&&f.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button}function rs(g,c,h){const y=g.offsetWidth===c.width?1:g.offsetWidth/c.width;return new f.Point((h.clientX-c.left)*y,(h.clientY-c.top)*y)}function pt(g,c){var h=c[0],y=c[1],x=c[2],C=c[3],M=h*C-x*y;return M?(g[0]=C*(M=1/M),g[1]=-y*M,g[2]=-x*M,g[3]=h*M,g):null}function qs(g){const{userImage:c}=g;return!!(c&&c.render&&c.render())&&(g.data.replace(new Uint8Array(c.data.buffer)),!0)}class Pa extends f.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new f.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:h,callback:y}of this.requestors)this._notify(h,y);this.requestors=[]}}hasImage(c){return!!this.getImage(c)}getImage(c){return this.images[c]}addImage(c,h){this._validate(c,h)&&(this.images[c]=h)}_validate(c,h){let y=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new f.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),y=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new f.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),y=!1),this._validateContent(h.content,h)||(this.fire(new f.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),y=!1),y}_validateStretch(c,h){if(!c)return!0;let y=0;for(const x of c){if(x[0]<y||x[1]<x[0]||h<x[1])return!1;y=x[1]}return!0}_validateContent(c,h){return!(c&&(4!==c.length||c[0]<0||h.data.width<c[0]||c[1]<0||h.data.height<c[1]||c[2]<0||h.data.width<c[2]||c[3]<0||h.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,h){h.version=this.images[c].version+1,this.images[c]=h,this.updatedImages[c]=!0}removeImage(c){const h=this.images[c];delete this.images[c],delete this.patterns[c],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,h){let y=!0;if(!this.isLoaded())for(const x of c)this.images[x]||(y=!1);this.isLoaded()||y?this._notify(c,h):this.requestors.push({ids:c,callback:h})}_notify(c,h){const y={};for(const x of c){this.images[x]||this.fire(new f.Event("styleimagemissing",{id:x}));const C=this.images[x];C?y[x]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!(!C.userImage||!C.userImage.render)}:f.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,y)}getPixelSize(){const{width:c,height:h}=this.atlasImage;return{width:c,height:h}}getPattern(c){const h=this.patterns[c],y=this.getImage(c);if(!y)return null;if(h&&h.position.version===y.version)return h.position;if(h)h.position.version=y.version;else{const x={w:y.data.width+2,h:y.data.height+2,x:0,y:0},C=new f.ImagePosition(x,y);this.patterns[c]={bin:x,position:C}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const h=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new f.Texture(c,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const C in this.patterns)c.push(this.patterns[C].bin);const{w:h,h:y}=f.potpack(c),x=this.atlasImage;x.resize({width:h||1,height:y||1});for(const C in this.patterns){const{bin:M}=this.patterns[C],I=M.x+1,R=M.y+1,N=this.images[C].data,L=N.width,V=N.height;f.RGBAImage.copy(N,x,{x:0,y:0},{x:I,y:R},{width:L,height:V}),f.RGBAImage.copy(N,x,{x:0,y:V-1},{x:I,y:R-1},{width:L,height:1}),f.RGBAImage.copy(N,x,{x:0,y:0},{x:I,y:R+V},{width:L,height:1}),f.RGBAImage.copy(N,x,{x:L-1,y:0},{x:I-1,y:R},{width:1,height:V}),f.RGBAImage.copy(N,x,{x:0,y:0},{x:I+L,y:R},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const h of c){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const y=this.images[h];qs(y)&&this.updateImage(h,y)}}}const xn=new f.Properties({anchor:new f.DataConstantProperty(f.spec.light.anchor),position:new class{constructor(){this.specification=f.spec.light.position}possiblyEvaluate(g,c){return function([h,y,x]){const C=f.degToRad(y+90),M=f.degToRad(x);return{x:h*Math.cos(C)*Math.sin(M),y:h*Math.sin(C)*Math.sin(M),z:h*Math.cos(M),azimuthal:y,polar:x}}(g.expression.evaluate(c))}interpolate(g,c,h){return{x:f.number(g.x,c.x,h),y:f.number(g.y,c.y,h),z:f.number(g.z,c.z,h),azimuthal:f.number(g.azimuthal,c.azimuthal,h),polar:f.number(g.polar,c.polar,h)}}},color:new f.DataConstantProperty(f.spec.light.color),intensity:new f.DataConstantProperty(f.spec.light.intensity)});class Ei extends f.Evented{constructor(c){super(),this._transitionable=new f.Transitionable(xn),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,h={}){if(!this._validate(f.validateLight,c,h))for(const y in c){const x=c[y];f.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),x):this._transitionable.setValue(y,x)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,h,y){return(!y||!1!==y.validate)&&f.emitValidationErrors(this,c.call(f.validateStyle,f.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:f.spec})))}}const Xl=new f.Properties({source:new f.DataConstantProperty(f.spec.terrain.source),exaggeration:new f.DataConstantProperty(f.spec.terrain.exaggeration)});let ul=class extends f.Evented{constructor(g,c){super(),this._transitionable=new f.Transitionable(Xl),this.set(g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(g){for(const c in g){const h=g[c];f.endsWith(c,"-transition")?this._transitionable.setTransition(c.slice(0,-11),h):this._transitionable.setValue(c,h)}}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}};function He(g,c,h,y){const x=f.smoothstep(45,65,h),[C,M]=mt(g,y),I=f.length(c);let R=1-Math.min(1,Math.exp((I-C)/(M-C)*-6));return R*=R*R,R=Math.min(1,1.00747*R),R*x*g.alpha}function mt(g,c){const h=.5/Math.tan(.5*c);return[g.range[0]+h,g.range[1]+h]}const wt=new f.Properties({range:new f.DataConstantProperty(f.spec.fog.range),color:new f.DataConstantProperty(f.spec.fog.color),"high-color":new f.DataConstantProperty(f.spec.fog["high-color"]),"space-color":new f.DataConstantProperty(f.spec.fog["space-color"]),"horizon-blend":new f.DataConstantProperty(f.spec.fog["horizon-blend"]),"star-intensity":new f.DataConstantProperty(f.spec.fog["star-intensity"])});class Xi extends f.Evented{constructor(c,h){super(),this._transitionable=new f.Transitionable(wt),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const c=this._transform,h="globe"===c.projection.name,y=f.globeToMercatorTransition(c.zoom),x=this.properties.get("range"),C=[.5,3];return{range:h?[f.number(C[0],x[0],y),f.number(C[1],x[1],y)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,h={}){if(!this._validate(f.validateFog,c,h)){for(const y of Object.keys(f.spec.fog))c&&void 0===c[y]&&(c[y]=f.spec.fog[y].default);for(const y in c){const x=c[y];f.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),x):this._transitionable.setValue(y,x)}}}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:f.smoothstep(45,65,c))*h.a}getOpacityAtLatLng(c,h){return this._transform.projection.supportsFog?function(y,x,C){const M=f.MercatorCoordinate.fromLngLat(x),I=C.elevation?C.elevation.getAtPointOrZero(M):0,R=[M.x,M.y,I];return f.transformMat4(R,R,C.mercatorFogMatrix),He(y,R,C.pitch,C._fov)}(this.state,c,h):0}getFovAdjustedRange(c){return this._transform.projection.supportsFog?mt(this.state,c):[0,1]}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,h,y){return(!y||!1!==y.validate)&&f.emitValidationErrors(this,c.call(f.validateStyle,f.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:f.spec})))}}class Vt{constructor(c,h){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=f.uniqueId();const y=this.workerPool.acquire(this.id);for(let x=0;x<y.length;x++){const C=new Vt.Actor(y[x],h,this.id);C.name=`Worker ${x}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,h,y){f.asyncAll(this.actors,(x,C)=>{x.send(c,h,C)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function gn(g,c,h){return c*(f.EXTENT/(g.tileSize*Math.pow(2,h-g.tileID.overscaledZ)))}Vt.Actor=f.Actor;class os{constructor(c,h,y,x){this.screenBounds=c,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(c,h){let y,x;if(c instanceof f.Point||"number"==typeof c[0]){const C=f.Point.convert(c);y=[C],x=h.isPointAboveHorizon(C)}else{const C=f.Point.convert(c[0]),M=f.Point.convert(c[1]);y=[C,M],x=f.polygonizeBounds(C,M).every(I=>h.isPointAboveHorizon(I))}return new os(y,h.getCameraPoint(),x,h)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(c){return f.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const h=this.screenBounds[0],y=1===this.screenBounds.length?this.screenBounds[0].add(new f.Point(1,1)):this.screenBounds[1],x=f.polygonizeBounds(h,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<y.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?x[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(x[3]=this.cameraPoint)),f.bufferConvexPolygon(x,c)}bufferedCameraGeometryGlobe(c){const h=this.screenBounds[0],y=1===this.screenBounds.length?this.screenBounds[0].add(new f.Point(1,1)):this.screenBounds[1],x=f.polygonizeBounds(h,y,c),C=this.cameraPoint.clone();switch(3*((C.y>h.y)+(C.y>y.y))+((C.x>h.x)+(C.x>y.x))){case 0:x[0]=C,x[4]=C.clone();break;case 1:x.splice(1,0,C);break;case 2:x[1]=C;break;case 3:x.splice(4,0,C);break;case 5:x.splice(2,0,C);break;case 6:x[3]=C;break;case 7:x.splice(3,0,C);break;case 8:x[2]=C}return x}containsTile(c,h,y,x=0){const C=c.queryPadding/h._pixelsPerMercatorPixel+1,M=y?this._bufferedCameraMercator(C,h):this._bufferedScreenMercator(C,h);let I=c.tileID.wrap+(M.unwrapped?x:0);const R=M.polygon.map(ee=>f.getTilePoint(c.tileTransform,ee,I));if(!f.polygonIntersectsBox(R,0,0,f.EXTENT,f.EXTENT))return;I=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const N=this.screenGeometryMercator.polygon.map(ee=>f.getTileVec3(c.tileTransform,ee,I)),L=N.map(ee=>new f.Point(ee[0],ee[1])),V=h.getFreeCameraOptions().position||new f.MercatorCoordinate(0,0,0),W=f.getTileVec3(c.tileTransform,V,I),X=N.map(ee=>{const U=f.sub(ee,ee,W);return f.normalize(U,U),new f.Ray(W,U)}),Q=gn(c,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:L,tilespaceRays:X,bufferedTilespaceGeometry:R,bufferedTilespaceBounds:(K=f.getBounds(R),K.min.x=f.clamp(K.min.x,0,f.EXTENT),K.min.y=f.clamp(K.min.y,0,f.EXTENT),K.max.x=f.clamp(K.max.x,0,f.EXTENT),K.max.y=f.clamp(K.max.y,0,f.EXTENT),K),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:Q};var K}_bufferedScreenMercator(c,h){const y=Xt(c);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let x;return x="globe"===h.projection.name?this._projectAndResample(this.bufferedScreenGeometry(c),h):{polygon:this.bufferedScreenGeometry(c).map(C=>h.pointCoordinate3D(C)),unwrapped:!0},this._screenRaycastCache[y]=x,x}}_bufferedCameraMercator(c,h){const y=Xt(c);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let x;return x="globe"===h.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),h):{polygon:this.bufferedCameraGeometry(c).map(C=>h.pointCoordinate3D(C)),unwrapped:!0},this._cameraRaycastCache[y]=x,x}}_projectAndResample(c,h){const y=function(C,M){const I=f.multiply([],M.pixelMatrix,M.globeMatrix),R=[0,-f.GLOBE_RADIUS,0,1],N=[0,f.GLOBE_RADIUS,0,1],L=[0,0,0,1];f.transformMat4$1(R,R,I),f.transformMat4$1(N,N,I),f.transformMat4$1(L,L,I);const V=new f.Point(R[0]/R[3],R[1]/R[3]),W=new f.Point(N[0]/N[3],N[1]/N[3]),X=f.polygonContainsPoint(C,V)&&R[3]<L[3],Q=f.polygonContainsPoint(C,W)&&N[3]<L[3];if(!X&&!Q)return null;const K=function(me,be,ve){for(let Ae=1;Ae<me.length;Ae++){const Je=bs(be.pointCoordinate3D(me[Ae-1]).x),De=bs(be.pointCoordinate3D(me[Ae]).x);if(ve<0){if(Je<De)return{idx:Ae,t:-Je/(De-1-Je)}}else if(De<Je)return{idx:Ae,t:(1-Je)/(De+1-Je)}}return null}(C,M,X?-1:1);if(!K)return null;const{idx:ee,t:U}=K;let Z=ee>1?Oi(C.slice(0,ee),M):[],ie=ee<C.length?Oi(C.slice(ee),M):[];Z=Z.map(me=>new f.Point(bs(me.x),me.y)),ie=ie.map(me=>new f.Point(bs(me.x),me.y));const re=[...Z];0===re.length&&re.push(ie[ie.length-1]);const ue=f.number(re[re.length-1].y,(0===ie.length?Z[0]:ie[0]).y,U);let ge;return ge=X?[new f.Point(0,ue),new f.Point(0,0),new f.Point(1,0),new f.Point(1,ue)]:[new f.Point(1,ue),new f.Point(1,1),new f.Point(0,1),new f.Point(0,ue)],re.push(...ge),0===ie.length?re.push(Z[0]):re.push(...ie),{polygon:re.map(me=>new f.MercatorCoordinate(me.x,me.y)),unwrapped:!1}}(c,h);if(y)return y;const x=function(C,M){let I=!1,R=-1/0,N=0;for(let V=0;V<C.length-1;V++)C[V].x>R&&(R=C[V].x,N=V);for(let V=0;V<C.length-1;V++){const W=(N+V)%(C.length-1),X=C[W],Q=C[W+1];Math.abs(X.x-Q.x)>.5&&(X.x<Q.x?(X.x+=1,0===W&&(C[C.length-1].x+=1)):(Q.x+=1,W+1===C.length-1&&(C[0].x+=1)),I=!0)}const L=f.mercatorXfromLng(M.center.lng);return I&&L<Math.abs(L-1)&&C.forEach(V=>{V.x-=1}),{polygon:C,unwrapped:I}}(Oi(c,h).map(C=>new f.Point(bs(C.x),C.y)),h);return{polygon:x.polygon.map(C=>new f.MercatorCoordinate(C.x,C.y)),unwrapped:x.unwrapped}}}function Oi(g,c){return f.resample(g,h=>{const y=c.pointCoordinate3D(h);h.x=y.x,h.y=y.y},1/256)}function bs(g){return g<0?1+g%1:g%1}function Xt(g){return 100*g|0}function Oa(g,c,h,y,x){const C=function(M,I){if(M)return x(M);if(I){g.url&&I.tiles&&g.tiles&&delete g.tiles;const R=f.pick(f.extend(I,g),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(R.vectorLayers=I.vector_layers,R.vectorLayerIds=R.vectorLayers.map(N=>N.id)),R.tiles=c.canonicalizeTileset(R,g.url),x(null,R)}};return g.url?f.getJSON(c.transformRequest(c.normalizeSourceURL(g.url,null,h,y),f.ResourceType.Source),C):f.exported.frame(()=>C(null,g))}class la{constructor(c,h,y){this.bounds=f.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=h||0,this.maxzoom=y||24}validateBounds(c){return Array.isArray(c)&&4===c.length?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const h=Math.pow(2,c.z),y=Math.floor(f.mercatorXfromLng(this.bounds.getWest())*h),x=Math.floor(f.mercatorYfromLat(this.bounds.getNorth())*h),C=Math.ceil(f.mercatorXfromLng(this.bounds.getEast())*h),M=Math.ceil(f.mercatorYfromLat(this.bounds.getSouth())*h);return c.x>=y&&c.x<C&&c.y>=x&&c.y<M}}class Ui{constructor(c,h,y){this.context=c;const x=c.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const fi={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Fc{constructor(c,h,y,x){this.length=h.length,this.attributes=y,this.itemSize=h.bytesPerElement,this.dynamicDraw=x,this.context=c;const C=c.gl;this.buffer=C.createBuffer(),c.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,h){for(let y=0;y<this.attributes.length;y++){const x=h.attributes[this.attributes[y].name];void 0!==x&&c.enableVertexAttribArray(x)}}setVertexAttribPointers(c,h,y){for(let x=0;x<this.attributes.length;x++){const C=this.attributes[x],M=h.attributes[C.name];void 0!==M&&c.vertexAttribPointer(M,C.components,c[fi[C.type]],!1,this.itemSize,C.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class xt{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class hl extends xt{getDefault(){return f.Color.transparent}set(c){const h=this.current;(c.r!==h.r||c.g!==h.g||c.b!==h.b||c.a!==h.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class ss extends xt{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Kl extends xt{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class ji extends xt{getDefault(){return[!0,!0,!0,!0]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class xs extends xt{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class Qu extends xt{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class pl extends xt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const h=this.current;(c.func!==h.func||c.ref!==h.ref||c.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class ws extends xt{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class eh extends xt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=c,this.dirty=!1}}class Vd extends xt{getDefault(){return[0,1]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Ud extends xt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=c,this.dirty=!1}}class Fa extends xt{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class Lc extends xt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.BLEND):h.disable(h.BLEND),this.current=c,this.dirty=!1}}class Nc extends xt{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class th extends xt{getDefault(){return f.Color.transparent}set(c){const h=this.current;(c.r!==h.r||c.g!==h.g||c.b!==h.b||c.a!==h.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class zo extends xt{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class La extends xt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=c,this.dirty=!1}}class jd extends xt{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Jl extends xt{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}let Bc,Cs=class extends xt{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class fl extends xt{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class ml extends xt{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class gl extends xt{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class Ql extends xt{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class zc extends xt{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class nh extends xt{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class le extends xt{getDefault(){return null}set(c){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class $ extends xt{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class G extends xt{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class se extends xt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class fe extends xt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class _e extends xt{constructor(c,h){super(c),this.context=c,this.parent=h}getDefault(){return null}}class Ee extends _e{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class Ce extends _e{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class ye extends Ce{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Oe{constructor(c,h,y,x){this.context=c,this.width=h,this.height=y;const C=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new Ee(c,C),x&&(this.depthAttachment=new Ce(c,C))}destroy(){const c=this.context.gl,h=this.colorAttachment.get();if(h&&c.deleteTexture(h),this.depthAttachment){const y=this.depthAttachment.get();y&&c.deleteRenderbuffer(y)}c.deleteFramebuffer(this.framebuffer)}}class ct{constructor(c,h=!1){if(this.gl=c,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const y=c;this.extVertexArrayObject={createVertexArrayOES:y.createVertexArray.bind(c),deleteVertexArrayOES:y.deleteVertexArray.bind(c),bindVertexArrayOES:y.bindVertexArray.bind(c)}}this.clearColor=new hl(this),this.clearDepth=new ss(this),this.clearStencil=new Kl(this),this.colorMask=new ji(this),this.depthMask=new xs(this),this.stencilMask=new Qu(this),this.stencilFunc=new pl(this),this.stencilOp=new ws(this),this.stencilTest=new eh(this),this.depthRange=new Vd(this),this.depthTest=new Ud(this),this.depthFunc=new Fa(this),this.blend=new Lc(this),this.blendFunc=new Nc(this),this.blendColor=new th(this),this.blendEquation=new zo(this),this.cullFace=new La(this),this.cullFaceSide=new jd(this),this.frontFace=new Jl(this),this.program=new Cs(this),this.activeTexture=new fl(this),this.viewport=new ml(this),this.bindFramebuffer=new gl(this),this.bindRenderbuffer=new Ql(this),this.bindTexture=new zc(this),this.bindVertexBuffer=new nh(this),this.bindElementBuffer=new le(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $(this),this.pixelStoreUnpack=new G(this),this.pixelStoreUnpackPremultiplyAlpha=new se(this),this.pixelStoreUnpackFlipY=new fe(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=c.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&c.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||c.getExtension("OES_standard_derivatives"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,h){return new Ui(this,c,h)}createVertexBuffer(c,h,y){return new Fc(this,c,h,y)}createRenderbuffer(c,h,y){const x=this.gl,C=x.createRenderbuffer();return this.bindRenderbuffer.set(C),x.renderbufferStorage(x.RENDERBUFFER,c,h,y),this.bindRenderbuffer.set(null),C}createFramebuffer(c,h,y){return new Oe(this,c,h,y)}clear({color:c,depth:h,stencil:y}){const x=this.gl;let C=0;c&&(C|=x.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(C|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),void 0!==y&&(C|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),x.clear(C)}setCullFace(c){!1===c.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){Ie(c.blendFunction,f.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ut extends f.Evented{constructor(c,h,y,x){if(super(),this.id=c,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f.extend(this,f.pick(h,["url","scheme","tileSize","promoteId"])),this._options=f.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new f.DedupedRequest}load(c){this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=Oa(this._options,this.map._requestManager,h,y,(x,C)=>{this._tileJSONRequest=null,this._loaded=!0,x?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),y&&2!==y.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new f.ErrorEvent(x))):C&&(f.extend(this,C),C.bounds&&(this.tileBounds=new la(C.bounds,this.minzoom,this.maxzoom)),f.postTurnstileEvent(C.tiles,this.map._requestManager._customAccessToken),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(x)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return f.extend({},this._options)}loadTile(c,h){const y=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(y,f.ResourceType.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:f.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile};if(x.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state)"loading"===c.state?c.reloadCallback=h:c.request=c.actor.send("reloadTile",x,C.bind(this));else if(c.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",x,C.bind(this),void 0,!0);else{const M=f.loadVectorTile.call({deduped:this._deduped},x,(I,R)=>{I||!R?C.call(this,I):(x.data={cacheControl:R.cacheControl,expires:R.expires,rawData:R.rawData.slice(0)},c.actor&&c.actor.send("loadTile",x,C.bind(this),void 0,!0))},!0);c.request={cancel:M}}function C(M,I){return delete c.request,c.aborted?h(null):M&&404!==M.status?h(M):(I&&I.resourceTiming&&(c.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&c.setExpiryData(I),c.loadVectorData(I,this.map.painter),f.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id})}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class it extends f.Evented{constructor(c,h,y,x){super(),this.id=c,this.dispatcher=y,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f.extend({type:"raster"},h),f.extend(this,f.pick(h,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Oa(this._options,this.map._requestManager,null,null,(h,y)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new f.ErrorEvent(h)):y&&(f.extend(this,y),y.bounds&&(this.tileBounds=new la(y.bounds,this.minzoom,this.maxzoom)),f.postTurnstileEvent(y.tiles),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(h)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return f.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,h){const y=f.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);c.request=f.getImage(this.map._requestManager.transformRequest(x,f.ResourceType.Tile),(C,M,I,R)=>(delete c.request,c.aborted?(c.state="unloaded",h(null)):C?(c.state="errored",h(C)):M?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:I,expires:R}),c.setTexture(M,this.map.painter),c.state="loaded",f.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null)))}static loadTileData(c,h,y){c.setTexture(h,y)}static unloadTileData(c,h){c.texture&&h.saveTileTexture(c.texture)}abortTile(c,h){c.request&&(c.request.cancel(),delete c.request),h()}unloadTile(c,h){c.texture&&this.map.painter.saveTileTexture(c.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function cn(g,c,h,y,x,C,M,I){const R=[g,h,x,c,y,C,1,1,1],N=[M,I,1],L=f.adjoint([],R),[V,W,X]=f.transformMat3(N,N,f.transpose(L,L));return f.multiply$1(R,[V,0,0,0,W,0,0,0,X],R)}class wn extends f.Evented{constructor(c,h,y,x){super(),this.id=c,this.dispatcher=y,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=h,this._dirty=!1}load(c,h){this._loaded=h||!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=f.getImage(this.map._requestManager.transformRequest(this.url,f.ResourceType.Image),(y,x)=>{if(this._imageRequest=null,this._loaded=!0,y)this.fire(new f.ErrorEvent(y));else if(x){const{HTMLImageElement:C}=f.window;this.image=x instanceof C?f.exported.getImageData(x):x,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading()}})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(c){this.coordinates=c,this._boundsArray=void 0;const h=c.map(f.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let x=1/0,C=1/0,M=-1/0,I=-1/0;for(const V of y)x=Math.min(x,V.x),C=Math.min(C,V.y),M=Math.max(M,V.x),I=Math.max(I,V.y);const R=Math.max(M-x,I-C),N=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),L=Math.pow(2,N);return new f.CanonicalTileID(N,Math.floor((x+M)/2*L),Math.floor((C+I)/2*L))}(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(c){for(const R in this.tiles){const N=this.tiles[R];"loaded"!==N.state&&(N.state="loaded",N.texture=this.texture)}if(this._boundsArray)return;const h=f.tileTransform(this.tileID,this.map.transform.projection),[y,x,C,M]=this.coordinates.map(R=>{const N=h.projection.project(R[0],R[1]);return f.getTilePoint(h,N)._round()});this.perspectiveTransform=function(R,N,L,V,W,X,Q,K,ee,U){const Z=cn(0,0,R,0,0,N,R,N),ie=cn(L,V,W,X,Q,K,ee,U);return f.multiply$1(ie,f.adjoint(Z,Z),ie),[ie[6]/ie[8]*R/f.EXTENT,ie[7]/ie[8]*N/f.EXTENT]}(this.width,this.height,y.x,y.y,x.x,x.y,M.x,M.y,C.x,C.y);const I=this._boundsArray=new f.StructArrayLayout4i8;I.emplaceBack(y.x,y.y,0,0),I.emplaceBack(x.x,x.y,f.EXTENT,0),I.emplaceBack(M.x,M.y,0,f.EXTENT),I.emplaceBack(C.x,C.y,f.EXTENT,f.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=c.createVertexBuffer(I,f.boundsAttributes.members),this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const c=this.map.painter.context,h=c.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new f.Texture(c,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(c)}loadTile(c,h){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},h(null)):(c.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Lt={vector:ut,raster:it,"raster-dem":class extends it{constructor(g,c,h,y){super(g,c,h,y),this.type="raster-dem",this.maxzoom=22,this._options=f.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(g,c){const h=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(x,C){x&&(g.state="errored",c(x)),C&&(g.dem=C,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",c(null))}g.request=f.getImage(this.map._requestManager.transformRequest(h,f.ResourceType.Tile),function(x,C,M,I){if(delete g.request,g.aborted)g.state="unloaded",c(null);else if(x)g.state="errored",c(x);else if(C){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:M,expires:I});const R=f.window.ImageBitmap&&C instanceof f.window.ImageBitmap&&(null==Bc&&(Bc=f.window.OffscreenCanvas&&new f.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof f.window.createImageBitmap),Bc),N=1-(C.width-f.prevPowerOfTwo(C.width))/2;N<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const L=R?C:f.exported.getImageData(C,N),V={uid:g.uid,coord:g.tileID,source:this.id,rawImageData:L,encoding:this.encoding,padding:N};g.actor&&"expired"!==g.state||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",V,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(g){const c=g.canonical,h=Math.pow(2,c.z),y=(c.x-1+h)%h,x=0===c.x?g.wrap-1:g.wrap,C=(c.x+1+h)%h,M=c.x+1===h?g.wrap+1:g.wrap,I={};return I[new f.OverscaledTileID(g.overscaledZ,x,c.z,y,c.y).key]={backfilled:!1},I[new f.OverscaledTileID(g.overscaledZ,M,c.z,C,c.y).key]={backfilled:!1},c.y>0&&(I[new f.OverscaledTileID(g.overscaledZ,x,c.z,y,c.y-1).key]={backfilled:!1},I[new f.OverscaledTileID(g.overscaledZ,g.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},I[new f.OverscaledTileID(g.overscaledZ,M,c.z,C,c.y-1).key]={backfilled:!1}),c.y+1<h&&(I[new f.OverscaledTileID(g.overscaledZ,x,c.z,y,c.y+1).key]={backfilled:!1},I[new f.OverscaledTileID(g.overscaledZ,g.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},I[new f.OverscaledTileID(g.overscaledZ,M,c.z,C,c.y+1).key]={backfilled:!1}),I}unloadTile(g){g.demTexture&&this.map.painter.saveTileTexture(g.demTexture),g.fbo&&(g.fbo.destroy(),delete g.fbo),g.dem&&delete g.dem,delete g.neighboringTiles,g.state="unloaded"}},geojson:class extends f.Evented{constructor(g,c,h,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(y),this._data=c.data,this._options=f.extend({},c),this._collectResourceTiming=c.collectResourceTiming,void 0!==c.maxzoom&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const x=f.EXTENT/this.tileSize;this.workerOptions=f.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(void 0!==c.buffer?c.buffer:128)*x,tolerance:(void 0!==c.tolerance?c.tolerance:.375)*x,extent:f.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:void 0!==c.clusterMaxZoom?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:f.EXTENT,radius:(void 0!==c.clusterRadius?c.clusterRadius:50)*x,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}getClusterExpansionZoom(g,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id},c),this}getClusterChildren(g,c){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id},c),this}getClusterLeaves(g,c,h,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:g,limit:c,offset:h},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new f.Event("dataloading",{dataType:"source"})),this._loaded=!1;const g=f.extend({},this.workerOptions),c=this._data;"string"==typeof c?(g.request=this.map._requestManager.transformRequest(f.exported.resolveURL(c),f.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,g,(h,y)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new f.ErrorEvent(h));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(x.resourceTiming=y.resourceTiming[this.id]),this.fire(new f.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(g,c){const h=g.actor?"reloadTile":"loadTile";g.actor=this.actor,g.request=this.actor.send(h,{type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:f.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,x)=>(delete g.request,g.unloadVectorData(),g.aborted?c(null):y?c(y):(g.loadVectorData(x,this.map.painter,"reloadTile"===h),c(null))),void 0,"loadTile"===h)}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g){g.unloadVectorData(),this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return f.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends wn{constructor(g,c,h,y){super(g,c,h,y),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const c of g.urls)this.urls.push(this.map._requestManager.transformRequest(c,f.ResourceType.Source).url);f.getVideo(this.urls,(c,h)=>{this._loaded=!0,c?this.fire(new f.ErrorEvent(c)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const c=this.video.seekable;g<c.start(0)||g>c.end(0)?this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const g=this.map.painter.context,c=g.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new f.Texture(g,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:wn,canvas:class extends wn{constructor(g,c,h,y){super(g,c,h,y),c.coordinates?Array.isArray(c.coordinates)&&4===c.coordinates.length&&!c.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(C=>"number"!=typeof C))||this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'missing required property "coordinates"'))),c.animate&&"boolean"!=typeof c.animate&&this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),c.canvas?"string"==typeof c.canvas||c.canvas instanceof f.window.HTMLCanvasElement||this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'missing required property "canvas"'))),this.options=c,this.animate=void 0===c.animate||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof f.window.HTMLCanvasElement?this.options.canvas:f.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new f.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const c=this.map.painter.context;this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new f.Texture(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends f.Evented{constructor(g,c,h,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=c,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new f.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new f.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new la(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),f.extend(this,f.pick(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return f.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this._map=g,this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:c,y:h,z:y}=g.canonical;return this._implementation.hasTile({x:c,y:h,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,c){const{x:h,y,z:x}=g.tileID.canonical,C=new f.window.AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:h,y,z:x},{signal:C.signal})).then(function(M){return delete g.request,g.aborted?(g.state="unloaded",c(null)):void 0===M?(g.state="errored",c(null)):null===M?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",c(null)):(I=M)instanceof f.window.ImageData||I instanceof f.window.HTMLCanvasElement||I instanceof f.window.ImageBitmap||I instanceof f.window.HTMLImageElement?(this.loadTileData(g,M),g.state="loaded",void c(null)):(g.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var I}.bind(this)).catch(M=>{20!==M.code&&(g.state="errored",c(M))}),g.request.cancel=()=>C.abort()}loadTileData(g,c){it.loadTileData(g,c,this._map.painter)}unloadTileData(g){it.unloadTileData(g,this._map.painter)}unloadTile(g,c){if(this.unloadTileData(g),this._implementation.unloadTile){const{x:h,y,z:x}=g.tileID.canonical;this._implementation.unloadTile({x:h,y,z:x})}c()}abortTile(g,c){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))}}},kn=function(g,c,h,y){const x=new Lt[c.type](g,c,h,y);if(x.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${x.id}`);return f.bindAll(["load","abort","unload","serialize","prepare"],x),x};function zn(g,c){const h=f.identity([]);return f.scale(h,h,[.5*g.width,.5*-g.height,1]),f.translate(h,h,[1,-1,0]),f.multiply(h,h,g.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(h)}function Hi(g,c,h,y,x,C,M,I=!1){const R=g.tilesIn(y,M,I);R.sort(Hr);const N=[];for(const V of R)N.push({wrappedTileID:V.tile.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(c,h,g._state,V,x,C,zn(g.transform,V.tile.tileID),I)});const L=function(V){const W={},X={};for(const Q of V){const K=Q.queryResults,ee=Q.wrappedTileID,U=X[ee]=X[ee]||{};for(const Z in K){const ie=K[Z],re=U[Z]=U[Z]||{},ue=W[Z]=W[Z]||[];for(const ge of ie)re[ge.featureIndex]||(re[ge.featureIndex]=!0,ue.push(ge))}}return W}(N);for(const V in L)L[V].forEach(W=>{const X=W.feature,Q=X.layer;Q&&"background"!==Q.type&&"sky"!==Q.type&&(X.source=Q.source,Q["source-layer"]&&(X.sourceLayer=Q["source-layer"]),X.state=void 0!==X.id?g.getFeatureState(Q["source-layer"],X.id):{})});return L}function pr(g,c){const h=g.getRenderableIds().map(C=>g.getTileByID(C)),y=[],x={};for(let C=0;C<h.length;C++){const M=h[C],I=M.tileID.canonical.key;x[I]||(x[I]=!0,M.querySourceFeatures(y,c))}return y}function Hr(g,c){const h=g.tileID,y=c.tileID;return h.overscaledZ-y.overscaledZ||h.canonical.y-y.canonical.y||h.wrap-y.wrap||h.canonical.x-y.canonical.x}function vr(){return null!=id.workerClass?new id.workerClass:new f.window.Worker(id.workerUrl)}const ca="mapboxgl_preloaded_worker_pool";class Ni{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<Ni.workerCount;)this.workers.push(new vr);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],0===this.numActive()&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ca]}numActive(){return Object.keys(this.active).length}}let wo;function Ki(){return wo||(wo=new Ni),wo}function Vc(g,c){const h={};for(const y in g)"ref"!==y&&(h[y]=g[y]);return f.refProperties.forEach(y=>{y in c&&(h[y]=c[y])}),h}function Es(g){g=g.slice();const c=Object.create(null);for(let h=0;h<g.length;h++)c[g[h].id]=g[h];for(let h=0;h<g.length;h++)"ref"in g[h]&&(g[h]=Vc(g[h],c[g[h].ref]));return g}Ni.workerCount=2;const ii={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function kp(g,c,h){h.push({command:ii.addSource,args:[g,c[g]]})}function Uc(g,c,h){c.push({command:ii.removeSource,args:[g]}),h[g]=!0}function Hd(g,c,h,y){Uc(g,h,y),kp(g,c,h)}function $d(g,c,h){let y;for(y in g[h])if(g[h].hasOwnProperty(y)&&"data"!==y&&!Ie(g[h][y],c[h][y]))return!1;for(y in c[h])if(c[h].hasOwnProperty(y)&&"data"!==y&&!Ie(g[h][y],c[h][y]))return!1;return!0}function Vo(g,c,h,y,x,C){let M;for(M in c=c||{},g=g||{})g.hasOwnProperty(M)&&(Ie(g[M],c[M])||h.push({command:C,args:[y,M,c[M],x]}));for(M in c)c.hasOwnProperty(M)&&!g.hasOwnProperty(M)&&(Ie(g[M],c[M])||h.push({command:C,args:[y,M,c[M],x]}))}function Na(g){return g.id}function ih(g,c){return g[c.id]=c,g}class rh{constructor(c,h){this.reset(c,h)}reset(c,h){this.points=c||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(1===this.points.length)return this.points[0];c=f.clamp(c,0,1);let h=1,y=this._distances[h];const x=c*this.paddedLength+this.padding;for(;y<x&&h<this._distances.length;)y=this._distances[++h];const C=h-1,M=this._distances[C],I=y-M,R=I>0?(x-M)/I:0;return this.points[C].mult(1-R).add(this.points[h].mult(R))}}class ec{constructor(c,h,y){const x=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(c/y),this.yCellCount=Math.ceil(h/y);for(let M=0;M<this.xCellCount*this.yCellCount;M++)x.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=h,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,h,y,x,C){this._forEachCell(h,y,x,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(h),this.bboxes.push(y),this.bboxes.push(x),this.bboxes.push(C)}insertCircle(c,h,y,x){this._forEachCell(h-x,y-x,h+x,y+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(h),this.circles.push(y),this.circles.push(x)}_insertBoxCell(c,h,y,x,C,M){this.boxCells[C].push(M)}_insertCircleCell(c,h,y,x,C,M){this.circleCells[C].push(M)}_query(c,h,y,x,C,M){if(y<0||c>this.width||x<0||h>this.height)return!C&&[];const I=[];if(c<=0&&h<=0&&this.width<=y&&this.height<=x){if(C)return!0;for(let R=0;R<this.boxKeys.length;R++)I.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const N=this.circles[3*R],L=this.circles[3*R+1],V=this.circles[3*R+2];I.push({key:this.circleKeys[R],x1:N-V,y1:L-V,x2:N+V,y2:L+V})}return M?I.filter(M):I}return this._forEachCell(c,h,y,x,this._queryCell,I,{hitTest:C,seenUids:{box:{},circle:{}}},M),C?I.length>0:I}_queryCircle(c,h,y,x,C){const M=c-y,I=c+y,R=h-y,N=h+y;if(I<0||M>this.width||N<0||R>this.height)return!x&&[];const L=[];return this._forEachCell(M,R,I,N,this._queryCellCircle,L,{hitTest:x,circle:{x:c,y:h,radius:y},seenUids:{box:{},circle:{}}},C),x?L.length>0:L}query(c,h,y,x,C){return this._query(c,h,y,x,!1,C)}hitTest(c,h,y,x,C){return this._query(c,h,y,x,!0,C)}hitTestCircle(c,h,y,x){return this._queryCircle(c,h,y,!0,x)}_queryCell(c,h,y,x,C,M,I,R){const N=I.seenUids,L=this.boxCells[C];if(null!==L){const W=this.bboxes;for(const X of L)if(!N.box[X]){N.box[X]=!0;const Q=4*X;if(c<=W[Q+2]&&h<=W[Q+3]&&y>=W[Q+0]&&x>=W[Q+1]&&(!R||R(this.boxKeys[X]))){if(I.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[X],x1:W[Q],y1:W[Q+1],x2:W[Q+2],y2:W[Q+3]})}}}const V=this.circleCells[C];if(null!==V){const W=this.circles;for(const X of V)if(!N.circle[X]){N.circle[X]=!0;const Q=3*X;if(this._circleAndRectCollide(W[Q],W[Q+1],W[Q+2],c,h,y,x)&&(!R||R(this.circleKeys[X]))){if(I.hitTest)return M.push(!0),!0;{const K=W[Q],ee=W[Q+1],U=W[Q+2];M.push({key:this.circleKeys[X],x1:K-U,y1:ee-U,x2:K+U,y2:ee+U})}}}}}_queryCellCircle(c,h,y,x,C,M,I,R){const N=I.circle,L=I.seenUids,V=this.boxCells[C];if(null!==V){const X=this.bboxes;for(const Q of V)if(!L.box[Q]){L.box[Q]=!0;const K=4*Q;if(this._circleAndRectCollide(N.x,N.y,N.radius,X[K+0],X[K+1],X[K+2],X[K+3])&&(!R||R(this.boxKeys[Q])))return M.push(!0),!0}}const W=this.circleCells[C];if(null!==W){const X=this.circles;for(const Q of W)if(!L.circle[Q]){L.circle[Q]=!0;const K=3*Q;if(this._circlesCollide(X[K],X[K+1],X[K+2],N.x,N.y,N.radius)&&(!R||R(this.circleKeys[Q])))return M.push(!0),!0}}}_forEachCell(c,h,y,x,C,M,I,R){const N=this._convertToXCellCoord(c),L=this._convertToYCellCoord(h),V=this._convertToXCellCoord(y),W=this._convertToYCellCoord(x);for(let X=N;X<=V;X++)for(let Q=L;Q<=W;Q++)if(C.call(this,c,h,y,x,this.xCellCount*Q+X,M,I,R))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,h,y,x,C,M){const I=x-c,R=C-h,N=y+M;return N*N>I*I+R*R}_circleAndRectCollide(c,h,y,x,C,M,I){const R=(M-x)/2,N=Math.abs(c-(x+R));if(N>R+y)return!1;const L=(I-C)/2,V=Math.abs(h-(C+L));if(V>L+y)return!1;if(N<=R||V<=L)return!0;const W=N-R,X=V-L;return W*W+X*X<=y*y}}const Ba={unknown:0,flipRequired:1,flipNotRequired:2},Gd=Math.tan(85*Math.PI/180);function ze(g,c,h,y,x,C,M){const I=f.create();if(h)if("globe"===C.name){const R=f.calculateGlobeLabelMatrix(x,c);f.multiply(I,I,R)}else{const R=pt([],M);I[0]=R[0],I[1]=R[1],I[4]=R[2],I[5]=R[3],y||f.rotateZ(I,I,x.angle)}else f.multiply(I,x.labelPlaneMatrix,g);return I}function da(g,c,h,y,x,C,M){const I=ze(g,c,h,y,x,C,M);return"globe"===C.name&&h||(I[2]=I[6]=I[10]=I[14]=0),I}function fr(g,c,h,y,x,C,M){if(h){if("globe"===C.name){const I=ze(g,c,h,y,x,C,M);return f.invert(I,I),f.multiply(I,g,I),I}{const I=f.clone(g),R=f.identity([]);return R[0]=M[0],R[1]=M[1],R[4]=M[2],R[5]=M[3],f.multiply(I,I,R),y||f.rotateZ(I,I,-x.angle),I}}return x.glCoordMatrix}function kr(g,c,h,y){const x=[g,c,h,1];h?f.transformMat4$1(x,x,y):vt(x,x,y);const C=x[3];return x[0]/=C,x[1]/=C,x[2]/=C,x}function mr(g,c){return Math.min(.5+g/c*.5,1.5)}function $i(g,c){const h=g[0]/g[3],y=g[1]/g[3];return h>=-c[0]&&h<=c[0]&&y>=-c[1]&&y<=c[1]}function oh(g,c,h,y,x,C,M,I,R,N){const L=h.transform,V=y?g.textSizeData:g.iconSizeData,W=f.evaluateSizeForZoom(V,h.transform.zoom),X="globe"===L.projection.name,Q=[256/h.width*2+1,256/h.height*2+1],K=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;K.clear();let ee=null;X&&(ee=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const U=g.lineVertexArray,Z=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,ie=h.transform.width/h.transform.height;let re,ue=!1;for(let ge=0;ge<Z.length;ge++){const me=Z.get(ge),{numGlyphs:be,writingMode:ve}=me;if(ve!==f.WritingMode.vertical||ue||re===f.WritingMode.horizontal||(ue=!0),re=ve,(me.hidden||ve===f.WritingMode.vertical)&&!ue){Pn(be,K);continue}ue=!1;const Ae=new f.Point(me.tileAnchorX,me.tileAnchorY);let{x:Je,y:De,z:Ve}=L.projection.projectTilePoint(Ae.x,Ae.y,N.canonical);if(R){const[nn,Mt,Ut]=R(Ae);Je+=nn,De+=Mt,Ve+=Ut}const Re=[Je,De,Ve,1];if(f.transformMat4$1(Re,Re,c),!$i(Re,Q)){Pn(be,K);continue}const Qe=mr(h.transform.cameraToCenterDistance,Re[3]),Me=f.evaluateSizeForFeature(V,W,me),$e=M?Me/Qe:Me*Qe,tt=kr(Je,De,Ve,x);if(tt[3]<=0){Pn(be,K);continue}let We={};const Le=M?null:R,Pt=yt(me,$e,!1,I,c,x,C,g.glyphOffsetArray,U,K,ee,tt,Ae,We,ie,Le,L.projection,N,M);ue=Pt.useVertical,Le&&Pt.needsFlipping&&(We={}),(Pt.notEnoughRoom||ue||Pt.needsFlipping&&yt(me,$e,!0,I,c,x,C,g.glyphOffsetArray,U,K,ee,tt,Ae,We,ie,Le,L.projection,N,M).notEnoughRoom)&&Pn(be,K)}y?(g.text.dynamicLayoutVertexBuffer.updateData(K),ee&&g.text.globeExtVertexBuffer.updateData(ee)):(g.icon.dynamicLayoutVertexBuffer.updateData(K),ee&&g.icon.globeExtVertexBuffer.updateData(ee))}function sh(g,c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K){const{lineStartIndex:ee,glyphStartIndex:U,segment:Z}=I,ie=U+I.numGlyphs,re=ee+I.lineLength,ue=c.getoffsetX(U),ge=c.getoffsetX(ie-1),me=as(g*ue,h,y,x,C,M,Z,ee,re,R,N,L,V,W,!0,X,Q,K);if(!me)return null;const be=as(g*ge,h,y,x,C,M,Z,ee,re,R,N,L,V,W,!0,X,Q,K);return be?{first:me,last:be}:null}function Jn(g,c,h,y){return g===f.WritingMode.horizontal&&Math.abs(y)>Math.abs(h)?{useVertical:!0}:g===f.WritingMode.vertical?y>0?{needsFlipping:!0}:null:c!==Ba.unknown&&(0===(x=h)||Math.abs(y/x)>Gd)?c===Ba.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null;var x}function yt(g,c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K,ee,U,Z){const ie=c/24,re=g.lineOffsetX*ie,ue=g.lineOffsetY*ie,{lineStartIndex:ge,glyphStartIndex:me,numGlyphs:be,segment:ve,writingMode:Ae,flipState:Je}=g,De=ge+g.lineLength,Ve=Re=>{if(L){const[tt,We,Le]=Re.up,Pt=N.length;f.updateGlobeVertexNormal(L,Pt+0,tt,We,Le),f.updateGlobeVertexNormal(L,Pt+1,tt,We,Le),f.updateGlobeVertexNormal(L,Pt+2,tt,We,Le),f.updateGlobeVertexNormal(L,Pt+3,tt,We,Le)}const[Qe,Me,$e]=Re.point;f.addDynamicAttributes(N,Qe,Me,$e,Re.angle)};if(be>1){const Re=sh(ie,I,re,ue,h,V,W,g,R,C,X,K,!1,ee,U,Z);if(!Re)return{notEnoughRoom:!0};if(y&&!h){let[Qe,Me,$e]=Re.first.point,[tt,We,Le]=Re.last.point;[Qe,Me]=kr(Qe,Me,$e,M),[tt,We]=kr(tt,We,Le,M);const Pt=Jn(Ae,Je,(tt-Qe)*Q,We-Me);if(g.flipState=Pt&&Pt.needsFlipping?Ba.flipRequired:Ba.flipNotRequired,Pt)return Pt}Ve(Re.first);for(let Qe=me+1;Qe<me+be-1;Qe++){const Me=as(ie*I.getoffsetX(Qe),re,ue,h,V,W,ve,ge,De,R,C,X,K,!1,!1,ee,U,Z);if(!Me)return N.length-=4*(Qe-me),{notEnoughRoom:!0};Ve(Me)}Ve(Re.last)}else{if(y&&!h){const Qe=kr(W.x,W.y,0,x),Me=ge+ve+1,$e=new f.Point(R.getx(Me),R.gety(Me)),tt=kr($e.x,$e.y,0,x),We=tt[3]>0?tt:Cn(W,$e,Qe,1,x,void 0,ee,U.canonical),Le=Jn(Ae,Je,(We[0]-Qe[0])*Q,We[1]-Qe[1]);if(g.flipState=Le&&Le.needsFlipping?Ba.flipRequired:Ba.flipNotRequired,Le)return Le}const Re=as(ie*I.getoffsetX(me),re,ue,h,V,W,ve,ge,De,R,C,X,K,!1,!1,ee,U,Z);if(!Re)return{notEnoughRoom:!0};Ve(Re)}return{}}function Gt(g,c,h,y,x){const{x:C,y:M,z:I}=y.projectTilePoint(g.x,g.y,c);if(!x)return kr(C,M,I,h);const[R,N,L]=x(g);return kr(C+R,M+N,I+L,h)}function Cn(g,c,h,y,x,C,M,I){const R=Gt(g.sub(c)._unit()._add(g),I,x,M,C);return f.sub(R,h,R),f.normalize(R,R),f.scaleAndAdd(R,h,R,y)}function as(g,c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K,ee,U){const Z=y?g-c:g+c;let ie=Z>0?1:-1,re=0;y&&(ie*=-1,re=Math.PI),ie<0&&(re+=Math.PI);let ue=I+M+(ie>0?0:1)|0,ge=x,me=x,be=0,ve=0;const Ae=Math.abs(Z),Je=[],De=[];let Ve=C,Re=Ve;const Qe=()=>Cn(Re,Ve,me,Ae-be+1,L,W,K,ee.canonical);for(;be+ve<=Ae;){if(ue+=ie,ue<I||ue>=R)return null;if(me=ge,Re=Ve,Je.push(me),X&&De.push(Re),Ve=new f.Point(N.getx(ue),N.gety(ue)),ge=V[ue],!ge){const Ut=Gt(Ve,ee.canonical,L,K,W);ge=Ut[3]>0?V[ue]=Ut:Qe()}be+=ve,ve=f.distance(me,ge)}Q&&W&&(V[ue]&&(ge=Qe(),ve=f.distance(me,ge)),V[ue]=ge);const Me=(Ae-be)/ve,$e=Ve.sub(Re)._mult(Me)._add(Re),tt=f.sub([],ge,me),We=f.scaleAndAdd([],me,tt,Me);let Le=[0,0,1],Pt=tt[0],nn=tt[1];if(U&&(Le=K.upVector(ee.canonical,$e.x,$e.y),0!==Le[0]||0!==Le[1]||1!==Le[2])){const Ut=[Le[2],0,-Le[0]],On=f.cross([],Le,Ut);f.normalize(Ut,Ut),f.normalize(On,On),Pt=f.dot(tt,Ut),nn=f.dot(tt,On)}if(h){const Ut=f.cross([],Le,tt);f.normalize(Ut,Ut),f.scaleAndAdd(We,We,Ut,h*ie)}const Mt=re+Math.atan2(nn,Pt);return Je.push(We),X&&De.push($e),{point:We,angle:Mt,path:Je,tilePath:De,up:Le}}function Pn(g,c){const h=c.length,y=h+4*g;c.resize(y),c.float32.fill(-1/0,4*h,4*y)}function vt(g,c,h){const y=c[0],x=c[1];return g[0]=h[0]*y+h[4]*x+h[12],g[1]=h[1]*y+h[5]*x+h[13],g[3]=h[3]*y+h[7]*x+h[15],g}const Co=100;class tc{constructor(c,h,y=new ec(c.width+200,c.height+200,25),x=new ec(c.width+200,c.height+200,25)){this.transform=c,this.grid=y,this.ignoredGrid=x,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Co,this.screenBottomBoundary=c.height+Co,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=h}placeCollisionBox(c,h,y,x,C,M,I,R){let N=y.projectedAnchorX,L=y.projectedAnchorY,V=y.projectedAnchorZ;const W=y.elevation,X=y.tileID,Q=c.getProjection();if(W&&X){const[ge,me,be]=Q.upVector(X.canonical,y.tileAnchorX,y.tileAnchorY),ve=Q.upVectorScale(X.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;N+=ge*W*ve,L+=me*W*ve,V+=be*W*ve}const K=this.projectAndGetPerspectiveRatio(I,N,L,V,y.tileID,"globe"===Q.name||!!W||this.transform.pitch>0,Q),ee=M*K.perspectiveRatio,U=(y.x1*h+x.x-y.padding)*ee+K.point.x,Z=(y.y1*h+x.y-y.padding)*ee+K.point.y,ie=(y.x2*h+x.x+y.padding)*ee+K.point.x,re=(y.y2*h+x.y+y.padding)*ee+K.point.y,ue=K.perspectiveRatio<=.55||K.occluded;return!this.isInsideGrid(U,Z,ie,re)||!C&&this.grid.hitTest(U,Z,ie,re,R)||ue?{box:[],offscreen:!1,occluded:K.occluded}:{box:[U,Z,ie,re],offscreen:this.isOffscreen(U,Z,ie,re),occluded:!1}}placeCollisionCircles(c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K){const ee=[],U=this.transform.elevation,Z=c.getProjection(),ie=U?U.getAtTileOffsetFunc(K,this.transform.center.lat,this.transform.worldSize,Z):null,re=new f.Point(y.tileAnchorX,y.tileAnchorY);let{x:ue,y:ge,z:me}=Z.projectTilePoint(re.x,re.y,K.canonical);if(ie){const[$e,tt,We]=ie(re);ue+=$e,ge+=tt,me+=We}const be="globe"===Z.name,ve=this.projectAndGetPerspectiveRatio(I,ue,ge,me,K,be||!!U||this.transform.pitch>0,Z),{perspectiveRatio:Ae}=ve,Je=(V?M/Ae:M*Ae)/f.ONE_EM,De=kr(ue,ge,me,R),Ve=ve.signedDistanceFromCamera>0?sh(Je,C,y.lineOffsetX*Je,y.lineOffsetY*Je,!1,De,re,y,x,R,{},U&&!V?ie:null,V&&!!U,Z,K,V):null;let Re=!1,Qe=!1,Me=!0;if(Ve&&!ve.occluded){const $e=.5*X*Ae+Q,tt=new f.Point(-100,-100),We=new f.Point(this.screenRightBoundary,this.screenBottomBoundary),Le=new rh,{first:Pt,last:nn}=Ve,Mt=Pt.path.length;let Ut=[];for(let At=Mt-1;At>=1;At--)Ut.push(Pt.path[At]);for(let At=1;At<nn.path.length;At++)Ut.push(nn.path[At]);const On=2.5*$e;N&&(Ut=Ut.map(([At,oi,mi],gi)=>(ie&&!be&&(mi=ie(gi<Mt-1?Pt.tilePath[Mt-1-gi]:nn.tilePath[gi-Mt+2])[2]),kr(At,oi,mi,N))),Ut.some(At=>At[3]<=0)&&(Ut=[]));let Sn=[];if(Ut.length>0){let At=1/0,oi=-1/0,mi=1/0,gi=-1/0;for(const _i of Ut)At=Math.min(At,_i[0]),mi=Math.min(mi,_i[1]),oi=Math.max(oi,_i[0]),gi=Math.max(gi,_i[1]);oi>=tt.x&&At<=We.x&&gi>=tt.y&&mi<=We.y&&(Sn=[Ut.map(_i=>new f.Point(_i[0],_i[1]))],(At<tt.x||oi>We.x||mi<tt.y||gi>We.y)&&(Sn=f.clipLine(Sn,tt.x,tt.y,We.x,We.y)))}for(const At of Sn){Le.reset(At,.25*$e);let oi=0;oi=Le.length<=.5*$e?1:Math.ceil(Le.paddedLength/On)+1;for(let mi=0;mi<oi;mi++){const gi=mi/Math.max(oi-1,1),_i=Le.lerp(gi),co=_i.x+Co,qe=_i.y+Co;ee.push(co,qe,$e,0);const Mn=co-$e,ti=qe-$e,on=co+$e,bn=qe+$e;if(Me=Me&&this.isOffscreen(Mn,ti,on,bn),Qe=Qe||this.isInsideGrid(Mn,ti,on,bn),!h&&this.grid.hitTestCircle(co,qe,$e,W)&&(Re=!0,!L))return{circles:[],offscreen:!1,collisionDetected:Re,occluded:!1}}}}return{circles:!L&&Re||!Qe?[]:ee,offscreen:Me,collisionDetected:Re,occluded:ve.occluded}}queryRenderedSymbols(c){if(0===c.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const h=[];let y=1/0,x=1/0,C=-1/0,M=-1/0;for(const L of c){const V=new f.Point(L.x+Co,L.y+Co);y=Math.min(y,V.x),x=Math.min(x,V.y),C=Math.max(C,V.x),M=Math.max(M,V.y),h.push(V)}const I=this.grid.query(y,x,C,M).concat(this.ignoredGrid.query(y,x,C,M)),R={},N={};for(const L of I){const V=L.key;if(void 0===R[V.bucketInstanceId]&&(R[V.bucketInstanceId]={}),R[V.bucketInstanceId][V.featureIndex])continue;const W=[new f.Point(L.x1,L.y1),new f.Point(L.x2,L.y1),new f.Point(L.x2,L.y2),new f.Point(L.x1,L.y2)];f.polygonIntersectsPolygon(h,W)&&(R[V.bucketInstanceId][V.featureIndex]=!0,void 0===N[V.bucketInstanceId]&&(N[V.bucketInstanceId]=[]),N[V.bucketInstanceId].push(V.featureIndex))}return N}insertCollisionBox(c,h,y,x,C){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:x,collisionGroupID:C},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,h,y,x,C){const M=h?this.ignoredGrid:this.grid,I={bucketInstanceId:y,featureIndex:x,collisionGroupID:C};for(let R=0;R<c.length;R+=4)M.insertCircle(I,c[R],c[R+1],c[R+2])}projectAndGetPerspectiveRatio(c,h,y,x,C,M,I){const R=[h,y,x,1];let N=!1;x||this.transform.pitch>0?(f.transformMat4$1(R,R,c),this.fogState&&C&&"globe"!==I.name&&(N=function(W,X,Q,K,ee,U){const Z=U.calculateFogTileMatrix(ee),ie=[X,Q,K];return f.transformMat4(ie,ie,Z),He(W,ie,U.pitch,U._fov)}(this.fogState,h,y,x,C.toUnwrapped(),this.transform)>.9)):vt(R,R,c);const L=R[3];return{point:new f.Point((R[0]/L+1)/2*this.transform.width+Co,(-R[1]/L+1)/2*this.transform.height+Co),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/L*.5,1.5),signedDistanceFromCamera:L,occluded:M&&R[2]>L||N}}isOffscreen(c,h,y,x){return y<Co||c>=this.screenRightBoundary||x<Co||h>this.screenBottomBoundary}isInsideGrid(c,h,y,x){return y>=0&&c<this.gridRightBoundary&&x>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const c=f.identity([]);return f.translate(c,c,[-100,-100,0]),c}}function jc(g,c,h){const y=c.createTileMatrix(g,g.worldSize,h.toUnwrapped());return f.multiply(new Float32Array(16),g.projMatrix,y)}function ls(g,c,h){if(c.projection.name===h.projection.name)return g.projMatrix;const y=h.clone();return y.setProjection(c.projection),jc(y,c.getProjection(),g)}function ke(g,c,h){return c.name===h.projection.name?g.projMatrix:jc(h,c,g)}class qd{constructor(c,h,y,x){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?h:-h))):x&&y?1:0,this.placed=y}isHidden(){return 0===this.opacity&&!this.placed}}class Qt{constructor(c,h,y,x,C,M=!1){this.text=new qd(c?c.text:null,h,y,C),this.icon=new qd(c?c.icon:null,h,x,C),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qn{constructor(c,h,y,x=!1){this.text=c,this.icon=h,this.skipFade=y,this.clipped=x}}class Wd{constructor(){this.invProjMatrix=f.create(),this.viewportMatrix=f.create(),this.circles=[]}}class Sm{constructor(c,h,y,x,C){this.bucketInstanceId=c,this.featureIndex=h,this.sourceLayerIndex=y,this.bucketIndex=x,this.tileID=C}}class Mm{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const h=++this.maxGroupID;this.collisionGroups[c]={ID:h,predicate:y=>y.collisionGroupID===h}}return this.collisionGroups[c]}}function _l(g,c,h,y,x){const{horizontalAlign:C,verticalAlign:M}=f.getAnchorAlignment(g),I=-(C-.5)*c,R=-(M-.5)*h,N=f.evaluateVariableOffset(g,y);return new f.Point(I+N[0]*x,R+N[1]*x)}function $r(g,c,h,y,x){const C=new f.Point(g,c);return h&&C._rotate(y?x:-x),C}class Rp{constructor(c,h,y,x,C){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new tc(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Mm(y),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,h,y,x){const C=y.getBucket(h),M=y.latestFeatureIndex;if(!C||!M||h.id!==C.layerIds[0])return;const I=C.layers[0].layout,R=y.collisionBoxArray,N=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),L=y.tileSize/f.EXTENT,V=y.tileID.toUnwrapped();this.transform.setProjection(C.projection);const W=(X=y.tileID,Q=C.getProjection(),K=this.transform,Q.name===this.projection?K.calculateProjMatrix(X.toUnwrapped()):jc(K,Q,X));var X,Q,K;const ee="map"===I.get("text-pitch-alignment"),U="map"===I.get("text-rotation-alignment");h.compileFilter();const Z=h.dynamicFilter(),ie=h.dynamicFilterNeedsFeature(),re=this.transform.calculatePixelsToTileUnitsMatrix(y),ue=da(W,y.tileID.canonical,ee,U,this.transform,C.getProjection(),re);let ge=null;if(ee){const ve=fr(W,y.tileID.canonical,ee,U,this.transform,C.getProjection(),re);ge=f.multiply([],this.transform.labelPlaneMatrix,ve)}let me=null;Z&&y.latestFeatureIndex&&(me={unwrappedTileID:V,dynamicFilter:Z,dynamicFilterNeedsFeature:ie,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new Sm(C.bucketInstanceId,M,C.sourceLayerIndex,C.index,y.tileID);const be={bucket:C,layout:I,posMatrix:W,textLabelPlaneMatrix:ue,labelToScreenMatrix:ge,clippingData:me,scale:N,textPixelRatio:L,holdingForFade:y.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:f.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:f.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(x)for(const ve of C.sortKeyRanges){const{sortKey:Ae,symbolInstanceStart:Je,symbolInstanceEnd:De}=ve;c.push({sortKey:Ae,symbolInstanceStart:Je,symbolInstanceEnd:De,parameters:be})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:be})}attemptAnchorPlacement(c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K,ee,U,Z){const{textOffset0:ie,textOffset1:re,crossTileID:ue}=W,ge=[ie,re],me=_l(c,y,x,ge,C),be=this.collisionIndex.placeCollisionBox(Q,C,h,$r(me.x,me.y,M,I,this.transform.angle),V,R,N,L.predicate);if(ee){const ve=Q.getSymbolInstanceIconSize(Z,this.transform.zoom,W.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Q,ve,ee,$r(me.x,me.y,M,I,this.transform.angle),V,R,N,L.predicate).box.length)return}if(be.box.length>0){let ve;return this.prevPlacement&&this.prevPlacement.variableOffsets[ue]&&this.prevPlacement.placements[ue]&&this.prevPlacement.placements[ue].text&&(ve=this.prevPlacement.variableOffsets[ue].anchor),this.variableOffsets[ue]={textOffset:ge,width:y,height:x,anchor:c,textScale:C,prevAnchor:ve},this.markUsedJustification(Q,c,W,K),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,K,W),this.placedOrientations[ue]=K),{shift:me,placedGlyphBoxes:be}}}placeLayerBucketPart(c,h,y,x){const{bucket:C,layout:M,posMatrix:I,textLabelPlaneMatrix:R,labelToScreenMatrix:N,clippingData:L,textPixelRatio:V,holdingForFade:W,collisionBoxArray:X,partiallyEvaluatedTextSize:Q,partiallyEvaluatedIconSize:K,collisionGroup:ee}=c.parameters,U=M.get("text-optional"),Z=M.get("icon-optional"),ie=M.get("text-allow-overlap"),re=M.get("icon-allow-overlap"),ue="map"===M.get("text-rotation-alignment"),ge="map"===M.get("text-pitch-alignment"),me="none"!==M.get("icon-text-fit"),be="viewport-y"===M.get("symbol-z-order");this.transform.setProjection(C.projection);let ve=ie&&(re||!C.hasIconData()||Z),Ae=re&&(ie||!C.hasTextData()||U);!C.collisionArrays&&X&&C.deserializeCollisionBoxes(X),y&&x&&C.updateCollisionDebugBuffers(this.transform.zoom,X);const Je=(De,Ve,Re)=>{const{crossTileID:Qe,numVerticalGlyphVertices:Me}=De;if(L){const on={zoom:this.transform.zoom,pitch:this.transform.pitch};let bn=null;if(L.dynamicFilterNeedsFeature){const Yn=this.retainedQueryData[C.bucketInstanceId];bn=L.featureIndex.loadFeature({featureIndex:De.featureIndex,bucketIndex:Yn.bucketIndex,sourceLayerIndex:Yn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,L.dynamicFilter)(on,bn,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new f.Point(De.tileAnchorX,De.tileAnchorY),this.transform.calculateDistanceTileData(L.unwrappedTileID)))return this.placements[Qe]=new Qn(!1,!1,!1,!0),void h.add(Qe)}if(h.has(Qe))return;if(W)return void(this.placements[Qe]=new Qn(!1,!1,!1));let $e=!1,tt=!1,We=!0,Le=!1,Pt=!1,nn=null,Mt={box:null,offscreen:null,occluded:null},Ut={box:null,offscreen:null,occluded:null},On=null,Sn=null,At=null,oi=0,mi=0,gi=0;Re.textFeatureIndex?oi=Re.textFeatureIndex:De.useRuntimeCollisionCircles&&(oi=De.featureIndex),Re.verticalTextFeatureIndex&&(mi=Re.verticalTextFeatureIndex);const _i=on=>{on.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const bn=this.transform.elevation;(bn||on.elevation)&&(on.elevation=bn?bn.getAtTileOffset(on.tileID,on.tileAnchorX,on.tileAnchorY):0)},co=Re.textBox;if(co){_i(co);const on=Yn=>{let Gi=f.WritingMode.horizontal;if(C.allowVerticalPlacement&&!Yn&&this.prevPlacement){const Ji=this.prevPlacement.placedOrientations[Qe];Ji&&(this.placedOrientations[Qe]=Ji,Gi=Ji,this.markUsedOrientation(C,Gi,De))}return Gi},bn=(Yn,Gi)=>{if(C.allowVerticalPlacement&&Me>0&&Re.verticalTextBox){for(const Ji of C.writingModes)if(Ji===f.WritingMode.vertical?(Mt=Gi(),Ut=Mt):Mt=Yn(),Mt&&Mt.box&&Mt.box.length)break}else Mt=Yn()};if(M.get("text-variable-anchor")){let Yn=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Qe]){const Si=this.prevPlacement.variableOffsets[Qe];Yn.indexOf(Si.anchor)>0&&(Yn=Yn.filter(uo=>uo!==Si.anchor),Yn.unshift(Si.anchor))}const Gi=(Si,uo,Sh)=>{const rd=C.getSymbolInstanceTextSize(Q,De,this.transform.zoom,Ve),od=(Si.x2-Si.x1)*rd+2*Si.padding,ir=(Si.y2-Si.y1)*rd+2*Si.padding,ho=me&&!re?uo:null;ho&&_i(ho);let El={box:[],offscreen:!1,occluded:!1};const Ga=ie?2*Yn.length:Yn.length;for(let ps=0;ps<Ga;++ps){const ef=this.attemptAnchorPlacement(Yn[ps%Yn.length],Si,od,ir,rd,ue,ge,V,I,ee,ps>=Yn.length,De,Ve,C,Sh,ho,Q,K);if(ef&&(El=ef.placedGlyphBoxes,El&&El.box&&El.box.length)){$e=!0,nn=ef.shift;break}}return El};bn(()=>Gi(co,Re.iconBox,f.WritingMode.horizontal),()=>{const Si=Re.verticalTextBox;return Si&&_i(Si),C.allowVerticalPlacement&&!(Mt&&Mt.box&&Mt.box.length)&&Me>0&&Si?Gi(Si,Re.verticalIconBox,f.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Mt&&($e=Mt.box,We=Mt.offscreen,Le=Mt.occluded);const Ji=on(!(!Mt||!Mt.box));if(!$e&&this.prevPlacement){const Si=this.prevPlacement.variableOffsets[Qe];Si&&(this.variableOffsets[Qe]=Si,this.markUsedJustification(C,Si.anchor,De,Ji))}}else{const Yn=(Gi,Ji)=>{const Si=C.getSymbolInstanceTextSize(Q,De,this.transform.zoom,Ve),uo=this.collisionIndex.placeCollisionBox(C,Si,Gi,new f.Point(0,0),ie,V,I,ee.predicate);return uo&&uo.box&&uo.box.length&&(this.markUsedOrientation(C,Ji,De),this.placedOrientations[Qe]=Ji),uo};bn(()=>Yn(co,f.WritingMode.horizontal),()=>{const Gi=Re.verticalTextBox;return C.allowVerticalPlacement&&Me>0&&Gi?(_i(Gi),Yn(Gi,f.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),on(!!(Mt&&Mt.box&&Mt.box.length))}}if(On=Mt,$e=On&&On.box&&On.box.length>0,We=On&&On.offscreen,Le=On&&On.occluded,De.useRuntimeCollisionCircles){const on=C.text.placedSymbolArray.get(De.centerJustifiedTextSymbolIndex>=0?De.centerJustifiedTextSymbolIndex:De.verticalPlacedTextSymbolIndex),bn=f.evaluateSizeForFeature(C.textSizeData,Q,on),Yn=M.get("text-padding");Sn=this.collisionIndex.placeCollisionCircles(C,ie,on,C.lineVertexArray,C.glyphOffsetArray,bn,I,R,N,y,ge,ee.predicate,De.collisionCircleDiameter*bn/f.ONE_EM,Yn,this.retainedQueryData[C.bucketInstanceId].tileID),$e=ie||Sn.circles.length>0&&!Sn.collisionDetected,We=We&&Sn.offscreen,Le=Sn.occluded}if(Re.iconFeatureIndex&&(gi=Re.iconFeatureIndex),Re.iconBox){const on=bn=>{_i(bn);const Yn=me&&nn?$r(nn.x,nn.y,ue,ge,this.transform.angle):new f.Point(0,0),Gi=C.getSymbolInstanceIconSize(K,this.transform.zoom,De.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Gi,bn,Yn,re,V,I,ee.predicate)};Ut&&Ut.box&&Ut.box.length&&Re.verticalIconBox?(At=on(Re.verticalIconBox),tt=At.box.length>0):(At=on(Re.iconBox),tt=At.box.length>0),We=We&&At.offscreen,Pt=At.occluded}const qe=U||0===De.numHorizontalGlyphVertices&&0===Me,Mn=Z||0===De.numIconVertices;if(qe||Mn?Mn?qe||(tt=tt&&$e):$e=tt&&$e:tt=$e=tt&&$e,$e&&On&&On.box&&this.collisionIndex.insertCollisionBox(On.box,M.get("text-ignore-placement"),C.bucketInstanceId,Ut&&Ut.box&&mi?mi:oi,ee.ID),tt&&At&&this.collisionIndex.insertCollisionBox(At.box,M.get("icon-ignore-placement"),C.bucketInstanceId,gi,ee.ID),Sn&&($e&&this.collisionIndex.insertCollisionCircles(Sn.circles,M.get("text-ignore-placement"),C.bucketInstanceId,oi,ee.ID),y)){const on=C.bucketInstanceId;let bn=this.collisionCircleArrays[on];void 0===bn&&(bn=this.collisionCircleArrays[on]=new Wd);for(let Yn=0;Yn<Sn.circles.length;Yn+=4)bn.circles.push(Sn.circles[Yn+0]),bn.circles.push(Sn.circles[Yn+1]),bn.circles.push(Sn.circles[Yn+2]),bn.circles.push(Sn.collisionDetected?1:0)}const ti="globe"!==C.projection.name;ve=ve&&(ti||!Le),Ae=Ae&&(ti||!Pt),this.placements[Qe]=new Qn($e||ve,tt||Ae,We||C.justReloaded),h.add(Qe)};if(be){const De=C.getSortedSymbolIndexes(this.transform.angle);for(let Ve=De.length-1;Ve>=0;--Ve){const Re=De[Ve];Je(C.symbolInstances.get(Re),Re,C.collisionArrays[Re])}}else for(let De=c.symbolInstanceStart;De<c.symbolInstanceEnd;De++)Je(C.symbolInstances.get(De),De,C.collisionArrays[De]);if(y&&C.bucketInstanceId in this.collisionCircleArrays){const De=this.collisionCircleArrays[C.bucketInstanceId];f.invert(De.invProjMatrix,I),De.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(c,h,y,x){const{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:R,crossTileID:N}=y,L=f.getAnchorJustification(h),V=x===f.WritingMode.vertical?R:"left"===L?C:"center"===L?M:"right"===L?I:-1;C>=0&&(c.text.placedSymbolArray.get(C).crossTileID=V>=0&&C!==V?0:N),M>=0&&(c.text.placedSymbolArray.get(M).crossTileID=V>=0&&M!==V?0:N),I>=0&&(c.text.placedSymbolArray.get(I).crossTileID=V>=0&&I!==V?0:N),R>=0&&(c.text.placedSymbolArray.get(R).crossTileID=V>=0&&R!==V?0:N)}markUsedOrientation(c,h,y){const x=h===f.WritingMode.horizontal||h===f.WritingMode.horizontalOnly?h:0,C=h===f.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:N}=y,L=c.text.placedSymbolArray;M>=0&&(L.get(M).placedOrientation=x),I>=0&&(L.get(I).placedOrientation=x),R>=0&&(L.get(R).placedOrientation=x),N>=0&&(L.get(N).placedOrientation=C)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let y=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const x=h?h.symbolFadeChange(c):1,C=h?h.opacities:{},M=h?h.variableOffsets:{},I=h?h.placedOrientations:{};for(const R in this.placements){const N=this.placements[R],L=C[R];L?(this.opacities[R]=new Qt(L,x,N.text,N.icon,null,N.clipped),y=y||N.text!==L.text.placed||N.icon!==L.icon.placed):(this.opacities[R]=new Qt(null,x,N.text,N.icon,N.skipFade,N.clipped),y=y||N.text||N.icon)}for(const R in C){const N=C[R];if(!this.opacities[R]){const L=new Qt(N,x,!1,!1);L.isHidden()||(this.opacities[R]=L,y=y||N.text.placed||N.icon.placed)}}for(const R in M)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=M[R]);for(const R in I)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=I[R]);y?this.lastPlacementChangeTime=c:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:c)}updateLayerOpacities(c,h){const y=new Set;for(const x of h){const C=x.getBucket(c);C&&x.latestFeatureIndex&&c.id===C.layerIds[0]&&this.updateBucketOpacities(C,y,x.collisionBoxArray)}}updateBucketOpacities(c,h,y){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const x=c.layers[0].layout,C=!!c.layers[0].dynamicFilter(),M=new Qt(null,0,!1,!1,!0),I=x.get("text-allow-overlap"),R=x.get("icon-allow-overlap"),N=x.get("text-variable-anchor"),L="map"===x.get("text-rotation-alignment"),V="map"===x.get("text-pitch-alignment"),W="none"!==x.get("icon-text-fit"),X=new Qt(null,0,I&&(R||!c.hasIconData()||x.get("icon-optional")),R&&(I||!c.hasTextData()||x.get("text-optional")),!0);!c.collisionArrays&&y&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(y);const Q=(ee,U,Z)=>{for(let ie=0;ie<U/4;ie++)ee.opacityVertexArray.emplaceBack(Z)};let K=0;for(let ee=0;ee<c.symbolInstances.length;ee++){const U=c.symbolInstances.get(ee),{numHorizontalGlyphVertices:Z,numVerticalGlyphVertices:ie,crossTileID:re,numIconVertices:ue}=U,ge=h.has(re);let me=this.opacities[re];ge?me=M:me||(me=X,this.opacities[re]=me),h.add(re);const be=Z>0||ie>0,ve=ue>0,Ae=this.placedOrientations[re],Je=Ae===f.WritingMode.vertical,De=Ae===f.WritingMode.horizontal||Ae===f.WritingMode.horizontalOnly;if(!be&&!ve||me.isHidden()||K++,be){const Ve=ah(me.text);Q(c.text,Z,Je?Qi:Ve),Q(c.text,ie,De?Qi:Ve);const Re=me.text.isHidden(),{leftJustifiedTextSymbolIndex:Qe,centerJustifiedTextSymbolIndex:Me,rightJustifiedTextSymbolIndex:$e,verticalPlacedTextSymbolIndex:tt}=U,We=c.text.placedSymbolArray,Le=Re||Je?1:0;Qe>=0&&(We.get(Qe).hidden=Le),Me>=0&&(We.get(Me).hidden=Le),$e>=0&&(We.get($e).hidden=Le),tt>=0&&(We.get(tt).hidden=Re||De?1:0);const Pt=this.variableOffsets[re];Pt&&this.markUsedJustification(c,Pt.anchor,U,Ae);const nn=this.placedOrientations[re];nn&&(this.markUsedJustification(c,"left",U,nn),this.markUsedOrientation(c,nn,U))}if(ve){const Ve=ah(me.icon),{placedIconSymbolIndex:Re,verticalPlacedIconSymbolIndex:Qe}=U,Me=c.icon.placedSymbolArray,$e=me.icon.isHidden()?1:0;Re>=0&&(Q(c.icon,ue,Je?Qi:Ve),Me.get(Re).hidden=$e),Qe>=0&&(Q(c.icon,U.numVerticalIconVertices,De?Qi:Ve),Me.get(Qe).hidden=$e)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const Ve=c.collisionArrays[ee];if(Ve){let Re=new f.Point(0,0),Qe=!0;if(Ve.textBox||Ve.verticalTextBox){if(N){const $e=this.variableOffsets[re];$e?(Re=_l($e.anchor,$e.width,$e.height,$e.textOffset,$e.textScale),L&&Re._rotate(V?this.transform.angle:-this.transform.angle)):Qe=!1}C&&(Qe=!me.clipped),Ve.textBox&&Hc(c.textCollisionBox.collisionVertexArray,me.text.placed,!Qe||Je,Re.x,Re.y),Ve.verticalTextBox&&Hc(c.textCollisionBox.collisionVertexArray,me.text.placed,!Qe||De,Re.x,Re.y)}const Me=Qe&&!(De||!Ve.verticalIconBox);Ve.iconBox&&Hc(c.iconCollisionBox.collisionVertexArray,me.icon.placed,Me,W?Re.x:0,W?Re.y:0),Ve.verticalIconBox&&Hc(c.iconCollisionBox.collisionVertexArray,me.icon.placed,!Me,W?Re.x:0,W?Re.y:0)}}}if(c.fullyClipped=0===K,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const ee=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ee.invProjMatrix,c.placementViewportMatrix=ee.viewportMatrix,c.collisionCircleArray=ee.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return 0===this.fadeDuration?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,h){const y=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*y>c}setStale(){this.stale=!0}}function Hc(g,c,h,y,x){g.emplaceBack(c?1:0,h?1:0,y||0,x||0),g.emplaceBack(c?1:0,h?1:0,y||0,x||0),g.emplaceBack(c?1:0,h?1:0,y||0,x||0),g.emplaceBack(c?1:0,h?1:0,y||0,x||0)}const cs=Math.pow(2,25),Di=Math.pow(2,24),Tm=Math.pow(2,17),Am=Math.pow(2,16),ds=Math.pow(2,9),Ws=Math.pow(2,8),Im=Math.pow(2,1);function ah(g){if(0===g.opacity&&!g.placed)return 0;if(1===g.opacity&&g.placed)return 4294967295;const c=g.placed?1:0,h=Math.floor(127*g.opacity);return h*cs+c*Di+h*Tm+c*Am+h*ds+c*Ws+h*Im+c}const Qi=0;class lh{constructor(c){this._sortAcrossTiles="viewport-y"!==c.layout.get("symbol-z-order")&&void 0!==c.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(c,h,y,x,C){const M=this._bucketParts;for(;this._currentTileIndex<c.length;)if(h.getBucketParts(M,x,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((I,R)=>I.sortKey-R.sortKey));this._currentPartIndex<M.length;){const I=M[this._currentPartIndex];if(h.placeLayerBucketPart(I,this._seenCrossTileIDs,y,0===I.symbolInstanceStart),this._currentPartIndex++,C())return!0}return!1}}class Uo{constructor(c,h,y,x,C,M,I,R){this.placement=new Rp(c,C,M,I,R),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(c,h,y){const x=f.exported.now(),C=()=>{const M=f.exported.now()-x;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=h[c[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if("symbol"===M.type&&(!M.minzoom||M.minzoom<=I)&&(!M.maxzoom||M.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new lh(M)),this._inProgressLayer.continuePlacement(y[M.source],this.placement,this._showCollisionBoxes,M,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Zn=512/f.EXTENT/2;class so{constructor(c,h,y){this.tileID=c,this.bucketInstanceId=y,this.index=new f.KDBush(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=c.canonical.x*f.EXTENT,C=c.canonical.y*f.EXTENT;for(let M=0;M<h.length;M++){const{key:I,crossTileID:R,tileAnchorX:N,tileAnchorY:L}=h.get(M),V=Math.floor((x+N)*Zn),W=Math.floor((C+L)*Zn);this.index.add(V,W),this.keys.push(I),this.crossTileIDs.push(R)}this.index.finish()}findMatches(c,h,y){const x=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),C=Zn/Math.pow(2,h.canonical.z-this.tileID.canonical.z),M=h.canonical.x*f.EXTENT,I=h.canonical.y*f.EXTENT;for(let R=0;R<c.length;R++){const N=c.get(R);if(N.crossTileID)continue;const{key:L,tileAnchorX:V,tileAnchorY:W}=N,X=Math.floor((M+V)*C),Q=Math.floor((I+W)*C),K=this.index.range(X-x,Q-x,X+x,Q+x);for(const ee of K){const U=this.crossTileIDs[ee];if(this.keys[ee]===L&&!y.has(U)){y.add(U),N.crossTileID=U;break}}}}}class km{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Rm{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const h=Math.round((c-this.lng)/360);if(0!==h)for(const y in this.indexes){const x=this.indexes[y],C={};for(const M in x){const I=x[M];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+h),C[I.tileID.key]=I}this.indexes[y]=C}this.lng=c}addBucket(c,h,y){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let C=0;C<h.symbolInstances.length;C++)h.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]=new Set);const x=this.usedCrossTileIDs[c.overscaledZ];for(const C in this.indexes){const M=this.indexes[C];if(Number(C)>c.overscaledZ)for(const I in M){const R=M[I];R.tileID.isChildOf(c)&&R.findMatches(h.symbolInstances,c,x)}else{const I=M[c.scaledTo(Number(C)).key];I&&I.findMatches(h.symbolInstances,c,x)}}for(let C=0;C<h.symbolInstances.length;C++){const M=h.symbolInstances.get(C);M.crossTileID||(M.crossTileID=y.generate(),x.add(M.crossTileID))}return void 0===this.indexes[c.overscaledZ]&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new so(c,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(c,h){for(const y of h.crossTileIDs)this.usedCrossTileIDs[c].delete(y)}removeStaleBuckets(c){let h=!1;for(const y in this.indexes){const x=this.indexes[y];for(const C in x)c[x[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,x[C]),delete x[C],h=!0)}return h}}class at{constructor(){this.layerIndexes={},this.crossTileIDs=new km,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,h,y,x){let C=this.layerIndexes[c.id];void 0===C&&(C=this.layerIndexes[c.id]=new Rm);let M=!1;const I={};"globe"!==x.name&&C.handleWrapJump(y);for(const R of h){const N=R.getBucket(c);N&&c.id===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(R.tileID,N,this.crossTileIDs)&&(M=!0),I[N.bucketInstanceId]=!0)}return C.removeStaleBuckets(I)&&(M=!0),M}pruneUnusedLayers(c){const h={};c.forEach(y=>{h[y]=!0});for(const y in this.layerIndexes)h[y]||delete this.layerIndexes[y]}}const nc=(g,c)=>f.emitValidationErrors(g,c&&c.filter(h=>"source.canvas"!==h.identifier)),pn=f.pick(ii,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ch=f.pick(ii,["setCenter","setZoom","setBearing","setPitch"]),Pp={version:8,layers:[],sources:{}},ic={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ua extends f.Evented{constructor(c,h={}){super(),this.map=c,this.dispatcher=new Vt(Ki(),this),this.imageManager=new Pa,this.imageManager.setEventedParent(this),this.glyphManager=new f.GlyphManager(c._requestManager,h.localFontFamily?f.LocalGlyphMode.all:h.localIdeographFontFamily?f.LocalGlyphMode.ideographs:f.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new at,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",f.getReferrer());const y=this;this._rtlTextPluginCallback=ua.registerForPluginStateChange(x=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(C,M)=>{if(f.triggerPluginCompletionEvent(C),M&&M.every(I=>I))for(const I in y._sourceCaches){const R=y._sourceCaches[I],N=R.getSource().type;"vector"!==N&&"geojson"!==N||R.reload()}})}),this.on("data",x=>{if("source"!==x.dataType||"metadata"!==x.sourceDataType)return;const C=this.getSource(x.sourceId);if(C&&C.vectorLayerIds)for(const M in this._layers){const I=this._layers[M];I.source===C.id&&this._validateLayer(I)}})}loadURL(c,h={}){this.fire(new f.Event("dataloading",{dataType:"style"}));const y="boolean"==typeof h.validate?h.validate:!f.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,h.accessToken);const x=this.map._requestManager.transformRequest(c,f.ResourceType.Style);this._request=f.getJSON(x,(C,M)=>{this._request=null,C?this.fire(new f.ErrorEvent(C)):M&&this._load(M,y)})}loadJSON(c,h={}){this.fire(new f.Event("dataloading",{dataType:"style"})),this._request=f.exported.frame(()=>{this._request=null,this._load(c,!1!==h.validate)})}loadEmpty(){this.fire(new f.Event("dataloading",{dataType:"style"})),this._load(Pp,!1)}_updateLayerCount(c,h){const y=h?1:-1;c.is3D()&&(this._num3DLayers+=y),"circle"===c.type&&(this._numCircleLayers+=y),"symbol"===c.type&&(this._numSymbolLayers+=y)}_load(c,h){if(h&&nc(this,f.validateStyle(c)))return;this._loaded=!0,this.stylesheet=f.clone$1(c),this._updateMapProjection();for(const x in c.sources)this.addSource(x,c.sources[x],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const y=Es(this.stylesheet.layers);this._order=y.map(x=>x.id),this._layers={},this._serializedLayers={};for(const x of y){const C=f.createStyleLayer(x);C.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ei(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new f.Event("data",{dataType:"style"})),this.fire(new f.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(c){this._spriteRequest=function(h,y,x){let C,M,I;const R=f.exported.devicePixelRatio>1?"@2x":"";let N=f.getJSON(y.transformRequest(y.normalizeSpriteURL(h,R,".json"),f.ResourceType.SpriteJSON),(W,X)=>{N=null,I||(I=W,C=X,V())}),L=f.getImage(y.transformRequest(y.normalizeSpriteURL(h,R,".png"),f.ResourceType.SpriteImage),(W,X)=>{L=null,I||(I=W,M=X,V())});function V(){if(I)x(I);else if(C&&M){const W=f.exported.getImageData(M),X={};for(const Q in C){const{width:K,height:ee,x:U,y:Z,sdf:ie,pixelRatio:re,stretchX:ue,stretchY:ge,content:me}=C[Q],be=new f.RGBAImage({width:K,height:ee});f.RGBAImage.copy(W,be,{x:U,y:Z},{x:0,y:0},{width:K,height:ee}),X[Q]={data:be,pixelRatio:re,sdf:ie,stretchX:ue,stretchY:ge,content:me}}x(null,X)}}return{cancel(){N&&(N.cancel(),N=null),L&&(L.cancel(),L=null)}}}(c,this.map._requestManager,(h,y)=>{if(this._spriteRequest=null,h)this.fire(new f.ErrorEvent(h));else if(y)for(const x in y)this.imageManager.addImage(x,y[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new f.Event("data",{dataType:"style"}))})}_validateLayer(c){const h=this.getSource(c.source);if(!h)return;const y=c.sourceLayer;y&&("geojson"===h.type||h.vectorLayerIds&&-1===h.vectorLayerIds.indexOf(y))&&this.fire(new f.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${h.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const h=[];for(const y of c){const x=this._layers[y];"custom"!==x.type&&h.push(x.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&("function"==typeof c.isLayerDraped?c.isLayerDraped():ic[c.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const h=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(x.length||C.length)&&this._updateWorkerLayers(x,C);for(const M in this._updatedSources){const I=this._updatedSources[M];"reload"===I?this._reloadSource(M):"clear"===I&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const y={};for(const x in this._sourceCaches){const C=this._sourceCaches[x];y[x]=C.used,C.used=!1}for(const x of this._order){const C=this._layers[x];if(C.recalculate(c,this._availableImages),!C.isHidden(c.zoom)){const I=this._getLayerSourceCache(C);I&&(I.used=!0)}const M=this.map.painter;if(M){const I=C.getProgramIds();if(!I)continue;const R=C.getProgramConfiguration(c.zoom);for(const N of I)M.useProgram(N,R)}}for(const x in y){const C=this._sourceCaches[x];y[x]!==C.used&&C.getSource().fire(new f.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new f.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),nc(this,f.validateStyle(c)))return!1;(c=f.clone$1(c)).layers=Es(c.layers);const h=function(x,C){if(!x)return[{command:ii.setStyle,args:[C]}];let M=[];try{if(!Ie(x.version,C.version))return[{command:ii.setStyle,args:[C]}];Ie(x.center,C.center)||M.push({command:ii.setCenter,args:[C.center]}),Ie(x.zoom,C.zoom)||M.push({command:ii.setZoom,args:[C.zoom]}),Ie(x.bearing,C.bearing)||M.push({command:ii.setBearing,args:[C.bearing]}),Ie(x.pitch,C.pitch)||M.push({command:ii.setPitch,args:[C.pitch]}),Ie(x.sprite,C.sprite)||M.push({command:ii.setSprite,args:[C.sprite]}),Ie(x.glyphs,C.glyphs)||M.push({command:ii.setGlyphs,args:[C.glyphs]}),Ie(x.transition,C.transition)||M.push({command:ii.setTransition,args:[C.transition]}),Ie(x.light,C.light)||M.push({command:ii.setLight,args:[C.light]}),Ie(x.fog,C.fog)||M.push({command:ii.setFog,args:[C.fog]}),Ie(x.projection,C.projection)||M.push({command:ii.setProjection,args:[C.projection]});const I={},R=[];!function(V,W,X,Q){let K;for(K in W=W||{},V=V||{})V.hasOwnProperty(K)&&(W.hasOwnProperty(K)||Uc(K,X,Q));for(K in W){if(!W.hasOwnProperty(K))continue;const ee=W[K];V.hasOwnProperty(K)?Ie(V[K],ee)||("geojson"===V[K].type&&"geojson"===ee.type&&$d(V,W,K)?X.push({command:ii.setGeoJSONSourceData,args:[K,ee.data]}):Hd(K,W,X,Q)):kp(K,W,X)}}(x.sources,C.sources,R,I);const N=[];x.layers&&x.layers.forEach(V=>{V.source&&I[V.source]?M.push({command:ii.removeLayer,args:[V.id]}):N.push(V)});let L=x.terrain;L&&I[L.source]&&(M.push({command:ii.setTerrain,args:[void 0]}),L=void 0),M=M.concat(R),Ie(L,C.terrain)||M.push({command:ii.setTerrain,args:[C.terrain]}),function(V,W,X){W=W||[];const Q=(V=V||[]).map(Na),K=W.map(Na),ee=V.reduce(ih,{}),U=W.reduce(ih,{}),Z=Q.slice(),ie=Object.create(null);let re,ue,ge,me,be,ve,Ae;for(re=0,ue=0;re<Q.length;re++)ge=Q[re],U.hasOwnProperty(ge)?ue++:(X.push({command:ii.removeLayer,args:[ge]}),Z.splice(Z.indexOf(ge,ue),1));for(re=0,ue=0;re<K.length;re++)ge=K[K.length-1-re],Z[Z.length-1-re]!==ge&&(ee.hasOwnProperty(ge)?(X.push({command:ii.removeLayer,args:[ge]}),Z.splice(Z.lastIndexOf(ge,Z.length-ue),1)):ue++,ve=Z[Z.length-re],X.push({command:ii.addLayer,args:[U[ge],ve]}),Z.splice(Z.length-re,0,ge),ie[ge]=!0);for(re=0;re<K.length;re++)if(ge=K[re],me=ee[ge],be=U[ge],!ie[ge]&&!Ie(me,be))if(Ie(me.source,be.source)&&Ie(me["source-layer"],be["source-layer"])&&Ie(me.type,be.type)){for(Ae in Vo(me.layout,be.layout,X,ge,null,ii.setLayoutProperty),Vo(me.paint,be.paint,X,ge,null,ii.setPaintProperty),Ie(me.filter,be.filter)||X.push({command:ii.setFilter,args:[ge,be.filter]}),Ie(me.minzoom,be.minzoom)&&Ie(me.maxzoom,be.maxzoom)||X.push({command:ii.setLayerZoomRange,args:[ge,be.minzoom,be.maxzoom]}),me)me.hasOwnProperty(Ae)&&"layout"!==Ae&&"paint"!==Ae&&"filter"!==Ae&&"metadata"!==Ae&&"minzoom"!==Ae&&"maxzoom"!==Ae&&(0===Ae.indexOf("paint.")?Vo(me[Ae],be[Ae],X,ge,Ae.slice(6),ii.setPaintProperty):Ie(me[Ae],be[Ae])||X.push({command:ii.setLayerProperty,args:[ge,Ae,be[Ae]]}));for(Ae in be)be.hasOwnProperty(Ae)&&!me.hasOwnProperty(Ae)&&"layout"!==Ae&&"paint"!==Ae&&"filter"!==Ae&&"metadata"!==Ae&&"minzoom"!==Ae&&"maxzoom"!==Ae&&(0===Ae.indexOf("paint.")?Vo(me[Ae],be[Ae],X,ge,Ae.slice(6),ii.setPaintProperty):Ie(me[Ae],be[Ae])||X.push({command:ii.setLayerProperty,args:[ge,Ae,be[Ae]]}))}else X.push({command:ii.removeLayer,args:[ge]}),ve=Z[Z.lastIndexOf(ge)+1],X.push({command:ii.addLayer,args:[be,ve]})}(N,C.layers,M)}catch(I){console.warn("Unable to compute style diff:",I),M=[{command:ii.setStyle,args:[C]}]}return M}(this.serialize(),c).filter(x=>!(x.command in ch));if(0===h.length)return!1;const y=h.filter(x=>!(x.command in pn));if(y.length>0)throw new Error(`Unimplemented: ${y.map(x=>x.command).join(", ")}.`);return h.forEach(x=>{"setTransition"!==x.command&&"setProjection"!==x.command&&this[x.command].apply(this,x.args)}),this.stylesheet=c,this._updateMapProjection(),!0}addImage(c,h){return this.getImage(c)?this.fire(new f.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,h),this._afterImageUpdated(c),this)}updateImage(c,h){this.imageManager.updateImage(c,h)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c),this._afterImageUpdated(c),this):this.fire(new f.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(c,h,y={}){if(this._checkLoaded(),void 0!==this.getSource(c))throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(f.validateSource,`sources.${c}`,h,null,y))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const x=kn(c,h,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c),source:x.serialize(),sourceId:c}));const C=M=>{const I=(M?"symbol:":"other:")+c,R=this._sourceCaches[I]=new f.SourceCache(I,x,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[c]=R,R.style=this,R.onAdd(this.map)};C(!1),"vector"!==h.type&&"geojson"!==h.type||C(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const h=this.getSource(c);if(!h)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===c)return this.fire(new f.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new f.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(c);for(const x of y)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new f.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(c,h){this._checkLoaded(),this.getSource(c).setData(h),this._changed=!0}getSource(c){const h=this._getSourceCache(c);return h&&h.getSource()}_getSources(){const c=[];for(const h in this._otherSourceCaches){const y=this._getSourceCache(h);y&&c.push(y.getSource())}return c}addLayer(c,h,y={}){this._checkLoaded();const x=c.id;if(this.getLayer(x))return void this.fire(new f.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let C;if("custom"===c.type){if(nc(this,f.validateCustomStyleLayer(c)))return;C=f.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(x,c.source),c=f.clone$1(c),c=f.extend(c,{source:x})),this._validate(f.validateLayer,`layers.${x}`,c,{arrayIndex:-1},y))return;C=f.createStyleLayer(c),this._validateLayer(C),C.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const M=h?this._order.indexOf(h):this._order.length;if(h&&-1===M)return void this.fire(new f.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(M,0,x),this._layerOrderChanged=!0,this._layers[x]=C;const I=this._getLayerSourceCache(C);if(this._removedLayers[x]&&C.source&&I&&"custom"!==C.type){const R=this._removedLayers[x];delete this._removedLayers[x],R.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",I.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,h){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===h)return;const y=this._order.indexOf(c);this._order.splice(y,1);const x=h?this._order.indexOf(h):this._order.length;h&&-1===x?this.fire(new f.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(x,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const h=this._layers[c];if(!h)return void this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const y=this._order.indexOf(c);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=h,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const h in this._layers)if(this._layers[h].type===c)return!0;return!1}setLayerZoomRange(c,h,y){this._checkLoaded();const x=this.getLayer(c);x?x.minzoom===h&&x.maxzoom===y||(null!=h&&(x.minzoom=h),null!=y&&(x.maxzoom=y),this._updateLayer(x)):this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,h,y={}){this._checkLoaded();const x=this.getLayer(c);if(x){if(!Ie(x.filter,h))return null==h?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(f.validateFilter,`layers.${x.id}.filter`,h,{layerType:x.type},y)||(x.filter=f.clone$1(h),this._updateLayer(x)))}else this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){const h=this.getLayer(c);return h&&f.clone$1(h.filter)}setLayoutProperty(c,h,y,x={}){this._checkLoaded();const C=this.getLayer(c);C?Ie(C.getLayoutProperty(h),y)||(C.setLayoutProperty(h,y,x),this._updateLayer(C)):this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,h){const y=this.getLayer(c);if(y)return y.getLayoutProperty(h);this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,h,y,x={}){this._checkLoaded();const C=this.getLayer(c);C?Ie(C.getPaintProperty(h),y)||(C.setPaintProperty(h,y,x)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,h){const y=this.getLayer(c);return y&&y.getPaintProperty(h)}setFeatureState(c,h){this._checkLoaded();const y=c.source,x=c.sourceLayer,C=this.getSource(y);if(!C)return void this.fire(new f.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const M=C.type;if("geojson"===M&&x)return void this.fire(new f.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===M&&!x)return void this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===c.id&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(y);for(const R of I)R.setFeatureState(x,c.id,h)}removeFeatureState(c,h){this._checkLoaded();const y=c.source,x=this.getSource(y);if(!x)return void this.fire(new f.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const C=x.type,M="vector"===C?c.sourceLayer:void 0;if("vector"===C&&!M)return void this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&"string"!=typeof c.id&&"number"!=typeof c.id)return void this.fire(new f.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(y);for(const R of I)R.removeFeatureState(M,c.id,h)}getFeatureState(c){this._checkLoaded();const h=c.source,y=c.sourceLayer,x=this.getSource(h);if(x){if("vector"!==x.type||y)return void 0===c.id&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(y,c.id);this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return f.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const h in this._sourceCaches){const y=this._sourceCaches[h].getSource();c[y.id]||(c[y.id]=y.serialize())}return f.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:c,layers:this._serializeLayers(this._order)},h=>void 0!==h)}_updateLayer(c){this._updatedLayers[c.id]=!0;const h=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&h&&"raster"!==h.getSource().type&&(this._updatedSources[c.source]="reload",h.pause()),this._changed=!0,c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const h=M=>"fill-extrusion"===this._layers[M].type,y={},x=[];for(let M=this._order.length-1;M>=0;M--){const I=this._order[M];if(h(I)){y[I]=M;for(const R of c){const N=R[I];if(N)for(const L of N)x.push(L)}}}x.sort((M,I)=>I.intersectionZ-M.intersectionZ);const C=[];for(let M=this._order.length-1;M>=0;M--){const I=this._order[M];if(h(I))for(let R=x.length-1;R>=0;R--){const N=x[R].feature;if(y[N.layer.id]<M)break;C.push(N),x.pop()}else for(const R of c){const N=R[I];if(N)for(const L of N)C.push(L.feature)}}return C}queryRenderedFeatures(c,h,y){h&&h.filter&&this._validate(f.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const x={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new f.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const R of h.layers){const N=this._layers[R];if(!N)return this.fire(new f.ErrorEvent(new Error(`The layer '${R}' does not exist in the map's style and cannot be queried for features.`))),[];x[N.source]=!0}}const C=[];h.availableImages=this._availableImages;const M=h&&h.layers?h.layers.some(R=>{const N=this.getLayer(R);return N&&N.is3D()}):this.has3DLayers(),I=os.createFromScreenPoints(c,y);for(const R in this._sourceCaches){const N=this._sourceCaches[R].getSource().id;h.layers&&!x[N]||C.push(Hi(this._sourceCaches[R],this._layers,this._serializedLayers,I,h,y,M,!!this.map._showQueryGeometry))}return this.placement&&C.push(function(R,N,L,V,W,X,Q){const K={},ee=X.queryRenderedSymbols(V),U=[];for(const Z of Object.keys(ee).map(Number))U.push(Q[Z]);U.sort(Hr);for(const Z of U){const ie=Z.featureIndex.lookupSymbolFeatures(ee[Z.bucketInstanceId],N,Z.bucketIndex,Z.sourceLayerIndex,W.filter,W.layers,W.availableImages,R);for(const re in ie){const ue=K[re]=K[re]||[],ge=ie[re];ge.sort((me,be)=>{const ve=Z.featureSortOrder;if(ve){const Ae=ve.indexOf(me.featureIndex);return ve.indexOf(be.featureIndex)-Ae}return be.featureIndex-me.featureIndex});for(const me of ge)ue.push(me)}}for(const Z in K)K[Z].forEach(ie=>{const re=ie.feature,ue=L(R[Z]);if(!ue)return;const ge=ue.getFeatureState(re.layer["source-layer"],re.id);re.source=re.layer.source,re.layer["source-layer"]&&(re.sourceLayer=re.layer["source-layer"]),re.state=ge});return K}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(c,h){h&&h.filter&&this._validate(f.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const y=this._getSourceCaches(c);let x=[];for(const C of y)x=x.concat(pr(C,h));return x}addSourceType(c,h,y){return ua.getSourceType(c)?y(new Error(`A source type called "${c}" already exists.`)):(ua.setSourceType(c,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:h.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(c,h={}){this._checkLoaded();const y=this.light.getLight();let x=!1;for(const M in c)if(!Ie(c[M],y[M])){x=!0;break}if(!x)return;const C=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(c,h),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,h=1){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let y=c;if(1===h){if("object"==typeof y.source){const x="terrain-dem-src";this.addSource(x,y.source),y=f.clone$1(y),y=f.extend(y,{source:x})}if(this._validate(f.validateTerrain,"terrain",y))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,h)}else{const x=this.terrain,C=x.get();for(const M of Object.keys(f.spec.terrain))!y.hasOwnProperty(M)&&f.spec.terrain[M].default&&(y[M]=f.spec.terrain[M].default);for(const M in y)if(!Ie(y[M],C[M])){x.set(y),this.stylesheet.terrain=y;const I=this._setTransitionParameters({duration:0});x.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const h=this.fog=new Xi(c,this.map.transform);this.stylesheet.fog=c;const y=this._setTransitionParameters({duration:0});h.updateTransitions(y)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,y=h.get();0===Object.keys(c).length&&h.set(c);for(const x in c)if(!Ie(c[x],y[x])){h.set(c),this.stylesheet.fog=c;const C=this._setTransitionParameters({duration:0});h.updateTransitions(C);break}}else this._createFog(c);this._markersNeedUpdate=!0}_setTransitionParameters(c){return{now:f.exported.now(),transition:f.extend(c,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(y=>this.isLayerDraped(this._layers[y])),h=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...h)}_createTerrain(c,h){const y=this.terrain=new ul(c,h);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});y.updateTransitions(x)}_force3DLayerUpdate(){for(const c in this._layers){const h=this._layers[c];"fill-extrusion"===h.type&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const h=this._layers[c];"symbol"===h.type&&this._updateLayer(h)}}_validate(c,h,y,x,C={}){return(!C||!1!==C.validate)&&nc(this,c.call(f.validateStyle,f.extend({key:h,style:this.serialize(),value:y,styleSpec:f.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),f.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const h=this._getSourceCaches(c);for(const y of h)y.clearTiles()}_reloadSource(c){const h=this._getSourceCaches(c);for(const y of h)y.resume(),y.reload()}_reloadSources(){for(const c of this._getSources())c.reload&&c.reload()}_updateSources(c){for(const h in this._sourceCaches)this._sourceCaches[h].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const h=this._sourceCaches[c];h.resume(),h.reload()}}_updatePlacement(c,h,y,x,C=!1){let M=!1,I=!1;const R={};for(const N of this._order){const L=this._layers[N];if("symbol"!==L.type)continue;if(!R[L.source]){const W=this._getLayerSourceCache(L);if(!W)continue;R[L.source]=W.getRenderableIds(!0).map(X=>W.getTileByID(X)).sort((X,Q)=>Q.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(Q.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(L,R[L.source],c.center.lng,c.projection);M=M||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||0===y,this._layerOrderChanged&&this.fire(new f.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(f.exported.now(),c.zoom))&&(this.pauseablePlacement=new Uo(c,this._order,C,h,y,x,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(f.exported.now()),I=!0),M&&this.pauseablePlacement.placement.setStale()),I||M)for(const N of this._order){const L=this._layers[N];"symbol"===L.type&&this.placement.updateLayerOpacities(L,R[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(f.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,h,y){this.imageManager.getImages(h.icons,y),this._updateTilesForChangedImages();const x=C=>{C&&C.setDependencies(h.tileID.key,h.type,h.icons)};x(this._otherSourceCaches[h.source]),x(this._symbolSourceCaches[h.source])}getGlyphs(c,h,y){this.glyphManager.getGlyphs(h.stacks,y)}getResource(c,h,y){return f.makeRequest(h,y)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return"symbol"===c.type?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const h=[];return this._otherSourceCaches[c]&&h.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&h.push(this._symbolSourceCaches[c]),h}_isSourceCacheLoaded(c){const h=this._getSourceCaches(c);return 0===h.length?(this.fire(new f.ErrorEvent(new Error(`There is no source with ID '${c}'`))),!1):h.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ua.getSourceType=function(g){return Lt[g]},ua.setSourceType=function(g,c){Lt[g]=c},ua.registerForPluginStateChange=f.registerForPluginStateChange;var dh="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",ha="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Zs="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",$c="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",za="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Jt={},yl={};const Gc=[];Yd(dh,Gc),Yd(Zs,Gc),Yd($c,Gc),Yd(za,Gc),Jt=ri("",Zs),yl=ri(za,$c);const Eo=ri("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Zd=dh,Pm="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Ii={background:ri("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:ri("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:ri("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:ri("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ri("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:ri("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ri("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ri("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ri("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:ri("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:ri("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:ri("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:ri("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:ri("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:ri("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:ri("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ri("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:ri("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:ri("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:ri("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:ri("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:ri("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:ri("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:ri("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:ri("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ri("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",ha),skyboxGradient:ri("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",ha),skyboxCapture:ri("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ri("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:ri("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Yd(g,c){const h=g.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let y of h)if(y=y.trim(),"#"===y[0]&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=y.split(" ");for(const C of x)c.includes(C)||c.push(C)}}function ri(g,c){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},C=[...Gc];return Yd(g,C),Yd(c,C),{fragmentSource:g=g.replace(h,(M,I,R,N,L)=>(x[L]=!0,"define"===I?`\n#ifndef HAS_UNIFORM_u_${L}\nvarying ${R} ${N} ${L};\n#else\nuniform ${R} ${N} u_${L};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${L}\n    ${R} ${N} ${L} = u_${L};\n#endif\n`)),vertexSource:c=c.replace(h,(M,I,R,N,L)=>{const V="float"===N?"vec2":"vec4",W=L.match(/color/)?"color":V;return x[L]?"define"===I?`\n#ifndef HAS_UNIFORM_u_${L}\nuniform lowp float u_${L}_t;\nattribute ${R} ${V} a_${L};\nvarying ${R} ${N} ${L};\n#else\nuniform ${R} ${N} u_${L};\n#endif\n`:"vec4"===W?`\n#ifndef HAS_UNIFORM_u_${L}\n    ${L} = a_${L};\n#else\n    ${R} ${N} ${L} = u_${L};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${L}\n    ${L} = unpack_mix_${W}(a_${L}, u_${L}_t);\n#else\n    ${R} ${N} ${L} = u_${L};\n#endif\n`:"define"===I?`\n#ifndef HAS_UNIFORM_u_${L}\nuniform lowp float u_${L}_t;\nattribute ${R} ${V} a_${L};\n#else\nuniform ${R} ${N} u_${L};\n#endif\n`:"vec4"===W?`\n#ifndef HAS_UNIFORM_u_${L}\n    ${R} ${N} ${L} = a_${L};\n#else\n    ${R} ${N} ${L} = u_${L};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${L}\n    ${R} ${N} ${L} = unpack_mix_${W}(a_${L}, u_${L}_t);\n#else\n    ${R} ${N} ${L} = u_${L};\n#endif\n`}),staticAttributes:y,usedDefines:C}}class Zb{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,h,y,x,C,M,I){this.context=c;let R=this.boundPaintVertexBuffers.length!==x.length;for(let L=0;!R&&L<x.length;L++)this.boundPaintVertexBuffers[L]!==x[L]&&(R=!0);let N=this.boundDynamicVertexBuffers.length!==I.length;for(let L=0;!N&&L<I.length;L++)this.boundDynamicVertexBuffers[L]!==I[L]&&(N=!0);if(!c.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==y||R||N||this.boundIndexBuffer!==C||this.boundVertexOffset!==M)this.freshBind(h,y,x,C,M,I);else{c.bindVertexArrayOES.set(this.vao);for(const L of I)L&&L.bind();C&&C.dynamicDraw&&C.bind()}}freshBind(c,h,y,x,C,M){let I;const R=c.numAttributes,N=this.context,L=N.gl;if(N.extVertexArrayObject)this.vao&&this.destroy(),this.vao=N.extVertexArrayObject.createVertexArrayOES(),N.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=c,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=x,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=M;else{I=N.currentNumAttributes||0;for(let V=R;V<I;V++)L.disableVertexAttribArray(V)}h.enableAttributes(L,c),h.bind(),h.setVertexAttribPointers(L,c,C);for(const V of y)V.enableAttributes(L,c),V.bind(),V.setVertexAttribPointers(L,c,C);for(const V of M)V&&(V.enableAttributes(L,c),V.bind(),V.setVertexAttribPointers(L,c,C));x&&x.bind(),N.currentNumAttributes=R}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function rc(g,c){const h=Math.pow(2,c.canonical.z),y=c.canonical.y;return[new f.MercatorCoordinate(0,y/h).toLngLat().lat,new f.MercatorCoordinate(0,(y+1)/h).toLngLat().lat]}function uh(g,c,h,y,x,C,M){const I=g.context,R=I.gl,N=h.fbo;if(!N)return;g.prepareDrawTile();const L=g.useProgram("hillshade");I.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,N.colorAttachment.get());const V=((K,ee,U,Z)=>{const ie=U.paint.get("hillshade-shadow-color"),re=U.paint.get("hillshade-highlight-color"),ue=U.paint.get("hillshade-accent-color");let ge=U.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===U.paint.get("hillshade-illumination-anchor")&&(ge-=K.transform.angle);const me=!K.options.moving;return{u_matrix:Z||K.transform.calculateProjMatrix(ee.tileID.toUnwrapped(),me),u_image:0,u_latrange:rc(0,ee.tileID),u_light:[U.paint.get("hillshade-exaggeration"),ge],u_shadow:ie,u_highlight:re,u_accent:ue}})(g,h,y,g.terrain?c.projMatrix:null);g.prepareDrawProgram(I,L,c.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:X,tileBoundsSegments:Q}=g.getTileBoundsBuffers(h);L.draw(I,R.TRIANGLES,x,C,M,f.CullFaceMode.disabled,V,y.id,W,X,Q)}function qc(g,c,h){if(!c.needsDEMTextureUpload)return;const y=g.context,x=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||g.getTileTexture(h.stride);const C=h.getPixels();c.demTexture?c.demTexture.update(C,{premultiply:!1}):c.demTexture=new f.Texture(y,C,x.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Om(g,c,h,y,x,C){const M=g.context,I=M.gl;if(!c.dem)return;const R=c.dem;if(M.activeTexture.set(I.TEXTURE1),qc(g,c,R),!c.demTexture)return;c.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const N=R.dim;M.activeTexture.set(I.TEXTURE0);let L=c.fbo;if(!L){const Q=new f.Texture(M,{width:N,height:N,data:null},I.RGBA);Q.bind(I.LINEAR,I.CLAMP_TO_EDGE),L=c.fbo=M.createFramebuffer(N,N,!0),L.colorAttachment.set(Q.texture)}M.bindFramebuffer.set(L.framebuffer),M.viewport.set([0,0,N,N]);const{tileBoundsBuffer:V,tileBoundsIndexBuffer:W,tileBoundsSegments:X}=g.getMercatorTileBoundsBuffers();g.useProgram("hillshadePrepare").draw(M,I.TRIANGLES,y,x,C,f.CullFaceMode.disabled,((Q,K)=>{const ee=K.stride,U=f.create();return f.ortho(U,0,f.EXTENT,-f.EXTENT,0,0,1),f.translate(U,U,[0,-f.EXTENT,0]),{u_matrix:U,u_image:1,u_dimension:[ee,ee],u_zoom:Q.overscaledZ,u_unpack:K.unpackVector}})(c.tileID,R),h.id,V,W,X),c.needsHillshadePrepare=!1}const Op=g=>({u_matrix:new f.UniformMatrix4f(g),u_image0:new f.Uniform1i(g),u_skirt_height:new f.Uniform1f(g)}),Wc=(g,c)=>({u_matrix:g,u_image0:0,u_skirt_height:c}),Xd=(g,c,h,y,x,C,M,I,R,N,L,V,W,X,Q)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:h,u_zoom_transition:x,u_merc_center:C,u_image0:0,u_frustum_tl:M,u_frustum_tr:I,u_frustum_br:R,u_frustum_bl:N,u_globe_pos:L,u_globe_radius:V,u_viewport:W,u_grid_matrix:Q?Float32Array.from(Q):new Float32Array(9),u_skirt_height:X});function Ys(g,c){return null!=g&&null!=c&&!(!g.hasData()||!c.hasData())&&null!=g.demTexture&&null!=c.demTexture&&g.tileID.key!==c.tileID.key}const Va=new class{constructor(){this.operations={}}newMorphing(g,c,h,y,x){if(g in this.operations){const C=this.operations[g];C.to.tileID.key!==h.tileID.key&&(C.queued=h)}else this.operations[g]={startTime:y,phase:0,duration:x,from:c,to:h,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const c=this.operations[g];return{from:c.from,to:c.to,phase:c.phase}}update(g){for(const c in this.operations){const h=this.operations[c];for(h.phase=(g-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,g)){delete this.operations[c];break}}}_nextOp(g,c){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=c,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},jo={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function hh(g){return 6*Math.pow(1.5,22-g)}function Ne(g,c){const h=1<<g.z;return!c&&(0===g.x||g.x===h-1)||0===g.y||g.y===h-1}const Zc=g=>({u_matrix:g});function gt(g,c,h,y,x){if(x>0){const C=f.exported.now(),M=(C-g.timeAdded)/x,I=c?(C-c.timeAdded)/x:-1,R=h.getSource(),N=y.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),L=!c||Math.abs(c.tileID.overscaledZ-N)>Math.abs(g.tileID.overscaledZ-N),V=L&&g.refreshedUponExpiration?1:f.clamp(L?M:1-I,0,1);return g.refreshedUponExpiration&&M>=1&&(g.refreshedUponExpiration=!1),c?{opacity:1,mix:1-V}:{opacity:V,mix:0}}return{opacity:1,mix:0}}class Yc extends f.SourceCache{constructor(c){const h={type:"raster-dem",maxzoom:c.transform.maxZoom},y=new Vt(Ki(),null),x=kn("mock-dem",h,y,c.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,h){c.state="loaded",h(null)}}class Xc extends f.SourceCache{constructor(c){const h=kn("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new Vt(Ki(),null),c.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,h,y){if(c.freezeTileCoverage)return;this.transform=c;const x=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((C,M)=>{if(C[M.key]="",!this._tiles[M.key]){const I=new f.Tile(M,this._source.tileSize*M.overscaleFactor(),c.tileZoom);I.state="loaded",this._tiles[M.key]=I}return C},{});for(const C in this._tiles)C in x||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(c){const h=this.proxyCachedFBO[c];if(void 0!==h){const y=Object.values(h);this.renderCachePool.push(...y),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class vl extends f.OverscaledTileID{constructor(c,h,y){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=h,this.projMatrix=y}}class Fp extends f.Elevation{constructor(c,h){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,x,C]=function(R){const N=new f.StructArrayLayout2i4,L=new f.StructArrayLayout3ui6,V=131;N.reserve(17161),L.reserve(33800);const W=f.EXTENT/128,X=f.EXTENT+W/2,Q=X+W;for(let ee=-W;ee<Q;ee+=W)for(let U=-W;U<Q;U+=W){const Z=U<0||U>X||ee<0||ee>X?24575:0,ie=f.clamp(Math.round(U),0,f.EXTENT),re=f.clamp(Math.round(ee),0,f.EXTENT);N.emplaceBack(ie+Z,re)}const K=(ee,U)=>{const Z=U*V+ee;L.emplaceBack(Z+1,Z,Z+V),L.emplaceBack(Z+V,Z+V+1,Z+1)};for(let ee=1;ee<129;ee++)for(let U=1;U<129;U++)K(U,ee);return[0,129].forEach(ee=>{for(let U=0;U<130;U++)K(U,ee),K(ee,U)}),[N,L,32768]}(),M=c.context;this.gridBuffer=M.createVertexBuffer(y,f.posAttributes.members),this.gridIndexBuffer=M.createIndexBuffer(x),this.gridSegments=f.SegmentVector.simpleSegment(0,0,y.length,x.length),this.gridNoSkirtSegments=f.SegmentVector.simpleSegment(0,0,y.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Xc(h.map),this.orthoMatrix=f.create(),f.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,f.EXTENT,0,f.EXTENT,0,1);const I=M.gl;this._overlapStencilMode=new f.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Yc(h.map)}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,h,y){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const x=c.terrain.properties;this.sourceCache=0===c.terrain.drapeRenderMode?this._mockSourceCache:c._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const C=()=>{this.sourceCache.used&&f.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.getScaledDemTileSize();this.sourceCache.update(h,M,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),h.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==c.efficiency&&f.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&"source"===c.dataType?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):"style"===c.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=0===y._centerAltitude&&-1===this.getAtPointOrZero(f.MercatorCoordinate.fromLngLat(y.center),-1),this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=h.getIds().map(R=>{const N=h.getTileByID(R).tileID;return N.projMatrix=y.calculateProjMatrix(N.toUnwrapped()),N});(function(R,N){const L=N.transform.pointCoordinate(N.transform.getCameraPoint()),V=new f.Point(L.x,L.y);R.sort((W,X)=>{if(X.overscaledZ-W.overscaledZ)return X.overscaledZ-W.overscaledZ;const Q=new f.Point(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),K=new f.Point(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),ee=V.mult(1<<W.canonical.z);return ee.x-=.5,ee.y-=.5,ee.distSqr(Q)-ee.distSqr(K)})})(x,this.painter),this._previousZoom=y.zoom;const C=this.proxyToSource||{};this.proxyToSource={},x.forEach(R=>{this.proxyToSource[R.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const R in M){const N=M[R];if(!N.used||(N!==this.sourceCache&&this.resetTileLookupCache(N.id),this._setupProxiedCoordsForOrtho(N,c[R],C),N.usedForTerrain))continue;const L=c[R];N.getSource().reparseOverscaled&&this._assignTerrainTiles(L)}this.proxiedCoords[h.id]=x.map(R=>new vl(R,R.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=f.exported.now();const I={};this._visibleDemTiles=[];for(const R of this.proxyCoords){const N=this.terrainTileForTile[R.key];if(!N)continue;const L=N.tileID.key;L in I||(this._visibleDemTiles.push(N),I[L]=L)}}_assignTerrainTiles(c){this._initializing||c.forEach(h=>{if(this.terrainTileForTile[h.key])return;const y=this._findTileCoveringTileID(h,this.sourceCache);y&&(this.terrainTileForTile[h.key]=y)})}_prepareDEMTextures(){const c=this.painter.context,h=c.gl;for(const y in this.terrainTileForTile){const x=this.terrainTileForTile[y],C=x.dem;!C||x.demTexture&&!x.needsDEMTextureUpload||(c.activeTexture.set(h.TEXTURE1),qc(this.painter,x,C))}}_prepareDemTileUniforms(c,h,y,x){if(!h||null==h.demTexture)return!1;const C=c.tileID.canonical,M=Math.pow(2,h.tileID.canonical.z-C.z),I=x||"";return y[`u_dem_tl${I}`]=[C.x*M%1,C.y*M%1],y[`u_dem_scale${I}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,h=c.gl;if(!this._emptyDepthBufferTexture){const y=new f.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new f.Texture(c,y,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const h=this._visibleDemTiles.reduce((y,x)=>{if(!x.dem)return y;const C=x.dem.tree.minimums[0];return C>0&&c++,y+C},0);return c?h/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,h=c.gl;c.activeTexture.set(h.TEXTURE2);const y=this._getLoadedAreaMinimum(),x=new f.RGBAImage({width:1,height:1},new Uint8Array(f.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(x,{premultiply:!1}):C=this._emptyDEMTexture=new f.Texture(c,x,h.RGBA,{premultiply:!1}),C}setupElevationDraw(c,h,y){const x=this.painter.context,C=x.gl,M=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:f.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();let R=null,N=null,L=1;if(y&&y.morphing&&this._useVertexMorphing){const V=y.morphing.srcDemTile,W=y.morphing.dstDemTile;L=y.morphing.phase,V&&W&&(this._prepareDemTileUniforms(c,V,M,"_prev")&&(N=V),this._prepareDemTileUniforms(c,W,M)&&(R=W))}if(N&&R?(x.activeTexture.set(C.TEXTURE2),R.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),x.activeTexture.set(C.TEXTURE4),N.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),M.u_dem_lerp=L):(R=this.terrainTileForTile[c.tileID.key],x.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(c,R,M)?R.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE)),x.activeTexture.set(C.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),M.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&R){const V=(1<<R.tileID.canonical.z)*f.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=V}if(y&&y.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),h.setTerrainUniformValues(x,M),"globe"===this.painter.transform.projection.name){const V=this.globeUniformValues(this.painter.transform,c.tileID.canonical,y&&y.useDenormalizedUpVectorScale);h.setGlobeUniformValues(x,V)}}globeUniformValues(c,h,y){const x=c.projection;return{u_tile_tl_up:x.upVector(h,0,0),u_tile_tr_up:x.upVector(h,f.EXTENT,0),u_tile_br_up:x.upVector(h,f.EXTENT,f.EXTENT),u_tile_bl_up:x.upVector(h,0,f.EXTENT),u_tile_up_scale:y?f.globeMetersToEcef(1):x.upVectorScale(h,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const h=this.painter,y=this.painter.context;0!==c.length&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,C,M,I,R){if("globe"===x.transform.projection.name)!function(N,L,V,W,X){const Q=N.context,K=Q.gl;let ee,U;const Z=N.options.showTerrainWireframe?2:0,ie=N.transform,re=f.globeUseCustomAntiAliasing(N,Q,ie),ue=(Qe,Me)=>{if(U===Qe)return;const $e=[jo[Qe],"PROJECTION_GLOBE_VIEW"];re&&$e.push("CUSTOM_ANTIALIASING"),Me&&$e.push(jo[Z]),ee=N.useProgram("globeRaster",null,$e),U=Qe},ge=N.colorModeForRenderPass(),me=new f.DepthMode(K.LEQUAL,f.DepthMode.ReadWrite,N.depthRangeFor3D);Va.update(X);const be=f.calculateGlobeMercatorMatrix(ie),ve=[f.mercatorXfromLng(ie.center.lng),f.mercatorYfromLat(ie.center.lat)],Ae=Z?[!1,!0]:[!1],Je=N.globeSharedBuffers,De=[ie.width*f.exported.devicePixelRatio,ie.height*f.exported.devicePixelRatio],Ve=Float32Array.from(ie.globeMatrix),Re={useDenormalizedUpVectorScale:!0};if(Ae.forEach(Qe=>{const Me=N.transform,$e=hh(Me.zoom)*L.exaggeration();U=-1;const tt=Qe?K.LINES:K.TRIANGLES;for(const We of W){const Le=V.getTile(We),Pt=f.StencilMode.disabled,nn=L.prevTerrainTileForTile[We.key],Mt=L.terrainTileForTile[We.key];Ys(nn,Mt)&&Va.newMorphing(We.key,nn,Mt,X,250),Q.activeTexture.set(K.TEXTURE0),Le.texture.bind(K.LINEAR,K.CLAMP_TO_EDGE);const Ut=Va.getMorphValuesForProxy(We.key),On=Ut?1:0;Ut&&f.extend$1(Re,{morphing:{srcDemTile:Ut.from,dstDemTile:Ut.to,phase:f.easeCubicInOut(Ut.phase)}});const Sn=f.tileCornersToBounds(We.canonical),At=f.getLatitudinalLod(Sn.getCenter().lat),oi=f.getGridMatrix(We.canonical,Sn,At,Me.worldSize/Me._pixelsPerMercatorPixel),mi=f.globeNormalizeECEF(f.globeTileBounds(We.canonical)),gi=Xd(Me.projMatrix,Ve,be,mi,f.globeToMercatorTransition(Me.zoom),ve,Me.frustumCorners.TL,Me.frustumCorners.TR,Me.frustumCorners.BR,Me.frustumCorners.BL,Me.globeCenterInViewSpace,Me.globeRadius,De,$e,oi);if(ue(On,Qe),L.setupElevationDraw(Le,ee,Re),N.prepareDrawProgram(Q,ee,We.toUnwrapped()),Je){const[_i,co,qe]=Qe?Je.getWirefameBuffers(N.context,At):Je.getGridBuffers(At,0!==$e);ee.draw(Q,tt,me,Pt,ge,f.CullFaceMode.backCCW,gi,"globe_raster",_i,co,qe)}}}),Je){const Qe=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];re&&Qe.push("CUSTOM_ANTIALIASING"),ee=N.useProgram("globeRaster",null,Qe);for(const Me of W){const{x:$e,y:tt,z:We}=Me.canonical,Le=0===tt,Pt=tt===(1<<We)-1,[nn,Mt,Ut,On]=Je.getPoleBuffers(We);if(On&&(Le||Pt)){const Sn=V.getTile(Me);Q.activeTexture.set(K.TEXTURE0),Sn.texture.bind(K.LINEAR,K.CLAMP_TO_EDGE);let At=f.globePoleMatrixForTile(We,$e,ie);const oi=f.globeNormalizeECEF(f.globeTileBounds(Me.canonical)),mi=(gi,_i)=>gi.draw(Q,K.TRIANGLES,me,f.StencilMode.disabled,ge,f.CullFaceMode.disabled,Xd(ie.projMatrix,At,At,oi,0,ve,ie.frustumCorners.TL,ie.frustumCorners.TR,ie.frustumCorners.BR,ie.frustumCorners.BL,ie.globeCenterInViewSpace,ie.globeRadius,De,0),"globe_pole_raster",_i,Ut,On);L.setupElevationDraw(Sn,ee,Re),N.prepareDrawProgram(Q,ee,Me.toUnwrapped()),Le&&mi(ee,nn),Pt&&(At=f.scale(f.create(),At,[1,-1,1]),mi(ee,Mt))}}}}(x,C,M,I,R);else{const N=x.context,L=N.gl;let V,W;const X=x.options.showTerrainWireframe?2:0,Q=(ie,re)=>{if(W===ie)return;const ue=[jo[ie]];re&&ue.push(jo[X]),V=x.useProgram("terrainRaster",null,ue),W=ie},K=x.colorModeForRenderPass(),ee=new f.DepthMode(L.LEQUAL,f.DepthMode.ReadWrite,x.depthRangeFor3D);Va.update(R);const U=x.transform,Z=hh(U.zoom)*C.exaggeration();(X?[!1,!0]:[!1]).forEach(ie=>{W=-1;const re=ie?L.LINES:L.TRIANGLES,[ue,ge]=ie?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const me of I){const be=M.getTile(me),ve=f.StencilMode.disabled,Ae=C.prevTerrainTileForTile[me.key],Je=C.terrainTileForTile[me.key];Ys(Ae,Je)&&Va.newMorphing(me.key,Ae,Je,R,250),N.activeTexture.set(L.TEXTURE0),be.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);const De=Va.getMorphValuesForProxy(me.key),Ve=De?1:0;let Re;De&&(Re={morphing:{srcDemTile:De.from,dstDemTile:De.to,phase:f.easeCubicInOut(De.phase)}});const Qe=Wc(me.projMatrix,Ne(me.canonical,U.renderWorldCopies)?Z/10:Z);Q(Ve,ie),C.setupElevationDraw(be,V,Re),x.prepareDrawProgram(N,V,me.toUnwrapped()),V.draw(N,re,ee,ve,K,f.CullFaceMode.backCCW,Qe,"terrain_raster",C.gridBuffer,ue,ge)}})}}(h,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(0===this._drapedRenderBatches.length)return c+1;this.renderingToTexture=!0;const h=this.painter,y=this.painter.context,x=this.proxySourceCache,C=this.proxiedCoords[x.id],M=this._drapedRenderBatches.shift(),I=[],R=h.style.order;let N=0;for(const L of C){const V=x.getTileByID(L.proxyTileKey),W=x.proxyCachedFBO[L.key]?x.proxyCachedFBO[L.key][c]:void 0,X=void 0!==W?x.renderCache[W]:this.pool[N++],Q=void 0!==W;if(V.texture=X.tex,Q&&!X.dirty){I.push(V.tileID);continue}let K;y.bindFramebuffer.set(X.fb.framebuffer),this.renderedToTile=!1,X.dirty&&(y.clear({color:f.Color.transparent,stencil:0}),X.dirty=!1);for(let ee=M.start;ee<=M.end;++ee){const U=h.style._layers[R[ee]];if(U.isHidden(h.transform.zoom))continue;const Z=h.style._getLayerSourceCache(U),ie=Z?this.proxyToSource[L.key][Z.id]:[L];if(!ie)continue;const re=ie;y.viewport.set([0,0,X.fb.width,X.fb.height]),K!==(Z?Z.id:null)&&(this._setupStencil(X,ie,U,Z),K=Z?Z.id:null),h.renderLayer(h,Z,U,re)}this.renderedToTile?(X.dirty=!0,I.push(V.tileID)):Q||--N,5===N&&(N=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,h.width,h.height]),M.end+1}postRender(){}renderCacheEfficiency(c){const h=c.order.length;if(0===h)return{efficiency:100};let y,x=0,C=0,M=!1;for(let I=0;I<h;++I){const R=c._layers[c.order[I]];this._style.isLayerDraped(R)?(M&&++x,++C):M||(M=!0,y=R.id)}return 0===C?{efficiency:100}:{efficiency:100*(1-x/C),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{c=Math.min(c,h.dem.tree.minimums[0])}),0===c?c:(c-30)*this._exaggeration}raycast(c,h,y){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(C=>C.dem).map(C=>{const M=C.tileID,I=1<<M.overscaledZ,{x:R,y:N}=M.canonical,L=R/I,V=(R+1)/I,W=N/I,X=(N+1)/I;return{minx:L,miny:W,maxx:V,maxy:X,t:C.dem.tree.raycastRoot(L,W,V,X,c,h,y),tile:C}});x.sort((C,M)=>(null!==C.t?C.t:Number.MAX_VALUE)-(null!==M.t?M.t:Number.MAX_VALUE));for(const C of x){if(null==C.t)return null;const M=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,c,h,y);if(null!=M)return M}return null}_createFBO(){const c=this.painter.context,h=c.gl,y=this.drapeBufferSize;c.activeTexture.set(h.TEXTURE0);const x=new f.Texture(c,{width:y[0],height:y[1],data:null},h.RGBA);x.bind(h.LINEAR,h.CLAMP_TO_EDGE);const C=c.createFramebuffer(y[0],y[1],!1);return C.colorAttachment.set(x.texture),C.depthAttachment=new ye(c,C.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:C,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const h=this._style._layers[c],y=h.isHidden(this.painter.transform.zoom);return"custom"===h.type?!y&&h.shouldRedrape():!y&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const y of this._style._getSources())if(y instanceof ut){c=!0;break}if(!c)return;const h={};for(let y=0;y<this._style.order.length;++y){const x=this._style._layers[this._style.order[y]],C=this._style._getLayerSourceCache(x);if(C&&!h[C.id]&&!x.isHidden(this.painter.transform.zoom)&&"line"===x.type&&x.widthExpression()instanceof f.ZoomDependentExpression){h[C.id]=!0;for(const M of this.proxyCoords){const I=this.proxyToSource[M.key][C.id];if(I)for(const R of I)this._clearRenderCacheForTile(C.id,R)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const y in this._style._sourceCaches)if(this._style._sourceCaches[y]._source instanceof it){c=!0;break}if(!c)return;const h={};for(let y=0;y<this._style.order.length;++y){const x=this._style._layers[this._style.order[y]],C=this._style._getLayerSourceCache(x);if(!C||h[C.id]||x.isHidden(this.painter.transform.zoom)||"raster"!==x.type)continue;const M=x.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const R=this.proxyToSource[I.key][C.id];if(R)for(const N of R){const L=gt(C.getTile(N),C.findLoadedParent(N,0),C,this.painter.transform,M);(1!==L.opacity||0!==L.mix)&&this._clearRenderCacheForTile(C.id,N)}}}}_setupDrapedRenderBatches(){const c=this._style.order,h=c.length;if(0===h)return;const y=[];let x,C=0,M=this._style._layers[c[C]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++C<h;)M=this._style._layers[c[C]];for(;C<h;++C){const I=this._style._layers[c[C]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?void 0===x&&(x=C):void 0!==x&&(y.push({start:x,end:C-1}),x=void 0))}void 0!==x&&y.push({start:x,end:C-1}),this._drapedRenderBatches=y}_setupRenderCache(c){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const M=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let I=0;I<M.length;++I){const R=Object.values(M[I]);h.renderCachePool.push(...R)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,x=this._tilesDirty;for(let M=y.length-1;M>=0;M--){const I=y[M];if(h.getTileByID(I.key),void 0!==h.proxyCachedFBO[I.key]){const R=c[I.key],N=this.proxyToSource[I.key];let L=0;for(const V in N){const W=N[V],X=R[V];if(!X||X.length!==W.length||W.some((Q,K)=>Q!==X[K]||x[V]&&x[V].hasOwnProperty(Q.key))){L=-1;break}++L}for(const V in h.proxyCachedFBO[I.key])h.renderCache[h.proxyCachedFBO[I.key][V]].dirty=L<0||L!==Object.values(R).length}}const C=[...this._drapedRenderBatches];C.sort((M,I)=>I.end-I.start-(M.end-M.start));for(const M of C)for(const I of y){if(h.proxyCachedFBO[I.key])continue;let R=h.renderCachePool.pop();void 0===R&&h.renderCache.length<50&&(R=h.renderCache.length,h.renderCache.push(this._createFBO())),void 0!==R&&(h.proxyCachedFBO[I.key]={},h.proxyCachedFBO[I.key][M.start]=R,h.renderCache[R].dirty=!0)}this._tilesDirty={}}_setupStencil(c,h,y,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,M=C.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let I;if(y.isTileClipped())I=h.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):f.StencilMode.disabled}_renderTileClippingMasks(c,h){const y=this.painter,x=this.painter.context,C=x.gl;y._tileClippingMaskIDs={},x.setColorMode(f.ColorMode.disabled),x.setDepthMode(f.DepthMode.disabled);const M=y.useProgram("clippingMask");for(const I of c){const R=y._tileClippingMaskIDs[I.key]=--h;M.draw(x,C.TRIANGLES,f.DepthMode.disabled,new f.StencilMode({func:C.ALWAYS,mask:0},R,255,C.KEEP,C.KEEP,C.REPLACE),f.ColorMode.disabled,f.CullFaceMode.disabled,Zc(I.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(c){const h=this.painter.transform;if(c.x<0||c.x>h.width||c.y<0||c.y>h.height)return null;const y=[c.x,c.y,1,1];f.transformMat4$1(y,y,h.pixelMatrixInverse),f.scale$1(y,y,1/y[3]),y[0]/=h.worldSize,y[1]/=h.worldSize;const x=h._camera.position,C=f.mercatorZfromAltitude(1,h.center.lat),M=[x[0],x[1],x[2]/C,0],I=f.subtract([],y.slice(0,3),M);f.normalize(I,I);const R=this.raycast(M,I,this._exaggeration);return null!==R&&R?(f.scaleAndAdd(M,M,I,R),M[3]=M[2],M[2]*=C,M):null}drawDepth(){const c=this.painter,h=c.context,y=this.proxySourceCache,x=Math.ceil(c.width),C=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const M=h.gl,I=h.createFramebuffer(x,C,!0);h.activeTexture.set(M.TEXTURE0);const R=new f.Texture(h,{width:x,height:C,data:null},M.RGBA);R.bind(M.NEAREST,M.CLAMP_TO_EDGE),I.colorAttachment.set(R.texture);const N=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,x,C);I.depthAttachment.set(N),this._depthFBO=I,this._depthTexture=R}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,x,C]),function(M,I,R,N){if("globe"===M.transform.projection.name)return;const L=M.context,V=L.gl;L.clear({depth:1});const W=M.useProgram("terrainDepth"),X=new f.DepthMode(V.LESS,f.DepthMode.ReadWrite,M.depthRangeFor3D);for(const Q of N){const K=R.getTile(Q),ee=Wc(Q.projMatrix,0);I.setupElevationDraw(K,W),W.draw(L,V.TRIANGLES,X,f.StencilMode.disabled,f.ColorMode.unblended,f.CullFaceMode.backCCW,ee,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(c,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,h,y){if(c.getSource()instanceof wn)return this._setupProxiedCoordsForImageSource(c,h,y);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const x=this.proxiedCoords[c.id]=[],C=this.proxyCoords;for(let I=0;I<C.length;I++){const R=C[I],N=this._findTileCoveringTileID(R,c);if(N){const L=this._createProxiedId(R,N,y[R.key]&&y[R.key][c.id]);x.push(L),this.proxyToSource[R.key][c.id]=[L]}}let M=!1;for(let I=0;I<h.length;I++){const R=c.getTile(h[I]);if(!R||!R.hasData())continue;const N=this._findTileCoveringTileID(R.tileID,this.proxySourceCache);if(N&&N.tileID.canonical.z!==R.tileID.canonical.z){const L=this.proxyToSource[N.tileID.key][c.id],V=this._createProxiedId(N.tileID,R,y[N.tileID.key]&&y[N.tileID.key][c.id]);L?L.splice(L.length-1,0,V):this.proxyToSource[N.tileID.key][c.id]=[V],x.push(V),M=!0}}this._sourceTilesOverlap[c.id]=M}_setupProxiedCoordsForImageSource(c,h,y){if(!c.getSource().loaded())return;const x=this.proxiedCoords[c.id]=[],C=this.proxyCoords,M=c.getSource(),I=new f.Point(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),R=M.coordinates.map(f.MercatorCoordinate.fromLngLat).reduce((L,V)=>(L.min.x=Math.min(L.min.x,V.x-I.x),L.min.y=Math.min(L.min.y,V.y-I.y),L.max.x=Math.max(L.max.x,V.x-I.x),L.max.y=Math.max(L.max.y,V.y-I.y),L),{min:new f.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new f.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),N=(L,V)=>{const W=L.wrap+L.canonical.x/(1<<L.canonical.z),X=L.canonical.y/(1<<L.canonical.z),Q=f.EXTENT/(1<<L.canonical.z),K=V.wrap+V.canonical.x/(1<<V.canonical.z),ee=V.canonical.y/(1<<V.canonical.z);return W+Q<K+R.min.x||W>K+R.max.x||X+Q<ee+R.min.y||X>ee+R.max.y};for(let L=0;L<C.length;L++){const V=C[L];for(let W=0;W<h.length;W++){const X=c.getTile(h[W]);if(!X||!X.hasData()||N(V,X.tileID))continue;const Q=this._createProxiedId(V,X,y[V.key]&&y[V.key][c.id]),K=this.proxyToSource[V.key][c.id];K?K.push(Q):this.proxyToSource[V.key][c.id]=[Q],x.push(Q)}}}_createProxiedId(c,h,y){let x=this.orthoMatrix;if(y){const C=y.find(M=>M.key===h.tileID.key);if(C)return C}if(h.tileID.key!==c.key){const C=c.canonical.z-h.tileID.canonical.z;let M,I,R;x=f.create();const N=h.tileID.wrap-c.wrap<<c.overscaledZ;C>0?(M=f.EXTENT>>C,I=M*((h.tileID.canonical.x<<C)-c.canonical.x+N),R=M*((h.tileID.canonical.y<<C)-c.canonical.y)):(M=f.EXTENT<<-C,I=f.EXTENT*(h.tileID.canonical.x-(c.canonical.x+N<<-C)),R=f.EXTENT*(h.tileID.canonical.y-(c.canonical.y<<-C))),f.ortho(x,0,M,0,M,0,1),f.translate(x,x,[I,R,0])}return new vl(h.tileID,c.key,x)}_findTileCoveringTileID(c,h){let y=h.getTile(c);if(y&&y.hasData())return y;const x=this._findCoveringTileCache[h.id],C=x[c.key];if(y=C?h.getTileByID(C):null,y&&y.hasData()||null===C)return y;let M=y?y.tileID:c,I=M.overscaledZ;const R=h.getSource().minzoom,N=[];if(!C){const V=h.getSource().maxzoom;if(c.canonical.z>=V){const W=c.canonical.z-V;h.getSource().reparseOverscaled?(I=Math.max(c.canonical.z+2,h.transform.tileZoom),M=new f.OverscaledTileID(I,c.wrap,V,c.canonical.x>>W,c.canonical.y>>W)):0!==W&&(I=V,M=new f.OverscaledTileID(I,c.wrap,V,c.canonical.x>>W,c.canonical.y>>W))}M.key!==c.key&&(N.push(M.key),y=h.getTile(M))}const L=V=>{N.forEach(W=>{x[W]=V}),N.length=0};for(I-=1;I>=R&&(!y||!y.hasData());I--){y&&L(y.tileID.key);const V=M.calculateScaledKey(I);if(y=h.getTileByID(V),y&&y.hasData())break;const W=x[V];if(null===W)break;void 0===W?N.push(V):y=h.getTileByID(W)}return L(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,h){let y=this._tilesDirty[c];y||(y=this._tilesDirty[c]={}),y[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(h){let y=0;const x=new f.StructArrayLayout2ui4,C=131;for(let M=1;M<129;M++){for(let I=1;I<129;I++)y=M*C+I,x.emplaceBack(y,y+1),x.emplaceBack(y,y+C),x.emplaceBack(y+1,y+C),128===M&&x.emplaceBack(y+C,y+C+1);x.emplaceBack(y+1,y+1+C)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=f.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Hn{static cacheKey(c,h,y,x){let C=`${h}${x?x.cacheKey:""}`;for(const M of y)c.usedDefines.includes(M)&&(C+=`/${M}`);return C}constructor(c,h,y,x,C,M){const I=c.gl;this.program=I.createProgram();const R=function(U){const Z=[];for(let ie=0;ie<U.length;ie++){if(null===U[ie])continue;const re=U[ie].split(" ");Z.push(re.pop())}return Z}(y.staticAttributes),N=x?x.getBinderAttributes():[],L=R.concat(N);let V=x?x.defines():[];V=V.concat(M.map(U=>`#define ${U}`));const W=c.isWebGL2?"#version 300 es\n":"",X=W+V.concat(c.extStandardDerivatives&&0===W.length?"#extension GL_OES_standard_derivatives : enable\n".concat(Pm):Pm,Pm,Zd,Eo.fragmentSource,yl.fragmentSource,y.fragmentSource).join("\n"),Q=W+V.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",Zd,Eo.vertexSource,yl.vertexSource,Jt.vertexSource,y.vertexSource).join("\n"),K=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(K,X),I.compileShader(K),I.attachShader(this.program,K);const ee=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(ee,Q),I.compileShader(ee),I.attachShader(this.program,ee),this.attributes={},this.numAttributes=L.length;for(let U=0;U<this.numAttributes;U++)L[U]&&(I.bindAttribLocation(this.program,U,L[U]),this.attributes[L[U]]=U);I.linkProgram(this.program),I.deleteShader(ee),I.deleteShader(K),this.fixedUniforms=C(c),this.binderUniforms=x?x.getUniforms(c):[],M.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new f.Uniform1i(U=c),u_dem_prev:new f.Uniform1i(U),u_dem_unpack:new f.Uniform4f(U),u_dem_tl:new f.Uniform2f(U),u_dem_scale:new f.Uniform1f(U),u_dem_tl_prev:new f.Uniform2f(U),u_dem_scale_prev:new f.Uniform1f(U),u_dem_size:new f.Uniform1f(U),u_dem_lerp:new f.Uniform1f(U),u_exaggeration:new f.Uniform1f(U),u_depth:new f.Uniform1i(U),u_depth_size_inv:new f.Uniform2f(U),u_meter_to_dem:new f.Uniform1f(U),u_label_plane_matrix_inv:new f.UniformMatrix4f(U)}),M.includes("GLOBE")&&(this.globeUniforms=(U=>({u_tile_tl_up:new f.Uniform3f(U),u_tile_tr_up:new f.Uniform3f(U),u_tile_br_up:new f.Uniform3f(U),u_tile_bl_up:new f.Uniform3f(U),u_tile_up_scale:new f.Uniform1f(U)}))(c)),M.includes("FOG")&&(this.fogUniforms=(U=>({u_fog_matrix:new f.UniformMatrix4f(U),u_fog_range:new f.Uniform2f(U),u_fog_color:new f.Uniform4f(U),u_fog_horizon_blend:new f.Uniform1f(U),u_fog_temporal_offset:new f.Uniform1f(U),u_frustum_tl:new f.Uniform3f(U),u_frustum_tr:new f.Uniform3f(U),u_frustum_br:new f.Uniform3f(U),u_frustum_bl:new f.Uniform3f(U),u_globe_pos:new f.Uniform3f(U),u_globe_radius:new f.Uniform1f(U),u_globe_transition:new f.Uniform1f(U),u_is_globe:new f.Uniform1i(U),u_viewport:new f.Uniform2f(U)}))(c))}var U}setTerrainUniformValues(c,h){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const x in h)y[x]&&y[x].set(this.program,x,h[x])}}setGlobeUniformValues(c,h){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const x in h)y[x]&&y[x].set(this.program,x,h[x])}}setFogUniformValues(c,h){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const x in h)y[x].set(this.program,x,h[x])}}draw(c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K){const ee=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(y),c.setStencilMode(x),c.setColorMode(C),c.setCullFace(M);for(const Z of Object.keys(this.fixedUniforms))this.fixedUniforms[Z].set(this.program,Z,I[Z]);Q&&Q.setUniforms(this.program,c,this.binderUniforms,W,{zoom:X});const U={[ee.LINES]:2,[ee.TRIANGLES]:3,[ee.LINE_STRIP]:1}[h];for(const Z of V.get()){const ie=Z.vaos||(Z.vaos={});(ie[R]||(ie[R]=new Zb)).bind(c,this,N,Q?Q.getPaintVertexBuffers():[],L,Z.vertexOffset,K||[]),ee.drawElements(h,Z.primitiveLength*U,ee.UNSIGNED_SHORT,Z.primitiveOffset*U*2)}}}function Kd(g,c){const h=Math.pow(2,c.tileID.overscaledZ),y=c.tileSize*Math.pow(2,g.transform.tileZoom)/h,x=y*(c.tileID.canonical.x+c.tileID.wrap*h),C=y*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_tile_units_to_pixels:1/gn(c,1,g.transform.tileZoom),u_pixel_coord_upper:[x>>16,C>>16],u_pixel_coord_lower:[65535&x,65535&C]}}const pa=f.create(),Ds=(g,c,h,y,x,C,M,I,R,N,L)=>{const V=c.style.light,W=V.properties.get("position"),X=[W.x,W.y,W.z],Q=f.create$1();"viewport"===V.properties.get("anchor")&&(f.fromRotation(Q,-c.transform.angle),f.transformMat3(X,X,Q));const K=V.properties.get("color"),ee=c.transform,U={u_matrix:g,u_lightpos:X,u_lightintensity:V.properties.get("intensity"),u_lightcolor:[K.r,K.g,K.b],u_vertical_gradient:+h,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:pa,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:C};return"globe"===ee.projection.name&&(U.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],U.u_zoom_transition=R,U.u_inv_rot_matrix=L,U.u_merc_center=N,U.u_up_dir=ee.projection.upVector(new f.CanonicalTileID(0,0,0),N[0]*f.EXTENT,N[1]*f.EXTENT),U.u_height_lift=I),U},Do=(g,c,h,y,x,C,M,I,R,N,L,V)=>{const W=Ds(g,c,h,y,x,C,M,R,N,L,V),X={u_height_factor:-Math.pow(2,M.overscaledZ)/I.tileSize/8};return f.extend(W,Kd(c,I),X)},So=g=>({u_matrix:g}),ei=(g,c,h)=>f.extend(So(g),Kd(c,h)),ph=(g,c)=>({u_matrix:g,u_world:c}),Lp=(g,c,h,y)=>f.extend(ei(g,c,h),{u_world:y}),Np=f.create(),fh=(g,c,h,y,x,C)=>{const M=g.transform,I="globe"===M.projection.name;let R;if("map"===C.paint.get("circle-pitch-alignment"))if(I){const L=f.globePixelsToTileUnits(M.zoom,c.canonical)*M._pixelsPerMercatorPixel;R=Float32Array.from([L,0,0,L])}else R=M.calculatePixelsToTileUnitsMatrix(h);else R=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const N={u_camera_to_center_distance:M.cameraToCenterDistance,u_matrix:g.translatePosMatrix(c.projMatrix,h,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_device_pixel_ratio:f.exported.devicePixelRatio,u_extrude_scale:R,u_inv_rot_matrix:Np,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){N.u_inv_rot_matrix=y,N.u_merc_center=x,N.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],N.u_zoom_transition=f.globeToMercatorTransition(M.zoom);const L=x[0]*f.EXTENT,V=x[1]*f.EXTENT;N.u_up_dir=M.projection.upVector(new f.CanonicalTileID(0,0,0),L,V)}return N},Xs=g=>{const c=[];return"map"===g.paint.get("circle-pitch-alignment")&&c.push("PITCH_WITH_MAP"),"map"===g.paint.get("circle-pitch-scale")&&c.push("SCALE_WITH_MAP"),c},oc=(g,c,h,y)=>{const x=f.EXTENT/h.tileSize;return{u_matrix:g,u_camera_to_center_distance:c.getCameraToCenterDistance(y),u_extrude_scale:[c.pixelsToGLUnits[0]/x,c.pixelsToGLUnits[1]/x]}},Jd=(g,c,h=1)=>({u_matrix:g,u_color:c,u_overlay:0,u_overlay_scale:h}),Bp=f.create(),mh=(g,c,h,y,x,C,M)=>{const I=g.transform,R="globe"===I.projection.name,N=R?f.globePixelsToTileUnits(I.zoom,c.canonical)*I._pixelsPerMercatorPixel:gn(h,1,C),L={u_matrix:c.projMatrix,u_extrude_scale:N,u_intensity:M,u_inv_rot_matrix:Bp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){L.u_inv_rot_matrix=y,L.u_merc_center=x,L.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],L.u_zoom_transition=f.globeToMercatorTransition(I.zoom);const V=x[0]*f.EXTENT,W=x[1]*f.EXTENT;L.u_up_dir=I.projection.upVector(new f.CanonicalTileID(0,0,0),V,W)}return L},Fm=(g,c,h,y,x,C,M)=>{const I=g.transform,R=I.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:gh(g,c,h,y),u_pixels_to_tile_units:R,u_device_pixel_ratio:C,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:Jc(h)?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:fa(c,g.transform),u_alpha_discard_threshold:0,u_trim_offset:M}},Kc=(g,c,h,y,x)=>{const C=g.transform;return{u_matrix:gh(g,c,h,y),u_texsize:c.imageAtlasTexture.size,u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:x,u_image:0,u_tile_units_to_pixels:fa(c,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function fa(g,c){return 1/gn(g,1,c.tileZoom)}function gh(g,c,h,y){return g.translatePosMatrix(y||c.tileID.projMatrix,c,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function Jc(g){const c=g.paint.get("line-dasharray").value;return c.value||"constant"!==c.kind}const zp=(g,c,h,y,x,C)=>{return{u_matrix:g,u_tl_parent:c,u_scale_parent:h,u_fade_t:y.mix,u_opacity:y.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(I=x.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(M=x.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:Ks(x.paint.get("raster-hue-rotate")),u_perspective_transform:C};var M,I};function Ks(g){g*=Math.PI/180;const c=Math.sin(g),h=Math.cos(g);return[(2*h+1)/3,(-Math.sqrt(3)*c-h+1)/3,(Math.sqrt(3)*c-h+1)/3]}const _h=f.create(),Vp=(g,c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K)=>{const ee=x.transform,U={u_is_size_zoom_constant:+("constant"===g||"source"===g),u_is_size_feature_constant:+("constant"===g||"camera"===g),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:ee.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:ee.width/ee.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:M,u_coord_matrix:I,u_is_text:+R,u_pitch_with_map:+y,u_texsize:N,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:_h,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:_h,u_up_vector:[0,-1,0]};return"globe"===K.name&&(U.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],U.u_zoom_transition=V,U.u_inv_rot_matrix=X,U.u_merc_center=W,U.u_camera_forward=ee._camera.forward(),U.u_ecef_origin=f.globeECEFOrigin(ee.globeMatrix,L.toUnwrapped()),U.u_tile_matrix=Float32Array.from(ee.globeMatrix),U.u_up_vector=Q),U},Ho=(g,c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K,ee)=>f.extend(Vp(g,c,h,y,x,C,M,I,R,N,V,W,X,Q,K,ee),{u_gamma_scale:y?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:f.exported.devicePixelRatio,u_is_halo:+L}),Lm=(g,c,h,y,x,C,M,I,R,N,L,V,W,X,Q,K)=>f.extend(Ho(g,c,h,y,x,C,M,I,!0,R,!0,L,V,W,X,Q,K),{u_texsize_icon:N,u_texture_icon:1}),yh=(g,c,h)=>({u_matrix:g,u_opacity:c,u_color:h}),G_=(g,c,h,y,x)=>f.extend(function(C,M,I){const R=M.imageManager.getPattern(C.toString()),{width:N,height:L}=M.imageManager.getPixelSize(),V=Math.pow(2,I.tileID.overscaledZ),W=I.tileSize*Math.pow(2,M.transform.tileZoom)/V,X=W*(I.tileID.canonical.x+I.tileID.wrap*V),Q=W*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:R.tl,u_pattern_br:R.br,u_texsize:[N,L],u_pattern_size:R.displaySize,u_tile_units_to_pixels:1/gn(I,1,M.transform.tileZoom),u_pixel_coord_upper:[X>>16,Q>>16],u_pixel_coord_lower:[65535&X,65535&Q]}}(y,h,x),{u_matrix:g,u_opacity:c}),Up={fillExtrusion:g=>({u_matrix:new f.UniformMatrix4f(g),u_lightpos:new f.Uniform3f(g),u_lightintensity:new f.Uniform1f(g),u_lightcolor:new f.Uniform3f(g),u_vertical_gradient:new f.Uniform1f(g),u_opacity:new f.Uniform1f(g),u_edge_radius:new f.Uniform1f(g),u_ao:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_up_dir:new f.Uniform3f(g),u_height_lift:new f.Uniform1f(g)}),fillExtrusionPattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_lightpos:new f.Uniform3f(g),u_lightintensity:new f.Uniform1f(g),u_lightcolor:new f.Uniform3f(g),u_vertical_gradient:new f.Uniform1f(g),u_height_factor:new f.Uniform1f(g),u_edge_radius:new f.Uniform1f(g),u_ao:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_up_dir:new f.Uniform3f(g),u_height_lift:new f.Uniform1f(g),u_image:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_pixel_coord_upper:new f.Uniform2f(g),u_pixel_coord_lower:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g),u_opacity:new f.Uniform1f(g)}),fill:g=>({u_matrix:new f.UniformMatrix4f(g)}),fillPattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_image:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_pixel_coord_upper:new f.Uniform2f(g),u_pixel_coord_lower:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g)}),fillOutline:g=>({u_matrix:new f.UniformMatrix4f(g),u_world:new f.Uniform2f(g)}),fillOutlinePattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_world:new f.Uniform2f(g),u_image:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_pixel_coord_upper:new f.Uniform2f(g),u_pixel_coord_lower:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g)}),circle:g=>({u_camera_to_center_distance:new f.Uniform1f(g),u_extrude_scale:new f.UniformMatrix2f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_up_dir:new f.Uniform3f(g)}),collisionBox:g=>({u_matrix:new f.UniformMatrix4f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_extrude_scale:new f.Uniform2f(g)}),collisionCircle:g=>({u_matrix:new f.UniformMatrix4f(g),u_inv_matrix:new f.UniformMatrix4f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_viewport_size:new f.Uniform2f(g)}),debug:g=>({u_color:new f.UniformColor(g),u_matrix:new f.UniformMatrix4f(g),u_overlay:new f.Uniform1i(g),u_overlay_scale:new f.Uniform1f(g)}),clippingMask:g=>({u_matrix:new f.UniformMatrix4f(g)}),heatmap:g=>({u_extrude_scale:new f.Uniform1f(g),u_intensity:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_up_dir:new f.Uniform3f(g)}),heatmapTexture:g=>({u_image:new f.Uniform1i(g),u_color_ramp:new f.Uniform1i(g),u_opacity:new f.Uniform1f(g)}),hillshade:g=>({u_matrix:new f.UniformMatrix4f(g),u_image:new f.Uniform1i(g),u_latrange:new f.Uniform2f(g),u_light:new f.Uniform2f(g),u_shadow:new f.UniformColor(g),u_highlight:new f.UniformColor(g),u_accent:new f.UniformColor(g)}),hillshadePrepare:g=>({u_matrix:new f.UniformMatrix4f(g),u_image:new f.Uniform1i(g),u_dimension:new f.Uniform2f(g),u_zoom:new f.Uniform1f(g),u_unpack:new f.Uniform4f(g)}),line:g=>({u_matrix:new f.UniformMatrix4f(g),u_pixels_to_tile_units:new f.UniformMatrix2f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_units_to_pixels:new f.Uniform2f(g),u_dash_image:new f.Uniform1i(g),u_gradient_image:new f.Uniform1i(g),u_image_height:new f.Uniform1f(g),u_texsize:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g),u_alpha_discard_threshold:new f.Uniform1f(g),u_trim_offset:new f.Uniform2f(g)}),linePattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_texsize:new f.Uniform2f(g),u_pixels_to_tile_units:new f.UniformMatrix2f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_image:new f.Uniform1i(g),u_units_to_pixels:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g),u_alpha_discard_threshold:new f.Uniform1f(g)}),raster:g=>({u_matrix:new f.UniformMatrix4f(g),u_tl_parent:new f.Uniform2f(g),u_scale_parent:new f.Uniform1f(g),u_fade_t:new f.Uniform1f(g),u_opacity:new f.Uniform1f(g),u_image0:new f.Uniform1i(g),u_image1:new f.Uniform1i(g),u_brightness_low:new f.Uniform1f(g),u_brightness_high:new f.Uniform1f(g),u_saturation_factor:new f.Uniform1f(g),u_contrast_factor:new f.Uniform1f(g),u_spin_weights:new f.Uniform3f(g),u_perspective_transform:new f.Uniform2f(g)}),symbolIcon:g=>({u_is_size_zoom_constant:new f.Uniform1i(g),u_is_size_feature_constant:new f.Uniform1i(g),u_size_t:new f.Uniform1f(g),u_size:new f.Uniform1f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_rotate_symbol:new f.Uniform1i(g),u_aspect_ratio:new f.Uniform1f(g),u_fade_change:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_label_plane_matrix:new f.UniformMatrix4f(g),u_coord_matrix:new f.UniformMatrix4f(g),u_is_text:new f.Uniform1i(g),u_pitch_with_map:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_camera_forward:new f.Uniform3f(g),u_tile_matrix:new f.UniformMatrix4f(g),u_up_vector:new f.Uniform3f(g),u_ecef_origin:new f.Uniform3f(g),u_texture:new f.Uniform1i(g)}),symbolSDF:g=>({u_is_size_zoom_constant:new f.Uniform1i(g),u_is_size_feature_constant:new f.Uniform1i(g),u_size_t:new f.Uniform1f(g),u_size:new f.Uniform1f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_rotate_symbol:new f.Uniform1i(g),u_aspect_ratio:new f.Uniform1f(g),u_fade_change:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_label_plane_matrix:new f.UniformMatrix4f(g),u_coord_matrix:new f.UniformMatrix4f(g),u_is_text:new f.Uniform1i(g),u_pitch_with_map:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_texture:new f.Uniform1i(g),u_gamma_scale:new f.Uniform1f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_camera_forward:new f.Uniform3f(g),u_tile_matrix:new f.UniformMatrix4f(g),u_up_vector:new f.Uniform3f(g),u_ecef_origin:new f.Uniform3f(g),u_is_halo:new f.Uniform1i(g)}),symbolTextAndIcon:g=>({u_is_size_zoom_constant:new f.Uniform1i(g),u_is_size_feature_constant:new f.Uniform1i(g),u_size_t:new f.Uniform1f(g),u_size:new f.Uniform1f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_rotate_symbol:new f.Uniform1i(g),u_aspect_ratio:new f.Uniform1f(g),u_fade_change:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_label_plane_matrix:new f.UniformMatrix4f(g),u_coord_matrix:new f.UniformMatrix4f(g),u_is_text:new f.Uniform1i(g),u_pitch_with_map:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_texsize_icon:new f.Uniform2f(g),u_texture:new f.Uniform1i(g),u_texture_icon:new f.Uniform1i(g),u_gamma_scale:new f.Uniform1f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_is_halo:new f.Uniform1i(g)}),background:g=>({u_matrix:new f.UniformMatrix4f(g),u_opacity:new f.Uniform1f(g),u_color:new f.UniformColor(g)}),backgroundPattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_opacity:new f.Uniform1f(g),u_image:new f.Uniform1i(g),u_pattern_tl:new f.Uniform2f(g),u_pattern_br:new f.Uniform2f(g),u_texsize:new f.Uniform2f(g),u_pattern_size:new f.Uniform2f(g),u_pixel_coord_upper:new f.Uniform2f(g),u_pixel_coord_lower:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g)}),terrainRaster:Op,terrainDepth:Op,skybox:g=>({u_matrix:new f.UniformMatrix4f(g),u_sun_direction:new f.Uniform3f(g),u_cubemap:new f.Uniform1i(g),u_opacity:new f.Uniform1f(g),u_temporal_offset:new f.Uniform1f(g)}),skyboxGradient:g=>({u_matrix:new f.UniformMatrix4f(g),u_color_ramp:new f.Uniform1i(g),u_center_direction:new f.Uniform3f(g),u_radius:new f.Uniform1f(g),u_opacity:new f.Uniform1f(g),u_temporal_offset:new f.Uniform1f(g)}),skyboxCapture:g=>({u_matrix_3f:new f.UniformMatrix3f(g),u_sun_direction:new f.Uniform3f(g),u_sun_intensity:new f.Uniform1f(g),u_color_tint_r:new f.Uniform4f(g),u_color_tint_m:new f.Uniform4f(g),u_luminance:new f.Uniform1f(g)}),globeRaster:g=>({u_proj_matrix:new f.UniformMatrix4f(g),u_globe_matrix:new f.UniformMatrix4f(g),u_normalize_matrix:new f.UniformMatrix4f(g),u_merc_matrix:new f.UniformMatrix4f(g),u_zoom_transition:new f.Uniform1f(g),u_merc_center:new f.Uniform2f(g),u_image0:new f.Uniform1i(g),u_grid_matrix:new f.UniformMatrix3f(g),u_skirt_height:new f.Uniform1f(g),u_frustum_tl:new f.Uniform3f(g),u_frustum_tr:new f.Uniform3f(g),u_frustum_br:new f.Uniform3f(g),u_frustum_bl:new f.Uniform3f(g),u_globe_pos:new f.Uniform3f(g),u_globe_radius:new f.Uniform1f(g),u_viewport:new f.Uniform2f(g)}),globeAtmosphere:g=>({u_frustum_tl:new f.Uniform3f(g),u_frustum_tr:new f.Uniform3f(g),u_frustum_br:new f.Uniform3f(g),u_frustum_bl:new f.Uniform3f(g),u_horizon:new f.Uniform1f(g),u_transition:new f.Uniform1f(g),u_fadeout_range:new f.Uniform1f(g),u_color:new f.Uniform4f(g),u_high_color:new f.Uniform4f(g),u_space_color:new f.Uniform4f(g),u_star_intensity:new f.Uniform1f(g),u_star_density:new f.Uniform1f(g),u_star_size:new f.Uniform1f(g),u_temporal_offset:new f.Uniform1f(g),u_horizon_angle:new f.Uniform1f(g),u_rotation_matrix:new f.UniformMatrix4f(g)})};let vh;function Qd(g,c,h,y,x,C,M){const I=g.context,R=I.gl,N=g.transform,L=g.useProgram("collisionBox"),V=[];let W=0,X=0;for(let re=0;re<y.length;re++){const ue=y[re],ge=c.getTile(ue),me=ge.getBucket(h);if(!me)continue;const be=ls(ue,me,N);let ve=be;0===x[0]&&0===x[1]||(ve=g.translatePosMatrix(be,ge,x,C));const Ae=M?me.textCollisionBox:me.iconCollisionBox,Je=me.collisionCircleArray;if(Je.length>0){const De=f.create(),Ve=ve;f.mul(De,me.placementInvProjMatrix,N.glCoordMatrix),f.mul(De,De,me.placementViewportMatrix),V.push({circleArray:Je,circleOffset:X,transform:Ve,invTransform:De,projection:me.getProjection()}),W+=Je.length/4,X=W}Ae&&(g.terrain&&g.terrain.setupElevationDraw(ge,L),L.draw(I,R.LINES,f.DepthMode.disabled,f.StencilMode.disabled,g.colorModeForRenderPass(),f.CullFaceMode.disabled,oc(ve,N,ge,me.getProjection()),h.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,null,N.zoom,null,[Ae.collisionVertexBuffer,Ae.collisionVertexBufferExt]))}if(!M||!V.length)return;const Q=g.useProgram("collisionCircle"),K=new f.StructArrayLayout2f1f2i16;K.resize(4*W),K._trim();let ee=0;for(const re of V)for(let ue=0;ue<re.circleArray.length/4;ue++){const ge=4*ue,me=re.circleArray[ge+0],be=re.circleArray[ge+1],ve=re.circleArray[ge+2],Ae=re.circleArray[ge+3];K.emplace(ee++,me,be,ve,Ae,0),K.emplace(ee++,me,be,ve,Ae,1),K.emplace(ee++,me,be,ve,Ae,2),K.emplace(ee++,me,be,ve,Ae,3)}(!vh||vh.length<2*W)&&(vh=function(re){const ue=2*re,ge=new f.StructArrayLayout3ui6;ge.resize(ue),ge._trim();for(let me=0;me<ue;me++){const be=6*me;ge.uint16[be+0]=4*me+0,ge.uint16[be+1]=4*me+1,ge.uint16[be+2]=4*me+2,ge.uint16[be+3]=4*me+2,ge.uint16[be+4]=4*me+3,ge.uint16[be+5]=4*me+0}return ge}(W));const U=I.createIndexBuffer(vh,!0),Z=I.createVertexBuffer(K,f.collisionCircleLayout.members,!0);for(const re of V){const ue={u_matrix:re.transform,u_inv_matrix:re.invTransform,u_camera_to_center_distance:(ie=N).getCameraToCenterDistance(re.projection),u_viewport_size:[ie.width,ie.height]};Q.draw(I,R.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,g.colorModeForRenderPass(),f.CullFaceMode.disabled,ue,h.id,Z,U,f.SegmentVector.simpleSegment(0,2*re.circleOffset,re.circleArray.length,re.circleArray.length/2),null,N.zoom)}var ie;Z.destroy(),U.destroy()}const jp=f.create();function Hp({width:g,height:c,anchor:h,textOffset:y,textScale:x},C){const{horizontalAlign:M,verticalAlign:I}=f.getAnchorAlignment(h),R=-(M-.5)*g,N=-(I-.5)*c,L=f.evaluateVariableOffset(h,y);return new f.Point((R/x+L[0])*C,(N/x+L[1])*C)}function q_(g,c,h,y,x,C,M,I,R,N,L){const V=g.text.placedSymbolArray,W=g.text.dynamicLayoutVertexArray,X=g.icon.dynamicLayoutVertexArray,Q={},K=g.getProjection(),ee=ke(I,K,C),U=C.elevation,Z=K.upVectorScale(I.canonical,C.center.lat,C.worldSize).metersToTile;W.clear();for(let ie=0;ie<V.length;ie++){const re=V.get(ie),{tileAnchorX:ue,tileAnchorY:ge,numGlyphs:me}=re,be=re.hidden||!re.crossTileID||g.allowVerticalPlacement&&!re.placedOrientation?null:y[re.crossTileID];if(be){let ve=0,Ae=0,Je=0;if(U){const Le=U?U.getAtTileOffset(I,ue,ge):0,[Pt,nn,Mt]=K.upVector(I.canonical,ue,ge);ve=Le*Pt*Z,Ae=Le*nn*Z,Je=Le*Mt*Z}let[De,Ve,Re,Qe]=kr(re.projectedAnchorX+ve,re.projectedAnchorY+Ae,re.projectedAnchorZ+Je,h?ee:M);const Me=mr(C.getCameraToCenterDistance(K),Qe);let $e=x.evaluateSizeForFeature(g.textSizeData,N,re)*Me/f.ONE_EM;h&&($e*=g.tilePixelRatio/R);const tt=Hp(be,$e);h?(({x:De,y:Ve,z:Re}=K.projectTilePoint(ue+tt.x,ge+tt.y,I.canonical)),[De,Ve,Re]=kr(De+ve,Ve+Ae,Re+Je,M)):(c&&tt._rotate(-C.angle),De+=tt.x,Ve+=tt.y,Re=0);const We=g.allowVerticalPlacement&&re.placedOrientation===f.WritingMode.vertical?Math.PI/2:0;for(let Le=0;Le<me;Le++)f.addDynamicAttributes(W,De,Ve,Re,We);L&&re.associatedIconIndex>=0&&(Q[re.associatedIconIndex]={x:De,y:Ve,z:Re,angle:We})}else Pn(me,W)}if(L){X.clear();const ie=g.icon.placedSymbolArray;for(let re=0;re<ie.length;re++){const ue=ie.get(re),{numGlyphs:ge}=ue,me=Q[re];if(ue.hidden||!me)Pn(ge,X);else{const{x:be,y:ve,z:Ae,angle:Je}=me;for(let De=0;De<ge;De++)f.addDynamicAttributes(X,be,ve,Ae,Je)}}g.icon.dynamicLayoutVertexBuffer.updateData(X)}g.text.dynamicLayoutVertexBuffer.updateData(W)}function $p(g,c,h){return h.iconsInText&&c?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Fn(g,c,h,y,x,C,M,I,R,N,L,V){const W=g.context,X=W.gl,Q=g.transform,K="map"===I,ee="map"===R,U=K&&"point"!==h.layout.get("symbol-placement"),Z=K&&!ee&&!U,ie=void 0!==h.layout.get("symbol-sort-key").constantOr(1);let re=!1;const ue=g.depthModeForSublayer(0,f.DepthMode.ReadOnly),ge=[f.mercatorXfromLng(Q.center.lng),f.mercatorYfromLat(Q.center.lat)],me=h.layout.get("text-variable-anchor"),be="globe"===Q.projection.name,ve=[],Ae=[0,-1,0];let Je=Ae;!be&&!Q.mercatorFromTransition||K||(Je=function(De){const Ve=De._camera.getWorldToCamera(De.worldSize,1),Re=f.multiply([],Ve,De.globeMatrix);f.invert(Re,Re);const Qe=[0,0,0],Me=[0,1,0,0];return f.transformMat4$1(Me,Me,Re),Qe[0]=Me[0],Qe[1]=Me[1],Qe[2]=Me[2],f.normalize(Qe,Qe),Qe}(Q));for(const De of y){const Ve=c.getTile(De),Re=Ve.getBucket(h);if(!Re||"mercator"===Re.projection.name&&be)continue;const Qe=x?Re.text:Re.icon;if(!Qe||Re.fullyClipped||!Qe.segments.get().length)continue;const Me=Qe.programConfigurations.get(h.id),$e=x||Re.sdfIcons,tt=x?Re.textSizeData:Re.iconSizeData,We=ee||0!==Q.pitch,Le=f.evaluateSizeForZoom(tt,Q.zoom);let Pt,nn,Mt,Ut,On=[0,0],Sn=null;if(x)nn=Ve.glyphAtlasTexture,Mt=X.LINEAR,Pt=Ve.glyphAtlasTexture.size,Re.iconsInText&&(On=Ve.imageAtlasTexture.size,Sn=Ve.imageAtlasTexture,Ut=We||g.options.rotating||g.options.zooming||"composite"===tt.kind||"camera"===tt.kind?X.LINEAR:X.NEAREST);else{const ir=1!==h.layout.get("icon-size").constantOr(0)||Re.iconsNeedLinear;nn=Ve.imageAtlasTexture,Mt=$e||g.options.rotating||g.options.zooming||ir||We?X.LINEAR:X.NEAREST,Pt=Ve.imageAtlasTexture.size}const At="globe"===Re.projection.name,oi=At?Je:Ae,mi=At?f.globeToMercatorTransition(Q.zoom):0,gi=ke(De,Re.getProjection(),Q),_i=Q.calculatePixelsToTileUnitsMatrix(Ve),co=ze(gi,Ve.tileID.canonical,ee,K,Q,Re.getProjection(),_i),qe=g.terrain&&ee&&U?f.invert(f.create(),co):jp,Mn=fr(gi,Ve.tileID.canonical,ee,K,Q,Re.getProjection(),_i),ti=me&&Re.hasTextData(),on="none"!==h.layout.get("icon-text-fit")&&ti&&Re.hasIconData();if(U){const ir=Q.elevation,ho=ir?ir.getAtTileOffsetFunc(De,Q.center.lat,Q.worldSize,Re.getProjection()):null,El=da(gi,Ve.tileID.canonical,ee,K,Q,Re.getProjection(),_i);oh(Re,gi,g,x,El,Mn,ee,N,ho,De)}const bn=U||x&&me||on,Yn=g.translatePosMatrix(gi,Ve,C,M),Gi=bn?jp:co,Ji=g.translatePosMatrix(Mn,Ve,C,M,!0),Si=Re.getProjection().createInversionMatrix(Q,De.canonical),uo=[];g.terrainRenderModeElevated()&&ee&&uo.push("PITCH_WITH_MAP_TERRAIN"),At&&uo.push("PROJECTION_GLOBE_VIEW"),bn&&uo.push("PROJECTED_POS_ON_VIEWPORT");const Sh=$e&&0!==h.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1);let rd;rd=$e?Re.iconsInText?Lm(tt.kind,Le,Z,ee,g,Yn,Gi,Ji,Pt,On,De,mi,ge,Si,oi,Re.getProjection()):Ho(tt.kind,Le,Z,ee,g,Yn,Gi,Ji,x,Pt,!0,De,mi,ge,Si,oi,Re.getProjection()):Vp(tt.kind,Le,Z,ee,g,Yn,Gi,Ji,x,Pt,De,mi,ge,Si,oi,Re.getProjection());const od={program:g.useProgram($p($e,x,Re),Me,uo),buffers:Qe,uniformValues:rd,atlasTexture:nn,atlasTextureIcon:Sn,atlasInterpolation:Mt,atlasInterpolationIcon:Ut,isSDF:$e,hasHalo:Sh,tile:Ve,labelPlaneMatrixInv:qe};if(ie&&Re.canOverlap){re=!0;const ir=Qe.segments.get();for(const ho of ir)ve.push({segments:new f.SegmentVector([ho]),sortKey:ho.sortKey,state:od})}else ve.push({segments:Qe.segments,sortKey:0,state:od})}re&&ve.sort((De,Ve)=>De.sortKey-Ve.sortKey);for(const De of ve){const Ve=De.state;if(g.terrain&&g.terrain.setupElevationDraw(Ve.tile,Ve.program,{useDepthForOcclusion:!be,labelPlaneMatrixInv:Ve.labelPlaneMatrixInv}),W.activeTexture.set(X.TEXTURE0),Ve.atlasTexture.bind(Ve.atlasInterpolation,X.CLAMP_TO_EDGE),Ve.atlasTextureIcon&&(W.activeTexture.set(X.TEXTURE1),Ve.atlasTextureIcon&&Ve.atlasTextureIcon.bind(Ve.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),Ve.isSDF){const Re=Ve.uniformValues;Ve.hasHalo&&(Re.u_is_halo=1,Qc(Ve.buffers,De.segments,h,g,Ve.program,ue,L,V,Re)),Re.u_is_halo=0}Qc(Ve.buffers,De.segments,h,g,Ve.program,ue,L,V,Ve.uniformValues)}}function Qc(g,c,h,y,x,C,M,I,R){const N=y.context,L=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.globeExtVertexBuffer];x.draw(N,N.gl.TRIANGLES,C,M,I,f.CullFaceMode.disabled,R,h.id,g.layoutVertexBuffer,g.indexBuffer,c,h.paint,y.transform.zoom,g.programConfigurations.get(h.id),L)}function Nm(g,c,h,y,x,C,M){const I=g.context.gl,R=h.paint.get("fill-pattern"),N=R&&R.constantOr(1);let L,V,W,X,Q;M?(V=N&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",L=I.LINES):(V=N?"fillPattern":"fill",L=I.TRIANGLES);for(const K of y){const ee=c.getTile(K);if(N&&!ee.patternsLoaded())continue;const U=ee.getBucket(h);if(!U)continue;g.prepareDrawTile();const Z=U.programConfigurations.get(h.id),ie=g.useProgram(V,Z);N&&(g.context.activeTexture.set(I.TEXTURE0),ee.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),Z.updatePaintBuffers());const re=R.constantOr(null);if(re&&ee.imageAtlas){const ge=ee.imageAtlas.patternPositions[re.toString()];ge&&Z.setConstantPatternPositions(ge)}const ue=g.translatePosMatrix(K.projMatrix,ee,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(M){X=U.indexBuffer2,Q=U.segments2;const ge=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];W="fillOutlinePattern"===V&&N?Lp(ue,g,ee,ge):ph(ue,ge)}else X=U.indexBuffer,Q=U.segments,W=N?ei(ue,g,ee):So(ue);g.prepareDrawProgram(g.context,ie,K.toUnwrapped()),ie.draw(g.context,L,x,g.stencilModeForClipping(K),C,f.CullFaceMode.disabled,W,h.id,U.layoutVertexBuffer,X,Q,h.paint,g.transform.zoom,Z)}}function bh(g,c,h,y,x,C,M){const I=g.context,R=I.gl,N=g.transform,L=h.paint.get("fill-extrusion-pattern"),V=L.constantOr(1),W=h.paint.get("fill-extrusion-opacity"),X=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],Q=h.layout.get("fill-extrusion-edge-radius"),K=Q>0&&!h.paint.get("fill-extrusion-rounded-roof"),ee=K?0:Q,U="globe"===N.projection.name?f.fillExtrusionHeightLift():0,Z="globe"===N.projection.name,ie=Z?f.globeToMercatorTransition(N.zoom):0,re=[f.mercatorXfromLng(N.center.lng),f.mercatorYfromLat(N.center.lat)],ue=[];Z&&ue.push("PROJECTION_GLOBE_VIEW"),X[0]>0&&ue.push("FAUX_AO"),K&&ue.push("ZERO_ROOF_RADIUS");for(const ge of y){const me=c.getTile(ge),be=me.getBucket(h);if(!be||be.projection.name!==N.projection.name)continue;const ve=be.programConfigurations.get(h.id),Ae=g.useProgram(V?"fillExtrusionPattern":"fillExtrusion",ve,ue);if(g.terrain){const $e=g.terrain;if(g.style.terrainSetForDrapingOnly())$e.setupElevationDraw(me,Ae,{useMeterToDem:!0});else{if(!be.enableTerrain)continue;if($e.setupElevationDraw(me,Ae,{useMeterToDem:!0}),En(I,c,ge,be,h,$e),!be.centroidVertexBuffer){const tt=Ae.attributes.a_centroid_pos;void 0!==tt&&R.vertexAttrib2f(tt,0,0)}}}V&&(g.context.activeTexture.set(R.TEXTURE0),me.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),ve.updatePaintBuffers());const Je=L.constantOr(null);if(Je&&me.imageAtlas){const $e=me.imageAtlas.patternPositions[Je.toString()];$e&&ve.setConstantPatternPositions($e)}const De=g.translatePosMatrix(ge.projMatrix,me,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Ve=N.projection.createInversionMatrix(N,ge.canonical),Re=h.paint.get("fill-extrusion-vertical-gradient"),Qe=V?Do(De,g,Re,W,X,ee,ge,me,U,ie,re,Ve):Ds(De,g,Re,W,X,ee,ge,U,ie,re,Ve);g.prepareDrawProgram(I,Ae,ge.toUnwrapped());const Me=[];g.terrain&&Me.push(be.centroidVertexBuffer),Z&&Me.push(be.layoutVertexExtBuffer),Ae.draw(I,I.gl.TRIANGLES,x,C,M,f.CullFaceMode.backCCW,Qe,h.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,h.paint,g.transform.zoom,ve,Me)}}function En(g,c,h,y,x,C){const M=[U=>{let Z=U.canonical.x-1,ie=U.wrap;return Z<0&&(Z=(1<<U.canonical.z)-1,ie--),new f.OverscaledTileID(U.overscaledZ,ie,U.canonical.z,Z,U.canonical.y)},U=>{let Z=U.canonical.x+1,ie=U.wrap;return Z===1<<U.canonical.z&&(Z=0,ie++),new f.OverscaledTileID(U.overscaledZ,ie,U.canonical.z,Z,U.canonical.y)},U=>new f.OverscaledTileID(U.overscaledZ,U.wrap,U.canonical.z,U.canonical.x,(0===U.canonical.y?1<<U.canonical.z:U.canonical.y)-1),U=>new f.OverscaledTileID(U.overscaledZ,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y===(1<<U.canonical.z)-1?0:U.canonical.y+1)],I=U=>{const Z=c.getSource().minzoom,ie=ue=>{const ge=c.getTileByID(ue);if(ge&&ge.hasData())return ge.getBucket(x)},re=[0,-1,1];for(const ue of re){if(U.overscaledZ+ue<Z)continue;const ge=ie(U.calculateScaledKey(U.overscaledZ+ue));if(ge)return ge}},R=[0,0,0],N=(U,Z)=>(R[0]=Math.min(U.min.y,Z.min.y),R[1]=Math.max(U.max.y,Z.max.y),R[2]=f.EXTENT-Z.min.x>U.max.x?Z.min.x-f.EXTENT:U.max.x,R),L=(U,Z)=>(R[0]=Math.min(U.min.x,Z.min.x),R[1]=Math.max(U.max.x,Z.max.x),R[2]=f.EXTENT-Z.min.y>U.max.y?Z.min.y-f.EXTENT:U.max.y,R),V=[(U,Z)=>N(U,Z),(U,Z)=>N(Z,U),(U,Z)=>L(U,Z),(U,Z)=>L(Z,U)],W=new f.Point(0,0);let X,Q,K;const ee=(U,Z,ie,re,ue)=>{const ge=[[re?ie:U,re?U:ie,0],[re?ie:Z,re?Z:ie,0]],me=ue<0?f.EXTENT+ue:ue,be=[re?me:(U+Z)/2,re?(U+Z)/2:me,0];return 0===ie&&ue<0||0!==ie&&ue>0?C.getForTilePoints(K,[be],!0,Q):ge.push(be),C.getForTilePoints(h,ge,!0,X),Math.max(ge[0][2],ge[1][2],be[2])/C.exaggeration()};for(let U=0;U<4;U++){const Z=(U<2?1:5)-U,ie=y.borders[U];if(0===ie.length)continue;const re=K=M[U](h),ue=I(re);if(!(ue&&ue instanceof f.FillExtrusionBucket&&ue.enableTerrain)||y.borderDoneWithNeighborZ[U]===ue.canonical.z&&ue.borderDoneWithNeighborZ[Z]===y.canonical.z||(Q=C.findDEMTileFor(re),!Q||!Q.dem))continue;if(!X){const ve=C.findDEMTileFor(h);if(!ve||!ve.dem)return;X=ve}const ge=ue.borders[Z];let me=0;const be=ue.borderDoneWithNeighborZ[Z]!==y.canonical.z;if(y.canonical.z===ue.canonical.z){for(let ve=0;ve<ie.length;ve++){const Ae=y.featuresOnBorder[ie[ve]],Je=Ae.borders[U];let De;for(;me<ge.length&&(De=ue.featuresOnBorder[ge[me]],!(De.borders[Z][1]>Je[0]+3));)be&&ue.encodeCentroid(void 0,De,!1),me++;if(De&&me<ge.length){const Ve=me;let Re=0;for(;!(De.borders[Z][0]>Je[1]-3)&&(Re++,++me!==ge.length);)De=ue.featuresOnBorder[ge[me]];if(De=ue.featuresOnBorder[ge[Ve]],Ae.intersectsCount()>1||De.intersectsCount()>1||1!==Re){1!==Re&&(me=Ve),y.encodeCentroid(void 0,Ae,!1),be&&ue.encodeCentroid(void 0,De,!1);continue}const Qe=V[U](Ae,De),Me=U%2?f.EXTENT-1:0;W.x=ee(Qe[0],Math.min(f.EXTENT-1,Qe[1]),Me,U<2,Qe[2]),W.y=0,y.encodeCentroid(W,Ae,!1),be&&ue.encodeCentroid(W,De,!1)}else y.encodeCentroid(void 0,Ae,!1)}y.borderDoneWithNeighborZ[U]=ue.canonical.z,y.needsCentroidUpdate=!0,be&&(ue.borderDoneWithNeighborZ[Z]=y.canonical.z,ue.needsCentroidUpdate=!0)}else{for(const ve of ie)y.encodeCentroid(void 0,y.featuresOnBorder[ve],!1);if(be){for(const ve of ge)ue.encodeCentroid(void 0,ue.featuresOnBorder[ve],!1);ue.borderDoneWithNeighborZ[Z]=y.canonical.z,ue.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[U]=ue.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&0!==y.centroidVertexArray.length)&&y.uploadCentroid(g)}const ed=new f.Color(1,0,0,1),Bm=new f.Color(0,1,0,1),rt=new f.Color(0,0,1,1),$o=new f.Color(1,0,1,1),di=new f.Color(0,1,1,1);function ao(g,c,h){const y=g.context,x=g.transform,C=y.gl,M="globe"===x.projection.name,I=M?["PROJECTION_GLOBE_VIEW"]:null;let R=h.projMatrix;if(M&&f.globeToMercatorTransition(x.zoom)>0){const Ae=f.transitionTileAABBinECEF(h.canonical,x),Je=f.globeDenormalizeECEF(Ae);R=f.multiply(new Float32Array(16),x.globeMatrix,Je),f.multiply(R,x.projMatrix,R)}const N=g.useProgram("debug",null,I),L=c.getTileByID(h.key);g.terrain&&g.terrain.setupElevationDraw(L,N);const V=f.DepthMode.disabled,W=f.StencilMode.disabled,X=g.colorModeForRenderPass(),Q="$debug";y.activeTexture.set(C.TEXTURE0),g.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),M?L._makeGlobeTileDebugBuffers(g.context,x):L._makeDebugTileBoundsBuffers(g.context,x.projection);const K=L._tileDebugBuffer||g.debugBuffer,ee=L._tileDebugIndexBuffer||g.debugIndexBuffer,U=L._tileDebugSegments||g.debugSegments;N.draw(y,C.LINE_STRIP,V,W,X,f.CullFaceMode.disabled,Jd(R,f.Color.red),Q,K,ee,U,null,null,null,[L._globeTileDebugBorderBuffer]);const Z=L.latestRawTileData,ie=Math.floor((Z&&Z.byteLength||0)/1024),re=c.getTile(h).tileSize,ue=512/Math.min(re,512)*(h.overscaledZ/x.zoom)*.5;let ge=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(ge+=` => ${h.overscaledZ}`),ge+=` ${ie}kb`,function(Ae,Je){Ae.initDebugOverlayCanvas();const De=Ae.debugOverlayCanvas,Ve=Ae.context.gl,Re=Ae.debugOverlayCanvas.getContext("2d");Re.clearRect(0,0,De.width,De.height),Re.shadowColor="white",Re.shadowBlur=2,Re.lineWidth=1.5,Re.strokeStyle="white",Re.textBaseline="top",Re.font="bold 36px Open Sans, sans-serif",Re.fillText(Je,5,5),Re.strokeText(Je,5,5),Ae.debugOverlayTexture.update(De),Ae.debugOverlayTexture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}(g,ge);const me=L._tileDebugTextBuffer||g.debugBuffer,be=L._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,ve=L._tileDebugTextSegments||g.debugSegments;N.draw(y,C.TRIANGLES,V,W,f.ColorMode.alphaBlended,f.CullFaceMode.disabled,Jd(R,f.Color.transparent,ue),Q,me,be,ve,null,null,null,[L._globeTileDebugTextBuffer])}function Mo(g,c,h,y){Rr(g,0,c+h/2,g.transform.width,h,y)}function Ua(g,c,h,y){Rr(g,c-h/2,0,h,g.transform.height,y)}function Rr(g,c,h,y,x,C){const M=g.context,I=M.gl;I.enable(I.SCISSOR_TEST),I.scissor(c*f.exported.devicePixelRatio,h*f.exported.devicePixelRatio,y*f.exported.devicePixelRatio,x*f.exported.devicePixelRatio),M.clear({color:C}),I.disable(I.SCISSOR_TEST)}const Gp=f.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:qp}=Gp;function Ss(g,c,h,y){g.emplaceBack(c,h,y)}class xh{constructor(c){this.vertexArray=new f.StructArrayLayout3f12,this.indices=new f.StructArrayLayout3ui6,Ss(this.vertexArray,-1,-1,1),Ss(this.vertexArray,1,-1,1),Ss(this.vertexArray,-1,1,1),Ss(this.vertexArray,1,1,1),Ss(this.vertexArray,-1,-1,-1),Ss(this.vertexArray,1,-1,-1),Ss(this.vertexArray,-1,1,-1),Ss(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,qp),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=f.SegmentVector.simpleSegment(0,0,36,12)}}function Ms(g,c,h,y,x,C){const M=g.gl,I=c.paint.get("sky-atmosphere-color"),R=c.paint.get("sky-atmosphere-halo-color"),N=c.paint.get("sky-atmosphere-sun-intensity"),L={u_matrix_3f:f.fromMat4(f.create$1(),y),u_sun_direction:x,u_sun_intensity:N,u_color_tint_r:[(Q=I).r,Q.g,Q.b,Q.a],u_color_tint_m:[(K=R).r,K.g,K.b,K.a],u_luminance:5e-5};var Q,K;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+C,c.skyboxTexture,0),h.draw(g,M.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,f.ColorMode.unblended,f.CullFaceMode.frontCW,L,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const er=f.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class It{constructor(c){const h=new f.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const y=new f.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(h,er.members),this.indexBuffer=c.createIndexBuffer(y),this.segments=f.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const dn={symbol:function(g,c,h,y,x){if("translucent"!==g.renderPass)return;const C=f.StencilMode.disabled,M=g.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(I,R,N,L,V,W,X){const Q=R.transform,K="map"===V,ee="map"===W;for(const U of I){const Z=L.getTile(U),ie=Z.getBucket(N);if(!ie||!ie.text||!ie.text.segments.get().length)continue;const re=f.evaluateSizeForZoom(ie.textSizeData,Q.zoom),ue=ke(U,ie.getProjection(),Q),ge=Q.calculatePixelsToTileUnitsMatrix(Z),me=ze(ue,Z.tileID.canonical,ee,K,Q,ie.getProjection(),ge),be="none"!==N.layout.get("icon-text-fit")&&ie.hasIconData();if(re){const ve=Math.pow(2,Q.zoom-Z.tileID.overscaledZ);q_(ie,K,ee,X,f.symbolSize,Q,me,U,ve,re,be)}}}(y,g,h,c,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),x),0!==h.paint.get("icon-opacity").constantOr(1)&&Fn(g,c,h,y,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),C,M),0!==h.paint.get("text-opacity").constantOr(1)&&Fn(g,c,h,y,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),C,M),c.map.showCollisionBoxes&&(Qd(g,c,h,y,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Qd(g,c,h,y,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(g,c,h,y){if("translucent"!==g.renderPass)return;const x=h.paint.get("circle-opacity"),C=h.paint.get("circle-stroke-width"),M=h.paint.get("circle-stroke-opacity"),I=void 0!==h.layout.get("circle-sort-key").constantOr(1);if(0===x.constantOr(1)&&(0===C.constantOr(1)||0===M.constantOr(1)))return;const R=g.context,N=R.gl,L=g.transform,V=g.depthModeForSublayer(0,f.DepthMode.ReadOnly),W=f.StencilMode.disabled,X=g.colorModeForRenderPass(),Q="globe"===L.projection.name,K=[f.mercatorXfromLng(L.center.lng),f.mercatorYfromLat(L.center.lat)],ee=[];for(let Z=0;Z<y.length;Z++){const ie=y[Z],re=c.getTile(ie),ue=re.getBucket(h);if(!ue||ue.projection.name!==L.projection.name)continue;const ge=ue.programConfigurations.get(h.id),me=Xs(h);Q&&me.push("PROJECTION_GLOBE_VIEW");const be=g.useProgram("circle",ge,me),ve=ue.layoutVertexBuffer,Ae=ue.globeExtVertexBuffer,Je=ue.indexBuffer,De=L.projection.createInversionMatrix(L,ie.canonical),Ve={programConfiguration:ge,program:be,layoutVertexBuffer:ve,globeExtVertexBuffer:Ae,indexBuffer:Je,uniformValues:fh(g,ie,re,De,K,h),tile:re};if(I){const Re=ue.segments.get();for(const Qe of Re)ee.push({segments:new f.SegmentVector([Qe]),sortKey:Qe.sortKey,state:Ve})}else ee.push({segments:ue.segments,sortKey:0,state:Ve})}I&&ee.sort((Z,ie)=>Z.sortKey-ie.sortKey);const U={useDepthForOcclusion:!Q};for(const Z of ee){const{programConfiguration:ie,program:re,layoutVertexBuffer:ue,globeExtVertexBuffer:ge,indexBuffer:me,uniformValues:be,tile:ve}=Z.state,Ae=Z.segments;g.terrain&&g.terrain.setupElevationDraw(ve,re,U),g.prepareDrawProgram(R,re,ve.tileID.toUnwrapped()),re.draw(R,N.TRIANGLES,V,W,X,f.CullFaceMode.disabled,be,h.id,ue,me,Ae,h.paint,L.zoom,ie,[ge])}},heatmap:function(g,c,h,y){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===g.renderPass){const x=g.context,C=x.gl,M=f.StencilMode.disabled,I=new f.ColorMode([C.ONE,C.ONE],f.Color.transparent,[!0,!0,!0,!0]);(function(X,Q,K,ee){const U=X.gl,Z=Q.width*ee,ie=Q.height*ee;X.activeTexture.set(U.TEXTURE1),X.viewport.set([0,0,Z,ie]);let re=K.heatmapFbo;if(!re||re&&(re.width!==Z||re.height!==ie)){re&&re.destroy();const ue=U.createTexture();U.bindTexture(U.TEXTURE_2D,ue),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_S,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_T,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.LINEAR),re=K.heatmapFbo=X.createFramebuffer(Z,ie,!1),function(ge,me,be,ve,Ae,Je){const De=ge.gl;De.texImage2D(De.TEXTURE_2D,0,ge.isWebGL2&&ge.extRenderToTextureHalfFloat?De.RGBA16F:De.RGBA,Ae,Je,0,De.RGBA,ge.extRenderToTextureHalfFloat?ge.isWebGL2?De.HALF_FLOAT:ge.extTextureHalfFloat.HALF_FLOAT_OES:De.UNSIGNED_BYTE,null),ve.colorAttachment.set(be)}(X,0,ue,re,Z,ie)}else U.bindTexture(U.TEXTURE_2D,re.colorAttachment.get()),X.bindFramebuffer.set(re.framebuffer)})(x,g,h,"globe"===g.transform.projection.name?.5:.25),x.clear({color:f.Color.transparent});const R=g.transform,N="globe"===R.projection.name,L=N?["PROJECTION_GLOBE_VIEW"]:null,V=N?f.CullFaceMode.frontCCW:f.CullFaceMode.disabled,W=[f.mercatorXfromLng(R.center.lng),f.mercatorYfromLat(R.center.lat)];for(let X=0;X<y.length;X++){const Q=y[X];if(c.hasRenderableParent(Q))continue;const K=c.getTile(Q),ee=K.getBucket(h);if(!ee||ee.projection.name!==R.projection.name)continue;const U=ee.programConfigurations.get(h.id),Z=g.useProgram("heatmap",U,L),{zoom:ie}=g.transform;g.terrain&&g.terrain.setupElevationDraw(K,Z),g.prepareDrawProgram(x,Z,Q.toUnwrapped());const re=R.projection.createInversionMatrix(R,Q.canonical);Z.draw(x,C.TRIANGLES,f.DepthMode.disabled,M,I,V,mh(g,Q,K,re,W,ie,h.paint.get("heatmap-intensity")),h.id,ee.layoutVertexBuffer,ee.indexBuffer,ee.segments,h.paint,g.transform.zoom,U,N?[ee.globeExtVertexBuffer]:null)}x.viewport.set([0,0,g.width,g.height])}else"translucent"===g.renderPass&&(g.context.setColorMode(g.colorModeForRenderPass()),function(x,C){const M=x.context,I=M.gl,R=C.heatmapFbo;if(!R)return;M.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,R.colorAttachment.get()),M.activeTexture.set(I.TEXTURE1);let N=C.colorRampTexture;N||(N=C.colorRampTexture=new f.Texture(M,C.colorRamp,I.RGBA)),N.bind(I.LINEAR,I.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(M,I.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,x.colorModeForRenderPass(),f.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:C.paint.get("heatmap-opacity")},C.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,C.paint,x.transform.zoom)}(g,h))},line:function(g,c,h,y){if("translucent"!==g.renderPass)return;const x=h.paint.get("line-opacity"),C=h.paint.get("line-width");if(0===x.constantOr(1)||0===C.constantOr(1))return;const M=g.depthModeForSublayer(0,f.DepthMode.ReadOnly),I=g.colorModeForRenderPass(),R=g.terrain&&g.terrain.renderingToTexture?1:f.exported.devicePixelRatio,N=h.paint.get("line-dasharray"),L=N.constantOr(1),V=h.layout.get("line-cap"),W=h.paint.get("line-pattern"),X=W.constantOr(1),Q=h.paint.get("line-gradient"),K=X?"linePattern":"line",ee=g.context,U=ee.gl,Z=(re=>{const ue=[];Jc(re)&&ue.push("RENDER_LINE_DASH"),re.paint.get("line-gradient")&&ue.push("RENDER_LINE_GRADIENT");const ge=re.paint.get("line-trim-offset");0===ge[0]&&0===ge[1]||ue.push("RENDER_LINE_TRIM_OFFSET");const me=re.paint.get("line-pattern").constantOr(1),be=1!==re.paint.get("line-opacity").constantOr(1);return!me&&be&&ue.push("RENDER_LINE_ALPHA_DISCARD"),ue})(h);let ie=Z.includes("RENDER_LINE_ALPHA_DISCARD");g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(ie=!1);for(const re of y){const ue=c.getTile(re);if(X&&!ue.patternsLoaded())continue;const ge=ue.getBucket(h);if(!ge)continue;g.prepareDrawTile();const me=ge.programConfigurations.get(h.id),be=g.useProgram(K,me,Z),ve=W.constantOr(null);if(ve&&ue.imageAtlas){const $e=ue.imageAtlas.patternPositions[ve.toString()];$e&&me.setConstantPatternPositions($e)}const Ae=N.constantOr(null),Je=V.constantOr(null);if(!X&&Ae&&Je&&ue.lineAtlas){const $e=ue.lineAtlas.getDash(Ae,Je);$e&&me.setConstantPatternPositions($e)}let[De,Ve]=h.paint.get("line-trim-offset");("round"===Je||"square"===Je)&&De!==Ve&&(0===De&&(De-=1),1===Ve&&(Ve+=1));const Re=g.terrain?re.projMatrix:null,Qe=X?Kc(g,ue,h,Re,R):Fm(g,ue,h,Re,ge.lineClipsArray.length,R,[De,Ve]);if(Q){const $e=ge.gradients[h.id];let tt=$e.texture;if(h.gradientVersion!==$e.version){let We=256;if(h.stepInterpolant){const Le=c.getSource().maxzoom,Pt=re.canonical.z===Le?Math.ceil(1<<g.transform.maxZoom-re.canonical.z):1;We=f.clamp(f.nextPowerOfTwo(ge.maxLineLength/f.EXTENT*1024*Pt),256,ee.maxTextureSize)}$e.gradient=f.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:We,image:$e.gradient||void 0,clips:ge.lineClipsArray}),$e.texture?$e.texture.update($e.gradient):$e.texture=new f.Texture(ee,$e.gradient,U.RGBA),$e.version=h.gradientVersion,tt=$e.texture}ee.activeTexture.set(U.TEXTURE1),tt.bind(h.stepInterpolant?U.NEAREST:U.LINEAR,U.CLAMP_TO_EDGE)}L&&(ee.activeTexture.set(U.TEXTURE0),ue.lineAtlasTexture.bind(U.LINEAR,U.REPEAT),me.updatePaintBuffers()),X&&(ee.activeTexture.set(U.TEXTURE0),ue.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),me.updatePaintBuffers()),g.prepareDrawProgram(ee,be,re.toUnwrapped());const Me=$e=>{be.draw(ee,U.TRIANGLES,M,$e,I,f.CullFaceMode.disabled,Qe,h.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,h.paint,g.transform.zoom,me,[ge.layoutVertexBuffer2])};if(ie){const $e=g.stencilModeForClipping(re).ref;0===$e&&g.terrain&&ee.clear({stencil:0});const tt={func:U.EQUAL,mask:255};Qe.u_alpha_discard_threshold=.8,Me(new f.StencilMode(tt,$e,255,U.KEEP,U.KEEP,U.INVERT)),Qe.u_alpha_discard_threshold=0,Me(new f.StencilMode(tt,$e,255,U.KEEP,U.KEEP,U.KEEP))}else Me(g.stencilModeForClipping(re))}ie&&(g.resetStencilClippingMasks(),g.terrain&&ee.clear({stencil:0}))},fill:function(g,c,h,y){const x=h.paint.get("fill-color"),C=h.paint.get("fill-opacity");if(0===C.constantOr(1))return;const M=g.colorModeForRenderPass(),I=h.paint.get("fill-pattern"),R=g.opaquePassEnabledForLayer()&&!I.constantOr(1)&&1===x.constantOr(f.Color.transparent).a&&1===C.constantOr(0)?"opaque":"translucent";if(g.renderPass===R){const N=g.depthModeForSublayer(1,"opaque"===g.renderPass?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly);Nm(g,c,h,y,N,M,!1)}if("translucent"===g.renderPass&&h.paint.get("fill-antialias")){const N=g.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,f.DepthMode.ReadOnly);Nm(g,c,h,y,N,M,!0)}},"fill-extrusion":function(g,c,h,y){const x=h.paint.get("fill-extrusion-opacity");if(0!==x&&"translucent"===g.renderPass){const C=new f.DepthMode(g.context.gl.LEQUAL,f.DepthMode.ReadWrite,g.depthRangeFor3D);if(1!==x||h.paint.get("fill-extrusion-pattern").constantOr(1))bh(g,c,h,y,C,f.StencilMode.disabled,f.ColorMode.disabled),bh(g,c,h,y,C,g.stencilModeFor3D(),g.colorModeForRenderPass()),g.resetStencilClippingMasks();else{const M=g.colorModeForRenderPass();bh(g,c,h,y,C,f.StencilMode.disabled,M)}}},hillshade:function(g,c,h,y){if("offscreen"!==g.renderPass&&"translucent"!==g.renderPass)return;const x=g.context,C=g.depthModeForSublayer(0,f.DepthMode.ReadOnly),M=g.colorModeForRenderPass(),I=g.terrain&&g.terrain.renderingToTexture,[R,N]="translucent"!==g.renderPass||I?[{},y]:g.stencilConfigForOverlap(y);for(const L of N){const V=c.getTile(L);if(V.needsHillshadePrepare&&"offscreen"===g.renderPass)Om(g,V,h,C,f.StencilMode.disabled,M);else if("translucent"===g.renderPass){const W=I&&g.terrain?g.terrain.stencilModeForRTTOverlap(L):R[L.overscaledZ];uh(g,L,V,h,C,W,M)}}x.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,c,h,y,x,C){if("translucent"!==g.renderPass||0===h.paint.get("raster-opacity")||!y.length)return;const M=g.context,I=M.gl,R=c.getSource(),N=g.useProgram("raster"),L=g.colorModeForRenderPass(),V=g.terrain&&g.terrain.renderingToTexture,[W,X]=R instanceof wn||V?[{},y]:g.stencilConfigForOverlap(y),Q=X[X.length-1].overscaledZ,K=!g.options.moving;for(const ee of X){const U=V?f.DepthMode.disabled:g.depthModeForSublayer(ee.overscaledZ-Q,1===h.paint.get("raster-opacity")?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly,I.LESS),Z=ee.toUnwrapped(),ie=c.getTile(ee);if(V&&(!ie||!ie.hasData()))continue;const re=V?ee.projMatrix:g.transform.calculateProjMatrix(Z,K),ue=g.terrain&&V?g.terrain.stencilModeForRTTOverlap(ee):W[ee.overscaledZ],ge=C?0:h.paint.get("raster-fade-duration");ie.registerFadeDuration(ge);const me=c.findLoadedParent(ee,0),be=gt(ie,me,c,g.transform,ge);let ve,Ae;g.terrain&&g.terrain.prepareDrawTile();const Je="nearest"===h.paint.get("raster-resampling")?I.NEAREST:I.LINEAR;M.activeTexture.set(I.TEXTURE0),ie.texture.bind(Je,I.CLAMP_TO_EDGE),M.activeTexture.set(I.TEXTURE1),me?(me.texture.bind(Je,I.CLAMP_TO_EDGE),ve=Math.pow(2,me.tileID.overscaledZ-ie.tileID.overscaledZ),Ae=[ie.tileID.canonical.x*ve%1,ie.tileID.canonical.y*ve%1]):ie.texture.bind(Je,I.CLAMP_TO_EDGE),ie.texture.useMipmap&&M.extTextureFilterAnisotropic&&g.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax);const De=zp(re,Ae||[0,0],ve||1,be,h,R instanceof wn?R.perspectiveTransform:[0,0]);if(g.prepareDrawProgram(M,N,Z),R instanceof wn)R.boundsBuffer&&R.boundsSegments&&N.draw(M,I.TRIANGLES,U,f.StencilMode.disabled,L,f.CullFaceMode.disabled,De,h.id,R.boundsBuffer,g.quadTriangleIndexBuffer,R.boundsSegments);else{const{tileBoundsBuffer:Ve,tileBoundsIndexBuffer:Re,tileBoundsSegments:Qe}=g.getTileBoundsBuffers(ie);N.draw(M,I.TRIANGLES,U,ue,L,f.CullFaceMode.disabled,De,h.id,Ve,Re,Qe)}}g.resetStencilClippingMasks()},background:function(g,c,h,y){const x=h.paint.get("background-color"),C=h.paint.get("background-opacity");if(0===C)return;const M=g.context,I=M.gl,R=g.transform,N=R.tileSize,L=h.paint.get("background-pattern");if(g.isPatternMissing(L))return;const V=!L&&1===x.a&&1===C&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==V)return;const W=f.StencilMode.disabled,X=g.depthModeForSublayer(0,"opaque"===V?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly),Q=g.colorModeForRenderPass(),K=g.useProgram(L?"backgroundPattern":"background");let ee,U=y;U||(ee=g.getBackgroundTiles(),U=Object.values(ee).map(Z=>Z.tileID)),L&&(M.activeTexture.set(I.TEXTURE0),g.imageManager.bind(g.context));for(const Z of U){const ie=Z.toUnwrapped(),re=y?Z.projMatrix:g.transform.calculateProjMatrix(ie);g.prepareDrawTile();const ue=c?c.getTile(Z):ee?ee[Z.key]:new f.Tile(Z,N,R.zoom,g),ge=L?G_(re,C,g,L,{tileID:Z,tileSize:N}):yh(re,C,x);g.prepareDrawProgram(M,K,ie);const{tileBoundsBuffer:me,tileBoundsIndexBuffer:be,tileBoundsSegments:ve}=g.getTileBoundsBuffers(ue);K.draw(M,I.TRIANGLES,X,W,Q,f.CullFaceMode.disabled,ge,h.id,me,be,ve)}},sky:function(g,c,h){const y=g.transform,x="mercator"===y.projection.name||"globe"===y.projection.name?1:f.smoothstep(7,8,y.zoom),C=h.paint.get("sky-opacity")*x;if(0===C)return;const M=g.context,I=h.paint.get("sky-type"),R=new f.DepthMode(M.gl.LEQUAL,f.DepthMode.ReadOnly,[0,1]),N=g.frameCounter/1e3%1;"atmosphere"===I?"offscreen"===g.renderPass?h.needsSkyboxCapture(g)&&(function(L,V,W,X){const Q=L.context,K=Q.gl;let ee=V.skyboxFbo;if(!ee){ee=V.skyboxFbo=Q.createFramebuffer(32,32,!1),V.skyboxGeometry=new xh(Q),V.skyboxTexture=Q.gl.createTexture(),K.bindTexture(K.TEXTURE_CUBE_MAP,V.skyboxTexture),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_MAG_FILTER,K.LINEAR);for(let re=0;re<6;++re)K.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+re,0,K.RGBA,32,32,0,K.RGBA,K.UNSIGNED_BYTE,null)}Q.bindFramebuffer.set(ee.framebuffer),Q.viewport.set([0,0,32,32]);const U=V.getCenter(L,!0),Z=L.useProgram("skyboxCapture"),ie=new Float64Array(16);f.identity(ie),f.rotateY(ie,ie,.5*-Math.PI),Ms(Q,V,Z,ie,U,0),f.identity(ie),f.rotateY(ie,ie,.5*Math.PI),Ms(Q,V,Z,ie,U,1),f.identity(ie),f.rotateX(ie,ie,.5*-Math.PI),Ms(Q,V,Z,ie,U,2),f.identity(ie),f.rotateX(ie,ie,.5*Math.PI),Ms(Q,V,Z,ie,U,3),f.identity(ie),Ms(Q,V,Z,ie,U,4),f.identity(ie),f.rotateY(ie,ie,Math.PI),Ms(Q,V,Z,ie,U,5),Q.viewport.set([0,0,L.width,L.height])}(g,h),h.markSkyboxValid(g)):"sky"===g.renderPass&&function(L,V,W,X,Q){const K=L.context,ee=K.gl,U=L.transform,Z=L.useProgram("skybox");K.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_CUBE_MAP,V.skyboxTexture);const ie={u_matrix:U.skyboxMatrix,u_sun_direction:V.getCenter(L,!1),u_cubemap:0,u_opacity:X,u_temporal_offset:Q};L.prepareDrawProgram(K,Z),Z.draw(K,ee.TRIANGLES,W,f.StencilMode.disabled,L.colorModeForRenderPass(),f.CullFaceMode.backCW,ie,"skybox",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(g,h,R,C,N):"gradient"===I&&"sky"===g.renderPass&&function(L,V,W,X,Q){const K=L.context,ee=K.gl,U=L.transform,Z=L.useProgram("skyboxGradient");V.skyboxGeometry||(V.skyboxGeometry=new xh(K)),K.activeTexture.set(ee.TEXTURE0);let ie=V.colorRampTexture;ie||(ie=V.colorRampTexture=new f.Texture(K,V.colorRamp,ee.RGBA)),ie.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const re=(ue=U.skyboxMatrix,ge=V.getCenter(L,!1),me=V.paint.get("sky-gradient-radius"),be=X,ve=Q,{u_matrix:ue,u_color_ramp:0,u_center_direction:ge,u_radius:f.degToRad(me),u_opacity:be,u_temporal_offset:ve});var ue,ge,me,be,ve;L.prepareDrawProgram(K,Z),Z.draw(K,ee.TRIANGLES,W,f.StencilMode.disabled,L.colorModeForRenderPass(),f.CullFaceMode.backCW,re,"skyboxGradient",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(g,h,R,C,N)},debug:function(g,c,h){for(let y=0;y<h.length;y++)ao(g,c,h[y])},custom:function(g,c,h,y){const x=g.context,C=h.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||"offscreen"===g.renderPass)&&h.isLayerDraped()){if("offscreen"===g.renderPass){const M=C.prerender;if(M){if(g.setCustomLayerDefaults(),x.setColorMode(g.colorModeForRenderPass()),"globe"===g.transform.projection.name){const I=g.transform.pointMerc;M.call(C,x.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),f.globeToMercatorTransition(g.transform.zoom),[I.x,I.y],g.transform.pixelsPerMeterRatio)}else M.call(C,x.gl,g.transform.customLayerMatrix());x.setDirty(),g.setBaseState()}}else if("translucent"===g.renderPass){if(g.terrain&&g.terrain.renderingToTexture){const I=C.renderToTile;if(I){const R=y[0].canonical,N=new f.MercatorCoordinate(R.x+y[0].wrap*(1<<R.z),R.y,R.z);x.setDepthMode(f.DepthMode.disabled),x.setStencilMode(f.StencilMode.disabled),x.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),I.call(C,x.gl,N),x.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),x.setColorMode(g.colorModeForRenderPass()),x.setStencilMode(f.StencilMode.disabled);const M="3d"===C.renderingMode?new f.DepthMode(g.context.gl.LEQUAL,f.DepthMode.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,f.DepthMode.ReadOnly);if(x.setDepthMode(M),"globe"===g.transform.projection.name){const I=g.transform.pointMerc;C.render(x.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),f.globeToMercatorTransition(g.transform.zoom),[I.x,I.y],g.transform.pixelsPerMeterRatio)}else C.render(x.gl,g.transform.customLayerMatrix());x.setDirty(),g.setBaseState(),x.bindFramebuffer.set(null)}}else f.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class ki{constructor(c,h,y=!1){this.context=new ct(c,y),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=f.SourceCache.maxUnderzooming+f.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(c,h){const y=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Fp(this,c));const x=this._terrain;this.transform.elevation=y?x:null,x.update(c,this.transform,h)}_updateFog(c){const h=c.fog;if(!h||"globe"===this.transform.projection.name||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,x]=h.getFovAdjustedRange(this.transform._fov);if(y>x)return void(this.transform.fogCullDistSq=null);const C=y+.78*(x-y);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,h){if(this.width=c*f.exported.devicePixelRatio,this.height=h*f.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const c=this.context,h=new f.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(f.EXTENT,0),h.emplaceBack(0,f.EXTENT),h.emplaceBack(f.EXTENT,f.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(h,f.posAttributes.members),this.tileExtentSegments=f.SegmentVector.simpleSegment(0,0,4,2);const y=new f.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(f.EXTENT,0),y.emplaceBack(0,f.EXTENT),y.emplaceBack(f.EXTENT,f.EXTENT),this.debugBuffer=c.createVertexBuffer(y,f.posAttributes.members),this.debugSegments=f.SegmentVector.simpleSegment(0,0,4,5);const x=new f.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(x,f.posAttributes.members),this.viewportSegments=f.SegmentVector.simpleSegment(0,0,4,2);const C=new f.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(f.EXTENT,0,f.EXTENT,0),C.emplaceBack(0,f.EXTENT,0,f.EXTENT),C.emplaceBack(f.EXTENT,f.EXTENT,f.EXTENT,f.EXTENT),this.mercatorBoundsBuffer=c.createVertexBuffer(C,f.boundsAttributes.members),this.mercatorBoundsSegments=f.SegmentVector.simpleSegment(0,0,4,2);const M=new f.StructArrayLayout3ui6;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(M);const I=new f.StructArrayLayout1ui2;for(const N of[0,1,3,2,0])I.emplaceBack(N);this.debugIndexBuffer=c.createIndexBuffer(I),this.emptyTexture=new f.Texture(c,new f.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=f.create();const R=this.context.gl;this.stencilClearMode=new f.StencilMode({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO),this.loadTimeStamps.push(f.window.performance.now()),this.atmosphereBuffer=new It(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context,h=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(c,h.TRIANGLES,f.DepthMode.disabled,this.stencilClearMode,f.ColorMode.disabled,f.CullFaceMode.disabled,Zc(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,h,y){if(!h||this.currentStencilSource===h.id||!c.isTileClipped()||!y||0===y.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const R of y)if(void 0===this._tileClippingMaskIDs[R.key]){I=!0;break}if(!I)return}this.currentStencilSource=h.id;const x=this.context,C=x.gl;this.nextStencilID+y.length>256&&this.clearStencil(),x.setColorMode(f.ColorMode.disabled),x.setDepthMode(f.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of y){const R=h.getTile(I),N=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:L,tileBoundsIndexBuffer:V,tileBoundsSegments:W}=this.getTileBoundsBuffers(R);M.draw(x,C.TRIANGLES,f.DepthMode.disabled,new f.StencilMode({func:C.ALWAYS,mask:0},N,255,C.KEEP,C.KEEP,C.REPLACE),f.ColorMode.disabled,f.CullFaceMode.disabled,Zc(I.projMatrix),"$clipping",L,V,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,h=this.context.gl;return new f.StencilMode({func:h.NOTEQUAL,mask:255},c,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const h=this.context.gl;return new f.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(c){const h=this.context.gl,y=c.sort((M,I)=>I.overscaledZ-M.overscaledZ),x=y[y.length-1].overscaledZ,C=y[0].overscaledZ-x+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const M={};for(let I=0;I<C;I++)M[I+x]=new f.StencilMode({func:h.GEQUAL,mask:255},I+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=C,[M,y]}return[{[x]:f.StencilMode.disabled},y]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new f.ColorMode([c.CONSTANT_COLOR,c.ONE],new f.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?f.ColorMode.unblended:f.ColorMode.alphaBlended}depthModeForSublayer(c,h,y){if(!this.opaquePassEnabledForLayer())return f.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new f.DepthMode(y||this.context.gl.LEQUAL,h,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,h){this.style=c,this.options=h,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(f.exported.now()),this.imageManager.beginFrame();const y=this.style.order,x=this.style._sourceCaches;for(const N in x){const L=x[N];L.used&&L.prepare(this.context)}const C={},M={},I={};for(const N in x){const L=x[N];C[N]=L.getVisibleCoordinates(),M[N]=C[N].slice().reverse(),I[N]=L.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let N=0;N<y.length;N++)if(this.style._layers[y[N]].is3D()){this.opaquePassCutoff=N;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new f.GlobeSharedBuffers(this.context)),!f.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const N of y){const L=this.style._layers[N],V=c._getLayerSourceCache(L);if(!L.hasOffscreenPass()||L.isHidden(this.transform.zoom))continue;const W=V?M[V.id]:void 0;("custom"===L.type||L.isSky()||W&&W.length)&&this.renderLayer(this,V,L,W)}this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon];const R=this.terrain;if(R&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&R.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?f.Color.black:f.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const N=this.style._layers[y[this.currentLayer]],L=c._getLayerSourceCache(N);if(N.isSky())continue;const V=L?M[L.id]:void 0;this._renderTileClippingMasks(N,L,V),this.renderLayer(this,L,N,V)}if(this.style.fog&&this.transform.projection.supportsFog&&function(N,L){const V=N.context,W=V.gl,X=N.transform,Q=new f.DepthMode(W.LEQUAL,f.DepthMode.ReadOnly,[0,1]),K=N.useProgram("globeAtmosphere",null,"globe"===X.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ee=f.globeToMercatorTransition(X.zoom),U=L.properties.get("color").toArray01(),Z=L.properties.get("high-color").toArray01(),ie=L.properties.get("space-color").toArray01PremultipliedAlpha(),re=f.identity$1([]);f.rotateY$1(re,re,-f.degToRad(X._center.lng)),f.rotateX$1(re,re,f.degToRad(X._center.lat)),f.rotateZ$1(re,re,X.angle),f.rotateX$1(re,re,-X._pitch);const ue=f.fromQuat(new Float32Array(16),re),ge=f.mapValue(L.properties.get("star-intensity"),0,1,0,.25),be=f.mapValue(L.properties.get("horizon-blend"),0,1,5e-4,.25),ve=f.globeUseCustomAntiAliasing(N,V,X)&&5e-4===be?X.worldSize/(2*Math.PI*1.025)-1:X.globeRadius,Ae=N.frameCounter/1e3%1,Je=f.length(X.globeCenterInViewSpace),De=Math.sqrt(Math.pow(Je,2)-Math.pow(ve,2)),Ve=Math.acos(De/Je),Re={u_frustum_tl:X.frustumCorners.TL,u_frustum_tr:X.frustumCorners.TR,u_frustum_br:X.frustumCorners.BR,u_frustum_bl:X.frustumCorners.BL,u_horizon:X.frustumCorners.horizon,u_transition:ee,u_fadeout_range:be,u_color:U,u_high_color:Z,u_space_color:ie,u_star_intensity:ge,u_star_size:5*f.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ae,u_horizon_angle:Ve,u_rotation_matrix:ue};N.prepareDrawProgram(V,K);const Qe=N.atmosphereBuffer;Qe&&K.draw(V,W.TRIANGLES,Q,f.StencilMode.disabled,f.ColorMode.alphaBlended,f.CullFaceMode.backCW,Re,"skybox",Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)}(this,this.style.fog),this.renderPass="sky",(f.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const N=this.style._layers[y[this.currentLayer]],L=c._getLayerSourceCache(N);N.isSky()&&this.renderLayer(this,L,N,L?M[L.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const N=this.style._layers[y[this.currentLayer]],L=c._getLayerSourceCache(N);if(N.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(N)){if(N.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const V=L?("symbol"===N.type?I:M)[L.id]:void 0;this._renderTileClippingMasks(N,L,L?C[L.id]:void 0),this.renderLayer(this,L,N,V),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let N=null;f.values(this.style._layers).forEach(L=>{const V=c._getLayerSourceCache(L);V&&!L.isHidden(this.transform.zoom)&&(!N||N.getSource().maxzoom<V.getSource().maxzoom)&&(N=V)}),N&&this.options.showTileBoundaries&&dn.debug(this,N,N.getVisibleCoordinates())}this.options.showPadding&&function(N){const L=N.transform.padding;Mo(N,N.transform.height-(L.top||0),3,ed),Mo(N,L.bottom||0,3,Bm),Ua(N,L.left||0,3,rt),Ua(N,N.transform.width-(L.right||0),3,$o);const V=N.transform.centerPoint;var W,X,Q,K;Rr(W=N,(X=V.x)-1,(Q=N.transform.height-V.y)-10,2,20,K=di),Rr(W,X-10,Q-1,20,2,K)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(f.window.performance.now()),this.saveCanvasCopy())}renderLayer(c,h,y,x){y.isHidden(this.transform.zoom)||("background"===y.type||"sky"===y.type||"custom"===y.type||x&&x.length)&&(this.id=y.id,this.gpuTimingStart(y),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(y.type)||c.terrain&&"custom"===y.type)&&dn[y.type](c,h,y,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let y=this.gpuTimers[c.id];y||(y=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),y.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,h=c.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),c.beginQueryEXT(c.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const h={};for(const y in c){const x=c[y],C=this.context.extTimerQuery,M=C.getQueryObjectEXT(x.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(x.query),h[y]=M}return h}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let y=0;for(const x of c)y+=h.getQueryObjectEXT(x,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(x);return y}translatePosMatrix(c,h,y,x,C){if(!y[0]&&!y[1])return c;const M=C?"map"===x?this.transform.angle:0:"viewport"===x?-this.transform.angle:0;if(M){const N=Math.sin(M),L=Math.cos(M);y=[y[0]*L-y[1]*N,y[0]*N+y[1]*L]}const I=[C?y[0]:gn(h,y[0],this.transform.zoom),C?y[1]:gn(h,y[1],this.transform.zoom),0],R=new Float32Array(16);return f.translate(R,c,I),R}saveTileTexture(c){const h=this._tileTextures[c.size[0]];h?h.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const h=this._tileTextures[c];return h&&h.length>0?h.pop():null}isPatternMissing(c){return null===c||void 0!==c&&!this.imageManager.getPattern(c.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&0===this.terrain.exaggeration(),y=this.style&&this.style.fog,x=[];return this.terrainRenderModeElevated()&&x.push("TERRAIN"),"globe"===this.transform.projection.name&&x.push("GLOBE"),h&&x.push("ZERO_EXAGGERATION"),y&&!c&&0!==y.getOpacity(this.transform.pitch)&&x.push("FOG"),c&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}useProgram(c,h,y){this.cache=this.cache||{};const x=y||[],C=this.currentGlobalDefines().concat(x),M=Hn.cacheKey(Ii[c],c,C,h);return this.cache[M]||(this.cache[M]=new Hn(this.context,c,Ii[c],h,Up[c],C)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=f.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new f.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(c,h,y){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const C=x.getOpacity(this.transform.pitch),M=((I,R,N,L,V,W,X,Q,K,ee,U)=>{const Z=I.transform,ie=R.properties.get("color").toArray01();ie[3]=L;const re=I.frameCounter/1e3%1;return{u_fog_matrix:N?Z.calculateFogTileMatrix(N):I.identityMat,u_fog_range:R.getFovAdjustedRange(Z._fov),u_fog_color:ie,u_fog_horizon_blend:R.properties.get("horizon-blend"),u_fog_temporal_offset:re,u_frustum_tl:V,u_frustum_tr:W,u_frustum_br:X,u_frustum_bl:Q,u_globe_pos:K,u_globe_radius:ee,u_viewport:U,u_globe_transition:f.globeToMercatorTransition(Z.zoom),u_is_globe:+("globe"===Z.projection.name)}})(this,x,y,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*f.exported.devicePixelRatio,this.transform.height*f.exported.devicePixelRatio]);h.setFogUniformValues(c,M)}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,h=c.createTexture();return c.bindTexture(c.TEXTURE_2D,h),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&0!==c.getOpacity(this.transform.pitch)}getBackgroundTiles(){const c=this._backgroundTiles,h=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const x of y)h[x.key]=c[x.key]||new f.Tile(x,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class Go{constructor(c=0,h=0,y=0,x=0){if(isNaN(c)||c<0||isNaN(h)||h<0||isNaN(y)||y<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=h,this.left=y,this.right=x}interpolate(c,h,y){return null!=h.top&&null!=c.top&&(this.top=f.number(c.top,h.top,y)),null!=h.bottom&&null!=c.bottom&&(this.bottom=f.number(c.bottom,h.bottom,y)),null!=h.left&&null!=c.left&&(this.left=f.number(c.left,h.left,y)),null!=h.right&&null!=c.right&&(this.right=f.number(c.right,h.right,y)),this}getCenter(c,h){const y=f.clamp((this.left+c-this.right)/2,0,c),x=f.clamp((this.top+h-this.bottom)/2,0,h);return new f.Point(y,x)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Go(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ma(g,c){const h=f.getColumn(g,3);f.fromQuat(g,c),f.setColumn(g,3,h)}function tn(g,c){const h=f.identity$1([]);return f.rotateZ$1(h,h,-c),f.rotateX$1(h,h,-g),h}function ga(g,c){const h=[g[0],g[1],0],y=[c[0],c[1],0];if(f.length(h)>=1e-15){const M=f.normalize([],h);f.scale$2(y,M,f.dot(y,M)),c[0]=y[0],c[1]=y[1]}const x=f.cross([],c,g);if(f.len(x)<1e-15)return null;const C=Math.atan2(-x[1],x[0]);return tn(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),C)}class tr{constructor(c,h){this.position=c,this.orientation=h}get position(){return this._position}set position(c){if(c){const h=c instanceof f.MercatorCoordinate?c:new f.MercatorCoordinate(c[0],c[1],c[2]);this._renderWorldCopies&&(h.x=f.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(c,h){if(this.orientation=null,!this.position)return;const y=this.position,x=this._elevation?this._elevation.getAtPointOrZero(f.MercatorCoordinate.fromLngLat(c)):0,C=f.MercatorCoordinate.fromLngLat(c,x),M=[C.x-y.x,C.y-y.y,C.z-y.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=ga(M,h)}setPitchBearing(c,h){this.orientation=tn(f.degToRad(c),f.degToRad(-h))}}class ja{constructor(c,h){this._transform=f.identity([]),this.orientation=h,this.position=c}get mercatorPosition(){const c=this.position;return new f.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=f.getColumn(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var h;c&&f.setColumn(this._transform,3,[(h=c)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||f.identity$1([]),c&&ma(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,h){this._orientation=tn(c,h),ma(this._transform,this._orientation)}forward(){const c=f.getColumn(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=f.getColumn(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=f.getColumn(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,h){const y=new Float64Array(16);return f.invert(y,this.getWorldToCamera(c,h)),y}getWorldToCameraPosition(c,h,y){const x=this.position;f.scale$2(x,x,-c);const C=new Float64Array(16);return f.fromScaling(C,[y,y,y]),f.translate(C,C,x),C[10]*=h,C}getWorldToCamera(c,h){const y=new Float64Array(16),x=new Float64Array(4),C=this.position;return f.conjugate(x,this._orientation),f.scale$2(C,C,-c),f.fromQuat(y,x),f.translate(y,y,C),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=h,y[9]*=h,y[10]*=h,y[11]*=h,y}getCameraToClipPerspective(c,h,y,x){const C=new Float64Array(16);return f.perspective(C,c,h,y,x),C}getDistanceToElevation(c,h=!1){const y=0===c?0:f.mercatorZfromAltitude(c,h?f.latFromMercatorY(this.position[1]):this.position[1]),x=this.forward();return(y-this.position[2])/x[2]}clone(){return new ja([...this.position],[...this.orientation])}}function Ts(g,c){const h=bl(g.projection,g.zoom,g.width,g.height),y=function(C,M,I,R,N){const L=new f.LngLat(I.lng-180*_a,I.lat),V=new f.LngLat(I.lng+180*_a,I.lat),W=C.project(L.lng,L.lat),X=C.project(V.lng,V.lat),Q=-Math.atan2(X.y-W.y,X.x-W.x),K=f.MercatorCoordinate.fromLngLat(I);K.y=f.clamp(K.y,-1+_a,1-_a);const ee=K.toLngLat(),U=C.project(ee.lng,ee.lat),Z=f.MercatorCoordinate.fromLngLat(ee);Z.x+=_a;const ie=Z.toLngLat(),re=C.project(ie.lng,ie.lat),ue=nr(re.x-U.x,re.y-U.y,Q),ge=f.MercatorCoordinate.fromLngLat(ee);ge.y+=_a;const me=ge.toLngLat(),be=C.project(me.lng,me.lat),ve=nr(be.x-U.x,be.y-U.y,Q),Ae=Math.abs(ue.x)/Math.abs(ve.y),Je=f.identity([]);f.rotateZ(Je,Je,-Q*(1-(N?0:R)));const De=f.identity([]);return f.scale(De,De,[1,1-(1-Ae)*R,1]),De[4]=-ve.x/ve.y*R,f.rotateZ(De,De,Q),f.multiply(De,Je,De),De}(g.projection,0,g.center,h,c),x=Dn(g);return f.scale(y,y,[x,x,1]),y}function Dn(g){const c=g.projection,h=bl(g.projection,g.zoom,g.width,g.height),y=sc(c,g.center),x=sc(c,f.LngLat.convert(c.center));return Math.pow(2,y*h+(1-h)*x)}function bl(g,c,h,y,x=1/0){const C=g.range;if(!C)return 0;const M=Math.min(x,Math.max(h,y)),I=Math.log(M/1024)/Math.LN2;return f.smoothstep(C[0]+I,C[1]+I,c)}const _a=1/4e4;function sc(g,c){const h=f.clamp(c.lat,-f.MAX_MERCATOR_LATITUDE,f.MAX_MERCATOR_LATITUDE),y=new f.LngLat(c.lng-180*_a,h),x=new f.LngLat(c.lng+180*_a,h),C=g.project(y.lng,h),M=g.project(x.lng,h),I=f.MercatorCoordinate.fromLngLat(y),R=f.MercatorCoordinate.fromLngLat(x),N=M.x-C.x,L=M.y-C.y,V=R.x-I.x,W=R.y-I.y,X=Math.sqrt((V*V+W*W)/(N*N+L*L));return Math.log(X)/Math.LN2}function nr(g,c,h){const y=Math.cos(h),x=Math.sin(h);return{x:g*y-c*x,y:g*x+c*y}}class ya{constructor(c,h,y,x,C,M,I){this.tileSize=512,this._renderWorldCopies=void 0===C||C,this._minZoom=c||0,this._maxZoom=h||22,this._minPitch=y??0,this._maxPitch=x??60,this.setProjection(M),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new f.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Go,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ja,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const c=new ya(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(c,h=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||y)&&this._updateCameraOnTerrain(),(c||y)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return f.pick(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=f.getProjection(this.projectionOptions);const y=!Ie(h,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=f.getProjection({name:"mercator"});const h=c!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(c){void 0===c?c=!0:null===c&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return f.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new f.Point(this.width,this.height)}get bearing(){return f.wrap(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const h=-c*Math.PI/180;var y,x,C,M,I,R,N,L,V,W;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(y=new f.ARRAY_TYPE(4),f.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),x=this.rotationMatrix,M=this.angle,I=(C=this.rotationMatrix)[0],R=C[1],N=C[2],L=C[3],V=Math.sin(M),W=Math.cos(M),x[0]=I*W+N*V,x[1]=R*W+L*V,x[2]=I*-V+N*W,x[3]=R*-V+L*W)}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const h=f.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=f.degToRad(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const h=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;this._centerAltitude=c.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=c.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let x=0,C=0;for(let M=0;M<h.length;M++){const I=new f.Point(h[M][0]*this.width,y+h[M][1]*(this.height-y)),R=c.pointCoordinate(I);if(!R)continue;const N=1/Math.hypot(R[0]-this._camera.position[0],R[1]-this._camera.position[1]);x+=R[3]*N,C+=N}return 0===C?NaN:x/C}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const c=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*h,x=this._mercatorZfromZoom(c),C=this._mercatorZfromZoom(this._maxZoom),M=Math.max(x-y,C);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let y;y=c.z<this._camera.position[2]?[h.x,h.y,h.z]:[c.x,c.y,c.z];const x=f.length(f.sub([],this._camera.position,y));return f.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let h=!1;if(c.orientation&&!f.exactEquals(c.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(c.orientation)),c.position){const y=[c.position.x,c.position.y,c.position.z];f.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,h=new tr;return h.position=new f.MercatorCoordinate(c[0],c[1],c[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(c){if(!f.length$1(c))return!1;f.normalize$1(c,c);const h=f.transformQuat([],[0,0,-1],c),y=f.transformQuat([],[0,-1,0],c);if(y[2]<0)return!1;const x=ga(h,y);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(c){const h=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;c[2]=f.clamp(c[2],x/y,x/h),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,h,y){this._unmodified=!1,this._edgeInsets.interpolate(c,h,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const h=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(c){const h=[new f.UnwrappedTileID(0,c)];if(this.renderWorldCopies){const y=this.pointCoordinate(new f.Point(0,0)),x=this.pointCoordinate(new f.Point(this.width,0)),C=this.pointCoordinate(new f.Point(this.width,this.height)),M=this.pointCoordinate(new f.Point(0,this.height)),I=Math.floor(Math.min(y.x,x.x,C.x,M.x)),R=Math.floor(Math.max(y.x,x.x,C.x,M.x)),N=1;for(let L=I-N;L<=R+N;L++)0!==L&&h.push(new f.UnwrappedTileID(L,c))}return h}coveringTiles(c){let h=this.coveringZoomLevel(c);const y=h,x=this.elevation&&!c.isTerrainDEM,C="mercator"===this.projection.name;if(void 0!==c.minzoom&&h<c.minzoom)return[];void 0!==c.maxzoom&&h>c.maxzoom&&(h=c.maxzoom);const M=this.locationCoordinate(this.center),I=this.center.lat,R=1<<h,N=[R*M.x,R*M.y,0],L="globe"===this.projection.name,V=!L,W=f.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,V),X=L?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Q=R*f.mercatorZfromAltitude(1,this.center.lat),K=this._camera.position[2]/f.mercatorZfromAltitude(1,this.center.lat),ee=[R*X.x,R*X.y,K*(V?1:Q)],U=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),Z=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,ie=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,re=c.isTerrainDEM?-ie:this._elevation?this._elevation.getMinElevationBelowMSL():0,ue=this.projection.isReprojectedInTileSpace?Dn(this):1,ge=Me=>{const tt=new f.MercatorCoordinate(Me.x+25e-6,Me.y,Me.z),We=new f.MercatorCoordinate(Me.x,Me.y+25e-6,Me.z),Le=Me.toLngLat(),Pt=tt.toLngLat(),nn=We.toLngLat(),Mt=this.locationCoordinate(Le),Ut=this.locationCoordinate(Pt),On=this.locationCoordinate(nn),Sn=Math.hypot(Ut.x-Mt.x,Ut.y-Mt.y),At=Math.hypot(On.x-Mt.x,On.y-Mt.y);return Math.sqrt(Sn*At)*ue/25e-6},me=Me=>{const $e=ie,tt=re;return{aabb:f.tileAABB(this,R,0,0,0,Me,tt,$e,this.projection),zoom:0,x:0,y:0,minZ:tt,maxZ:$e,wrap:Me,fullyVisible:!1}},be=[];let ve=[];const Ae=h,Je=c.reparseOverscaled?y:h,De=Me=>Me*Me,Ve=De((K-this._centerAltitude)*Q),Re=Me=>{if(!this._elevation||!Me.tileID||!C)return;const $e=this._elevation.getMinMaxForTile(Me.tileID),tt=Me.aabb;$e?(tt.min[2]=$e.min,tt.max[2]=$e.max,tt.center[2]=(tt.min[2]+tt.max[2])/2):(Me.shouldSplit=Qe(Me),Me.shouldSplit||(tt.min[2]=tt.max[2]=tt.center[2]=this._centerAltitude))},Qe=Me=>{if(Me.zoom<Z)return!0;if(Me.zoom===Ae)return!1;if(null!=Me.shouldSplit)return Me.shouldSplit;const $e=Me.aabb.distanceX(ee),tt=Me.aabb.distanceY(ee);let We=Ve,Le=1;if(L){We=De(Me.aabb.distanceZ(ee));const Mt=Math.pow(2,Me.zoom),Ut=f.latFromMercatorY((Me.y+1)/Mt),On=f.latFromMercatorY(Me.y/Mt),Sn=Math.min(Math.max(I,Ut),On),At=f.circumferenceAtLatitude(Sn)/f.circumferenceAtLatitude(I);if(Le=Sn===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,At/this._mercatorScaleRatio),this.zoom<=f.GLOBE_ZOOM_THRESHOLD_MIN&&Me.zoom===Ae-1&&At>=.9)return!0}else if(x&&(We=De(Me.aabb.distanceZ(ee)*Q)),this.projection.isReprojectedInTileSpace&&y<=5){const Mt=Math.pow(2,Me.zoom),Ut=ge(new f.MercatorCoordinate((Me.x+.5)/Mt,(Me.y+.5)/Mt));Le=Ut>.85?1:Ut}const Pt=$e*$e+tt*tt+We;return Pt<De((1<<Ae-Me.zoom)*U*Le*((Mt,Ut)=>{if(Ut*De(.707)<Mt)return 1;const On=Math.sqrt(Ut/Mt);return On/(1.4144271570014144+(Math.pow(1.1,On-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(We,Ve),Pt))};if(this.renderWorldCopies)for(let Me=1;Me<=3;Me++)be.push(me(-Me)),be.push(me(Me));for(be.push(me(0));be.length>0;){const Me=be.pop(),$e=Me.x,tt=Me.y;let We=Me.fullyVisible;if(!We){const Le=Me.aabb.intersects(W);if(0===Le)continue;We=2===Le}if(Me.zoom!==Ae&&Qe(Me))for(let Le=0;Le<4;Le++){const Pt=($e<<1)+Le%2,nn=(tt<<1)+(Le>>1),Mt={aabb:C?Me.aabb.quadrant(Le):f.tileAABB(this,R,Me.zoom+1,Pt,nn,Me.wrap,Me.minZ,Me.maxZ,this.projection),zoom:Me.zoom+1,x:Pt,y:nn,wrap:Me.wrap,fullyVisible:We,tileID:void 0,shouldSplit:void 0,minZ:Me.minZ,maxZ:Me.maxZ};x&&!L&&(Mt.tileID=new f.OverscaledTileID(Me.zoom+1===Ae?Je:Me.zoom+1,Me.wrap,Me.zoom+1,Pt,nn),Re(Mt)),be.push(Mt)}else{const Le=Me.zoom===Ae?Je:Me.zoom;if(c.minzoom&&c.minzoom>Le)continue;const Pt=N[0]-(.5+$e+(Me.wrap<<Me.zoom))*(1<<h-Me.zoom),nn=N[1]-.5-tt,Mt=Me.tileID?Me.tileID:new f.OverscaledTileID(Le,Me.wrap,Me.zoom,$e,tt);ve.push({tileID:Mt,distanceSq:Pt*Pt+nn*nn})}}if(this.fogCullDistSq){const Me=this.fogCullDistSq,$e=this.horizonLineFromTop();ve=ve.filter(tt=>{const We=[0,0,0,1],Le=[f.EXTENT,f.EXTENT,0,1],Pt=this.calculateFogTileMatrix(tt.tileID.toUnwrapped());f.transformMat4$1(We,We,Pt),f.transformMat4$1(Le,Le,Pt);const nn=f.getAABBPointSquareDist(We,Le);if(0===nn)return!0;let Mt=!1;const Ut=this._elevation;if(Ut&&nn>Me&&0!==$e){const On=this.calculateProjMatrix(tt.tileID.toUnwrapped());let Sn;c.isTerrainDEM||(Sn=Ut.getMinMaxForTile(tt.tileID)),Sn||(Sn={min:re,max:ie});const At=f.furthestTileCorner(this.rotation),oi=[At[0]*f.EXTENT,At[1]*f.EXTENT,Sn.max];f.transformMat4(oi,oi,On),Mt=(1-oi[1])*this.height*.5<$e}return nn<Me||Mt})}return ve.sort((Me,$e)=>Me.distanceSq-$e.distanceSq).map(Me=>Me.tileID)}resize(c,h){this.width=c,this.height=h,this.pixelsToGLUnits=[2/c,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const h=f.clamp(c.lat,-f.MAX_MERCATOR_LATITUDE,f.MAX_MERCATOR_LATITUDE),y=this.projection.project(c.lng,h);return new f.Point(y.x*this.worldSize,y.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/f.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,h){let y,x;const C=this.centerPoint;if("globe"===this.projection.name){const I=this.worldSize;y=(h.x-C.x)/I,x=(h.y-C.y)/I}else{const I=this.pointCoordinate(h),R=this.pointCoordinate(C);y=I.x-R.x,x=I.y-R.y}const M=this.locationCoordinate(c);this.setLocation(new f.MercatorCoordinate(M.x-y,M.y-x))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,h){const y=h?f.mercatorZfromAltitude(h,c.lat):void 0,x=this.projection.project(c.lng,c.lat);return new f.MercatorCoordinate(x.x,x.y,y)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,h){const y=h??this._centerAltitude,x=[c.x,c.y,0,1],C=[c.x,c.y,1,1];f.transformMat4$1(x,x,this.pixelMatrixInverse),f.transformMat4$1(C,C,this.pixelMatrixInverse);const M=C[3];f.scale$1(x,x,1/x[3]),f.scale$1(C,C,1/M);const I=x[2],R=C[2];return{p0:x,p1:C,t:I===R?0:(y-I)/(R-I)}}screenPointToMercatorRay(c){const h=[c.x,c.y,0,1],y=[c.x,c.y,1,1];return f.transformMat4$1(h,h,this.pixelMatrixInverse),f.transformMat4$1(y,y,this.pixelMatrixInverse),f.scale$1(h,h,1/h[3]),f.scale$1(y,y,1/y[3]),h[2]=f.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,y[2]=f.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,f.scale$1(h,h,1/this.worldSize),f.scale$1(y,y,1/this.worldSize),new f.Ray([h[0],h[1],h[2]],f.normalize([],f.sub([],y,h)))}rayIntersectionCoordinate(c){const{p0:h,p1:y,t:x}=c,C=f.mercatorZfromAltitude(h[2],this._center.lat),M=f.mercatorZfromAltitude(y[2],this._center.lat);return new f.MercatorCoordinate(f.number(h[0],y[0],x)/this.worldSize,f.number(h[1],y[1],x)/this.worldSize,f.number(C,M,x))}pointCoordinate(c,h=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,h)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let h=this.projection.pointCoordinate3D(this,c.x,c.y);if(h)return new f.MercatorCoordinate(h[0],h[1],h[2]);let y=0,x=this.horizonLineFromTop();if(c.y>x)return this.pointCoordinate(c);const C=.02*x,M=c.clone();for(let I=0;I<10&&x-y>C;I++){M.y=f.number(y,x,.66);const R=this.projection.pointCoordinate3D(this,M.x,M.y);R?(x=M.y,h=R):y=M.y}return h?new f.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}isPointOnSurface(c){if(c.y<0||c.y>this.height||c.x<0||c.x>this.width)return!1;if(this.elevation||this.zoom>=f.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(c);const h=this.pointCoordinate(c);return h.y>=0&&h.y<=1}_coordinatePoint(c,h){const y=h&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,x=[c.x*this.worldSize,c.y*this.worldSize,y+c.toAltitude(),1];return f.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new f.Point(x[0]/x[3],x[1]/x[3]):new f.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:h}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,C=this.pointLocation3D(new f.Point(h,c)),M=this.pointLocation3D(new f.Point(x,c)),I=this.pointLocation3D(new f.Point(x,y)),R=this.pointLocation3D(new f.Point(h,y));let N=Math.min(C.lng,M.lng,I.lng,R.lng),L=Math.max(C.lng,M.lng,I.lng,R.lng),V=Math.min(C.lat,M.lat,I.lat,R.lat),W=Math.max(C.lat,M.lat,I.lat,R.lat);const X=Math.pow(2,-this.zoom)/16*270,Q="globe"===this.projection.name?1:4,K=(ee,U,Z,ie,re)=>{const ue=(ee+Z)/2,ge=(U+ie)/2,me=new f.Point(ue,ge),{lng:be,lat:ve}=this.pointLocation3D(me),Ae=Math.max(0,N-be,V-ve,be-L,ve-W);N=Math.min(N,be),L=Math.max(L,be),V=Math.min(V,ve),W=Math.max(W,ve),(re<Q||Ae>X)&&(K(ee,U,ue,ge,re+1),K(ue,ge,Z,ie,re+1))};if(K(h,c,x,c,1),K(x,c,x,y,1),K(x,y,h,y,1),K(h,y,h,c,1),"globe"===this.projection.name){const[ee,U]=f.polesInViewport(this);ee?(W=90,L=180,N=-180):U&&(V=-90,L=180,N=-180)}return new f.LngLatBounds(new f.LngLat(N,V),new f.LngLat(L,W))}_getBoundsRectangular(c,h){const{top:y,left:x}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,M=this.width-this._edgeInsets.right,I=new f.Point(x,y),R=new f.Point(M,y),N=new f.Point(M,C),L=new f.Point(x,C);let V=this.pointCoordinate(I,c),W=this.pointCoordinate(R,c);const X=this.pointCoordinate(N,h),Q=this.pointCoordinate(L,h),K=(ee,U)=>(U.y-ee.y)/(U.x-ee.x);return V.y>1&&W.y>=0?V=new f.MercatorCoordinate((1-Q.y)/K(Q,V)+Q.x,1):V.y<0&&W.y<=1&&(V=new f.MercatorCoordinate(-Q.y/K(Q,V)+Q.x,0)),W.y>1&&V.y>=0?W=new f.MercatorCoordinate((1-X.y)/K(X,W)+X.x,1):W.y<0&&V.y<=1&&(W=new f.MercatorCoordinate(-X.y/K(X,W)+X.x,0)),(new f.LngLatBounds).extend(this.coordinateLocation(V)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(X))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=c.visibleDemTiles.reduce((y,x)=>{if(x.dem){const C=x.dem.tree;y.min=Math.min(y.min,C.minimums[0]),y.max=Math.max(y.max,C.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*c.exaggeration(),h.max*c.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-h*(1-this._horizonShift);return c?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-f.MAX_MERCATOR_LATITUDE,this.maxLat=f.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=f.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=f.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=f.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=f.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,h){return this.projection.createTileMatrix(this,h,c)}calculateDistanceTileData(c){const h=c.key,y=this._distanceTileDataCache;if(y[h])return y[h];const x=c.canonical,C=1/this.height,M=this.cameraWorldSize,I=M/this.zoomScale(x.z),R=(x.x+Math.pow(2,x.z)*c.wrap)*I,N=x.y*I,L=this.point;L.x*=M/this.worldSize,L.y*=M/this.worldSize;const V=this.angle,W=Math.sin(-V),X=-Math.cos(-V);return y[h]={bearing:[W,X],center:[(L.x-R)*C,(L.y-N)*C],scale:I/f.EXTENT*C},y[h]}calculateFogTileMatrix(c){const h=c.key,y=this._fogTileMatrixCache;if(y[h])return y[h];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return f.multiply(x,this.worldToFogMatrix,x),y[h]=new Float32Array(x),y[h]}calculateProjMatrix(c,h=!1){const y=c.key,x=h?this._alignedProjMatrixCache:this._projMatrixCache;if(x[y])return x[y];const C=this.calculatePosMatrix(c,this.worldSize);return f.multiply(C,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,C),x[y]=new Float32Array(C),x[y]}calculatePixelsToTileUnitsMatrix(c){const h=c.tileID.key,y=this._pixelsToTileUnitsCache;if(y[h])return y[h];const x=function(C,M){const{scale:I}=C.tileTransform,R=I*f.EXTENT/(C.tileSize*Math.pow(2,M.zoom-C.tileID.overscaledZ+C.tileID.canonical.z));return N=new Float32Array(4),W=(L=M.inverseAdjustmentMatrix)[1],X=L[2],Q=L[3],ee=(V=[R,R])[1],N[0]=L[0]*(K=V[0]),N[1]=W*K,N[2]=X*ee,N[3]=Q*ee,N;var N,L,V,W,X,Q,K,ee}(c,this);return y[h]=x,y[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const c=1/this.worldSize,h=f.fromScaling([],[c,c,c]);return f.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const c=this._elevation;this._updateCameraState();const h=f.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(h),x=this._camera.forward(),C=f.mercatorZfromAltitude(1,this._center.lat);y[2]/=C,x[2]/=C,f.normalize(x,x);const M=c.raycast(y,x,c.exaggeration());if(M){const I=f.scaleAndAdd([],y,x,M),R=new f.MercatorCoordinate(I[0],I[1],f.mercatorZfromAltitude(I[2],f.latFromMercatorY(I[1]))),N=(R.z+f.length([R.x-y[0],R.y-y[1],R.z-y[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(N),this._centerAltitude=R.toAltitude(),this._center=this.coordinateLocation(R),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const h=this._elevation,y=f.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(y),C=h.getAtPointOrZero(new f.MercatorCoordinate(...x)),M=this.pixelsPerMeter/this.worldSize*C,I=this._minimumHeightOverTerrain(),R=x[2]-M;if(R<=I)if(R<0||c){const N=this.locationCoordinate(this._center,this._centerAltitude),L=[x[0],x[1],N.z-x[2]],V=f.length(L);L[2]-=(I-R)/this._pixelsPerMercatorPixel;const W=f.length(L);if(0===W)return;f.scale$2(L,L,V/W*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],N.z*this._pixelsPerMercatorPixel-L[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const W=this.center;return W.lat=f.clamp(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(W.lng=f.clamp(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const h=this._unmodified,{x:y,y:x}=this.point;let C=0,M=y,I=x;const R=this.width/2,N=this.height/2,L=this.worldMinY*this.scale,V=this.worldMaxY*this.scale;if(x-N<L&&(I=L+N),x+N>V&&(I=V-N),V-L<this.height&&(C=Math.max(C,this.height/(V-L)),I=(V+L)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,X=this.worldMaxX*this.scale,Q=this.worldSize/2-(W+X)/2;M=(y+Q+this.worldSize)%this.worldSize-Q,M-R<W&&(M=W+R),M+R>X&&(M=X-R),X-W<this.width&&(C=Math.max(C,this.width/(X-W)),M=(X+W)/2)}M===y&&I===x||(this.center=this.unproject(new f.Point(M,I))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,h=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=f.mercatorZfromAltitude(1,this.center.lat)/f.mercatorZfromAltitude(1,f.GLOBE_SCALE_MATCH_LATITUDE));const y=bl(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x="meters"===this.projection.zAxisUnit?h:1,C=this._camera.getWorldToCamera(this.worldSize,x),M=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);M[8]=2*-c.x/this.width,M[9]=2*c.y/this.height;let I=f.mul([],M,C);if(this.projection.isReprojectedInTileSpace){const ge=this.locationCoordinate(this.center),me=f.identity([]);f.translate(me,me,[ge.x*this.worldSize,ge.y*this.worldSize,0]),f.multiply(me,me,Ts(this)),f.translate(me,me,[-ge.x*this.worldSize,-ge.y*this.worldSize,0]),f.multiply(I,I,me),this.inverseAdjustmentMatrix=function(be){const ve=Ts(be,!0);return pt([],[ve[0],ve[1],ve[4],ve[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=f.scale([],I,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=I,this.invProjMatrix=f.invert(new Float64Array(16),this.projMatrix);const R=f.invert([],M);this.frustumCorners=f.FrustumCorners.fromInvProjectionMatrix(R,this.horizonLineFromTop(),this.height);const N=new Float32Array(16);f.identity(N),f.scale(N,N,[1,-1,1]),f.rotateX(N,N,this._pitch),f.rotateZ(N,N,this.angle);const L=f.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),V=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;L[8]=2*-c.x/this.width,L[9]=2*(c.y+V)/this.height,this.skyboxMatrix=f.multiply(N,L,N);const W=this.point,X=W.x,Q=W.y,K=this.width%2/2,ee=this.height%2/2,U=Math.cos(this.angle),Z=Math.sin(this.angle),ie=X-Math.round(X)+U*K+Z*ee,re=Q-Math.round(Q)+U*ee+Z*K,ue=new Float64Array(I);if(f.translate(ue,ue,[ie>.5?ie-1:ie,re>.5?re-1:re,0]),this.alignedProjMatrix=ue,I=f.create(),f.scale(I,I,[this.width/2,-this.height/2,1]),f.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=f.create(),f.scale(I,I,[1,-1,1]),f.translate(I,I,[-1,-1,0]),f.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=f.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=f.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=f.calculateGlobeMatrix(this);const ge=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=f.transformMat4(ge,ge,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,y=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,C=[c,c,h];f.scale$2(C,C,x),f.scale$2(y,y,-1),f.multiply$2(y,y,C);const M=f.create();f.translate(M,M,y),f.scale(M,M,C),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,h,x)}_computeCameraPosition(c){const h=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),x=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-c/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-y[0]*C,x.y/this.worldSize-y[1]*C,c/this.worldSize*this._centerAltitude-y[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],x=c[2];let C=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(C=Math.min((h-y)/x,1)),this._camera.position=f.scaleAndAdd([],this._camera.position,c,C),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,h=this._camera.forward(),{pitch:y,bearing:x}=this._camera.getPitchBearing(),C=f.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(f.degToRad(this._maxPitch)),I=Math.max((c[2]-C)/Math.cos(y),M),R=this._zoomFromMercatorZ(I);f.scaleAndAdd(c,c,h,I),this._pitch=f.clamp(y,f.degToRad(this.minPitch),f.degToRad(this.maxPitch)),this.angle=f.wrap(x,-Math.PI,Math.PI),this._setZoom(f.clamp(R,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new f.MercatorCoordinate(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let h=0,y=f.GLOBE_ZOOM_THRESHOLD_MAX,x=0,C=1/0;for(;y-h>1e-6&&y>h;){const M=h+.5*(y-h),I=this.tileSize*Math.pow(2,M),R=this.getCameraToCenterDistance(this.projection,M,I),N=this.scaleZoom(R/(c*this.tileSize)),L=Math.abs(M-N);L<C&&(C=L,x=M),M<N?h=M:y=M}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(f.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,h){const y=Math.min(c.x,h.x),x=Math.max(c.x,h.x),C=Math.min(c.y,h.y),M=Math.max(c.y,h.y);if(C<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const I=[new f.Point(y,C),new f.Point(x,M),new f.Point(y,M),new f.Point(x,C)],R=this.renderWorldCopies?-3:0,N=this.renderWorldCopies?4:1;for(const L of I){const V=this.pointRayIntersection(L);if(V.t<0)return!0;const W=this.rayIntersectionCoordinate(V);if(W.x<R||W.y<0||W.x>N||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+f.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new f.Point(0,0),new f.Point(this.width,this.height))}zoomDeltaToMovement(c,h){const y=f.length(f.sub([],this._camera.position,c)),x=this._zoomFromMercatorZ(y)+h;return y-this._mercatorZfromZoom(x)}getCameraPoint(){if("globe"===this.projection.name){const c=function([h,y,x],C){const M=[h,y,x,1];f.transformMat4$1(M,M,C);const I=M[3]=Math.max(M[3],1e-6);return M[0]/=I,M[1]/=I,M[2]/=I,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new f.Point(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new f.Point(0,c))}}getCameraToCenterDistance(c,h=this.zoom,y=this.worldSize){const x=bl(c,h,this.width,this.height,1024),C=c.pixelSpaceConversion(this.center.lat,y,x);return.5/Math.tan(.5*this._fov)*this.height*C}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&f.multiply(c,c,this.globeMatrix),c}}function Js(g,c){let h=!1,y=null;const x=()=>{y=null,h&&(g(),y=setTimeout(x,c),h=!1)};return()=>(h=!0,y||x(),y)}class As{constructor(c){this._hashName=c&&encodeURIComponent(c),f.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Js(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,f.window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),f.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const h=Ha(c);if(this._hashName){const y=this._hashName;let x=!1;const C=f.window.location.hash.slice(1).split("&").map(M=>{const I=M.split("=")[0];return I===y?(x=!0,`${I}=${h}`):M}).filter(M=>M);return x||C.push(`${y}=${h}`),`#${C.join("&")}`}return`#${h}`}_getCurrentHash(){const c=f.window.location.hash.replace("#","");if(this._hashName){let h;return c.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(h=y)}),(h&&h[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(y=>isNaN(y))){const y=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(h[3]||0):c.getBearing();return c.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:y,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=f.window.location.href.replace(/(#.+)?$/,this.getHashString());f.window.history.replaceState(f.window.history.state,null,c)}}function Ha(g,c){const h=g.getCenter(),y=Math.round(100*g.getZoom())/100,x=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,x),M=Math.round(h.lng*C)/C,I=Math.round(h.lat*C)/C,R=g.getBearing(),N=g.getPitch();let L=c?`/${M}/${I}/${y}`:`${y}/${I}/${M}`;return(R||N)&&(L+="/"+Math.round(10*R)/10),N&&(L+=`/${Math.round(N)}`),L}const td={linearity:.3,easing:f.bezier(0,0,.3,1)},Qs=f.extend({deceleration:2500,maxSpeed:1400},td),Is=f.extend({deceleration:20,maxSpeed:1400},td),bt=f.extend({deceleration:1e3,maxSpeed:360},td),qo=f.extend({deceleration:1e3,maxSpeed:90},td);class $n{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:f.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,h=f.exported.now();for(;c.length>0&&h-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new f.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)h.zoom+=C.zoomDelta||0,h.bearing+=C.bearingDelta||0,h.pitch+=C.pitchDelta||0,C.panDelta&&h.pan._add(C.panDelta),C.around&&(h.around=C.around),C.pinchAround&&(h.pinchAround=C.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(h.pan.mag()){const C=ac(h.pan.mag(),y,f.extend({},Qs,c||{}));x.offset=h.pan.mult(C.amount/h.pan.mag()),x.center=this._map.transform.center,wh(x,C)}if(h.zoom){const C=ac(h.zoom,y,Is);x.zoom=this._map.transform.zoom+C.amount,wh(x,C)}if(h.bearing){const C=ac(h.bearing,y,bt);x.bearing=this._map.transform.bearing+f.clamp(C.amount,-179,179),wh(x,C)}if(h.pitch){const C=ac(h.pitch,y,qo);x.pitch=this._map.transform.pitch+C.amount,wh(x,C)}if(x.zoom||x.bearing){const C=void 0===h.pinchAround?h.around:h.pinchAround;x.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function wh(g,c){(!g.duration||g.duration<c.duration)&&(g.duration=c.duration,g.easing=c.easing)}function ac(g,c,h){const{maxSpeed:y,linearity:x,deceleration:C}=h,M=f.clamp(g*x/(c/1e3),-y,y),I=Math.abs(M)/(C*x);return{easing:h.easing,duration:1e3*I,amount:M*(I/2)}}class Cr extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,y,x={}){const C=oo(h.getCanvasContainer(),y),M=h.unproject(C);super(c,f.extend({point:C,lngLat:M,originalEvent:y},x)),this._defaultPrevented=!1,this.target=h}}class Wo extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,y){const x="touchend"===c?y.changedTouches:y.touches,C=aa(h.getCanvasContainer(),x),M=C.map(R=>h.unproject(R)),I=C.reduce((R,N,L,V)=>R.add(N.div(V.length)),new f.Point(0,0));super(c,{points:C,point:I,lngLats:M,lngLat:h.unproject(I),originalEvent:y}),this._defaultPrevented=!1}}class lc extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,y){super(c,{originalEvent:y}),this._defaultPrevented=!1}}class xl{constructor(c,h){this._map=c,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new lc(c.type,this._map,c))}mousedown(c,h){return this._mousedownPos=h,this._firePreventable(new Cr(c.type,this._map,c))}mouseup(c){this._map.fire(new Cr(c.type,this._map,c))}preclick(c){const h=f.extend({},c);h.type="preclick",this._map.fire(new Cr(h.type,this._map,h))}click(c,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(c),this._map.fire(new Cr(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new Cr(c.type,this._map,c))}mouseover(c){this._map.fire(new Cr(c.type,this._map,c))}mouseout(c){this._map.fire(new Cr(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Wo(c.type,this._map,c))}touchmove(c){this._map.fire(new Wo(c.type,this._map,c))}touchend(c){this._map.fire(new Wo(c.type,this._map,c))}touchcancel(c){this._map.fire(new Wo(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wl{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new Cr(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Cr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new Cr(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pr{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,h){this.isEnabled()&&c.shiftKey&&0===c.button&&(ka(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(c,h){if(!this._active)return;const y=h,x=this._startPos,C=this._lastPos;if(!x||!C||C.equals(y)||!this._box&&y.dist(x)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=ln("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const M=Math.min(x.x,y.x),I=Math.max(x.x,y.x),R=Math.min(x.y,y.y),N=Math.max(x.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${R}px)`,this._box.style.width=I-M+"px",this._box.style.height=N-R+"px")})}mouseupWindow(c,h){if(!this._active)return;const y=this._startPos,x=h;if(y&&0===c.button){if(this.reset(),Bo(),y.x!==x.x||y.y!==x.y)return this._map.fire(new f.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:C=>C.fitScreenCoordinates(y,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&27===c.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ra(),delete this._startPos,delete this._lastPos}_fireEvent(c,h){return this._map.fire(new f.Event(c,{originalEvent:h}))}}function Wp(g,c){const h={};for(let y=0;y<g.length;y++)h[g[y].identifier]=c[y];return h}class Or{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,h,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=c.timeStamp),y.length===this.numTouches&&(this.centroid=function(x){const C=new f.Point(0,0);for(const M of x)C._add(M);return C.div(x.length)}(h),this.touches=Wp(y,h)))}touchmove(c,h,y){if(this.aborted||!this.centroid)return;const x=Wp(y,h);for(const C in this.touches){const M=x[C];(!M||M.dist(this.touches[C])>30)&&(this.aborted=!0)}}touchend(c,h,y){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),0===y.length){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class lo{constructor(c){this.singleTap=new Or(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,h,y){this.singleTap.touchstart(c,h,y)}touchmove(c,h,y){this.singleTap.touchmove(c,h,y)}touchend(c,h,y){const x=this.singleTap.touchend(c,h,y);if(x){const C=c.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(x)<30;if(C&&M||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Zp{constructor(){this._zoomIn=new lo({numTouches:1,numTaps:2}),this._zoomOut=new lo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,h,y){this._zoomIn.touchstart(c,h,y),this._zoomOut.touchstart(c,h,y)}touchmove(c,h,y){this._zoomIn.touchmove(c,h,y),this._zoomOut.touchmove(c,h,y)}touchend(c,h,y){const x=this._zoomIn.touchend(c,h,y),C=this._zoomOut.touchend(c,h,y);return x?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(x)},{originalEvent:c})}):C?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(C)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Cl={0:1,2:2};class $a{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,h){return!1}_move(c,h){return{}}mousedown(c,h){if(this._lastPoint)return;const y=vs(c);this._correctButton(c,y)&&(this._lastPoint=h,this._eventButton=y)}mousemoveWindow(c,h){const y=this._lastPoint;if(y)if(c.preventDefault(),null!=this._eventButton&&function(x,C){const M=Cl[C];return void 0===x.buttons||(x.buttons&M)!==M}(c,this._eventButton))this.reset();else if(this._moved||!(h.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(y,h)}mouseupWindow(c){this._lastPoint&&vs(c)===this._eventButton&&(this._moved&&Bo(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class us extends $a{mousedown(c,h){super.mousedown(c,h),this._lastPoint&&(this._active=!0)}_correctButton(c,h){return 0===h&&!c.ctrlKey}_move(c,h){return{around:h,panDelta:h.sub(c)}}}class eu extends $a{_correctButton(c,h){return 0===h&&c.ctrlKey||2===h}_move(c,h){const y=.8*(h.x-c.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(c){c.preventDefault()}}class Yp extends $a{_correctButton(c,h){return 0===h&&c.ctrlKey||2===h}_move(c,h){const y=-.5*(h.y-c.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(c){c.preventDefault()}}class Xp{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),f.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new f.Point(0,0)}touchstart(c,h,y){return this._calculateTransform(c,h,y)}touchmove(c,h,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===y.length&&!f.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,h,y)}}touchend(c,h,y){this._calculateTransform(c,h,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,h,y){y.length>0&&(this._active=!0);const x=Wp(y,h),C=new f.Point(0,0),M=new f.Point(0,0);let I=0;for(const N in x){const L=x[N],V=this._touches[N];V&&(C._add(L),M._add(L.sub(V)),I++,x[N]=L)}if(this._touches=x,I<this._minTouches||!M.mag())return;const R=M.div(I);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(I),panDelta:R}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ln("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class tu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,h,y){return{}}touchstart(c,h,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([h[0],h[1]]))}touchmove(c,h,y){const x=this._firstTwoTouches;if(!x)return;c.preventDefault();const[C,M]=x,I=nu(y,h,C),R=nu(y,h,M);if(!I||!R)return;const N=this._aroundCenter?null:I.add(R).div(2);return this._move([I,R],N,c)}touchend(c,h,y){if(!this._firstTwoTouches)return;const[x,C]=this._firstTwoTouches,M=nu(y,h,x),I=nu(y,h,C);M&&I||(this._active&&Bo(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function nu(g,c,h){for(let y=0;y<g.length;y++)if(g[y].identifier===h)return c[y]}function zm(g,c){return Math.log(g/c)/Math.LN2}class W_ extends tu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,h){const y=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(zm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zm(this._distance,y),pinchAround:h}}}function Vm(g,c){return 180*g.angleWith(c)/Math.PI}class Z_ extends tu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,h){const y=this._vector;if(this._vector=c[0].sub(c[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Vm(this._vector,y),pinchAround:h}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const h=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const x=Vm(c,y);return Math.abs(x)<h}}function cc(g){return Math.abs(g.y)>Math.abs(g.x)}class Y_ extends tu{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,cc(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,h,y){const x=this._lastPoints;if(!x)return;const C=c[0].sub(x[0]),M=c[1].sub(x[1]);return this._map._cooperativeGestures&&!f.isFullscreen()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(C,M,y.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(C.y+M.y)/2*-.5})}gestureBeginsVertically(c,h,y){if(void 0!==this._valid)return this._valid;const x=c.mag()>=2,C=h.mag()>=2;if(!x&&!C)return;if(!x||!C)return null==this._firstMove&&(this._firstMove=y),y-this._firstMove<100&&void 0;const M=c.y>0==h.y>0;return cc(c)&&cc(h)&&M}}const X_={panStep:100,bearingStep:15,pitchStep:10};class Yb{constructor(){const c=X_;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let h=0,y=0,x=0,C=0,M=0;switch(c.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:c.shiftKey?y=-1:(c.preventDefault(),C=-1);break;case 39:c.shiftKey?y=1:(c.preventDefault(),C=1);break;case 38:c.shiftKey?x=1:(c.preventDefault(),M=-1);break;case 40:c.shiftKey?x=-1:(c.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(y=0,x=0),{cameraAnimation:I=>{const R=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:K_,zoom:h?Math.round(R)+h*(c.shiftKey?2:1):R,bearing:I.getBearing()+y*this._bearingStep,pitch:I.getPitch()+x*this._pitchStep,offset:[-C*this._panStep,-M*this._panStep],center:I.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function K_(g){return g*(2-g)}const Um=4.000244140625;class J_{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,f.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||f.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=c.deltaMode===f.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const y=f.exported.now(),x=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,0!==h&&h%Um==0?this._type="wheel":0!==h&&Math.abs(h)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(x*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),c.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=c,this._delta-=h,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=oo(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;"wheel"===this._type&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(0!==this._delta){const R="wheel"===this._type&&Math.abs(this._delta)>Um?this._wheelZoomRate:this._defaultZoomRate;let N=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&0!==N&&(N=1/N);const L=h(),V=Math.pow(2,L),W="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):V;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(W*N))),"wheel"===this._type&&(this._startZoom=L,this._easing=this._smoothOutEasing(200)),this._delta=0}const y="number"==typeof this._targetZoom?this._targetZoom:h(),x=this._startZoom,C=this._easing;let M,I=!1;if("wheel"===this._type&&x&&C){const R=Math.min((f.exported.now()-this._lastWheelEventTime)/200,1),N=C(R);M=f.number(x,y,N),R<1?this._frameId||(this._frameId=!0):I=!0}else M=y,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:M-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let h=f.ease;if(this._prevEase){const y=this._prevEase,x=(f.exported.now()-y.start)/y.duration,C=y.easing(x+.01)-y.easing(x),M=.27/Math.sqrt(C*C+1e-4)*.01,I=Math.sqrt(.0729-M*M);h=f.bezier(M,I,.25,1)}return this._prevEase={start:f.exported.now(),duration:c,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ln("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(f.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Q_{constructor(c,h){this._clickZoom=c,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Gr{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,h){return c.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(c.shiftKey?-1:1),around:y.unproject(h)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jm{constructor(){this._tap=new lo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,h,y){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=h[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(c,h,y))}touchmove(c,h,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const x=h[0],C=x.y-this._swipePoint.y;return this._swipePoint=x,c.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(c,h,y)}touchend(c,h,y){this._tapTime?this._swipePoint&&0===y.length&&this.reset():this._tap.touchend(c,h,y)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ey{constructor(c,h,y){this._el=c,this._mousePan=h,this._touchPan=y}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Xb{constructor(c,h,y){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=h,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Kb{constructor(c,h,y,x){this._el=c,this._touchZoom=h,this._touchRotate=y,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Fr=g=>g.zoom||g.drag||g.pitch||g.rotate;class Kp extends f.Event{}class Jb{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,h){const y=f.sub([],h,c);this.radius=f.length(y[2]<0?f.div([],y,this.constants):[y[0],y[1],0])}projectRay(c){f.div(c,c,this.constants),f.normalize(c,c),f.mul$1(c,c,this.constants);const h=f.scale$2([],c,this.radius);if(h[2]>0){const y=f.scale$2([],[0,0,1],f.dot(h,[0,0,1])),x=f.scale$2([],f.normalize([],[h[0],h[1],0]),this.radius),C=f.add([],h,f.scale$2([],f.sub([],f.add([],x,y),h),2));h[0]=C[0],h[1]=C[1]}return h}}function hs(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class ea{constructor(c,h){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new $n(c),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Jb,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),f.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[f.window.document,"mousemove",{capture:!0}],[f.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[f.window,"blur",void 0]];for(const[x,C,M]of this._listeners)x.addEventListener(C,x===f.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[c,h,y]of this._listeners)c.removeEventListener(h,c===f.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(c){const h=this._map,y=h.getCanvasContainer();this._add("mapEvent",new xl(h,c));const x=h.boxZoom=new Pr(h,c);this._add("boxZoom",x);const C=new Zp,M=new Gr;h.doubleClickZoom=new Q_(M,C),this._add("tapZoom",C),this._add("clickZoom",M);const I=new jm;this._add("tapDragZoom",I);const R=h.touchPitch=new Y_(h);this._add("touchPitch",R);const N=new eu(c),L=new Yp(c);h.dragRotate=new Xb(c,N,L),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);const V=new us(c),W=new Xp(h,c);h.dragPan=new ey(y,V,W),this._add("mousePan",V),this._add("touchPan",W,["touchZoom","touchRotate"]);const X=new Z_,Q=new W_;h.touchZoomRotate=new Kb(y,Q,X,I),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]),this._add("blockableMapEvent",new wl(h));const K=h.scrollZoom=new J_(h,this);this._add("scrollZoom",K,["mousePan"]);const ee=h.keyboard=new Yb;this._add("keyboard",ee);for(const U of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[U]&&h[U].enable(c[U])}_add(c,h,y){this._handlers.push({handlerName:c,handler:h,allowed:y}),this._handlersById[c]=h}stop(c){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fr(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,h,y){for(const x in c)if(x!==y&&(!h||h.indexOf(x)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const h=[];for(const y of c)this._el.contains(y.target)&&h.push(y);return h}handleEvent(c,h){this._updatingCamera=!0;const y="renderFrame"===c.type,x=y?void 0:c,C={needsRenderFrame:!1},M={},I={},R=c.touches?this._getMapTouches(c.touches):void 0,N=R?aa(this._el,R):y?void 0:oo(this._el,c);for(const{handlerName:W,handler:X,allowed:Q}of this._handlers){if(!X.isEnabled())continue;let K;this._blockedByActive(I,Q,W)?X.reset():X[h||c.type]&&(K=X[h||c.type](c,N,R),this.mergeHandlerResult(C,M,K,W,x),K&&K.needsRenderFrame&&this._triggerRenderFrame()),(K||X.isActive())&&(I[W]=X)}const L={};for(const W in this._previousActiveHandlers)I[W]||(L[W]=x);this._previousActiveHandlers=I,(Object.keys(L).length||hs(C))&&(this._changes.push([C,M,L]),this._triggerRenderFrame()),(Object.keys(I).length||hs(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=C;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(c,h,y,x,C){if(!y)return;f.extend(c,y);const M={handlerName:x,originalEvent:y.originalEvent||C};void 0!==y.zoomDelta&&(h.zoom=M),void 0!==y.panDelta&&(h.drag=M),void 0!==y.pitchDelta&&(h.pitch=M),void 0!==y.bearingDelta&&(h.rotate=M)}_applyChanges(){const c={},h={},y={};for(const[x,C,M]of this._changes)x.panDelta&&(c.panDelta=(c.panDelta||new f.Point(0,0))._add(x.panDelta)),x.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+x.pitchDelta),void 0!==x.around&&(c.around=x.around),void 0!==x.aroundCoord&&(c.aroundCoord=x.aroundCoord),void 0!==x.pinchAround&&(c.pinchAround=x.pinchAround),x.noInertia&&(c.noInertia=x.noInertia),f.extend(h,C),f.extend(y,M);this._updateMapTransform(c,h,y),this._changes=[]}_updateMapTransform(c,h,y){const x=this._map,C=x.transform,M=Z=>[Z.x,Z.y,Z.z];if((Z=>{const ie=this._eventsInProgress.drag;return ie&&!this._handlersById[ie.handlerName].isActive()})()&&!hs(c)){const Z=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",Z!==C.zoom&&this._map._update(!0)}if(C._isCameraConstrained&&x._stop(!0),!hs(c))return void this._fireEvents(h,y,!0);let{panDelta:I,zoomDelta:R,bearingDelta:N,pitchDelta:L,around:V,aroundCoord:W,pinchAround:X}=c;C._isCameraConstrained&&(R>0&&(R=0),C._isCameraConstrained=!1),void 0!==X&&(V=X),(R||(Z=>h[Z]&&!this._eventsInProgress[Z])("drag"))&&V&&(this._dragOrigin=M(C.pointCoordinate3D(V)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",x._stop(!0),V=V||x.transform.centerPoint,N&&(C.bearing+=N),L&&(C.pitch+=L),C._updateCameraState();const Q=[0,0,0];if(I)if("mercator"===C.projection.name){const Z=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(V).dir),ie=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(V.sub(I)).dir);Q[0]=ie[0]-Z[0],Q[1]=ie[1]-Z[1]}else{const Z=C.pointCoordinate(V);if("globe"===C.projection.name){I=I.rotate(-C.angle);const ie=C._pixelsPerMercatorPixel/C.worldSize;Q[0]=-I.x*f.mercatorScale(f.latFromMercatorY(Z.y))*ie,Q[1]=-I.y*f.mercatorScale(C.center.lat)*ie}else{const ie=C.pointCoordinate(V.sub(I));Z&&ie&&(Q[0]=ie.x-Z.x,Q[1]=ie.y-Z.y)}}const K=C.zoom,ee=[0,0,0];if(R){const Z=M(W||C.pointCoordinate3D(V)),ie={dir:f.normalize([],f.sub([],Z,C._camera.position))};if(ie.dir[2]<0){const re=C.zoomDeltaToMovement(Z,R);f.scale$2(ee,ie.dir,re)}}const U=f.add(Q,Q,ee);C._translateCameraConstrained(U),R&&Math.abs(C.zoom-K)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(h,y,!0)}_fireEvents(c,h,y){const x=Fr(this._eventsInProgress),C=Fr(c),M={};for(const L in c){const{originalEvent:V}=c[L];this._eventsInProgress[L]||(M[`${L}start`]=V),this._eventsInProgress[L]=c[L]}!x&&C&&this._fireEvent("movestart",C.originalEvent);for(const L in M)this._fireEvent(L,M[L]);C&&this._fireEvent("move",C.originalEvent);for(const L in c){const{originalEvent:V}=c[L];this._fireEvent(L,V)}const I={};let R;for(const L in this._eventsInProgress){const{handlerName:V,originalEvent:W}=this._eventsInProgress[L];this._handlersById[V].isActive()||(delete this._eventsInProgress[L],R=h[V]||W,I[`${L}end`]=R)}for(const L in I)this._fireEvent(L,I[L]);const N=Fr(this._eventsInProgress);if(y&&(x||C)&&!N){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=W=>0!==W&&-this._bearingSnap<W&&W<this._bearingSnap;L?(V(L.bearing||this._map.getBearing())&&(L.bearing=0),this._map.easeTo(L,{originalEvent:R})):(this._map.fire(new f.Event("moveend",{originalEvent:R})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,h){this._map.fire(new f.Event(c,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new Kp("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const dc="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ch extends f.Evented{constructor(c,h){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=!1!==h.respectPrefersReducedMotion,f.bindAll(["_renderFrameCallback"],this)}getCenter(){return new f.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,h){return this.jumpTo({center:c},h)}panBy(c,h,y){return c=f.Point.convert(c).mult(-1),this.panTo(this.transform.center,f.extend({offset:c},h),y)}panTo(c,h,y){return this.easeTo(f.extend({center:c},h),y)}getZoom(){return this.transform.zoom}setZoom(c,h){return this.jumpTo({zoom:c},h),this}zoomTo(c,h,y){return this.easeTo(f.extend({zoom:c},h),y)}zoomIn(c,h){return this.zoomTo(this.getZoom()+1,c,h),this}zoomOut(c,h){return this.zoomTo(this.getZoom()-1,c,h),this}getBearing(){return this.transform.bearing}setBearing(c,h){return this.jumpTo({bearing:c},h),this}getPadding(){return this.transform.padding}setPadding(c,h){return this.jumpTo({padding:c},h),this}rotateTo(c,h,y){return this.easeTo(f.extend({bearing:c},h),y)}resetNorth(c,h){return this.rotateTo(0,f.extend({duration:1e3},c),h),this}resetNorthPitch(c,h){return this.easeTo(f.extend({bearing:0,pitch:0,duration:1e3},c),h),this}snapToNorth(c,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,h):this}getPitch(){return this.transform.pitch}setPitch(c,h){return this.jumpTo({pitch:c},h),this}cameraForBounds(c,h){c=f.LngLatBounds.convert(c);const y=h&&h.bearing||0,x=h&&h.pitch||0,C=c.getNorthWest(),M=c.getSouthEast();return this._cameraForBounds(this.transform,C,M,y,x,h)}_extendCameraOptions(c){const h={top:0,bottom:0,right:0,left:0};if("number"==typeof(c=f.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding){const y=c.padding;c.padding={top:y,bottom:y,right:y,left:y}}return c.padding=f.extend(h,c.padding),c}_minimumAABBFrustumDistance(c,h){const y=h.max[0]-h.min[0],x=h.max[1]-h.min[1];return y/x>c.aspect?y/(2*Math.tan(.5*c.fovX)*c.aspect):x/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,h,y,x,C,M){const I=c.clone(),R=this._extendCameraOptions(M);I.bearing=x,I.pitch=C;const N=f.LngLat.convert(h),L=f.LngLat.convert(y),V=.5*(N.lat+L.lat),W=.5*(N.lng+L.lng),X=f.latLngToECEF(V,W),Q=f.normalize([],X),K=f.normalize([],f.cross([],Q,[0,1,0])),ee=f.cross([],K,Q),U=[K[0],K[1],K[2],0,ee[0],ee[1],ee[2],0,Q[0],Q[1],Q[2],0,0,0,0,1],Z=[X,f.latLngToECEF(N.lat,N.lng),f.latLngToECEF(L.lat,N.lng),f.latLngToECEF(L.lat,L.lng),f.latLngToECEF(N.lat,L.lng),f.latLngToECEF(V,N.lng),f.latLngToECEF(V,L.lng),f.latLngToECEF(N.lat,W),f.latLngToECEF(L.lat,W)];let ie=f.Aabb.fromPoints(Z.map(We=>[f.dot(K,We),f.dot(ee,We),f.dot(Q,We)]));const re=f.transformMat4([],ie.center,U);0===f.squaredLength(re)&&f.set(re,0,0,1),f.normalize(re,re),f.scale$2(re,re,f.GLOBE_RADIUS),I.center=f.ecefToLatLng(re);const ue=I.getWorldToCameraMatrix(),ge=f.invert(new Float64Array(16),ue);ie=f.Aabb.applyTransform(ie,f.multiply([],ue,U)),f.transformMat4(re,re,ue);const me=.5*(ie.max[2]-ie.min[2]),be=this._minimumAABBFrustumDistance(I,ie),ve=f.scale$2([],[0,0,1],me),Ae=f.add(ve,re,ve),Je=be+(0===I.pitch?0:f.distance(re,Ae)),De=I.globeCenterInViewSpace,Ve=f.sub([],re,[De[0],De[1],De[2]]);f.normalize(Ve,Ve),f.scale$2(Ve,Ve,Je);const Re=f.add([],re,Ve);f.transformMat4(Re,Re,ge);const Qe=f.earthRadius/f.GLOBE_RADIUS,Me=f.length(Re),$e=f.mercatorZfromAltitude(Math.max(Me*Qe-f.earthRadius,Number.EPSILON),0),tt=Math.min(I.zoomFromMercatorZAdjusted($e),R.maxZoom);return tt>.5*(f.GLOBE_ZOOM_THRESHOLD_MIN+f.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=tt,this._cameraForBounds(I,h,y,x,C,M)):{center:I.center,zoom:tt,bearing:x,pitch:C}}queryTerrainElevation(c,h){const y=this.transform.elevation;return y?(h=f.extend({},{exaggerated:!0},h),y.getAtPoint(f.MercatorCoordinate.fromLngLat(c),null,h.exaggerated)):null}_cameraForBounds(c,h,y,x,C,M){if("globe"===c.projection.name)return this._cameraForBoundsOnGlobe(c,h,y,x,C,M);const I=c.clone(),R=this._extendCameraOptions(M),N=I.padding;I.bearing=x,I.pitch=C;const L=f.LngLat.convert(h),V=f.LngLat.convert(y),W=new f.LngLat(L.lng,V.lat),X=new f.LngLat(V.lng,L.lat),Q=I.project(L),K=I.project(V),ee=this.queryTerrainElevation(L),U=this.queryTerrainElevation(V),Z=this.queryTerrainElevation(W),ie=this.queryTerrainElevation(X),re=[[Q.x,Q.y,Math.min(ee||0,U||0,Z||0,ie||0)],[K.x,K.y,Math.max(ee||0,U||0,Z||0,ie||0)]];let ue=f.Aabb.fromPoints(re);const ge=I.getWorldToCameraMatrix(),me=f.invert(new Float64Array(16),ge);ue=f.Aabb.applyTransform(ue,ge);const be=f.sub([],ue.max,ue.min),ve=N.left||0,Ae=N.right||0,Je=N.bottom||0,De=N.top||0,{left:Ve,right:Re,top:Qe,bottom:Me}=R.padding,$e=.5*(ve+Ae),tt=.5*(De+Je),We=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(ve+Ae+Ve+Re))/be[0],(I.height-(Je+De+Me+Qe))/be[1])),R.maxZoom),Le=I.scale/I.zoomScale(We);ue=new f.Aabb([ue.min[0]-(Ve+$e)*Le,ue.min[1]-(Me+tt)*Le,ue.min[2]],[ue.max[0]+(Re+$e)*Le,ue.max[1]+(Qe+tt)*Le,ue.max[2]]);const Pt=.5*be[2],nn=this._minimumAABBFrustumDistance(I,ue),Mt=[0,0,1,0];f.transformMat4$1(Mt,Mt,ge),f.normalize$2(Mt,Mt);const Ut=f.scale$2([],Mt,nn+Pt),On=f.add([],ue.center,Ut),Sn=("number"==typeof R.offset.x&&"number"==typeof R.offset.y?new f.Point(R.offset.x,R.offset.y):f.Point.convert(R.offset)).rotate(-f.degToRad(x));ue.center[0]-=Sn.x*Le,ue.center[1]+=Sn.y*Le,f.transformMat4(ue.center,ue.center,me),f.transformMat4(On,On,me);const At=[ue.center[0],ue.center[1],On[2]*I.pixelsPerMeter];f.scale$2(At,At,1/I.worldSize);const oi=f.lngFromMercatorX(At[0]),mi=f.latFromMercatorY(At[1]),gi=Math.min(I._zoomFromMercatorZ(At[2]),R.maxZoom),_i=new f.LngLat(oi,mi);return I.mercatorFromTransition&&gi<.5*(f.GLOBE_ZOOM_THRESHOLD_MIN+f.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=gi,this._cameraForBounds(I,h,y,x,C,M)):{center:_i,zoom:gi,bearing:x,pitch:C}}fitBounds(c,h,y){const x=this.cameraForBounds(c,h);return this._fitInternal(x,h,y)}fitScreenCoordinates(c,h,y,x,C){const M=f.Point.convert(c),I=f.Point.convert(h),R=new f.Point(Math.min(M.x,I.x),Math.min(M.y,I.y)),N=new f.Point(Math.max(M.x,I.x),Math.max(M.y,I.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(M,I))return this;const L=this.transform.pointLocation3D(R),V=this.transform.pointLocation3D(N),W=this.transform.pointLocation3D(new f.Point(R.x,N.y)),X=this.transform.pointLocation3D(new f.Point(N.x,R.y)),Q=[Math.min(L.lng,V.lng,W.lng,X.lng),Math.min(L.lat,V.lat,W.lat,X.lat)],K=[Math.max(L.lng,V.lng,W.lng,X.lng),Math.max(L.lat,V.lat,W.lat,X.lat)],ee=x&&x.pitch?x.pitch:this.getPitch(),U=this._cameraForBounds(this.transform,Q,K,y,ee,x);return this._fitInternal(U,x,C)}_fitInternal(c,h,y){return c?(delete(h=f.extend(c,h)).padding,h.linear?this.easeTo(h,y):this.flyTo(h,y)):this}jumpTo(c,h){this.stop();const y=c.preloadOnly?this.transform.clone():this.transform;let x=!1,C=!1,M=!1;return"zoom"in c&&y.zoom!==+c.zoom&&(x=!0,y.zoom=+c.zoom),void 0!==c.center&&(y.center=f.LngLat.convert(c.center)),"bearing"in c&&y.bearing!==+c.bearing&&(C=!0,y.bearing=+c.bearing),"pitch"in c&&y.pitch!==+c.pitch&&(M=!0,y.pitch=+c.pitch),null==c.padding||y.isPaddingEqual(c.padding)||(y.padding=c.padding),c.preloadOnly?(this._preloadTiles(y),this):(this.fire(new f.Event("movestart",h)).fire(new f.Event("move",h)),x&&this.fire(new f.Event("zoomstart",h)).fire(new f.Event("zoom",h)).fire(new f.Event("zoomend",h)),C&&this.fire(new f.Event("rotatestart",h)).fire(new f.Event("rotate",h)).fire(new f.Event("rotateend",h)),M&&this.fire(new f.Event("pitchstart",h)).fire(new f.Event("pitch",h)).fire(new f.Event("pitchend",h)),this.fire(new f.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||f.warnOnce(dc),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,h){const y=this.transform;if(!y.projection.supportsFreeCamera)return f.warnOnce(dc),this;this.stop();const x=y.zoom,C=y.pitch,M=y.bearing;y.setFreeCameraOptions(c);const I=x!==y.zoom,R=C!==y.pitch,N=M!==y.bearing;return this.fire(new f.Event("movestart",h)).fire(new f.Event("move",h)),I&&this.fire(new f.Event("zoomstart",h)).fire(new f.Event("zoom",h)).fire(new f.Event("zoomend",h)),N&&this.fire(new f.Event("rotatestart",h)).fire(new f.Event("rotate",h)).fire(new f.Event("rotateend",h)),R&&this.fire(new f.Event("pitchstart",h)).fire(new f.Event("pitch",h)).fire(new f.Event("pitchend",h)),this.fire(new f.Event("moveend",h)),this}easeTo(c,h){this._stop(!1,c.easeId),(!1===(c=f.extend({offset:[0,0],duration:500,easing:f.ease},c)).animate||this._prefersReducedMotion(c))&&(c.duration=0);const y=this.transform,x=this.getZoom(),C=this.getBearing(),M=this.getPitch(),I=this.getPadding(),R="zoom"in c?+c.zoom:x,N="bearing"in c?this._normalizeBearing(c.bearing,C):C,L="pitch"in c?+c.pitch:M,V="padding"in c?c.padding:y.padding,W=f.Point.convert(c.offset);let X,Q,K;if("globe"===y.projection.name){const ve=f.MercatorCoordinate.fromLngLat(y.center),Ae=W.rotate(-y.angle);ve.x+=Ae.x/y.worldSize,ve.y+=Ae.y/y.worldSize;const Je=ve.toLngLat(),De=f.LngLat.convert(c.center||Je);this._normalizeCenter(De),X=y.centerPoint.add(Ae),Q=new f.Point(ve.x,ve.y).mult(y.worldSize),K=new f.Point(f.mercatorXfromLng(De.lng),f.mercatorYfromLat(De.lat)).mult(y.worldSize).sub(Q)}else{X=y.centerPoint.add(W);const ve=y.pointLocation(X),Ae=f.LngLat.convert(c.center||ve);this._normalizeCenter(Ae),Q=y.project(ve),K=y.project(Ae).sub(Q)}const ee=y.zoomScale(R-x);let U,Z;c.around&&(U=f.LngLat.convert(c.around),Z=y.locationPoint(U));const ie=this._zooming||R!==x,re=this._rotating||C!==N,ue=this._pitching||L!==M,ge=!y.isPaddingEqual(V),me=ve=>Ae=>{if(ie&&(ve.zoom=f.number(x,R,Ae)),re&&(ve.bearing=f.number(C,N,Ae)),ue&&(ve.pitch=f.number(M,L,Ae)),ge&&(ve.interpolatePadding(I,V,Ae),X=ve.centerPoint.add(W)),U)ve.setLocationAtPoint(U,Z);else{const Je=ve.zoomScale(ve.zoom-x),De=R>x?Math.min(2,ee):Math.max(.5,ee),Ve=Math.pow(De,1-Ae),Re=ve.unproject(Q.add(K.mult(Ae*Ve)).mult(Je));ve.setLocationAtPoint(ve.renderWorldCopies?Re.wrap():Re,X)}return c.preloadOnly||this._fireMoveEvents(h),ve};if(c.preloadOnly){const ve=this._emulate(me,c.duration,y);return this._preloadTiles(ve),this}const be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ie,this._rotating=re,this._pitching=ue,this._padding=ge,this._easeId=c.easeId,this._prepareEase(h,c.noMoveStart,be),this._ease(me(y),ve=>{y.recenterOnTerrain(),this._afterEase(h,ve)},c),this}_prepareEase(c,h,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||y.moving||this.fire(new f.Event("movestart",c)),this._zooming&&!y.zooming&&this.fire(new f.Event("zoomstart",c)),this._rotating&&!y.rotating&&this.fire(new f.Event("rotatestart",c)),this._pitching&&!y.pitching&&this.fire(new f.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new f.Event("move",c)),this._zooming&&this.fire(new f.Event("zoom",c)),this._rotating&&this.fire(new f.Event("rotate",c)),this._pitching&&this.fire(new f.Event("pitch",c))}_afterEase(c,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,x=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new f.Event("zoomend",c)),x&&this.fire(new f.Event("rotateend",c)),C&&this.fire(new f.Event("pitchend",c)),this.fire(new f.Event("moveend",c))}flyTo(c,h){if(this._prefersReducedMotion(c)){const We=f.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(We,h)}this.stop(),c=f.extend({offset:[0,0],speed:1.2,curve:1.42,easing:f.ease},c);const y=this.transform,x=this.getZoom(),C=this.getBearing(),M=this.getPitch(),I=this.getPadding(),R="zoom"in c?f.clamp(+c.zoom,y.minZoom,y.maxZoom):x,N="bearing"in c?this._normalizeBearing(c.bearing,C):C,L="pitch"in c?+c.pitch:M,V="padding"in c?c.padding:y.padding,W=y.zoomScale(R-x),X=f.Point.convert(c.offset);let Q=y.centerPoint.add(X);const K=y.pointLocation(Q),ee=f.LngLat.convert(c.center||K);this._normalizeCenter(ee);const U=y.project(K),Z=y.project(ee).sub(U);let ie=c.curve;const re=Math.max(y.width,y.height),ue=re/W,ge=Z.mag();if("minZoom"in c){const We=f.clamp(Math.min(c.minZoom,x,R),y.minZoom,y.maxZoom),Le=re/y.zoomScale(We-x);ie=Math.sqrt(Le/ge*2)}const me=ie*ie;function be(We){const Le=(ue*ue-re*re+(We?-1:1)*me*me*ge*ge)/(2*(We?ue:re)*me*ge);return Math.log(Math.sqrt(Le*Le+1)-Le)}function ve(We){return(Math.exp(We)-Math.exp(-We))/2}function Ae(We){return(Math.exp(We)+Math.exp(-We))/2}const Je=be(0);let De=function(We){return Ae(Je)/Ae(Je+ie*We)},Ve=function(We){return re*((Ae(Je)*(ve(Le=Je+ie*We)/Ae(Le))-ve(Je))/me)/ge;var Le},Re=(be(1)-Je)/ie;if(Math.abs(ge)<1e-6||!isFinite(Re)){if(Math.abs(re-ue)<1e-6)return this.easeTo(c,h);const We=ue<re?-1:1;Re=Math.abs(Math.log(ue/re))/ie,Ve=function(){return 0},De=function(Le){return Math.exp(We*ie*Le)}}c.duration="duration"in c?+c.duration:1e3*Re/("screenSpeed"in c?+c.screenSpeed/ie:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const Qe=C!==N,Me=L!==M,$e=!y.isPaddingEqual(V),tt=We=>Le=>{const Pt=Le*Re,nn=1/De(Pt);We.zoom=1===Le?R:x+We.scaleZoom(nn),Qe&&(We.bearing=f.number(C,N,Le)),Me&&(We.pitch=f.number(M,L,Le)),$e&&(We.interpolatePadding(I,V,Le),Q=We.centerPoint.add(X));const Mt=1===Le?ee:We.unproject(U.add(Z.mult(Ve(Pt))).mult(nn));return We.setLocationAtPoint(We.renderWorldCopies?Mt.wrap():Mt,Q),We._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(h),We};if(c.preloadOnly){const We=this._emulate(tt,c.duration,y);return this._preloadTiles(We),this}return this._zooming=!0,this._rotating=Qe,this._pitching=Me,this._padding=$e,this._prepareEase(h,!1),this._ease(tt(y),()=>this._afterEase(h),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,h)}if(!c){const y=this.handlers;y&&y.stop(!1)}return this}_ease(c,h,y){!1===y.animate||0===y.duration?(c(1),h()):(this._easeStart=f.exported.now(),this._easeOptions=y,this._onEaseFrame=c,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((f.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,h){c=f.wrap(c,-180,180);const y=Math.abs(c-h);return Math.abs(c-360-h)<y&&(c-=360),Math.abs(c+360-h)<y&&(c+=360),c}_normalizeCenter(c){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const y=c.lng-h.center.lng;c.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(c){return this._respectPrefersReducedMotion&&f.exported.prefersReducedMotion&&!(c&&c.essential)}_emulate(c,h,y){const x=Math.ceil(15*h/1e3),C=[],M=c(y.clone());for(let I=0;I<=x;I++){const R=M(I/x);C.push(R.clone())}return C}}class Dt{constructor(c={}){this.options=c,f.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const h=this.options&&this.options.compact;return this._map=c,this._container=ln("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ln("button","mapboxgl-ctrl-attrib-button",this._container),ln("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ln("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===h&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,h){const y=this._map._getUIString(`AttributionControl.${h}`);c.setAttribute("aria-label",y),c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||f.config.ACCESS_TOKEN}];if(c){const y=h.reduce((x,C,M)=>(C.value&&(x+=`${C.key}=${C.value}${M<h.length-1?"&":""}`),x),"?");c.href=`${f.config.FEEDBACK_URL}/${y}#${Ha(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||"metadata"!==c.sourceDataType&&"visibility"!==c.sourceDataType&&"style"!==c.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const h=this._map.style._sourceCaches;for(const x in h){const C=h[x];if(C.used){const M=C.getSource();M.attribution&&c.indexOf(M.attribution)<0&&c.push(M.attribution)}}c.sort((x,C)=>x.length-C.length),c=c.filter((x,C)=>{for(let M=C+1;M<c.length;M++)if(c[M].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const y=c.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,c.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Hm{constructor(){f.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=ln("div","mapboxgl-ctrl");const h=ln("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&"metadata"!==c.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(0===Object.entries(c).length)return!0;for(const h in c){const y=c[h].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const h=c[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Jp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const h=++this._id;return this._queue.push({callback:c,id:h,cancelled:!1}),h}remove(c){const h=this._currentlyRunning,y=h?this._queue.concat(h):this._queue;for(const x of y)if(x.id===c)return void(x.cancelled=!0)}run(c=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const y of h)if(!y.cancelled&&(y.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function To(g,c,h){if(g=new f.LngLat(g.lng,g.lat),c){const y=new f.LngLat(g.lng-360,g.lat),x=new f.LngLat(g.lng+360,g.lat),C=360*Math.ceil(Math.abs(g.lng-h.center.lng)/360),M=h.locationPoint(g).distSqr(c),I=c.x<0||c.y<0||c.x>h.width||c.y>h.height;h.locationPoint(y).distSqr(c)<M&&(I||Math.abs(y.lng-h.center.lng)<C)?g=y:h.locationPoint(x).distSqr(c)<M&&(I||Math.abs(x.lng-h.center.lng)<C)&&(g=x)}for(;Math.abs(g.lng-h.center.lng)>180;){const y=h.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=h.width&&y.y<=h.height)break;g.lng>h.center.lng?g.lng-=360:g.lng+=360}return g}const va={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class dt extends f.Evented{constructor(c,h){if(super(),(c instanceof f.window.HTMLElement||h)&&(c=f.extend({element:c},h)),f.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=f.Point.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=ln("div");const x=41,C=27,M=Vi("svg",{display:"block",height:x*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${x}`},this._element),I=Vi("radialGradient",{id:"shadowGradient"},Vi("defs",{},M));Vi("stop",{offset:"10%","stop-opacity":.4},I),Vi("stop",{offset:"100%","stop-opacity":.05},I),Vi("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),Vi("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),Vi("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),Vi("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=f.Point.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const y=this._element.classList;for(const x in va)y.remove(`mapboxgl-marker-anchor-${x}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=f.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(24.6+x)],"bottom-right":[-x,-1*(24.6+x)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const h=c.code,y=c.charCode||c.keyCode;"Space"!==h&&"Enter"!==h&&32!==y&&13!==y||this.togglePopup()}_onMapClick(c){const h=c.originalEvent.target,y=this._element;this._popup&&(h===y||y.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,h=this._pos;if(!c||!h)return!1;const y=c.unproject(h),x=c.getFreeCameraOptions();if(!x.position)return!1;const C=x.position.toLngLat();return C.distanceTo(y)<.9*C.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const h=this._pos;if(!h||h.x<0||h.x>c.transform.width||h.y<0||h.y>c.transform.height)return void this._clearFadeTimer();const y=c.unproject(h);let x;c._showingGlobe()&&f.isLngLatBehindGlobe(c.transform,this._lngLat)?x=0:(x=1-c._queryFogOpacity(y),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${c.x}px,${c.y}px)\n            ${va[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${h.x}px,${h.y}px)\n        `}_calculateXYTransform(){const c=this._pos,h=this._map,y=this.getPitchAlignment();if(!h||!c||"map"!==y)return"";if(!h._showingGlobe()){const R=h.getPitch();return R?`rotateX(${R}deg)`:""}const x=f.radToDeg(f.globeTiltAtLngLat(h.transform,this._lngLat)),C=c.sub(f.globeCenterToScreenPoint(h.transform)),M=Math.abs(C.x)+Math.abs(C.y);if(0===M)return"";const I=x/M;return`rotateX(${-C.y*I}deg) rotateY(${C.x*I}deg)`}_calculateZTransform(){const c=this._pos,h=this._map;if(!h||!c)return"";let y=0;const x=this.getRotationAlignment();if("map"===x)if(h._showingGlobe()){const C=h.project(new f.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),M=h.project(new f.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);y=f.radToDeg(Math.atan2(M.y,M.x))-90}else y=-h.getBearing();else if("horizon"===x){const C=f.smoothstep(4,6,h.getZoom()),M=f.globeCenterToScreenPoint(h.transform);M.y+=C*h.transform.height;const I=c.sub(M),R=f.radToDeg(Math.atan2(I.y,I.x));y=(R>90?R-270:R+90)*(1-C)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(c){f.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=To(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),!0===c?this._updateFrameId=f.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=f.Point.convert(c),this._update(),this}_onMove(c){const h=this._map;if(!h)return;const y=this._pointerdownPos,x=this._positionDelta;if(y&&x){if(!this._isDragging){const C=this._clickTolerance||h._clickTolerance;if(c.point.dist(y)<C)return;this._isDragging=!0}this._pos=c.point.sub(x),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new f.Event("dragstart"))),this.fire(new f.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new f.Event("dragend")),this._state="inactive"}_addDragHandler(c){const h=this._map,y=this._pos;h&&y&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(y),this._pointerdownPos=c.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const h=this._map;return h&&(c?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Eh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Qb=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Dh(g=new f.Point(0,0),c="bottom"){if("number"==typeof g){const h=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(c){case"top":return new f.Point(0,g);case"top-left":return new f.Point(h,h);case"top-right":return new f.Point(-h,h);case"bottom":return new f.Point(0,-g);case"bottom-left":return new f.Point(h,-h);case"bottom-right":return new f.Point(-h,-h);case"left":return new f.Point(g,0);case"right":return new f.Point(-g,0)}return new f.Point(0,0)}return g instanceof f.Point||Array.isArray(g)?f.Point.convert(g):f.Point.convert(g[c]||[0,0])}class iu{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const h=f.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,h,y){this._start=this.getValue(h),this._end=c,this._startTime=h,this._endTime=h+y}}const ru={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},$m={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},e0={showCompass:!0,showZoom:!0,visualizePitch:!1};class Gm{constructor(c,h,y=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new eu({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,y&&(this.mousePitch=new Yp({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),f.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(c,h){this.mouseRotate.mousedown(c,h),this.mousePitch&&this.mousePitch.mousedown(c,h),ka()}move(c,h){const y=this.map,x=this.mouseRotate.mousemoveWindow(c,h),C=x&&x.bearingDelta;if(C&&y.setBearing(y.getBearing()+C),this.mousePitch){const M=this.mousePitch.mousemoveWindow(c,h),I=M&&M.pitchDelta;I&&y.setPitch(y.getPitch()+I)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ra(),f.window.removeEventListener("mousemove",this.mousemove),f.window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(f.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),oo(this.element,c)),f.window.addEventListener("mousemove",this.mousemove),f.window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,oo(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){1!==c.targetTouches.length?this.reset():(this._startPos=this._lastPos=aa(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){1!==c.targetTouches.length?this.reset():(this._lastPos=aa(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){0===c.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ou={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Qp={maxWidth:100,unit:"metric"},nd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},id={version:f.version,supported:Pi,setRTLTextPlugin:f.setRTLTextPlugin,getRTLTextPluginStatus:f.getRTLTextPluginStatus,Map:class extends Ch{constructor(g){if(f.LivePerformanceUtils.mark(f.PerformanceMarkers.create),null!=(g=f.extend({},$m,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&f.isSafariWithAntialiasingBug(f.window)&&(g.antialias=!1,f.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ya(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._useWebGL2=g.useWebGL2,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._optimizeForTerrain=g.optimizeForTerrain,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new Jp,this._domRenderTaskQueue=new Jp,this._controls=[],this._markers=[],this._popups=[],this._mapId=f.uniqueId(),this._locale=f.extend({},ru,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new iu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new f.RequestManager(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,"string"==typeof g.container){if(this._container=f.window.document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof f.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&f.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),f.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==f.window&&(f.window.addEventListener("online",this._onWindowOnline,!1),f.window.addEventListener("resize",this._onWindowResize,!1),f.window.addEventListener("orientationchange",this._onWindowResize,!1),f.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),f.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ea(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this._hash=g.hash&&new As("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,f.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),g.attributionControl&&this.addControl(new Dt({customAttribution:g.customAttribution})),this._logoControl=new Hm,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update("style"===c.dataType),this.fire(new f.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new f.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(g,c){if(void 0===c&&(c=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[c];return-1!==c.indexOf("bottom")?y.insertBefore(h,y.firstChild):y.appendChild(h),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(g);return c>-1&&this._controls.splice(c,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new f.Event("movestart",g)).fire(new f.Event("move",g)),this.fire(new f.Event("resize",g)),c&&this.fire(new f.Event("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(f.LngLatBounds.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new f.Event("zoomstart")).fire(new f.Event("zoom")).fire(new f.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new f.Event("zoomstart")).fire(new f.Event("zoom")).fire(new f.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new f.Event("pitchstart")).fire(new f.Event("pitch")).fire(new f.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new f.Event("pitchstart")).fire(new f.Event("pitch")).fire(new f.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return"auto"===g?f.window.navigator.language:Array.isArray(g)?0===g.length?void 0:g.map(c=>"auto"===c?f.window.navigator.language:c):g}setLanguage(g){const c=this._parseLanguage(g);if(!this.style||c===this._language)return this;this._language=c,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(g){return this._lazyInitEmptyStyle(),g?"string"==typeof g&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const g=this.transform,c=g.projection.name;let h;"globe"===c&&g.zoom>=f.GLOBE_ZOOM_THRESHOLD_MAX?(g.setMercatorFromTransition(),h=!0):"mercator"===c&&g.zoom<f.GLOBE_ZOOM_THRESHOLD_MAX&&(g.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,c){return this._updateProjection(g||c||{name:"mercator"})}_updateProjection(g){let c;if(c="globe"===g.name&&this.transform.zoom>=f.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),c){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(g){return this.transform.locationPoint3D(f.LngLat.convert(g))}unproject(g){return this.transform.pointLocation3D(f.Point.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,c,h){if("mouseenter"===g||"mouseover"===g){let y=!1;const x=M=>{const I=c.filter(N=>this.getLayer(N)),R=I.length?this.queryRenderedFeatures(M.point,{layers:I}):[];R.length?y||(y=!0,h.call(this,new Cr(g,this,M.originalEvent,{features:R}))):y=!1},C=()=>{y=!1};return{layers:new Set(c),listener:h,delegates:{mousemove:x,mouseout:C}}}if("mouseleave"===g||"mouseout"===g){let y=!1;const x=M=>{const I=c.filter(R=>this.getLayer(R));(I.length?this.queryRenderedFeatures(M.point,{layers:I}):[]).length?y=!0:y&&(y=!1,h.call(this,new Cr(g,this,M.originalEvent)))},C=M=>{y&&(y=!1,h.call(this,new Cr(g,this,M.originalEvent)))};return{layers:new Set(c),listener:h,delegates:{mousemove:x,mouseout:C}}}{const y=x=>{const C=c.filter(I=>this.getLayer(I)),M=C.length?this.queryRenderedFeatures(x.point,{layers:C}):[];M.length&&(x.features=M,h.call(this,x),delete x.features)};return{layers:new Set(c),listener:h,delegates:{[g]:y}}}}on(g,c,h){if(void 0===h)return super.on(g,c);Array.isArray(c)||(c=[c]);const y=this._createDelegatedListener(g,c,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const x in y.delegates)this.on(x,y.delegates[x]);return this}once(g,c,h){if(void 0===h)return super.once(g,c);Array.isArray(c)||(c=[c]);const y=this._createDelegatedListener(g,c,h);for(const x in y.delegates)this.once(x,y.delegates[x]);return this}off(g,c,h){if(void 0===h)return super.off(g,c);c=new Set(Array.isArray(c)?c:[c]);const y=(C,M)=>{if(C.size!==M.size)return!1;for(const I of C)if(!M.has(I))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[g]:void 0;return x&&(C=>{for(let M=0;M<C.length;M++){const I=C[M];if(I.listener===h&&y(I.layers,c)){for(const R in I.delegates)this.off(R,I.delegates[R]);return C.splice(M,1),this}}})(x),this}queryRenderedFeatures(g,c){return this.style?(void 0!==c||void 0===g||g instanceof f.Point||Array.isArray(g)||(c=g,g=void 0),this.style.queryRenderedFeatures(g=g||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(g,c){return this.style.querySourceFeatures(g,c)}isPointOnSurface(g){const{name:c}=this.transform.projection;return"globe"!==c&&"mercator"!==c&&f.warnOnce(`${c} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(f.Point.convert(g))}setStyle(g,c){return!1!==(c=f.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&g?(this._diffStyle(g,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(g,c))}_getUIString(g){const c=this._locale[g];if(null==c)throw new Error(`Missing UI string '${g}'`);return c}_updateStyle(g,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g&&(this.style=new ua(this,c||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ua(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,c){if("string"==typeof g){const h=this._requestManager.normalizeStyleURL(g),y=this._requestManager.transformRequest(h,f.ResourceType.Style);f.getJSON(y,(x,C)=>{x?this.fire(new f.ErrorEvent(x)):C&&this._updateDiff(C,c)})}else"object"==typeof g&&this._updateDiff(g,c)}_updateDiff(g,c){try{this.style.setState(g)&&this._update(!0)}catch(h){f.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(g,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(f.warnOnce("There is no style added to the map."),!1)}addSource(g,c){return this._lazyInitEmptyStyle(),this.style.addSource(g,c),this._update(!0)}isSourceLoaded(g){return!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){const g=this.style&&this.style._sourceCaches;for(const c in g){const h=g[c]._tiles;for(const y in h){const x=h[y];if("loaded"!==x.state&&"errored"!==x.state)return!1}}return!0}addSourceType(g,c,h){this._lazyInitEmptyStyle(),this.style.addSourceType(g,c,h)}removeSource(g){return this.style.removeSource(g),this._updateTerrain(),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,c,{pixelRatio:h=1,sdf:y=!1,stretchX:x,stretchY:C,content:M}={}){if(this._lazyInitEmptyStyle(),c instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&c instanceof f.window.ImageBitmap){const{width:I,height:R,data:N}=f.exported.getImageData(c);this.style.addImage(g,{data:new f.RGBAImage({width:I,height:R},N),pixelRatio:h,stretchX:x,stretchY:C,content:M,sdf:y,version:0})}else if(void 0===c.width||void 0===c.height)this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:R}=c,N=c;this.style.addImage(g,{data:new f.RGBAImage({width:I,height:R},new Uint8Array(N.data)),pixelRatio:h,stretchX:x,stretchY:C,content:M,sdf:y,version:0,userImage:N}),N.onAdd&&N.onAdd(this,g)}}updateImage(g,c){const h=this.style.getImage(g);if(!h)return void this.fire(new f.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=c instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&c instanceof f.window.ImageBitmap?f.exported.getImageData(c):c,{width:x,height:C}=y;void 0!==x&&void 0!==C?x===h.data.width&&C===h.data.height?(h.data.replace(y.data,!(c instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&c instanceof f.window.ImageBitmap)),this.style.updateImage(g,h)):this.fire(new f.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${C})\n                must be that same as the previous version of the image\n                (${h.data.width}, ${h.data.height})`))):this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new f.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,c){f.getImage(this._requestManager.transformRequest(g,f.ResourceType.Image),(h,y)=>{c(h,y instanceof f.window.HTMLImageElement?f.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(g,c){return this._lazyInitEmptyStyle(),this.style.addLayer(g,c),this._update(!0)}moveLayer(g,c){return this.style.moveLayer(g,c),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}setLayerZoomRange(g,c,h){return this.style.setLayerZoomRange(g,c,h),this._update(!0)}setFilter(g,c,h={}){return this.style.setFilter(g,c,h),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,c,h,y={}){return this.style.setPaintProperty(g,c,h,y),this._update(!0)}getPaintProperty(g,c){return this.style.getPaintProperty(g,c)}setLayoutProperty(g,c,h,y={}){return this.style.setLayoutProperty(g,c,h,y),this._update(!0)}getLayoutProperty(g,c){return this.style.getLayoutProperty(g,c)}setLight(g,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(f.LngLat.convert(g),this.transform):0}setFeatureState(g,c){return this.style.setFeatureState(g,c),this._update()}removeFeatureState(g,c){return this.style.removeFeatureState(g,c),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let h,y,x,C=this._container;for(;C&&(!y||!x);){const M=f.window.getComputedStyle(C).transform;M&&"none"!==M&&(h=M.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&"0"!==h[0]&&"1"!==h[0]&&(y=h[0]),h[3]&&"0"!==h[3]&&"1"!==h[3]&&(x=h[3])),C=C.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=x?Math.abs(c/x):c}_detectMissingCSS(){"rgb(250, 128, 114)"!==f.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&f.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=ln("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=ln("div","mapboxgl-canvas-container",g);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=ln("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=ln("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{y[x]=ln("div",`mapboxgl-ctrl-${x}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,c){const h=f.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(g),this._canvas.height=h*Math.ceil(c),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${c}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const c=this._markers.indexOf(g);-1!==c&&this._markers.splice(c,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const c=this._popups.indexOf(g);-1!==c&&this._popups.splice(c,1)}_setupPainter(){const g=f.extend({},Pi.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._useWebGL2&&this._canvas.getContext("webgl2",g),h=c||this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);h?(this._useWebGL2&&!c&&f.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),f.storeAuthState(h,!0),this.painter=new ki(h,this.transform,!!c),this.on("data",y=>{"source"===y.dataType&&this.painter.setTileLoadedFlag(!0)}),f.exported$1.testSupport(h)):this.fire(new f.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new f.Event("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new f.Event("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let c;const h=this.painter.context.extTimerQuery,y=f.exported.now();if(this.listens("gpu-timing-frame")&&(c=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],f.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],f.window.performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,R=this.transform.pitch,N=f.exported.now(),L=new f.EvaluationParameters(I,{now:N,fadeDuration:x,pitch:R,transition:this.style.getTransition()});this.style.update(L)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new f.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new f.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const I=f.exported.now()-y;h.endQueryEXT(h.TIME_ELAPSED_EXT,c),setTimeout(()=>{const R=h.getQueryObjectEXT(c,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(c),this.fire(new f.Event("gpu-timing-frame",{cpuTime:I,gpuTime:R})),f.window.performance.mark("frame-gpu",{startTime:y,detail:{gpuTime:R}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const R=this.painter.queryGpuTimers(I);this.fire(new f.Event("gpu-timing-layer",{layerTimes:R}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const R=this.painter.queryGpuTimeDeferredRender(I);this.fire(new f.Event("gpu-timing-deferred-render",{gpuTime:R}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(M||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(C=this._updateAverageElevation(y,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new f.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const R=this._calculateSpeedIndex();this.fire(new f.Event("speedindexcompleted",{speedIndex:R})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,f.LivePerformanceUtils.mark(f.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&f.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const c of this._markers)g&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!g||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(g,c=!1){const h=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&h(0);if((c||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const y=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),C=!1;this.transform.elevation&&(C=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=g;const M=Math.abs(y-x);if(M>1){if(this._isInitialLoad||C)return this._averageElevation.jumpTo(x),h(x);this._averageElevation.easeTo(x,g,300)}else if(M>1e-4)return this._averageElevation.jumpTo(x),h(x)}return!!this._averageElevation.isEasing(g)&&h(this._averageElevation.getValue(g))}_authenticate(){f.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===f.AUTH_ERR_MSG||401===g.status)){const c=this.painter.context.gl;f.storeAuthState(c,!1),this._logoControl instanceof Hm&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new f.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),f.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const h=this.painter.context.gl,y=h.createFramebuffer();function x(C){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,C,0);const M=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,M),M}return h.bindFramebuffer(h.FRAMEBUFFER,y),this._canvasPixelComparison(x(g),c.canvasCopies.map(x),c.timeStamps)}_canvasPixelComparison(g,c,h){let y=h[1]-h[0];const x=g.length/4;for(let C=0;C<c.length;C++){const M=c[C];let I=0;for(let R=0;R<M.length;R+=4)M[R]===g[R]&&M[R+1]===g[R+1]&&M[R+2]===g[R+2]&&M[R+3]===g[R+3]&&(I+=1);y+=(h[C+2]-h[C+1])*(1-I/x)}return y}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==f.window&&(f.window.removeEventListener("resize",this._onWindowResize,!1),f.window.removeEventListener("orientationchange",this._onWindowResize,!1),f.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),f.window.removeEventListener("online",this._onWindowOnline,!1),f.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),f.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new f.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=f.exported.frame(c=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(c)}))}_preloadTiles(g){const c=this.style?Object.values(this.style._sourceCaches):[];return f.asyncAll(c,(h,y)=>h._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){"hidden"===f.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,g&&this._update())}_setCacheLimits(g,c){f.setCacheLimits(g,c)}get version(){return f.version}},NavigationControl:class{constructor(g){this.options=f.extend({},e0,g),this._container=ln("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(f.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),ln("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),ln("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(f.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:c}):h.resetNorth({},{originalEvent:c}))}),this._compassIcon=ln("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const c=g.getZoom(),h=c===g.getMaxZoom(),y=c===g.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gm(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,c){const h=ln("button",g,this._container);return h.type="button",h.addEventListener("click",c),h}_setButtonTitle(g,c){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${c}`);g.setAttribute("aria-label",h),g.firstElementChild&&g.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends f.Evented{constructor(g){super(),this.options=f.extend({geolocation:f.window.navigator.geolocation},ou,g),f.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Js(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=ln("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const c=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,g(h)};void 0!==this._supportsGeolocation?g(this._supportsGeolocation):void 0!==f.window.navigator.permissions?f.window.navigator.permissions.query({name:"geolocation"}).then(h=>c("denied"!==h.state)).catch(()=>c()):c()}_isOutOfMapMaxBounds(g){const c=this._map.getMaxBounds(),h=g.coords;return!!c&&(h.longitude<c.getWest()||h.longitude>c.getEast()||h.latitude<c.getSouth()||h.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new f.Event("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(g),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(g),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("geolocate",g)),this._finish()}}_updateCamera(g){const c=new f.LngLat(g.coords.longitude,g.coords.latitude),h=g.coords.accuracy,y=this._map.getBearing(),x=f.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(h),x,{geolocateSource:!0})}_updateMarker(g){if(g){const c=new f.LngLat(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,c=f.mercatorZfromAltitude(1,g._center.lat)*g.worldSize,h=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(1===g.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===g.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=ln("button","mapboxgl-ctrl-geolocate",this._container),ln("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===g){f.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ln("div","mapboxgl-user-location"),this._dotElement.appendChild(ln("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ln("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new dt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ln("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new dt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||"ACTIVE_LOCK"!==this._watchState||c.originalEvent&&"resize"===c.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new f.Event("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:!0===g.absolute&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return f.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new f.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new f.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new f.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{f.window.addEventListener("ondeviceorientationabsolute"in f.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==f.window.DeviceMotionEvent&&"function"==typeof f.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(c=>{"granted"===c&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),f.window.removeEventListener("deviceorientation",this._onDeviceOrientation),f.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Dt,ScaleControl:class{constructor(g){this.options=f.extend({},Qp,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),f.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,c=this._map,h=c._containerHeight/2,y=c._containerWidth/2-g/2,x=c.unproject([y,h]),C=c.unproject([y+g,h]),M=x.distanceTo(C);if("imperial"===this.options.unit){const I=3.2808*M;I>5280?this._setScale(g,I/5280,"mile"):this._setScale(g,I,"foot")}else"nautical"===this.options.unit?this._setScale(g,M/1852,"nautical-mile"):M>=1e3?this._setScale(g,M/1e3,"kilometer"):this._setScale(g,M,"meter")}_setScale(g,c,h){this._map._requestDomTask(()=>{const y=function(C){const M=Math.pow(10,`${Math.floor(C)}`.length-1);let I=C/M;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(R){const N=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*N)/N}(I),M*I}(c),x=y/c;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==h?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(y):`${y}&nbsp;${nd[h]}`,this._container.style.width=g*x+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=ln("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof f.window.HTMLElement?this._container=g.container:f.warnOnce("Full screen control 'container' must be a DOM element.")),f.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in f.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in f.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=ln("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",f.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,f.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!f.window.document.fullscreenEnabled&&!f.window.document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=ln("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ln("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),f.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(f.window.document.fullscreenElement||f.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?f.window.document.exitFullscreen?f.window.document.exitFullscreen():f.window.document.webkitCancelFullScreen&&f.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends f.Evented{constructor(g){super(),this.options=f.extend(Object.create(Eh),g),f.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new f.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new f.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=f.LngLat.convert(g),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(f.window.document.createTextNode(g))}setHTML(g){const c=f.window.document.createDocumentFragment(),h=f.window.document.createElement("body");let y;for(h.innerHTML=g;y=h.firstChild,y;)c.appendChild(y);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=ln("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(g),this.options.closeButton){const h=this._closeButton=ln("button","mapboxgl-popup-close-button",c);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let c;return this._classList.delete(g)?c=!1:(this._classList.add(g),c=!0),this._updateClassList(),c}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const c=this._map,h=this._container,y=this._pos;if(!c||!h||!y)return"bottom";const x=h.offsetWidth,C=h.offsetHeight,M=y.x<x/2,I=y.x>c.transform.width-x/2;if(y.y+g<C)return M?"top-left":I?"top-right":"top";if(y.y>c.transform.height-C){if(M)return"bottom-left";if(I)return"bottom-right"}return M?"left":I?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),g.className=c.join(" ")}_update(g){const c=this._map,h=this._content;if(!c||!this._lngLat&&!this._trackPointer||!h)return;let y=this._container;if(y||(y=this._container=ln("div","mapboxgl-popup",c.getContainer()),this._tip=ln("div","mapboxgl-popup-tip",y),y.appendChild(h)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=To(this._lngLat,this._pos,c.transform)),!this._trackPointer||g){const x=this._pos=this._trackPointer&&g?g:c.project(this._lngLat),C=Dh(this.options.offset),M=this._anchor=this._getAnchor(C.y),I=Dh(this.options.offset,M),R=x.add(I).round();c._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${va[M]} translate(${R.x}px,${R.y}px)`)})}if(!this._marker&&c._showingGlobe()){const x=f.isLngLatBehindGlobe(c.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Qb);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:dt,Style:ua,LngLat:f.LngLat,LngLatBounds:f.LngLatBounds,Point:f.Point,MercatorCoordinate:f.MercatorCoordinate,FreeCameraOptions:tr,Evented:f.Evented,config:f.config,prewarm:function(){Ki().acquire(ca)},clearPrewarmedResources:function(){const g=wo;g&&(g.isPreloaded()&&1===g.numActive()?(g.release(ca),wo=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return f.config.ACCESS_TOKEN},set accessToken(g){f.config.ACCESS_TOKEN=g},get baseApiUrl(){return f.config.API_URL},set baseApiUrl(g){f.config.API_URL=g},get workerCount(){return Ni.workerCount},set workerCount(g){Ni.workerCount=g},get maxParallelImageRequests(){return f.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){f.config.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){f.clearTileCache(g)},workerUrl:"",workerClass:null,setNow:f.exported.setNow,restoreNow:f.exported.restoreNow};return id}),mn}()},762:(Gs,jr,zi)=>{var mn;if("object"==typeof globalThis)mn=globalThis;else try{mn=zi(878)}catch{}finally{if(!mn&&typeof window<"u"&&(mn=window),!mn)throw new Error("Could not determine global this")}var io=mn.WebSocket||mn.MozWebSocket,wr=zi(386);function f(Ie,Pi){return Pi?new io(Ie,Pi):new io(Ie)}io&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(Ie){Object.defineProperty(f,Ie,{get:function(){return io[Ie]}})}),Gs.exports={w3cwebsocket:io?f:null,version:wr}},386:(Gs,jr,zi)=>{Gs.exports=zi(794).version},794:Gs=>{"use strict";Gs.exports={version:"1.0.34"}}},Gs=>{Gs(Gs.s=702)}]);